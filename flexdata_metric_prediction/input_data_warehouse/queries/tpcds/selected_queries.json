[
  "\nSELECT \n    COUNT(*) AS total_sales,\n    SUM(ss_net_profit) AS total_net_profit,\n    AVG(ss_sales_price) AS average_sales_price,\n    MAX(ss_sales_price) AS max_sales_price,\n    MIN(ss_sales_price) AS min_sales_price,\n    SUM(ss_quantity) AS total_quantity_sold\nFROM \n    store_sales\nWHERE \n    ss_sold_date_sk BETWEEN 5000 AND 6000;\n",
  "\nSELECT \n    SUM(ss_net_paid) AS total_net_paid,\n    COUNT(DISTINCT ss_customer_sk) AS total_customers,\n    AVG(ss_sales_price) AS average_sales_price,\n    MAX(ss_net_profit) AS max_net_profit,\n    MIN(ss_ext_discount_amt) AS min_discount\nFROM \n    store_sales \nWHERE \n    ss_sold_date_sk BETWEEN 10000 AND 20000;\n",
  "\nSELECT COUNT(*) AS total_sales, \n       SUM(ss_sales_price) AS total_sales_amount, \n       AVG(ss_sales_price) AS average_sales_price, \n       MAX(ss_sales_price) AS max_sales_price, \n       MIN(ss_sales_price) AS min_sales_price \nFROM store_sales \nWHERE ss_sold_date_sk BETWEEN 20200101 AND 20201231;\n",
  "WITH sales_summary AS (\n    SELECT \n        SUM(ss_ext_sales_price) AS total_sales,\n        COUNT(ss_ticket_number) AS total_transactions,\n        AVG(ss_net_profit) AS avg_net_profit\n    FROM \n        store_sales\n    WHERE \n        ss_sold_date_sk BETWEEN 2457122 AND 2457485 \n)\nSELECT \n    total_sales,\n    total_transactions,\n    avg_net_profit\nFROM \n    sales_summary;",
  "\nSELECT COUNT(*) AS total_customers \nFROM customer;\n",
  "\nSELECT COUNT(*) AS total_customers\nFROM customer;\n",
  "\nSELECT COUNT(*) AS total_customers FROM customer;\n",
  "\nSELECT \n    COUNT(*) AS total_customers\nFROM \n    customer;\n",
  "\nSELECT DISTINCT ca_city, ca_state \nFROM customer_address \nWHERE ca_country = 'USA';\n",
  "\nSELECT \n    COUNT(*) AS total_customers, \n    COUNT(DISTINCT c_customer_id) AS distinct_customers \nFROM \n    customer;\n",
  "\nSELECT SUM(ss_net_profit) AS total_net_profit\nFROM store_sales\nWHERE ss_sold_date_sk BETWEEN 20230101 AND 20231231;\n",
  "\nSELECT \n    ca_address_id, \n    ca_street_name, \n    ca_city, \n    ca_state \nFROM \n    customer_address \nWHERE \n    ca_state = 'CA' \nORDER BY \n    ca_city;\n",
  "\nSELECT COUNT(*) AS total_customers\nFROM customer\nWHERE c_birth_year = 1980;\n",
  "\nSELECT SUM(ss_sales_price) AS total_sales, COUNT(ss_ticket_number) AS total_transactions\nFROM store_sales\nWHERE ss_sold_date_sk BETWEEN 1000 AND 2000;\n",
  "\nSELECT COUNT(*)\nFROM customer\nWHERE c_preferred_cust_flag = 'Y';\n",
  "\nSELECT SUM(ws_net_profit) AS total_net_profit \nFROM web_sales \nWHERE ws_sold_date_sk BETWEEN 20230101 AND 20231231;\n",
  "\nSELECT \n    ca_address_id, \n    ca_city, \n    ca_state \nFROM \n    customer_address \nWHERE \n    ca_state = 'CA' \nORDER BY \n    ca_city;\n",
  "\nSELECT COUNT(*) AS total_customers, AVG(cd_purchase_estimate) AS average_purchase_estimate\nFROM customer_demographics\nWHERE cd_gender = 'F' AND cd_marital_status = 'M';\n",
  "\nSELECT COUNT(*) \nFROM customer_address \nWHERE ca_city = 'San Francisco';\n",
  "\nSELECT COUNT(*) AS total_sales\nFROM store_sales\nWHERE ss_sold_date_sk BETWEEN 20230101 AND 20231231;\n",
  "\nSELECT \n    COUNT(*) AS total_customers,\n    COUNT(DISTINCT c_customer_id) AS unique_customer_ids\nFROM \n    customer;\n",
  "\nSELECT COUNT(*) AS total_customers, AVG(cd_purchase_estimate) AS average_purchase_estimate\nFROM customer_demographics\nWHERE cd_gender = 'F';\n",
  "\nWITH StringProcessingResults AS (\n    SELECT \n        ca_address_sk,\n        UPPER(ca_street_name) AS upper_street_name,\n        LOWER(ca_city) AS lower_city,\n        LENGTH(ca_street_type) AS street_type_length,\n        RTRIM(ca_suite_number) AS trimmed_suite_number,\n        CONCAT(ca_street_number, ' ', ca_street_name, ' ', ca_street_type) AS full_address,\n        SUBSTRING(ca_country FROM 1 FOR 3) AS country_abbr\n    FROM \n        customer_address\n    WHERE \n        ca_street_name IS NOT NULL\n)\nSELECT \n    COUNT(*) AS total_records,\n    MAX(street_type_length) AS max_street_type_length,\n    MIN(street_type_length) AS min_street_type_length,\n    AVG(street_type_length) AS avg_street_type_length,\n    STRING_AGG(upper_street_name, ', ') AS combined_upper_street_names,\n    STRING_AGG(lower_city, ', ') AS combined_lower_cities,\n    STRING_AGG(trimmed_suite_number, ', ') AS combined_trimmed_suites,\n    STRING_AGG(full_address, '; ') AS all_full_addresses,\n    COUNT(DISTINCT country_abbr) AS distinct_country_abbr_count\nFROM \n    StringProcessingResults;\n",
  "\nWITH String_Benchmark AS (\n    SELECT\n        c.c_first_name,\n        c.c_last_name,\n        CONCAT(c.c_first_name, ' ', c.c_last_name) AS full_name,\n        LENGTH(CONCAT(c.c_first_name, ' ', c.c_last_name)) AS full_name_length,\n        REPLACE(CONCAT(c.c_first_name, ' ', c.c_last_name), ' ', '') AS full_name_without_spaces,\n        LENGTH(REPLACE(CONCAT(c.c_first_name, ' ', c.c_last_name), ' ', '')) AS full_name_without_spaces_length,\n        LOWER(CONCAT(c.c_first_name, ' ', c.c_last_name)) AS full_name_lower,\n        UPPER(CONCAT(c.c_first_name, ' ', c.c_last_name)) AS full_name_upper,\n        LEFT(CONCAT(c.c_first_name, ' ', c.c_last_name), 10) AS full_name_first_10_chars,\n        RIGHT(CONCAT(c.c_first_name, ' ', c.c_last_name), 10) AS full_name_last_10_chars,\n        SUBSTRING(CONCAT(c.c_first_name, ' ', c.c_last_name), 6, 5) AS full_name_substring\n    FROM\n        customer c\n    WHERE\n        c.c_first_name IS NOT NULL AND c.c_last_name IS NOT NULL\n),\nAggregated_Results AS (\n    SELECT\n        AVG(full_name_length) AS avg_full_name_length,\n        AVG(full_name_without_spaces_length) AS avg_full_name_without_spaces_length,\n        COUNT(*) AS total_records\n    FROM\n        String_Benchmark\n)\nSELECT\n    a.avg_full_name_length,\n    a.avg_full_name_without_spaces_length,\n    a.total_records,\n    (SELECT COUNT(*) FROM customer) AS total_customers,\n    (SELECT COUNT(DISTINCT CONCAT(c_first_name, ' ', c_last_name)) FROM customer) AS unique_full_names,\n    (SELECT COUNT(DISTINCT c_email_address) FROM customer) AS unique_emails\nFROM\n    Aggregated_Results a;\n",
  "\nWITH String_Benchmark AS (\n    SELECT \n        c.c_customer_id, \n        CONCAT(c.c_first_name, ' ', c.c_last_name) AS full_name,\n        REPLACE(c.c_email_address, '@', '#') AS modified_email,\n        UPPER(c.c_birth_country) AS birth_country_upper,\n        LOWER(c.c_login) AS login_lower,\n        LENGTH(c.c_first_name) AS first_name_length,\n        LENGTH(c.c_last_name) AS last_name_length,\n        LENGTH(c.c_email_address) AS email_length,\n        LENGTH(c.c_birth_country) AS country_length\n    FROM \n        customer c\n    WHERE \n        c.c_birth_year BETWEEN 1980 AND 2000\n),\nAggregate_Benchmarks AS (\n    SELECT \n        AVG(first_name_length) AS avg_first_name_length,\n        AVG(last_name_length) AS avg_last_name_length,\n        AVG(email_length) AS avg_email_length,\n        AVG(country_length) AS avg_country_length\n    FROM \n        String_Benchmark\n)\nSELECT \n    sb.full_name, \n    sb.modified_email, \n    sb.birth_country_upper, \n    sb.login_lower, \n    ab.avg_first_name_length, \n    ab.avg_last_name_length, \n    ab.avg_email_length, \n    ab.avg_country_length\nFROM \n    String_Benchmark sb, \n    Aggregate_Benchmarks ab\nORDER BY \n    sb.full_name;\n",
  "\nWITH string_benchmark AS (\n    SELECT \n        c.c_first_name AS customer_first_name,\n        c.c_last_name AS customer_last_name,\n        CONCAT(c.c_first_name, ' ', c.c_last_name) AS full_name,\n        LENGTH(CONCAT(c.c_first_name, ' ', c.c_last_name)) AS full_name_length,\n        UPPER(c.c_first_name) AS first_name_upper,\n        LOWER(c.c_last_name) AS last_name_lower,\n        TRIM(c.c_first_name) AS first_name_trimmed,\n        REPLACE(c.c_last_name, 'a', '@') AS last_name_replaced,\n        LPAD(CAST(c.c_customer_sk AS CHAR), 10, '0') AS padded_customer_id,\n        c.c_email_address,\n        CHAR_LENGTH(c.c_email_address) AS email_length\n    FROM \n        customer c\n    WHERE \n        c.c_email_address IS NOT NULL\n),\nstring_statistics AS (\n    SELECT \n        COUNT(*) AS total_customers,\n        AVG(full_name_length) AS average_full_name_length,\n        MIN(full_name_length) AS min_full_name_length,\n        MAX(full_name_length) AS max_full_name_length,\n        COUNT(DISTINCT first_name_upper) AS unique_first_names,\n        COUNT(DISTINCT last_name_lower) AS unique_last_names\n    FROM \n        string_benchmark\n)\nSELECT \n    total_customers,\n    average_full_name_length,\n    min_full_name_length,\n    max_full_name_length,\n    unique_first_names,\n    unique_last_names,\n    CONCAT('Total Customers: ', total_customers) AS total_customers_summary,\n    CONCAT('Avg Full Name Length: ', ROUND(average_full_name_length, 2)) AS average_full_name_length_summary,\n    CONCAT('Min Full Name Length: ', min_full_name_length) AS min_full_name_length_summary,\n    CONCAT('Max Full Name Length: ', max_full_name_length) AS max_full_name_length_summary,\n    CONCAT('Unique First Names: ', unique_first_names) AS unique_first_names_summary,\n    CONCAT('Unique Last Names: ', unique_last_names) AS unique_last_names_summary\nFROM \n    string_statistics;\n",
  "\nWITH String_Benchmark AS (\n    SELECT \n        c.c_customer_id,\n        CONCAT(c.c_first_name, ' ', c.c_last_name) AS full_name,\n        REPLACE(c.c_email_address, '@example.com', '@test.com') AS modified_email,\n        UPPER(c.c_first_name || ' ' || c.c_last_name) AS upper_case_full_name,\n        LENGTH(c.c_email_address) AS email_length,\n        LEFT(c.c_last_name, 5) AS last_name_prefix,\n        RIGHT(c.c_first_name, 3) AS first_name_suffix,\n        SUBSTR(c.c_last_name, 1, 10) AS truncated_last_name,\n        CASE \n            WHEN c.c_birth_month IS NOT NULL THEN CONCAT(CAST(c.c_birth_month AS VARCHAR), '/', CAST(c.c_birth_day AS VARCHAR))\n            ELSE 'N/A' \n        END AS birth_date_string\n    FROM \n        customer c\n    WHERE \n        c.c_customer_id IS NOT NULL\n)\nSELECT \n    full_name,\n    modified_email,\n    upper_case_full_name,\n    email_length,\n    last_name_prefix,\n    first_name_suffix,\n    truncated_last_name,\n    birth_date_string\nFROM \n    String_Benchmark\nORDER BY\n    email_length DESC,\n    full_name ASC\nLIMIT 100;\n",
  "\nWITH StringManipulations AS (\n    SELECT \n        ca_address_id,\n        UPPER(ca_street_name) AS upper_street_name,\n        LOWER(ca_city) AS lower_city,\n        LENGTH(ca_street_name) AS street_name_length,\n        CONCAT(ca_street_number, ' ', ca_street_name, ' ', ca_street_type) AS full_address,\n        REPLACE(ca_zip, '-', '') AS sanitized_zip,\n        SUBSTRING(ca_country FROM 1 FOR 3) AS country_code\n    FROM \n        customer_address\n    WHERE \n        ca_state IN ('CA', 'TX') AND \n        ca_zip IS NOT NULL\n)\nSELECT \n    COUNT(*) AS records_processed,\n    AVG(street_name_length) AS avg_street_name_length,\n    MAX(upper_street_name) AS max_upper_street_name,\n    MIN(lower_city) AS min_lower_city,\n    STRING_AGG(full_address, '; ') AS full_addresses_sample,\n    COUNT(DISTINCT sanitized_zip) AS unique_zip_codes,\n    STRING_AGG(country_code, ', ') AS sample_country_codes\nFROM \n    StringManipulations;\n",
  "\nWITH StringProcessing AS (\n    SELECT \n        c_first_name,\n        c_last_name,\n        CONCAT(c_first_name, ' ', c_last_name) AS full_name,\n        LENGTH(CONCAT(c_first_name, c_last_name)) AS total_length,\n        CONCAT(SUBSTR(c_last_name, 1, 1), '.') AS short_name,\n        UPPER(c_first_name) AS upper_first_name,\n        LOWER(c_last_name) AS lower_last_name,\n        REPLACE(c_email_address, '@', '[AT]') AS modified_email\n    FROM \n        customer\n    WHERE \n        c_email_address IS NOT NULL\n),\nAggregatedResults AS (\n    SELECT \n        AVG(total_length) AS avg_string_length,\n        COUNT(DISTINCT short_name) AS unique_short_names,\n        COUNT(*) AS total_customers,\n        COUNT(DISTINCT upper_first_name) AS unique_upper_first_names,\n        STRING_AGG(upper_first_name, ', ') AS example_upper_first_names\n    FROM \n        StringProcessing\n)\nSELECT \n    a.avg_string_length,\n    a.unique_short_names,\n    a.total_customers,\n    a.unique_upper_first_names,\n    a.example_upper_first_names\nFROM \n    AggregatedResults a;\n",
  "\nWITH string_benchmarks AS (\n    SELECT \n        ca.ca_address_id,\n        CONCAT(ca.ca_street_number, ' ', ca.ca_street_name, ' ', ca.ca_street_type) AS full_address,\n        LENGTH(CONCAT(ca.ca_street_number, ' ', ca.ca_street_name, ' ', ca.ca_street_type)) AS address_length,\n        UPPER(ca.ca_city) AS city_upper,\n        LOWER(ca.ca_street_name) AS street_name_lower,\n        REPLACE(ca.ca_zip, '-', '') AS zip_cleaned\n    FROM customer_address ca\n    WHERE ca.ca_state = 'CA'\n),\nstring_statistics AS (\n    SELECT \n        COUNT(*) AS total_addresses,\n        AVG(address_length) AS avg_address_length,\n        COUNT(DISTINCT city_upper) AS unique_cities,\n        COUNT(DISTINCT street_name_lower) AS unique_streets,\n        SUM(CASE WHEN zip_cleaned = '' THEN 1 ELSE 0 END) AS missing_zips\n    FROM string_benchmarks\n)\nSELECT \n    total_addresses,\n    avg_address_length,\n    unique_cities,\n    unique_streets,\n    missing_zips,\n    (SELECT COUNT(*) FROM customer_demographics) AS total_demographics,\n    (SELECT COUNT(*) FROM customer) AS total_customers\nFROM string_statistics;\n",
  "\nWITH ProcessedAddresses AS (\n    SELECT \n        ca_address_sk,\n        TRIM(CONCAT(ca_street_number, ' ', ca_street_name, ' ', ca_street_type)) AS FullAddress,\n        UPPER(ca_city) AS UpperCity,\n        LOWER(ca_state) AS LowerState,\n        SUBSTR(ca_zip, 1, 5) AS ShortZip\n    FROM customer_address\n),\nFilteredAddresses AS (\n    SELECT \n        FullAddress,\n        UpperCity,\n        LowerState,\n        ShortZip\n    FROM ProcessedAddresses\n    WHERE UpperCity LIKE '%NEW%'\n)\nSELECT \n    COUNT(*) AS AddressCount,\n    MAX(LENGTH(FullAddress)) AS MaxAddressLength,\n    MIN(LENGTH(FullAddress)) AS MinAddressLength,\n    AVG(LENGTH(FullAddress)) AS AvgAddressLength,\n    STRING_AGG(FullAddress, ', ') AS SampleAddresses\nFROM FilteredAddresses;\n",
  "\nWITH string_benchmark AS (\n    SELECT \n        CONCAT(c_first_name, ' ', c_last_name) AS full_name,\n        SUBSTRING(c_email_address, POSITION('@' IN c_email_address) + 1) AS domain,\n        LENGTH(c_email_address) AS email_length,\n        LOWER(c_first_name) AS lower_first_name,\n        UPPER(c_last_name) AS upper_last_name\n    FROM \n        customer \n    WHERE \n        c_birth_year > 1980\n),\naggregated_results AS (\n    SELECT \n        COUNT(*) AS total_customers,\n        AVG(email_length) AS avg_email_length,\n        COUNT(DISTINCT domain) AS unique_domains\n    FROM \n        string_benchmark\n)\nSELECT \n    total_customers,\n    avg_email_length,\n    unique_domains,\n    CONCAT('Average email length: ', ROUND(avg_email_length, 2)) AS email_length_info,\n    CONCAT('Total customers from 1980 onward: ', total_customers) AS customer_info,\n    CONCAT('Unique email domains: ', unique_domains) AS domain_info\nFROM \n    aggregated_results;\n",
  "\nWITH String_Manipulation AS (\n    SELECT \n        c.c_customer_sk,\n        CONCAT(c.c_first_name, ' ', c.c_last_name) AS full_name,\n        UPPER(c.c_email_address) AS email_upper,\n        TRIM(c.c_birth_country) AS birth_country_trimmed,\n        LEFT(c.c_first_name, 1) || '.' AS first_initial,\n        REPLACE(c.c_first_name, 'a', '@') AS first_name_replaced\n    FROM \n        customer c\n    WHERE \n        c.c_birth_country IS NOT NULL\n),\nAggregated_Results AS (\n    SELECT \n        COUNT(*) AS total_customers,\n        COUNT(DISTINCT full_name) AS unique_full_names,\n        COUNT(DISTINCT email_upper) AS unique_email_upper,\n        COUNT(DISTINCT birth_country_trimmed) AS unique_birth_countries,\n        COUNT(DISTINCT first_initial) AS unique_first_initials,\n        COUNT(DISTINCT first_name_replaced) AS unique_first_name_replaced\n    FROM \n        String_Manipulation\n)\nSELECT \n    total_customers,\n    unique_full_names,\n    unique_email_upper,\n    unique_birth_countries,\n    unique_first_initials,\n    unique_first_name_replaced,\n    ROUND(total_customers * 1.0 / NULLIF(unique_full_names, 0), 2) AS avg_full_names_per_customer,\n    ROUND(total_customers * 1.0 / NULLIF(unique_email_upper, 0), 2) AS avg_emails_per_customer,\n    ROUND(total_customers * 1.0 / NULLIF(unique_birth_countries, 0), 2) AS avg_birth_countries_per_customer,\n    ROUND(total_customers * 1.0 / NULLIF(unique_first_initials, 0), 2) AS avg_initials_per_customer,\n    ROUND(total_customers * 1.0 / NULLIF(unique_first_name_replaced, 0), 2) AS avg_replaced_names_per_customer\nFROM \n    Aggregated_Results;\n",
  "\nWITH StringBenchmarks AS (\n    SELECT\n        c.c_customer_id,\n        CONCAT(c.c_first_name, ' ', c.c_last_name) AS full_name,\n        SUBSTRING(c.c_email_address FROM 1 FOR 15) AS truncated_email,\n        REPLACE(c.c_last_name, 'a', '@') AS obfuscated_last_name,\n        LOWER(c.c_first_name) AS lower_first_name,\n        UPPER(c.c_last_name) AS upper_last_name,\n        LPAD(CAST(c.c_birth_day AS CHAR), 2, '0') || '-' || LPAD(CAST(c.c_birth_month AS CHAR), 2, '0') || '-' || CAST(c.c_birth_year AS CHAR) AS formatted_birthdate,\n        LENGTH(c.c_first_name) AS first_name_length,\n        LENGTH(c.c_last_name) AS last_name_length\n    FROM\n        customer c\n)\nSELECT\n    full_name, \n    truncated_email,\n    obfuscated_last_name,\n    lower_first_name,\n    upper_last_name,\n    formatted_birthdate,\n    first_name_length,\n    last_name_length\nFROM \n    StringBenchmarks\nWHERE \n    first_name_length > 5\nORDER BY \n    last_name_length DESC\nLIMIT 100;\n",
  "\nSELECT COUNT(*) AS total_sales, \n       SUM(ws_ext_sales_price) AS total_revenue, \n       AVG(ws_quantity) AS avg_quantity_per_sale \nFROM web_sales \nWHERE ws_sold_date_sk BETWEEN 2450000 AND 2450500 \n  AND ws_ship_mode_sk IN (SELECT sm_ship_mode_sk \n                          FROM ship_mode \n                          WHERE sm_type = 'Standard')\nGROUP BY ws_ship_mode_sk \nORDER BY total_revenue DESC;\n",
  "\nSELECT \n    COUNT(*) as total_sales, \n    SUM(ws_ext_sales_price) as total_revenue\nFROM \n    web_sales \nWHERE \n    ws_sold_date_sk BETWEEN (SELECT d_date_sk FROM date_dim WHERE d_date = '2023-01-01') AND (SELECT d_date_sk FROM date_dim WHERE d_date = '2023-01-31')\nGROUP BY \n    ws_web_site_sk \nORDER BY \n    total_revenue DESC;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ws_order_number) AS total_orders, \n    COUNT(DISTINCT ws_bill_customer_sk) AS unique_customers\nFROM \n    web_sales \nWHERE \n    ws_sold_date_sk BETWEEN 20210101 AND 20211231 \nGROUP BY \n    ws_ship_mode_sk\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    COUNT(*) AS total_sales,\n    SUM(ss_sales_price) AS total_revenue,\n    AVG(ss_sales_price) AS average_sales_price,\n    MAX(ss_sales_price) AS max_sales_price,\n    MIN(ss_sales_price) AS min_sales_price\nFROM \n    store_sales\nWHERE \n    ss_sold_date_sk BETWEEN 1 AND 365\nGROUP BY \n    ss_store_sk\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    cs_item_sk, \n    SUM(cs_sales_price) AS total_sales, \n    COUNT(DISTINCT cs_order_number) AS total_orders \nFROM \n    catalog_sales \nWHERE \n    cs_sold_date_sk BETWEEN 1 AND 100 \nGROUP BY \n    cs_item_sk \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws_order_number) AS total_orders,\n    AVG(ws_net_profit) AS average_net_profit\nFROM \n    web_sales\nWHERE \n    ws_sold_date_sk BETWEEN 1 AND 365\nGROUP BY \n    ws_ship_mode_sk\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    cs_item_sk, \n    SUM(cs_sales_price) AS total_sales, \n    COUNT(cs_order_number) AS total_orders\nFROM \n    catalog_sales\nWHERE \n    cs_sold_date_sk BETWEEN 1 AND 365\nGROUP BY \n    cs_item_sk\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    COUNT(*) AS Total_Sales, \n    SUM(ss_net_paid) AS Total_Revenue, \n    AVG(ss_net_paid) AS Avg_Sale_Amount, \n    ss_store_sk\nFROM \n    store_sales\nWHERE \n    ss_sold_date_sk BETWEEN 1000 AND 2000 \nGROUP BY \n    ss_store_sk\nORDER BY \n    Total_Revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    cs_item_sk, \n    SUM(cs_sales_price) AS total_sales, \n    COUNT(cs_order_number) AS total_orders \nFROM \n    catalog_sales \nWHERE \n    cs_sold_date_sk BETWEEN 2458922 AND 2458982 \nGROUP BY \n    cs_item_sk \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ws_order_number) AS total_orders, \n    COUNT(DISTINCT ws_bill_customer_sk) AS unique_customers\nFROM \n    web_sales\nWHERE \n    ws_sold_date_sk BETWEEN 1 AND 31\n    AND ws_ship_date_sk IS NOT NULL\nGROUP BY \n    ws_web_site_sk\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT SUM(ss_net_profit) AS total_net_profit, COUNT(DISTINCT ss_ticket_number) AS total_transactions\nFROM store_sales\nWHERE ss_sold_date_sk BETWEEN 1 AND 365\nGROUP BY ss_store_sk\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_net_profit) AS total_net_profit, \n    COUNT(DISTINCT ws_order_number) AS total_orders, \n    AVG(ws_quantity) AS avg_quantity_per_order\nFROM \n    web_sales \nWHERE \n    ws_sold_date_sk BETWEEN 1 AND 365 \nGROUP BY \n    ws_ship_mode_sk \nORDER BY \n    total_net_profit DESC;\n",
  "SELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws_order_number) AS total_orders,\n    AVG(ws_ext_sales_price) AS average_order_value,\n    ws_ship_mode_sk\nFROM \n    web_sales\nWHERE \n    ws_sold_date_sk BETWEEN 2450883 AND 2450920  \nGROUP BY \n    ws_ship_mode_sk\nORDER BY \n    total_sales DESC;",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws_order_number) AS total_orders,\n    COUNT(DISTINCT ws_bill_customer_sk) AS unique_customers,\n    COUNT(DISTINCT ws_item_sk) AS unique_items\nFROM \n    web_sales\nWHERE \n    ws_sold_date_sk BETWEEN 2451545 AND 2451545 + 30\nGROUP BY \n    ws_web_site_sk\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    COUNT(*) AS total_returns,\n    SUM(sr_return_amt) AS total_return_amount,\n    AVG(sr_return_quantity) AS avg_return_quantity,\n    MAX(sr_return_time_sk) AS latest_return_time\nFROM \n    store_returns\nWHERE \n    sr_returned_date_sk > (\n        SELECT \n            MAX(d_date_sk) \n        FROM \n            date_dim \n        WHERE \n            d_year = 2022\n    )\nGROUP BY \n    sr_reason_sk\nORDER BY \n    total_returns DESC;\n",
  "\nSELECT \n    COUNT(*) AS total_sales, \n    SUM(ws_sales_price) AS total_revenue, \n    AVG(ws_sales_price) AS avg_sales_price \nFROM \n    web_sales \nWHERE \n    ws_sold_date_sk BETWEEN 1 AND 30 \nGROUP BY \n    ws_ship_mode_sk \nORDER BY \n    total_revenue DESC;\n",
  "\nSELECT \n    COUNT(*) AS total_sales,\n    SUM(ss_net_profit) AS total_profit,\n    AVG(ss_quantity) AS avg_quantity_sold,\n    MAX(ss_sales_price) AS max_sales_price,\n    MIN(ss_sales_price) AS min_sales_price\nFROM \n    store_sales\nWHERE \n    ss_sold_date_sk BETWEEN 1 AND 365\nGROUP BY \n    ss_store_sk\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ss_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ss_customer_sk) AS unique_customers, \n    AVG(ss_sales_price) AS average_sales_price\nFROM \n    store_sales\nWHERE \n    ss_sold_date_sk BETWEEN 1000 AND 2000\nGROUP BY \n    ss_store_sk\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    cs_item_sk, \n    SUM(cs_quantity) AS total_quantity,\n    SUM(cs_sales_price) AS total_sales,\n    AVG(cs_net_profit) AS average_net_profit\nFROM \n    catalog_sales\nWHERE \n    cs_sold_date_sk BETWEEN 2451877 AND 2451938\nGROUP BY \n    cs_item_sk\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT SUM(ws_ext_sales_price) AS total_sales, COUNT(DISTINCT ws_order_number) AS total_orders\nFROM web_sales\nWHERE ws_sold_date_sk BETWEEN 2451545 AND 2451546\nGROUP BY ws_web_site_sk\nORDER BY total_sales DESC;\n",
  "\nSELECT SUM(ws_ext_sales_price) AS total_sales, \n       COUNT(DISTINCT ws_order_number) AS total_orders, \n       AVG(ws_net_profit) AS average_profit\nFROM web_sales\nWHERE ws_sold_date_sk BETWEEN 1 AND 100\nGROUP BY ws_web_page_sk\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws_order_number) AS total_orders,\n    COUNT(DISTINCT ws_bill_customer_sk) AS unique_customers,\n    AVG(ws_net_paid_inc_tax) AS average_order_value\nFROM \n    web_sales\nWHERE \n    ws_sold_date_sk BETWEEN 2450000 AND 2450050\nGROUP BY \n    ws_web_site_sk\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ws_order_number) AS total_orders, \n    AVG(ws_net_profit) AS average_profit\nFROM \n    web_sales \nWHERE \n    ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    ws_web_site_sk\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    COUNT(*) AS total_returns,\n    SUM(sr_return_quantity) AS total_return_quantity,\n    AVG(sr_return_amt) AS average_return_amount,\n    MAX(sr_return_time_sk) AS latest_return_time\nFROM \n    store_returns\nWHERE \n    sr_returned_date_sk BETWEEN 20230101 AND 20231231\nGROUP BY \n    sr_store_sk\nORDER BY \n    total_returns DESC;\n",
  "\nSELECT \n    SUM(ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss_customer_sk) AS total_customers,\n    COUNT(DISTINCT ss_ticket_number) AS total_transactions,\n    AVG(ss_sales_price) AS avg_sales_price\nFROM \n    store_sales\nWHERE \n    ss_sold_date_sk IN (\n        SELECT d_date_sk \n        FROM date_dim \n        WHERE d_year = 2023\n    )\nGROUP BY \n    ss_store_sk\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws_order_number) AS total_orders,\n    AVG(ws_ext_sales_price) AS avg_sales_price,\n    ws_ship_mode_sk\nFROM \n    web_sales\nWHERE \n    ws_sold_date_sk BETWEEN 10000 AND 10050\nGROUP BY \n    ws_ship_mode_sk\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    SUM(ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws_order_number) AS total_orders, \n    AVG(ws_sales_price) AS average_order_value \nFROM \n    web_sales \nWHERE \n    ws_sold_date_sk BETWEEN 1 AND 100 \nGROUP BY \n    ws_ship_mode_sk \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws_order_number) AS total_orders,\n    AVG(ws_sales_price) AS average_sales_price,\n    ws_ship_mode_sk\nFROM \n    web_sales\nWHERE \n    ws_sold_date_sk BETWEEN 1000 AND 2000\nGROUP BY \n    ws_ship_mode_sk\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "SELECT \n    SUM(ss_ext_sales_price) AS total_sales,\n    COUNT(ss_ticket_number) AS total_transactions,\n    AVG(ss_sales_price) AS average_sale_price\nFROM \n    store_sales\nWHERE \n    ss_sold_date_sk = 2459607 \nGROUP BY \n    ss_store_sk\nORDER BY \n    total_sales DESC\nLIMIT 10;",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws_order_number) AS order_count,\n    AVG(ws_net_profit) AS average_net_profit\nFROM \n    web_sales\nWHERE \n    ws_sold_date_sk BETWEEN (SELECT d_date_sk FROM date_dim WHERE d_date = '2023-01-01') \n    AND (SELECT d_date_sk FROM date_dim WHERE d_date = '2023-12-31')\nGROUP BY \n    ws_web_site_sk\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT COUNT(*) AS total_sales, SUM(ws_ext_sales_price) AS total_revenue\nFROM web_sales\nWHERE ws_sold_date_sk BETWEEN 1 AND 1000\nGROUP BY ws_ship_mode_sk\nORDER BY total_revenue DESC;\n",
  "\nSELECT \n    COUNT(*) AS total_sales,\n    SUM(ss_net_profit) AS total_net_profit,\n    AVG(ss_sales_price) AS average_sales_price,\n    MAX(ss_net_paid) AS max_net_paid,\n    MIN(ss_net_paid) AS min_net_paid\nFROM \n    store_sales\nWHERE \n    ss_sold_date_sk BETWEEN 1000 AND 2000\nGROUP BY \n    ss_store_sk\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    COUNT(*) AS total_sales,\n    SUM(ws_sales_price) AS total_revenue,\n    AVG(ws_net_profit) AS average_profit\nFROM \n    web_sales\nWHERE \n    ws_sold_date_sk BETWEEN (SELECT d_date_sk FROM date_dim WHERE d_date = '2023-01-01') \n    AND (SELECT d_date_sk FROM date_dim WHERE d_date = '2023-12-31')\n    AND ws_ship_mode_sk IN (SELECT sm_ship_mode_sk FROM ship_mode WHERE sm_type = 'AIR')\nGROUP BY \n    ws_item_sk\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    cs_item_sk, \n    SUM(cs_quantity) AS total_sales_quantity, \n    SUM(cs_ext_sales_price) AS total_sales_amount\nFROM \n    catalog_sales\nWHERE \n    cs_sold_date_sk BETWEEN 2450000 AND 2450600\nGROUP BY \n    cs_item_sk\nORDER BY \n    total_sales_quantity DESC\nLIMIT 100;\n",
  "\nSELECT \n    SUM(ws_sales_price) AS Total_Sales, \n    COUNT(DISTINCT ws_order_number) AS Total_Orders, \n    AVG(ws_sales_price) AS Average_Sale_Price \nFROM \n    web_sales \nWHERE \n    ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim) \nGROUP BY \n    ws_item_sk \nORDER BY \n    Total_Sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    SUM(ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss_customer_sk) AS unique_customers,\n    AVG(ss_net_profit) AS average_profit\nFROM\n    store_sales\nWHERE\n    ss_sold_date_sk BETWEEN 1 AND 1000\nGROUP BY\n    ss_store_sk\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count\nFROM customer_address\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count\nFROM customer_address\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count \nFROM customer_address \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count \nFROM customer_address \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 5;\n",
  "\nSELECT ca_city, COUNT(*) AS num_addresses \nFROM customer_address \nGROUP BY ca_city \nORDER BY num_addresses DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(*) AS customer_count \nFROM \n    customer_address \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS num_customers\nFROM customer_address\nGROUP BY ca_city\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS num_addresses\nFROM customer_address\nGROUP BY ca_city\nORDER BY num_addresses DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count\nFROM customer_address\nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(*) AS address_count\nFROM customer_address\nGROUP BY ca_city\nORDER BY address_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(ca_address_sk) AS address_count\nFROM customer_address\nGROUP BY ca_state\nORDER BY address_count DESC;\n",
  "\nSELECT ca_state, COUNT(*) AS total_addresses\nFROM customer_address\nGROUP BY ca_state\nORDER BY total_addresses DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS number_of_addresses\nFROM customer_address\nGROUP BY ca_city\nORDER BY number_of_addresses DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ss_sales_price) AS total_sales\nFROM \n    store_sales\nWHERE \n    ss_sold_date_sk BETWEEN 1 AND 100\nGROUP BY \n    ss_store_sk\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count \nFROM customer_address \nGROUP BY ca_state \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS total_addresses\nFROM customer_address\nGROUP BY ca_city\nORDER BY total_addresses DESC\nLIMIT 10;\n",
  "\nSELECT\n    ca_city,\n    COUNT(*) AS customer_count\nFROM\n    customer_address\nGROUP BY\n    ca_city\nORDER BY\n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count \nFROM customer_address \nGROUP BY ca_state \nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(*) AS city_count \nFROM customer_address \nGROUP BY ca_city \nORDER BY city_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nGROUP BY ca_city\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_state, COUNT(*) as customer_count\nFROM customer_address\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(*) AS customer_count \nFROM \n    customer_address \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) AS total_customers\nFROM customer_address\nGROUP BY ca_state\nORDER BY total_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count \nFROM customer_address \nGROUP BY ca_city \nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(*)\nFROM customer_address\nGROUP BY ca_city\nORDER BY COUNT(*) DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count\nFROM customer_address \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) as address_count\nFROM customer_address\nGROUP BY ca_state\nORDER BY address_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(ca_address_sk) AS address_count\nFROM customer_address\nGROUP BY ca_state\nORDER BY address_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_country, COUNT(*) as customer_count\nFROM customer_address\nGROUP BY ca_country\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as number_of_customers \nFROM customer_address \nGROUP BY ca_city \nORDER BY number_of_customers DESC \nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) as customer_count \nFROM customer_address \nGROUP BY ca_state \nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(*) as total_addresses\nFROM customer_address\nGROUP BY ca_city\nORDER BY total_addresses DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(ca_address_sk) AS address_count \nFROM \n    customer_address \nGROUP BY \n    ca_state \nORDER BY \n    address_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS address_count \nFROM customer_address \nGROUP BY ca_city \nORDER BY address_count DESC \nLIMIT 10;\n",
  "\nSELECT CA.ca_city, COUNT(CA.ca_address_sk) AS address_count\nFROM customer_address CA\nGROUP BY CA.ca_city\nORDER BY address_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as total_customers\nFROM customer_address\nGROUP BY ca_city\nORDER BY total_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(*) AS total_addresses \nFROM \n    customer_address \nGROUP BY \n    ca_city \nORDER BY \n    total_addresses DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(*) as customer_count\nFROM \n    customer_address\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) as customer_count\nFROM customer_address\nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(*) AS customers\nFROM customer_address\nGROUP BY ca_city\nORDER BY customers DESC\nLIMIT 10;\n",
  "\nSELECT SUM(ws_sales_price) AS total_sales, COUNT(ws_order_number) AS total_orders\nFROM web_sales\nWHERE ws_sold_date_sk BETWEEN 1 AND 100\nGROUP BY ws_web_site_sk\nORDER BY total_sales DESC;\n",
  "\nSELECT ca_city, COUNT(*) as address_count\nFROM customer_address\nGROUP BY ca_city\nORDER BY address_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, COUNT(ca_address_sk) AS address_count\nFROM \n    customer_address\nGROUP BY \n    ca_state\nORDER BY \n    address_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nGROUP BY ca_city\nHAVING COUNT(*) > 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nWHERE ca_state = 'CA'\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_country, COUNT(*) AS customer_count\nFROM customer_address\nGROUP BY ca_country\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS number_of_addresses \nFROM customer_address \nGROUP BY ca_city \nORDER BY number_of_addresses DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) \nFROM customer_address \nGROUP BY ca_city \nORDER BY COUNT(*) DESC \nLIMIT 10;\n",
  "\nWITH address_parts AS (\n    SELECT\n        ca_address_sk,\n        TRIM(ca_street_number) AS street_number,\n        INITCAP(LOWER(ca_street_name)) AS street_name,\n        INITCAP(LOWER(ca_street_type)) AS street_type,\n        CA_CITY AS city,\n        CA_STATE AS state,\n        CA_ZIP AS zip,\n        CA_COUNTRY AS country\n    FROM\n        customer_address\n),\nformatted_addresses AS (\n    SELECT\n        ca_address_sk,\n        CONCAT(street_number, ' ', street_name, ' ', street_type, ', ', city, ', ', state, ' ', zip, ', ', country) AS full_address\n    FROM\n        address_parts\n),\nunique_addresses AS (\n    SELECT\n        full_address,\n        COUNT(*) AS address_count\n    FROM\n        formatted_addresses\n    GROUP BY\n        full_address\n    HAVING\n        COUNT(*) > 1\n)\nSELECT \n    ua.full_address,\n    ua.address_count,\n    'Duplicate Address' AS issue\nFROM \n    unique_addresses ua\nORDER BY \n    ua.address_count DESC;\n",
  "\nWITH StringBench AS (\n    SELECT \n        ca_address_id,\n        CONCAT(ca_street_number, ' ', ca_street_name, ' ', ca_street_type) AS full_address,\n        LENGTH(CONCAT(ca_street_number, ' ', ca_street_name, ' ', ca_street_type)) AS address_length,\n        SUBSTR(ca_city, 1, 5) AS city_prefix,\n        UPPER(ca_country) AS country_upper,\n        LOWER(ca_state) AS state_lower,\n        MD5(CONCAT(ca_address_id, CAST(ca_zip AS CHAR))) AS address_checksum\n    FROM \n        customer_address\n    WHERE \n        ca_city IS NOT NULL \n        AND ca_country IS NOT NULL\n)\nSELECT \n    city_prefix,\n    COUNT(*) AS address_count,\n    AVG(address_length) AS avg_address_length,\n    COUNT(DISTINCT country_upper) AS unique_countries,\n    MIN(address_checksum) AS min_checksum,\n    MAX(address_checksum) AS max_checksum\nFROM \n    StringBench\nGROUP BY \n    city_prefix\nORDER BY \n    address_count DESC\nLIMIT 10;\n",
  "\nWITH ProcessedAddresses AS (\n    SELECT \n        ca_address_sk,\n        CONCAT(ca_street_number, ' ', ca_street_name, ' ', ca_street_type) AS full_address,\n        UPPER(ca_city) AS uppercase_city,\n        LOWER(ca_county) AS lowercase_county,\n        TRIM(COALESCE(ca_suite_number, '')) AS trimmed_suite,\n        ca_state,\n        ca_country\n    FROM \n        customer_address\n),\nFilteredAddresses AS (\n    SELECT \n        *,\n        LENGTH(full_address) AS address_length,\n        CASE \n            WHEN LENGTH(full_address) > 50 THEN 'Long Address' \n            ELSE 'Short Address' \n        END AS address_size\n    FROM \n        ProcessedAddresses\n    WHERE \n        UPPER(ca_state) IN ('CA', 'NY', 'TX') \n        AND ca_country = 'USA'\n)\nSELECT \n    uppercase_city,\n    COUNT(*) AS address_count,\n    address_size,\n    MAX(address_length) AS max_address_length\nFROM \n    FilteredAddresses\nGROUP BY \n    uppercase_city, address_size\nORDER BY \n    address_count DESC, uppercase_city ASC;\n",
  "\nWITH ProcessedAddresses AS (\n    SELECT \n        ca_address_sk,\n        TRIM(CONCAT(ca_street_number, ' ', ca_street_name, ' ', ca_street_type)) AS full_address,\n        REPLACE(ca_city, ' ', '-') AS city_slug,\n        ca_state,\n        UPPER(ca_country) AS country_upper\n    FROM \n        customer_address\n),\nAddressAnalytics AS (\n    SELECT \n        full_address,\n        city_slug,\n        ca_state,\n        country_upper,\n        CHAR_LENGTH(full_address) AS address_length,\n        (LENGTH(full_address) - LENGTH(REPLACE(full_address, ' ', ''))) + 1 AS word_count\n    FROM \n        ProcessedAddresses\n)\nSELECT \n    city_slug, \n    ca_state, \n    country_upper,\n    AVG(address_length) AS avg_address_length,\n    AVG(word_count) AS avg_word_count,\n    COUNT(*) AS total_addresses\nFROM \n    AddressAnalytics\nGROUP BY \n    city_slug, ca_state, country_upper\nORDER BY \n    avg_address_length DESC,\n    total_addresses DESC\nLIMIT 10;\n",
  "\nWITH AddressParts AS (\n    SELECT \n        ca_address_sk, \n        TRIM(ca_street_number) AS street_number,\n        TRIM(ca_street_name) AS street_name,\n        TRIM(ca_street_type) AS street_type,\n        CONCAT(TRIM(ca_street_number), ' ', TRIM(ca_street_name), ' ', TRIM(ca_street_type)) AS full_address,\n        ca_city,\n        ca_state,\n        ca_zip,\n        ca_country\n    FROM \n        customer_address\n),\nStreetAddressAnalysis AS (\n    SELECT \n        ca_state,\n        ca_city,\n        COUNT(*) AS address_count,\n        AVG(LENGTH(full_address)) AS avg_address_length,\n        MAX(LENGTH(full_address)) AS max_address_length,\n        MIN(LENGTH(full_address)) AS min_address_length,\n        STRING_AGG(DISTINCT street_type, ', ') AS distinct_street_types\n    FROM \n        AddressParts\n    GROUP BY \n        ca_state, \n        ca_city\n),\nProcessedAddresses AS (\n    SELECT \n        ca_state,\n        ca_city,\n        address_count,\n        avg_address_length,\n        max_address_length,\n        min_address_length,\n        distinct_street_types,\n        CASE \n            WHEN address_count > 100 THEN 'High Volume'\n            WHEN address_count BETWEEN 50 AND 100 THEN 'Medium Volume'\n            ELSE 'Low Volume'\n        END AS volume_category\n    FROM \n        StreetAddressAnalysis\n)\nSELECT \n    *,\n    CONCAT('The number of addresses in ', ca_city, ', ', ca_state, ' is categorized as: ', volume_category) AS volume_description\nFROM \n    ProcessedAddresses\nORDER BY \n    ca_state, \n    ca_city;\n",
  "\nWITH AddressParts AS (\n    SELECT \n        ca_address_sk,\n        CONCAT(TRIM(ca_street_number), ' ', TRIM(ca_street_name), ' ', TRIM(ca_street_type)) AS full_address,\n        TRIM(ca_city) AS city,\n        TRIM(ca_state) AS state,\n        TRIM(ca_zip) AS zip\n    FROM \n        customer_address\n),\nDistinctAddresses AS (\n    SELECT DISTINCT\n        full_address,\n        city,\n        state,\n        zip\n    FROM \n        AddressParts\n),\nAddressStatistics AS (\n    SELECT \n        state,\n        COUNT(DISTINCT full_address) AS unique_address_count,\n        COUNT(DISTINCT city) AS unique_city_count,\n        MAX(LENGTH(full_address)) AS max_address_length\n    FROM \n        DistinctAddresses\n    GROUP BY \n        state\n)\nSELECT \n    state, \n    unique_address_count,\n    unique_city_count,\n    max_address_length,\n    CONCAT('State: ', state, ', Unique Addresses: ', unique_address_count, ', Unique Cities: ', unique_city_count, ', Max Address Length: ', max_address_length) AS detailed_info\nFROM \n    AddressStatistics\nORDER BY \n    state;\n",
  "\nWITH string_benchmark AS (\n    SELECT \n        ca.ca_city AS city,\n        ca.ca_state AS state,\n        CONCAT(ca.ca_street_number, ' ', ca.ca_street_name, ' ', ca.ca_street_type) AS full_address,\n        SUBSTRING(ca.ca_country, 1, 3) AS country_prefix,\n        LENGTH(ca.ca_zip) AS zip_length,\n        lower(ca.ca_city) AS city_lower,\n        upper(ca.ca_state) AS state_upper,\n        REPLACE(ca.ca_street_name, 'Street', 'St') AS street_abbreviation\n    FROM customer_address ca\n    WHERE ca.ca_city IS NOT NULL\n), aggregated_string_benchmark AS (\n    SELECT \n        city_lower,\n        COUNT(*) AS address_count,\n        MAX(zip_length) AS max_zip_length,\n        MIN(zip_length) AS min_zip_length,\n        STRING_AGG(street_abbreviation, ', ') AS all_streets\n    FROM string_benchmark\n    GROUP BY city_lower\n)\nSELECT \n    city_lower,\n    address_count,\n    max_zip_length,\n    min_zip_length,\n    all_streets\nFROM aggregated_string_benchmark\nWHERE address_count > 10\nORDER BY address_count DESC;\n",
  "\nWITH processed_addresses AS (\n    SELECT \n        ca_address_sk,\n        CONCAT(ca_street_number, ' ', ca_street_name, ' ', ca_street_type) AS full_address,\n        REPLACE(REPLACE(REPLACE(ca_city, ' ', ''), '-', ''), ',', '') AS clean_city,\n        UPPER(ca_state) AS upper_state,\n        SUBSTR(ca_zip, 1, 5) AS zip_code\n    FROM \n        customer_address\n),\naddress_stats AS (\n    SELECT \n        upper_state,\n        COUNT(DISTINCT ca_address_sk) AS address_count,\n        AVG(LENGTH(full_address)) AS avg_full_address_length,\n        MAX(LENGTH(clean_city)) AS max_clean_city_length,\n        MIN(LENGTH(clean_city)) AS min_clean_city_length,\n        COUNT(DISTINCT zip_code) AS unique_zip_count\n    FROM \n        processed_addresses\n    GROUP BY \n        upper_state\n)\nSELECT \n    upper_state,\n    address_count,\n    avg_full_address_length,\n    max_clean_city_length,\n    min_clean_city_length,\n    unique_zip_count\nFROM \n    address_stats\nORDER BY \n    address_count DESC, \n    unique_zip_count DESC;\n",
  "\nWITH SplitAddress AS (\n    SELECT\n        ca_address_sk,\n        ca_street_number,\n        ca_street_name,\n        ca_city,\n        ca_state,\n        SPLIT_PART(ca_street_name, ' ', 1) AS first_word,\n        SPLIT_PART(ca_street_name, ' ', 2) AS second_word,\n        LENGTH(ca_street_name) AS street_name_length\n    FROM\n        customer_address\n),\nAggregatedStats AS (\n    SELECT\n        ca_state,\n        COUNT(*) AS address_count,\n        AVG(street_name_length) AS avg_street_length,\n        COUNT(DISTINCT first_word) AS unique_first_words,\n        COUNT(DISTINCT second_word) AS unique_second_words\n    FROM\n        SplitAddress\n    GROUP BY\n        ca_state\n)\nSELECT\n    ca_state,\n    address_count,\n    avg_street_length,\n    unique_first_words,\n    unique_second_words,\n    CASE \n        WHEN avg_street_length > 20 THEN 'Long Streets' \n        ELSE 'Short Streets' \n    END AS street_length_category\nFROM \n    AggregatedStats\nORDER BY \n    avg_street_length DESC, unique_first_words DESC;\n",
  "\nWITH processed_addresses AS (\n    SELECT\n        ca_address_sk,\n        CONCAT(TRIM(ca_street_number), ' ', ca_street_name, ' ', ca_street_type) AS full_address,\n        UPPER(TRIM(ca_city)) AS city_upper,\n        LOWER(TRIM(ca_state)) AS state_lower,\n        CONCAT(SUBSTRING(ca_zip, 1, 5), '-', SUBSTRING(ca_zip, 6, 4)) AS formatted_zip\n    FROM customer_address\n),\naddress_stats AS (\n    SELECT\n        city_upper,\n        state_lower,\n        COUNT(*) AS address_count,\n        AVG(LENGTH(full_address)) AS avg_address_length,\n        COUNT(DISTINCT formatted_zip) AS unique_zip_count\n    FROM processed_addresses\n    GROUP BY city_upper, state_lower\n)\nSELECT\n    city_upper,\n    state_lower,\n    address_count,\n    avg_address_length,\n    unique_zip_count\nFROM address_stats\nWHERE address_count > 1\nORDER BY address_count DESC, avg_address_length ASC\nLIMIT 10;\n",
  "\nWITH StringProcessing AS (\n    SELECT \n        c.c_customer_id,\n        CONCAT(c.c_first_name, ' ', c.c_last_name) AS full_name,\n        UPPER(c.c_email_address) AS email_upper,\n        LOWER(c.c_birth_country) AS country_lower,\n        CASE \n            WHEN c.c_preferred_cust_flag = 'Y' THEN 'Preferred'\n            ELSE 'Regular'\n        END AS customer_type,\n        LENGTH(CONCAT(c.c_first_name, ' ', c.c_last_name)) AS full_name_length,\n        REPLACE(c.c_email_address, '@', '[at]') AS email_obfuscated\n    FROM customer c\n    WHERE c.c_email_address LIKE '%@%'\n),\nAggregatedData AS (\n    SELECT \n        full_name,\n        email_upper,\n        country_lower,\n        customer_type,\n        AVG(full_name_length) AS avg_name_length,\n        COUNT(*) AS customer_count\n    FROM StringProcessing\n    GROUP BY full_name, email_upper, country_lower, customer_type\n)\nSELECT \n    customer_type,\n    COUNT(*) AS total_customers,\n    AVG(avg_name_length) AS average_full_name_length\nFROM AggregatedData\nGROUP BY customer_type\nORDER BY total_customers DESC;\n",
  "\nWITH string_benchmarks AS (\n    SELECT \n        ca_city,\n        ca_state,\n        CONCAT(ca_street_number, ' ', ca_street_name, ' ', ca_street_type) AS full_address,\n        LENGTH(ca_street_name) AS street_name_length,\n        UPPER(ca_street_name) AS upper_street_name,\n        LOWER(ca_street_name) AS lower_street_name,\n        REPLACE(ca_street_name, ' ', '-') AS street_name_hyphenated,\n        SUBSTRING(ca_street_name, 1, 10) AS street_name_short\n    FROM \n        customer_address\n), aggregated_data AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT ca_city) AS distinct_cities,\n        AVG(street_name_length) AS avg_street_name_length,\n        STRING_AGG(upper_street_name, ', ') AS upper_street_names,\n        STRING_AGG(street_name_hyphenated, ', ') AS hyphenated_street_names\n    FROM \n        string_benchmarks\n    GROUP BY \n        ca_state\n)\nSELECT \n    a.ca_state,\n    a.distinct_cities,\n    a.avg_street_name_length,\n    a.upper_street_names,\n    LENGTH(a.upper_street_names) AS total_upper_length,\n    a.hyphenated_street_names,\n    LEAST(a.avg_street_name_length, 50) AS capped_avg_length\nFROM \n    aggregated_data a\nORDER BY \n    a.distinct_cities DESC, a.avg_street_name_length DESC;\n",
  "\nWITH processed_addresses AS (\n    SELECT \n        LOWER(TRIM(CONCAT(ca_street_number, ' ', ca_street_name, ' ', ca_street_type, ', ', ca_city, ', ', ca_state, ' ', ca_zip))) AS complete_address,\n        COUNT(*) AS address_count\n    FROM \n        customer_address\n    GROUP BY \n        ca_street_number, ca_street_name, ca_street_type, ca_city, ca_state, ca_zip\n),\naddress_summary AS (\n    SELECT \n        complete_address,\n        CASE \n            WHEN address_count > 1 THEN 'Duplicate'\n            ELSE 'Unique'\n        END AS address_type\n    FROM \n        processed_addresses\n)\nSELECT \n    address_type,\n    COUNT(*) AS total_addresses,\n    STRING_AGG(complete_address, '; ') AS aggregated_addresses\nFROM \n    address_summary\nGROUP BY \n    address_type\nORDER BY \n    total_addresses DESC;\n",
  "\nWITH String_Benchmark AS (\n    SELECT \n        ca.ca_address_id,\n        ca.ca_street_name,\n        ca.ca_city,\n        ca.ca_state,\n        CONCAT(ca.ca_street_number, ' ', ca.ca_street_name, ' ', ca.ca_street_type) AS full_address,\n        LOWER(ca.ca_city) AS lower_city,\n        UPPER(ca.ca_state) AS upper_state,\n        LENGTH(ca.ca_zip) AS zip_length,\n        REPLACE(ca.ca_street_name, ' ', '') AS street_name_no_spaces,\n        TRIM(ca.ca_street_name) AS trimmed_street_name,\n        SUBSTR(ca.ca_street_name, 1, 10) AS street_name_prefix\n    FROM \n        customer_address ca\n    WHERE \n        ca.ca_state IN ('NY', 'CA', 'TX') \n    ORDER BY \n        ca.ca_address_id\n),\nAggregated_Results AS (\n    SELECT\n        lower_city,\n        upper_state,\n        COUNT(*) AS address_count,\n        AVG(zip_length) AS avg_zip_length,\n        MAX(street_name_prefix) AS max_street_name_prefix\n    FROM \n        String_Benchmark\n    GROUP BY \n        lower_city, upper_state\n)\nSELECT \n    B.lower_city,\n    B.upper_state,\n    B.address_count,\n    B.avg_zip_length,\n    (B.avg_zip_length * 1.0) / NULLIF(B.address_count, 0) AS zip_length_per_address,\n    STRING_AGG(B.max_street_name_prefix, ', ') AS max_street_names\nFROM \n    Aggregated_Results B\nGROUP BY \n    B.lower_city, \n    B.upper_state, \n    B.address_count,\n    B.avg_zip_length\nORDER BY \n    B.lower_city, \n    B.upper_state;\n",
  "\nWITH AddressWords AS (\n    SELECT \n        DISTINCT \n        TRIM(LOWER(SUBSTRING(ca_street_name, POSITION(' ' IN ca_street_name) + 1))) AS word\n    FROM \n        customer_address\n    WHERE \n        ca_street_name IS NOT NULL\n),\nWordCount AS (\n    SELECT \n        word, \n        LENGTH(word) AS length,\n        COUNT(*) AS count\n    FROM \n        AddressWords\n    GROUP BY \n        word\n),\nStringAggregation AS (\n    SELECT \n        STRING_AGG(word, ', ') AS all_words,\n        MAX(length) AS max_length,\n        MIN(length) AS min_length,\n        AVG(length) AS avg_length\n    FROM \n        WordCount\n)\nSELECT \n    all_words,\n    max_length,\n    min_length,\n    avg_length,\n    COUNT(*) AS total_unique_words\nFROM \n    StringAggregation\nGROUP BY \n    all_words, max_length, min_length, avg_length\nORDER BY \n    avg_length DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nFROM \n    customer \nJOIN \n    customer_address ON c_current_addr_sk = ca_address_sk \nWHERE \n    ca_state = 'CA' \nORDER BY \n    c_last_name, \n    c_first_name;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nWHERE \n    ca.ca_state = 'CA' \nORDER BY \n    c.c_last_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'CA'\nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_state = 'CA' \nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state = 'NY'\nORDER BY c.c_last_name, c.c_first_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'CA';\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nWHERE \n    ca.ca_state = 'NY' \nORDER BY \n    c.c_last_name, c.c_first_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_state = 'CA';\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE \n    ca_state = 'CA' \nORDER BY \n    c_last_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_state = 'CA'\nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT \n    COUNT(*) AS total_customers,\n    AVG(cd_purchase_estimate) AS average_purchase_estimate\nFROM \n    customer\nJOIN \n    customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk;\n",
  "\nSELECT c_first_name, c_last_name, ca_city\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'CA'\nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_city = 'San Francisco' \nORDER BY c_last_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'CA';\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_state = 'CA' \nORDER BY c_last_name, c_first_name \nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer AS c \nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk \nWHERE ca_state = 'CA' \nORDER BY c_last_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_state = 'CA' \nORDER BY c_last_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'CA'\nORDER BY c_last_name;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state = 'CA'\nORDER BY c.c_last_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_city = 'Los Angeles' \nORDER BY c_last_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'NY'\nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state = 'CA'\nORDER BY c.c_last_name, c.c_first_name;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state = 'CA'\nORDER BY c.c_last_name, c.c_first_name;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state = 'CA'\nORDER BY c.c_last_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_state = 'NY' \nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'CA'\nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca_state = 'CA'\nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    s.ss_sales_price, \n    s.ss_quantity \nFROM \n    customer c \nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk \nWHERE \n    s.ss_sold_date_sk = 20230101 \nORDER BY \n    s.ss_sales_price DESC \nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_city = 'Los Angeles' AND ca_state = 'CA';\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_state = 'CA' \nORDER BY c_last_name LIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nFROM \n    customer \nJOIN \n    customer_address \nON \n    customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE \n    ca_state = 'CA';\n",
  "\nSELECT c_first_name, c_last_name, ca_city\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state = 'CA'\nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE\n    ca.ca_state = 'CA'\nORDER BY\n    c.c_last_name, c.c_first_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_city = 'San Francisco'\nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT c_customer_id, c_first_name, c_last_name, ca_city, ca_state\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'CA'\nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'NY';\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_state = 'NY';\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nFROM \n    customer \nJOIN \n    customer_address ON c_current_addr_sk = ca_address_sk \nWHERE \n    ca_state = 'CA' \nORDER BY \n    c_last_name, c_first_name;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, a.ca_city, a.ca_state\nFROM customer c\nJOIN customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nWHERE a.ca_state = 'TX';\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'CA' \nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE \n    ca_state = 'CA' \nORDER BY \n    c_last_name, c_first_name;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state = 'CA';\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'CA' AND c_customer_sk < 1000\nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_country = 'USA'\nORDER BY c.c_last_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_country = 'USA';\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nWHERE \n    ca.ca_state = 'CA' \nORDER BY \n    c.c_last_name, c.c_first_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'CA';\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state = 'CA';\n",
  "\nSELECT c_first_name, c_last_name, cd_gender, cd_marital_status \nFROM customer \nJOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk \nWHERE cd_gender = 'F' AND cd_marital_status = 'M';\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city \nFROM customer c \nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nWHERE ca.ca_state = 'CA';\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state\nFROM customer\nJOIN customer_address ON c_current_addr_sk = ca_address_sk\nWHERE ca_state = 'CA'\nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state = 'CA'\nORDER BY c.c_last_name, c.c_first_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_city = 'San Francisco';\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state = 'NY'\nORDER BY c.c_last_name;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nWHERE \n    ca.ca_state = 'CA' \nORDER BY \n    c.c_last_name, c.c_first_name;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE \n    ca_state = 'CA'\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    s.ss_sales_price, \n    s.ss_quantity \nFROM \n    customer c \nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk \nWHERE \n    s.ss_sold_date_sk = 20230101 \nORDER BY \n    s.ss_sales_price DESC \nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nFROM \n    customer \nJOIN \n    customer_address ON c_current_addr_sk = ca_address_sk \nWHERE \n    ca_city = 'San Francisco' \n    AND ca_state = 'CA';\n",
  "\nSELECT \n    COUNT(*) AS total_customers, \n    AVG(cd_purchase_estimate) AS avg_purchase_estimate \nFROM \n    customer \nJOIN \n    customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\nWHERE \n    cd_gender = 'F' \n    AND cd_marital_status = 'M';\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state = 'CA';\n",
  "\nSELECT COUNT(*) AS total_customers, AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM customer\nJOIN customer_demographics ON c_customer_sk = cd_demo_sk\nWHERE cd_gender = 'F' AND cd_marital_status = 'M';\n",
  "\nSELECT c.c_customer_sk, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state = 'CA'\nORDER BY c.c_last_name, c.c_first_name;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE \n    ca_state = 'CA' \nORDER BY \n    c_last_name, \n    c_first_name;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nFROM \n    customer \nJOIN \n    customer_address ON c_current_addr_sk = ca_address_sk \nWHERE \n    ca_state = 'CA' \nORDER BY \n    c_last_name;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE \n    ca_state = 'CA';\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_city = 'San Francisco' \nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state\nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'CA'\nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nLIMIT 10;\n",
  "\nSELECT c_last_name, c_first_name, ca_city, ca_state \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_state = 'CA' \nORDER BY c_last_name, c_first_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state\nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state = 'CA';\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, ca_zip \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE ca_state = 'CA' \nORDER BY c_last_name;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nWHERE \n    ca_state = 'CA'\nORDER BY \n    c_last_name, c_first_name;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state = 'CA'\nORDER BY c.c_first_name;\n",
  "\nWITH StringBenchmark AS (\n    SELECT \n        c.c_first_name AS Customer_First_Name,\n        c.c_last_name AS Customer_Last_Name,\n        ca.ca_city AS Address_City,\n        ca.ca_state AS Address_State,\n        CONCAT(c.c_first_name, ' ', c.c_last_name) AS Full_Name,\n        REPLACE(CONCAT(c.c_first_name, ' ', c.c_last_name), ' ', '_') AS Replace_Space_With_Underscore,\n        LENGTH(CONCAT(c.c_first_name, ' ', c.c_last_name)) AS Full_Name_Length,\n        LOWER(CONCAT(c.c_first_name, ' ', c.c_last_name)) AS Full_Name_Lower,\n        UPPER(CONCAT(c.c_first_name, ' ', c.c_last_name)) AS Full_Name_Upper,\n        SUBSTRING(CONCAT(c.c_first_name, ' ', c.c_last_name), 1, 10) AS Name_Substring,\n        CHAR_LENGTH(CONCAT(c.c_first_name, ' ', c.c_last_name)) AS Char_Length\n    FROM \n        customer AS c\n    JOIN \n        customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\n    WHERE \n        ca.ca_state IN ('NY', 'CA') \n)\nSELECT \n    Customer_First_Name,\n    Customer_Last_Name,\n    Address_City,\n    Address_State,\n    Full_Name,\n    Replace_Space_With_Underscore,\n    Full_Name_Length,\n    Full_Name_Lower,\n    Full_Name_Upper,\n    Name_Substring,\n    Char_Length\nFROM \n    StringBenchmark\nORDER BY \n    Full_Name\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year BETWEEN 1980 AND 1990\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk BETWEEN 1000 AND 2000 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_quantity) AS total_quantity_sold, \n    SUM(ws.ws_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year BETWEEN 1970 AND 1990\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_current_cdemo_sk IS NOT NULL \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS average_sales_price,\n    MAX(ws.ws_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk BETWEEN 2451545 AND 2451545 + 30\nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ss.ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023)\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ss.ss_sold_date_sk BETWEEN 1000 AND 2000\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS sale_count \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS average_profit,\n    COUNT(DISTINCT ss.ss_store_sk) AS unique_stores\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 1000 AND 2000\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 1 AND 365\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim) \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE c.c_birth_year BETWEEN 1980 AND 1990\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "SELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state IN ('CA', 'TX', 'NY')\nGROUP BY ca_state\nORDER BY customer_count DESC;",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_current_cdemo_sk IS NOT NULL \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year BETWEEN 1980 AND 1990\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year = 1980\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    sum(ss.ss_sales_price) as total_sales,\n    count(ss.ss_ticket_number) as total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 20230101 AND 20230131\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 1000 AND 2000\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 2451005 AND 2451350\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS average_sales_price \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_preferred_cust_flag = 'Y' \nAND \n    ss.ss_sold_date_sk BETWEEN 2459586 AND 2459615 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    MAX(ws.ws_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sale\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year BETWEEN 1980 AND 1990\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address a\nJOIN customer c ON a.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year BETWEEN 1980 AND 1990\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS average_sale_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ss.ss_sold_date_sk BETWEEN 1000 AND 2000\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ss_net_profit) AS total_net_profit, \n    COUNT(DISTINCT ss_customer_sk) AS total_customers, \n    COUNT(DISTINCT ss_item_sk) AS total_items_sold\nFROM \n    store_sales \nJOIN \n    date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\nWHERE \n    date_dim.d_year = 2023 \n    AND date_dim.d_month_seq IN (1, 2, 3)\nGROUP BY \n    date_dim.d_month_seq\nORDER BY \n    date_dim.d_month_seq;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions, \n    AVG(ss.ss_sales_price) AS average_sale_price \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nHAVING \n    SUM(ss.ss_sales_price) > 10000 \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 1 AND 100\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_net_profit) AS total_profit,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    c.c_birth_year BETWEEN 1980 AND 1990\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "SELECT \n    COUNT(*) AS total_sales,\n    SUM(ss_net_paid) AS total_revenue,\n    AVG(ss_net_profit) AS average_profit,\n    s_store_name\nFROM \n    store_sales ss\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 2459302 AND 2459330  \nGROUP BY \n    s_store_name\nORDER BY \n    total_sales DESC\nLIMIT 10;",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ws.ws_sold_date_sk BETWEEN 1000 AND 2000\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_net_paid) AS total_sales, \n       COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM customer c \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE ss.ss_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim) \nGROUP BY c.c_customer_id \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE c.c_birth_year BETWEEN 1980 AND 1990\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count,\n    AVG(ss.ss_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 10000 AND 10010\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 2451545 AND 2451545 + 30\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "SELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 1000 AND 1000 + 30 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ss.ss_sold_date_sk >= (SELECT MIN(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023)\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_net_profit) AS total_net_profit, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 2451545 AND 2451626\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales, \n    SUM(ss.ss_ext_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year > 1980\n    AND ss.ss_sold_date_sk BETWEEN 2450000 AND 2450600\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_orders,\n    AVG(ss.ss_sales_price) AS average_order_value,\n    MAX(ss.ss_sales_price) AS max_order_value,\n    MIN(ss.ss_sales_price) AS min_order_value\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sale_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 1 AND 30\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "SELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 2451500 AND 2451540  \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MIN(ss.ss_sold_date_sk) AS first_transaction_date,\n    MAX(ss.ss_sold_date_sk) AS last_transaction_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 2451545 AND 2451545 + 30\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders, \n    AVG(ws.ws_sales_price) AS average_order_value, \n    MIN(ws.ws_sales_price) AS min_order_value, \n    MAX(ws.ws_sales_price) AS max_order_value \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ws.ws_sold_date_sk BETWEEN 1 AND 365 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 2451919 AND 2451950\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "SELECT \n    c.c_customer_id, \n    COUNT(o.ss_item_sk) AS total_items_sold, \n    SUM(o.ss_sales_price) AS total_sales, \n    SUM(o.ss_ext_tax) AS total_tax \nFROM \n    customer c \nJOIN \n    store_sales o ON c.c_customer_sk = o.ss_customer_sk \nWHERE \n    o.ss_sold_date_sk BETWEEN 2451545 AND 2451545 + 30 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;",
  "\nSELECT \n    customer.c_customer_id,\n    SUM(store_sales.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT store_sales.ss_ticket_number) AS total_transactions,\n    AVG(store_sales.ss_sales_price) AS avg_purchase_value\nFROM \n    customer\nJOIN \n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nWHERE \n    store_sales.ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    customer.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE c.c_current_addr_sk IS NOT NULL\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ws.ws_sales_price) AS total_sales, \n       COUNT(ws.ws_order_number) AS total_orders \nFROM customer c \nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE c.c_current_cdemo_sk IS NOT NULL \nGROUP BY c.c_customer_id \nORDER BY total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales, \n    AVG(ss.ss_sales_price) AS average_sales_price, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 1000 AND 2000\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    SUM(ws_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ws_order_number) AS total_orders,\n    AVG(ws_sales_price) AS average_sales_price,\n    SUM(ws_quantity) AS total_quantity_sold\nFROM \n    web_sales\nJOIN \n    date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk\nWHERE \n    d_year = 2023\nGROUP BY \n    d_month_seq\nORDER BY \n    d_month_seq;\n",
  "\nWITH top_items AS (\n    SELECT ws_item_sk, SUM(ws_sales_price) AS total_sales\n    FROM web_sales\n    GROUP BY ws_item_sk\n    ORDER BY total_sales DESC\n    LIMIT 10\n)\nSELECT i.i_item_id, i.i_item_desc, ti.total_sales\nFROM item i\nJOIN top_items ti ON i.i_item_sk = ti.ws_item_sk;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_purchases,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year BETWEEN 1980 AND 1990\nGROUP BY \n    c.c_customer_id\nHAVING \n    COUNT(DISTINCT ss.ss_ticket_number) > 5\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    COUNT(DISTINCT ws.ws_web_page_sk) AS unique_web_pages\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ws.ws_sold_date_sk BETWEEN 2451000 AND 2452000\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk \nWHERE \n    ws.ws_sold_date_sk BETWEEN 1000 AND 2000 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk > (\n        SELECT \n            MAX(d.d_date_sk) \n        FROM \n            date_dim d \n        WHERE \n            d.d_year = 2022\n    )\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value,\n    MAX(ss.ss_sales_price) AS max_transaction_value,\n    MIN(ss.ss_sales_price) AS min_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) as total_sales,\n    COUNT(ss.ss_ticket_number) as number_of_transactions,\n    AVG(ss.ss_sales_price) as average_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_country = 'USA'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year BETWEEN 1980 AND 1990\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 50;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nWHERE ca_state = 'CA'\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    MAX(ws.ws_sold_date_sk) AS last_purchase_date\nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    c.c_current_cdemo_sk IS NOT NULL \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "SELECT \n    c.c_customer_id,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 2450000 AND 2451000 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023) \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sale_price,\n    MIN(ss.ss_sales_price) AS min_sale_price,\n    MAX(ss.ss_sales_price) AS max_sale_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 20230101 AND 20231231\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year BETWEEN 1980 AND 1990\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss_ext_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE c.c_birth_year BETWEEN 1970 AND 2000\n  AND c.c_preferred_cust_flag = 'Y'\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk BETWEEN 1 AND 365 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_store_sk) AS number_of_stores\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 1000 AND 2000\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ws.ws_sold_date_sk IN (SELECT d.d_date_sk FROM date_dim d WHERE d.d_year = 2023)\nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk BETWEEN 1 AND 365 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count,\n    AVG(ss.ss_sales_price) AS average_sale\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 2450000 AND 2450599\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT sr_ticket_number) AS total_returns,\n    SUM(sr_return_amt) AS total_return_amount,\n    SUM(sr_return_tax) AS total_return_tax\nFROM \n    customer c\nJOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_returns DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_spent,\n    COUNT(ss.ss_ticket_number) AS total_purchases,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_spent DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "SELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_quantity) AS avg_quantity_per_transaction\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 2000000 AND 2001000 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders, \n    SUM(ws.ws_sales_price) AS total_sales,\n    MAX(ws.ws_sold_date_sk) AS last_order_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id\nHAVING \n    SUM(ws.ws_sales_price) > 10000\nORDER BY \n    total_sales DESC\nLIMIT \n    100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS average_net_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    d.d_year, \n    SUM(ss_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ss_ticket_number) AS total_transactions, \n    AVG(ss_sales_price) AS average_sales_price\nFROM \n    store_sales\nJOIN \n    date_dim d ON ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year BETWEEN 2020 AND 2023\nGROUP BY \n    d.d_year\nORDER BY \n    d.d_year;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ss.ss_sold_date_sk BETWEEN (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023) - 30 AND (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023)\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ws.ws_sold_date_sk BETWEEN 1000 AND 2000\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nHAVING \n    COUNT(ss.ss_ticket_number) > 5\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM\n    customer AS c\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ss.ss_sold_date_sk BETWEEN 1 AND 100\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_purchases,\n    AVG(ss.ss_sales_price) AS avg_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nWHERE ca_state IS NOT NULL\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, COUNT(DISTINCT sr_ticket_number) AS return_count\nFROM customer c\nJOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY c.c_customer_id\nORDER BY return_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk >= (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "SELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 2451000 AND 2453000 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk BETWEEN 1 AND 365 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_birth_year BETWEEN 1980 AND 1990 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 1000 AND 2000\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount,\n    AVG(ss.ss_net_profit) AS average_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year > 1980\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(ss.ss_ticket_number) AS total_transactions, \n       AVG(ss.ss_sales_price) AS avg_sales_price\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE c.c_current_cdemo_sk IS NOT NULL\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(ss.ss_ticket_number) AS total_transactions\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE c.c_current_addr_sk IS NOT NULL\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    d_year, \n    SUM(ws_sales_price) AS total_sales \nFROM \n    web_sales \nJOIN \n    date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk \nGROUP BY \n    d_year \nORDER BY \n    d_year;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(ss.ss_ticket_number) AS total_transactions \nFROM customer AS c \nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE c.c_birth_year >= 1980 \nGROUP BY c.c_customer_id \nORDER BY total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    SUM(ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss_ticket_number) AS total_transactions,\n    AVG(ss_ext_sales_price) AS average_sales_price,\n    EXTRACT(MONTH FROM d_date) AS sales_month\nFROM \n    store_sales\nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk\nWHERE \n    d_date BETWEEN '2023-01-01' AND '2023-12-31'\nGROUP BY \n    EXTRACT(MONTH FROM d_date)\nORDER BY \n    sales_month;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS sales_count, \n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws_order_number) AS total_orders,\n    AVG(ws_net_profit) AS average_profit\nFROM \n    web_sales\nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk\nWHERE \n    d_year = 2023\nGROUP BY \n    d_month_seq\nORDER BY \n    d_month_seq;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_list_price) AS average_list_price,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year BETWEEN 1980 AND 1990\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year >= 1980\nGROUP BY \n    c.c_customer_id\nHAVING \n    COUNT(ss.ss_ticket_number) > 5\nORDER BY \n    total_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year BETWEEN 1970 AND 1990\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    AVG(ss.ss_sales_price) AS avg_sales_price, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_order_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "SELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 2451545 AND 2452060 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 1 AND 100\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "SELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_quantity) AS avg_quantity\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 2451545 AND 2451546 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid) AS total_revenue,\n    AVG(ss.ss_net_profit) AS average_profit,\n    SUM(ss.ss_quantity) AS total_quantity_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk IN (SELECT d.d_date_sk FROM date_dim d WHERE d.d_year = 2023)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    sum(ss.ss_sales_price) AS total_sales,\n    count(ss.ss_ticket_number) AS total_transactions,\n    avg(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    AVG(ss.ss_net_profit) AS avg_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 20220101 AND 20221231\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    c.c_birth_year BETWEEN 1980 AND 1990\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_current_addr_sk IS NOT NULL \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_birth_year BETWEEN 1970 AND 1990 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 20000101 AND 20201231\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions, \n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ss.ss_sold_date_sk BETWEEN 1 AND 100\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ss.ss_sold_date_sk BETWEEN 1 AND 365\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN 1 AND 30\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS num_customers\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_state\nORDER BY num_customers DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_current_cdemo_sk IS NOT NULL \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_ext_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk >= (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS unique_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY ca_city\nORDER BY unique_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nWHERE ca_state = 'CA'\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk IN (\n        SELECT d.d_date_sk\n        FROM date_dim d\n        WHERE d.d_year = 2023\n    )\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS avg_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value,\n    MAX(ss.ss_sales_price) AS highest_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    c.c_current_addr_sk IS NOT NULL\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss_ticket_number) AS number_of_transactions,\n    MAX(ss_sold_date_sk) AS last_purchase_date\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(sr.sr_return_quantity) AS total_returns, \n    SUM(sr.sr_return_amt) AS total_return_amount, \n    MAX(sr.sr_return_time_sk) AS last_return_time\nFROM \n    customer c\nJOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_returns DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales_price, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_price DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address\nJOIN customer ON c_current_addr_sk = ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MAX(d.d_date_sk) FROM date_dim d) - 30 AND (SELECT MAX(d.d_date_sk) FROM date_dim d)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_birth_month = 12 \n    AND c.c_current_cdemo_sk IS NOT NULL \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS avg_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_purchased\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT \n    10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_per_transaction\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_ext_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    COUNT(DISTINCT ss.ss_store_sk) AS store_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    COUNT(DISTINCT sr_ticket_number) AS total_returns,\n    SUM(sr_return_quantity) AS total_returned_quantity,\n    SUM(sr_return_amt_inc_tax) AS total_returned_amount\nFROM\n    customer c\nJOIN\n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_returns DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       SUM(ss.ss_net_profit) AS total_profit\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE c.c_current_cdemo_sk IS NOT NULL\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nWHERE ca_state = 'NY'\nGROUP BY ca_city\nORDER BY customer_count DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim) \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid) AS total_revenue,\n    AVG(ss.ss_net_profit) AS average_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(sr.sr_item_sk) AS returns_count,\n    SUM(sr.sr_return_amt) AS total_returned_amount,\n    AVG(sr.sr_return_quantity) AS avg_returned_quantity\nFROM \n    customer c\nJOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_returned_amount DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address AS ca\nJOIN customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_orders,\n    AVG(ss.ss_sales_price) AS avg_order_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ws_order_number) AS total_orders, \n    AVG(ws_net_profit) AS average_profit \nFROM \n    web_sales \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    d_month_seq \nORDER BY \n    d_month_seq;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales, \n    SUM(ws_ext_discount_amt) AS total_discount, \n    COUNT(DISTINCT ws_order_number) AS total_orders, \n    AVG(ws_net_profit) AS average_profit \nFROM \n    web_sales \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2022 \nGROUP BY \n    d_month_seq \nORDER BY \n    d_month_seq;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    COUNT(DISTINCT ws.ws_web_page_sk) AS total_web_pages\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE\n    c.c_current_addr_sk IS NOT NULL\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE c.c_current_addr_sk IS NOT NULL\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_sk\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_purchases \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS avg_net_profit\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    c.c_current_addr_sk IN (\n        SELECT \n            ca_address_sk \n        FROM \n            customer_address \n        WHERE \n            ca_state = 'CA'\n    )\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_current_addr_sk IS NOT NULL \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_net_paid) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_paid) AS average_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ws.ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    sum(ss.ss_sales_price) AS total_sales,\n    count(ss.ss_ticket_number) AS number_of_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_net_paid) AS total_net_paid\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_paid DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk IN (SELECT d.d_date_sk FROM date_dim d WHERE d.d_year = 2023)\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY ca_state \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS num_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, COUNT(*) AS customer_count\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY \n    ca_state\nORDER BY \n    customer_count DESC;\n",
  "\nSELECT c.c_customer_id, COUNT(sr.sr_ticket_number) AS return_count\nFROM customer c\nJOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY c.c_customer_id\nORDER BY return_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count \nFROM customer c \nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nINNER JOIN customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(*) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, COUNT(ss.ss_ticket_number) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) as total_sales,\n    COUNT(ss.ss_ticket_number) as total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_customer_id, SUM(ss_sales_price) AS total_sales\nFROM customer\nJOIN store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_sales_price) AS total_sales\nFROM customer AS c\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer_address.ca_address_sk = customer.c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_id) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) as customer_count\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_state \nORDER BY customer_count DESC;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS num_customers\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY ca_city\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_net_paid) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS total_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY total_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT\n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM\n    customer_address\nJOIN\n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY\n    ca_city\nORDER BY\n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) as customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_id) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    COUNT(sr.sr_item_sk) AS total_returns\nFROM\n    customer c\nJOIN\n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_returns DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS num_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY ca_city\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT c_customer_id, COUNT(ss_ticket_number) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, COUNT(sr.sr_item_sk) AS return_count\nFROM customer c\nJOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY c.c_customer_id\nORDER BY return_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(distinct c_customer_sk) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_net_paid) AS total_sales \nFROM customer c \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY c.c_customer_id \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS num_customers\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY \n    ca_state\nORDER BY \n    num_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count \nFROM customer_address ca \nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS number_of_customers \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    number_of_customers DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS total_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY total_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT  c.c_customer_id, SUM(ss_ext_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS num_customers \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    num_customers DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 5;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nGROUP BY \n    ca_state\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count\nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_sk) AS customer_count\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer_address.ca_address_sk = customer.c_current_addr_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC;\n",
  "\nSELECT\n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM\n    customer_address ca\nJOIN\n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY\n    ca_city\nORDER BY\n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS customer_count\nFROM customer_address \nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_sk) AS num_customers \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    num_customers DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count \nFROM customer_address \nJOIN customer ON ca_address_sk = c_current_addr_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, COUNT(sr.sr_ticket_number) AS total_returns\nFROM customer c\nJOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_returns DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_ext_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS num_customers\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS number_of_customers\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_city\nORDER BY number_of_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS num_customers \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_state \nORDER BY \n    num_customers DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count \nFROM customer c \nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_sales_price) AS total_sales \nFROM customer c \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY c.c_customer_id \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS total_customers\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY ca_city\nORDER BY total_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count \nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC;\n",
  "\nSELECT c.c_customer_id, SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) as total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS num_customers\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    num_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_net_profit) AS total_net_profit,\n    d_year\nFROM \n    web_sales\nJOIN \n    date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk\nGROUP BY \n    d_year\nORDER BY \n    d_year;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_sales_price) AS total_revenue \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_revenue DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address AS ca\nJOIN customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS num_customers\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_city\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY \n    ca_state\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS unique_customers\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY \n    ca_state\nORDER BY \n    unique_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count \nFROM \n    customer_address AS ca \nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) AS num_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) as total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count \nFROM \n    customer_address CA \nJOIN \n    customer C \nON \n    CA.ca_address_sk = C.c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC;\n",
  "\nSELECT s_store_name, SUM(ss_net_profit) AS total_net_profit\nFROM store_sales\nJOIN store ON store.s_store_sk = store_sales.ss_store_sk\nGROUP BY s_store_name\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(s.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_sk) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_net_paid) AS total_revenue \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT c_customer_id, COUNT(ss_ticket_number) AS total_sales\nFROM customer\nJOIN store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(c_customer_id) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_sk) AS customer_count\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_net_paid) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(distinct c_customer_id) AS customer_count \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS num_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS num_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS num_customers \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    num_customers DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca.ca_city, COUNT(c.c_customer_sk) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca.ca_city\nORDER BY customer_count DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nSELECT ca_state, COUNT(*) AS number_of_customers\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY ca_state\nORDER BY number_of_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address\nJOIN customer ON customer_address.ca_address_sk = customer.c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address AS ca\nJOIN customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT\n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM\n    customer_address AS ca\nJOIN\n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY\n    ca_state\nORDER BY\n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT s.ss_ticket_number) AS total_sales,\n    SUM(s.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) as customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_state \nORDER BY customer_count DESC;\n",
  "\nSELECT ca_state, COUNT(*) AS num_customers\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY ca_state\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) as customer_count\nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) as customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_net_paid) AS total_spent \nFROM customer c \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY c.c_customer_id \nORDER BY total_spent DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(*) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer \nON \n    customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, COUNT(sr.sr_ticket_number) AS return_count \nFROM customer c \nLEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk \nGROUP BY c.c_customer_id \nORDER BY return_count DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nHAVING COUNT(*) > 1\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca.ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(*) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT\n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM\n    customer_address AS ca\nJOIN\n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY\n    ca_city\nORDER BY\n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(*) AS customer_count \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss \nON \n    c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_country, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_country\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) as customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT\n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS num_customers\nFROM\n    customer_address\nJOIN\n    customer ON ca_address_sk = c_current_addr_sk\nGROUP BY\n    ca_city\nORDER BY\n    num_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS num_customers\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_city\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT\n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS num_customers\nFROM\n    customer_address\nJOIN\n    customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY\n    ca_state\nORDER BY\n    num_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as total_customers\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY ca_city\nORDER BY total_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count \nFROM \n    customer_address AS ca \nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer \nJOIN \n    customer_address ON c_current_addr_sk = ca_address_sk\nGROUP BY \n    ca_state\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS customer_count\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) as num_customers \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_city \nORDER BY num_customers DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS customer_count\nFROM customer\nJOIN customer_address ON c_current_addr_sk = ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nINNER JOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) AS total_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state\nORDER BY total_customers DESC;\n",
  "\nSELECT c.c_customer_id, SUM(ws.ws_net_paid) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS total_customers \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_city \nORDER BY total_customers DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_quantity) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS total_customers \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_customers DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_customers DESC \nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_state \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_net_profit) AS total_profit\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nHAVING COUNT(DISTINCT c_customer_sk) > 10\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_ext_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_id) AS customer_count\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS num_customers\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_city\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    ca_city,\n    COUNT(c_customer_sk) AS customer_count\nFROM\n    customer_address\nJOIN\n    customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY\n    ca_city\nORDER BY\n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT a.ca_city, COUNT(c.c_customer_sk) AS customer_count\nFROM customer_address a\nJOIN customer c ON a.ca_address_sk = c.c_current_addr_sk\nGROUP BY a.ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS num_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state\nORDER BY num_customers DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS unique_customers\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY \n    ca_city\nORDER BY \n    unique_customers DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, COUNT(ss.ss_ticket_number) AS sales_count\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id\nORDER BY sales_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(*) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY \n    ca_state\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer AS c\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as customer_count\nFROM customer_address\nINNER JOIN customer ON customer.c_current_addr_sk = ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(*) AS customer_count \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_sk) AS customer_count\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS customer_count\nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT c_customer_id, COUNT(ss_ticket_number) AS total_sales\nFROM customer\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY \n    ca_state\nORDER BY \n    customer_count DESC;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY \n    ca_state\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(*) AS customer_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, COUNT(sr_ticket_number) AS returns_count\nFROM customer c\nJOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY c.c_customer_id\nORDER BY returns_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_quantity) AS total_quantity_sold,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) as customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) AS total_customers\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_city\nORDER BY total_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address AS ca\nJOIN customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count \nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY ca_city \nORDER BY customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(*) AS total_customers \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_customers DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = ca_address_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS num_customers\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nGROUP BY ca_city\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as num_customers\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY ca_city\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) as total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) as total_sales, \n    d_year \nFROM \n    web_sales \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nGROUP BY \n    d_year \nORDER BY \n    d_year;\n",
  "\nSELECT ca_city, COUNT(c_customer_sk) as total_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY total_customers DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ws.ws_net_profit) AS total_profit\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(*) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS num_customers\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    num_customers DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer_address.ca_address_sk = customer.c_current_addr_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_customer_id\nHAVING SUM(ws.ws_sales_price) > 1000\nORDER BY total_sales DESC;\n",
  "\nSELECT\n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM\n    customer_address ca\nJOIN\n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nGROUP BY\n    ca_city\nORDER BY\n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, COUNT(*) AS customer_count \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as total_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY total_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_sk) AS total_customers \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_customers DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY \n    ca_state\nORDER BY \n    customer_count DESC;\n",
  "\nSELECT\n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS customer_count\nFROM\n    customer_address\nJOIN\n    customer ON ca_address_sk = c_current_addr_sk\nGROUP BY\n    ca_city\nORDER BY\n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_quantity) AS total_quantity_sold\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(*) AS total_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_state;\n",
  "\nSELECT c.c_customer_id, COUNT(sr.sr_item_sk) AS total_returns\nFROM customer c\nJOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_returns DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    COUNT(sr.sr_ticket_number) AS return_count,\n    SUM(sr.sr_return_amt) AS total_return_amount\nFROM\n    customer c\nJOIN\n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY\n    c.c_customer_id\nORDER BY\n    return_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(*) AS customer_count \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS unique_customers \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nGROUP BY \n    ca_city \nORDER BY \n    unique_customers DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_sk) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nHAVING COUNT(*) > 10\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT ca_city, COUNT(*) AS customer_count \nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_net_paid) AS total_spent\nFROM customer AS c\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id\nORDER BY total_spent DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(*) as num_customers\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city\nORDER BY num_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss_ticket_number) AS total_transactions,\n    AVG(ss_ext_sales_price) AS avg_sales_per_transaction,\n    EXTRACT(YEAR FROM d_date) AS sales_year,\n    EXTRACT(MONTH FROM d_date) AS sales_month\nFROM \n    store_sales\nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk\nWHERE \n    d_date BETWEEN '2023-01-01' AND '2023-12-31'\nGROUP BY \n    EXTRACT(YEAR FROM d_date),\n    EXTRACT(MONTH FROM d_date)\nORDER BY \n    sales_year, sales_month;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_price,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales_price DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    d_year,\n    d_month_seq\nFROM \n    web_sales\nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk\nGROUP BY \n    d_year, d_month_seq\nORDER BY \n    d_year, d_month_seq;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales, \n    d_year, \n    d_month_seq \nFROM \n    web_sales \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nGROUP BY \n    d_year, d_month_seq \nORDER BY \n    d_year, d_month_seq;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IN (\n        SELECT cd.cd_demo_sk \n        FROM customer_demographics cd \n        WHERE cd.cd_gender = 'F' AND cd.cd_marital_status = 'M'\n    )\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_preferred_cust_flag = 'Y'\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss \nON \n    c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    c.c_birth_year = 1980 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_current_addr_sk IS NOT NULL \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_city = 'Los Angeles')\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MAX(d.d_date_sk) FROM date_dim d) - 30 AND (SELECT MAX(d.d_date_sk) FROM date_dim d)\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT\n    SUM(ws_ext_sales_price) AS total_sales,\n    d_year AS sales_year,\n    d_month_seq AS sales_month\nFROM\n    web_sales\nJOIN\n    date_dim ON ws_sold_date_sk = d_date_sk\nGROUP BY\n    d_year, d_month_seq\nORDER BY\n    sales_year, sales_month;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim) \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    d.d_month_seq,\n    d.d_year,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS avg_sales_price\nFROM \n    web_sales AS ws\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nGROUP BY \n    d.d_month_seq, d.d_year\nORDER BY \n    d.d_year, d.d_month_seq;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE c.c_preferred_cust_flag = 'Y'\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk IN (\n        SELECT d.d_date_sk \n        FROM date_dim AS d \n        WHERE d.d_year = 2023\n    ) \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    d_year,\n    d_month_seq\nFROM \n    web_sales \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk\nGROUP BY \n    d_year, d_month_seq\nORDER BY \n    d_year, d_month_seq;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE c.c_current_cdemo_sk IS NOT NULL\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    SUM(ws_quantity) AS total_quantity_sold,\n    SUM(ws_sales_price) AS total_sales_amount,\n    COUNT(DISTINCT ws_order_number) AS total_orders,\n    d_year,\n    d_month_seq\nFROM \n    web_sales\nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk\nWHERE \n    d_year = 2022\nGROUP BY \n    d_year, d_month_seq\nORDER BY \n    d_year, d_month_seq;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    d_year,\n    d_moy\nFROM \n    web_sales\nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk\nGROUP BY \n    d_year, d_moy\nORDER BY \n    d_year, d_moy;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ws.ws_net_profit) AS total_profit\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, SUM(ss_net_paid) AS total_spent\nFROM customer\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name\nORDER BY total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, COUNT(ss_ticket_number) AS total_purchases\nFROM customer\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name\nORDER BY total_purchases DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE c.c_current_addr_sk IS NOT NULL\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(ss.ss_ticket_number) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_ext_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_net_paid) AS total_spent\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_spent DESC\nLIMIT 10;\n",
  "\nSELECT DISTINCT ca_city, ca_state, COUNT(c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_city, ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_first_name,\n    c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, SUM(ss_net_paid) AS total_sales\nFROM customer\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, sum(ws.ws_net_profit) AS total_profit\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_net_paid) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, COUNT(ss_ticket_number) AS total_sales\nFROM customer\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(s.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales s ON c.c_customer_sk = s.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, SUM(ss_sales_price) AS total_sales\nFROM customer\nJOIN store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY c_first_name, c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer \nJOIN \n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY \n    c_first_name, \n    c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss_ext_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(ss.ss_ticket_number) AS total_purchases \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_purchases DESC \nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, SUM(ss_sales_price) AS total_sales\nFROM customer\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    SUM(ss_net_paid) AS total_spent\nFROM \n    customer \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY \n    c_first_name, \n    c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss \nON \n    c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, COUNT(ss.ss_ticket_number) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    sum(ss.ss_quantity) as total_sales\nFROM \n    item i\nJOIN \n    store_sales ss ON i.i_item_sk = ss.ss_item_sk\nGROUP BY \n    i.i_item_id, i.i_item_desc\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, sum(ss.ss_sales_price) AS total_sales\nFROM customer AS c\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    SUM(ss_ext_sales_price) AS total_sales\nFROM \n    customer \nJOIN \n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY \n    c_first_name, \n    c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, COUNT(*) AS order_count \nFROM customer \nJOIN store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY c_first_name, c_last_name \nORDER BY order_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer AS c\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_first_name,\n    c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer \nJOIN \n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY \n    c_first_name, c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name,\n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_quantity) AS total_quantity\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_quantity DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_net_profit) AS total_profit\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer AS c\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_quantity) AS total_quantity_sold\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT c_last_name, c_first_name, SUM(ss_net_paid) AS total_spent\nFROM customer\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_last_name, c_first_name\nORDER BY total_spent DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, count(ss.ss_ticket_number) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, SUM(ss_net_paid) AS total_spent\nFROM customer\nJOIN store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY c_first_name, c_last_name\nORDER BY total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk = 20230101\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, sum(ss.ss_sales_price) as total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ws.ws_quantity) AS total_quantity_sold\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, SUM(ss_net_profit) AS total_profit\nFROM customer\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, sum(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(ss.ss_ticket_number) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, COUNT(ss.ss_ticket_number) AS total_sales \nFROM customer c \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY c.c_first_name, c.c_last_name \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_spent \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    COUNT(sr.sr_ticket_number) AS return_count,\n    SUM(sr.sr_return_amt) AS total_return_amount\nFROM\n    customer c\nLEFT JOIN\n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY\n    return_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_spent,\n    COUNT(ss.ss_ticket_number) AS total_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_first_shipto_date_sk IS NOT NULL \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_current_cdemo_sk IS NOT NULL \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_spent,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       c.c_first_name, \n       c.c_last_name, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_current_cdemo_sk IS NOT NULL \nGROUP BY \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent, \n    COUNT(ss.ss_ticket_number) AS total_purchases \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim) \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name\nHAVING\n    SUM(ss.ss_sales_price) > 1000\nORDER BY\n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_item_sk) AS total_items_purchased\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_spent,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_store_sk) AS total_stores\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n                            AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk IN (\n        SELECT \n            d.d_date_sk \n        FROM \n            date_dim d \n        WHERE \n            d.d_year = 2022\n    )\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        s.ss_store_sk AS store_id,\n        SUM(s.ss_quantity) AS total_quantity_sold,\n        SUM(s.ss_net_paid) AS total_net_revenue\n    FROM \n        store_sales s\n    JOIN \n        date_dim d ON s.ss_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        s.ss_store_sk\n)\nSELECT \n    s.store_id, \n    s.total_quantity_sold, \n    s.total_net_revenue\nFROM \n    sales_summary s\nORDER BY \n    s.total_net_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    c.c_current_cdemo_sk IS NOT NULL \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    COUNT(sr.sr_ticket_number) AS total_returns,\n    SUM(sr.sr_return_amt_inc_tax) AS total_return_value\nFROM\n    customer AS c\nLEFT JOIN\n    store_returns AS sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY\n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY\n    total_returns DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT\n        ws_sold_date_sk,\n        SUM(ws_sales_price) AS total_sales,\n        COUNT(ws_order_number) AS total_orders\n    FROM\n        web_sales\n    GROUP BY\n        ws_sold_date_sk\n)\nSELECT\n    dd.d_date,\n    ss.total_sales,\n    ss.total_orders\nFROM\n    sales_summary ss\nJOIN\n    date_dim dd ON ss.ws_sold_date_sk = dd.d_date_sk\nWHERE\n    dd.d_year = 2023\nORDER BY\n    dd.d_date;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(ws.ws_order_number) AS total_orders, \n    SUM(ws.ws_sales_price) AS total_spent\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_orders \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_address_sk, \n    ca_city, \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY \n    ca_address_sk, ca_city, ca_state\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND \n                                (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year = 1980\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    SUM(ss.ss_quantity) AS total_quantity \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    count(ss.ss_ticket_number) AS total_sales,\n    sum(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_year = 1980\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(ss.ss_ticket_number) AS sales_count, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_sales_price) as total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(ss.ss_net_paid) AS total_spent\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY total_spent DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(ss.ss_net_paid) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales \nFROM customer c \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_net_paid) AS total_revenue\nFROM \n    customer c \nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer AS c\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(ss.ss_quantity) AS total_quantity_sold\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, count(ss.ss_ticket_number) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer AS c\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_address_id, ca_city, ca_state, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_address_id, ca_city, ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT ca_address_id, ca_city, ca_state, COUNT(c_customer_sk) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_address_id, ca_city, ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_street_name, ca_city, ca_state, COUNT(*) AS customer_count\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nGROUP BY ca_street_name, ca_city, ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_sales_price) AS total_sales\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n)\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    ss.total_quantity,\n    ss.total_sales\nFROM \n    sales_summary ss\nJOIN \n    item i ON ss.ws_item_sk = i.i_item_sk\nORDER BY \n    ss.total_sales DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_sales_price) AS total_sales,\n        AVG(ws_sales_price) AS avg_sales_price\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n)\nSELECT \n    i.i_item_id,\n    ss.total_quantity,\n    ss.total_sales,\n    ss.avg_sales_price\nFROM \n    sales_summary ss\nJOIN \n    item i ON ss.ws_item_sk = i.i_item_sk\nORDER BY \n    ss.total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_item_sk, \n        SUM(ws_quantity) AS total_quantity, \n        SUM(ws_sales_price) AS total_sales \n    FROM \n        web_sales \n    GROUP BY \n        ws_item_sk\n)\nSELECT \n    i.i_item_id, \n    i.i_item_desc, \n    COALESCE(ss.total_quantity, 0) AS total_quantity, \n    COALESCE(ss.total_sales, 0) AS total_sales \nFROM \n    item i \nLEFT JOIN \n    sales_summary ss ON i.i_item_sk = ss.ws_item_sk \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n)\nSELECT \n    i.i_item_id,\n    ss.total_quantity,\n    ss.total_sales,\n    ss.total_profit\nFROM \n    sales_summary ss\nJOIN \n    item i ON ss.ws_item_sk = i.i_item_sk\nORDER BY \n    ss.total_sales DESC\nLIMIT 10;\n",
  "\nWITH DateRange AS (\n    SELECT d_date_sk\n    FROM date_dim\n    WHERE d_year = 2023\n),\nItemStats AS (\n    SELECT \n        i_item_sk,\n        i_item_id,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_net_profit) AS total_net_profit\n    FROM web_sales ws\n    JOIN item i ON ws.ws_item_sk = i.i_item_sk\n    WHERE ws.ws_sold_date_sk IN (SELECT d_date_sk FROM DateRange)\n    GROUP BY i_item_sk, i_item_id\n)\nSELECT \n    COUNT(*) AS total_items,\n    AVG(total_quantity) AS avg_quantity,\n    MAX(total_net_profit) AS max_net_profit\nFROM ItemStats;\n",
  "\nWITH AddressParts AS (\n    SELECT \n        ca_address_sk,\n        TRIM(ca_street_number || ' ' || ca_street_name || ' ' || ca_street_type) AS full_address,\n        UPPER(ca_city) AS city_upper,\n        LOWER(ca_zip) AS zip_lower\n    FROM \n        customer_address\n),\nDistinctCities AS (\n    SELECT DISTINCT city_upper\n    FROM AddressParts\n),\nAddressAggregates AS (\n    SELECT \n        ap.city_upper,\n        COUNT(DISTINCT ap.ca_address_sk) AS address_count,\n        COUNT(DISTINCT LENGTH(ap.full_address)) AS unique_length_count\n    FROM \n        AddressParts ap\n    JOIN \n        DistinctCities dc ON ap.city_upper = dc.city_upper\n    GROUP BY \n        ap.city_upper\n)\nSELECT \n    a.city_upper,\n    a.address_count,\n    a.unique_length_count,\n    CASE \n        WHEN a.address_count > 100 THEN 'High Density'\n        WHEN a.address_count > 50 THEN 'Medium Density'\n        ELSE 'Low Density' \n    END AS density_category\nFROM \n    AddressAggregates a\nORDER BY \n    a.address_count DESC, a.city_upper;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_returned_date_sk,\n        sr_item_sk,\n        COUNT(*) AS total_returns,\n        SUM(sr_return_amt_inc_tax) AS total_return_amount\n    FROM \n        store_returns\n    WHERE \n        sr_returned_date_sk IS NOT NULL \n    GROUP BY \n        sr_returned_date_sk, sr_item_sk\n),\nTopItems AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_sold,\n        SUM(ws_sales_price) AS total_revenue\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n    ORDER BY \n        total_revenue DESC\n    LIMIT 10\n),\nReturnStatistics AS (\n    SELECT \n        ci.ws_item_sk,\n        ci.total_sold,\n        ci.total_revenue,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        CASE \n            WHEN ci.total_sold = 0 THEN 0\n            ELSE (COALESCE(cr.total_returns, 0) * 1.0 / ci.total_sold)\n        END AS return_rate\n    FROM \n        TopItems ci\n    LEFT JOIN \n        CustomerReturns cr ON ci.ws_item_sk = cr.sr_item_sk\n)\nSELECT \n    r.ws_item_sk,\n    r.total_sold,\n    r.total_revenue,\n    r.total_returns,\n    r.total_return_amount,\n    r.return_rate,\n    CASE \n        WHEN r.return_rate > 0.1 THEN 'High Return Rate'\n        WHEN r.return_rate BETWEEN 0.05 AND 0.1 THEN 'Moderate Return Rate'\n        ELSE 'Low Return Rate'\n    END AS return_rate_category\nFROM \n    ReturnStatistics r\nWHERE \n    r.total_revenue > 1000\nORDER BY \n    r.return_rate DESC,\n    r.total_revenue DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ss_item_sk,\n        SUM(ss_quantity) AS total_quantity,\n        SUM(ss_ext_sales_price) AS total_sales\n    FROM \n        store_sales\n    GROUP BY \n        ss_item_sk\n),\nItemDetails AS (\n    SELECT \n        i_item_sk,\n        i_product_name,\n        i_current_price\n    FROM \n        item\n)\nSELECT \n    id.i_product_name,\n    id.i_current_price,\n    sd.total_quantity,\n    sd.total_sales\nFROM \n    SalesData sd\nJOIN \n    ItemDetails id ON sd.ss_item_sk = id.i_item_sk\nORDER BY \n    sd.total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_sales_price) AS total_sales\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n),\nitem_details AS (\n    SELECT\n        i.i_item_sk,\n        i.i_item_desc,\n        ss.total_quantity,\n        ss.total_sales\n    FROM \n        item AS i\n    JOIN \n        sales_summary AS ss ON i.i_item_sk = ss.ws_item_sk\n)\nSELECT \n    id.i_item_desc,\n    id.total_quantity,\n    id.total_sales,\n    (id.total_sales / NULLIF(id.total_quantity, 0)) AS avg_price\nFROM \n    item_details AS id\nORDER BY \n    id.total_sales DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_sold_date_sk, \n        SUM(ws_quantity) AS total_quantity, \n        SUM(ws_sales_price) AS total_sales\n    FROM \n        web_sales\n    GROUP BY \n        ws_sold_date_sk\n)\nSELECT \n    d.d_date AS sale_date, \n    s.total_quantity, \n    s.total_sales, \n    COALESCE(s.total_sales / NULLIF(s.total_quantity, 0), 0) AS avg_sales_price\nFROM \n    date_dim d\nLEFT JOIN \n    sales_summary s ON d.d_date_sk = s.ws_sold_date_sk\nWHERE \n    d.d_year = 2023\nORDER BY \n    d.d_date;\n",
  "\nWITH AddressComponents AS (\n    SELECT \n        ca_address_sk,\n        ca_street_number || ' ' || ca_street_name || ' ' || ca_street_type AS full_address,\n        ca_city,\n        ca_state,\n        ca_zip,\n        ca_country\n    FROM \n        customer_address\n),\nDemographics AS (\n    SELECT \n        cd_demo_sk,\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_purchase_estimate,\n        cd_credit_rating,\n        cd_dep_count,\n        cd_dep_employed_count,\n        cd_dep_college_count,\n        CASE \n            WHEN cd_gender = 'M' THEN 'Male'\n            WHEN cd_gender = 'F' THEN 'Female'\n            ELSE 'Other'\n        END AS gender_label\n    FROM \n        customer_demographics\n),\nJoinData AS (\n    SELECT \n        ca.ca_address_sk,\n        ca.full_address,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_zip,\n        dm.cd_demo_sk,\n        dm.gender_label,\n        dm.cd_marital_status,\n        dm.cd_education_status,\n        dm.cd_purchase_estimate\n    FROM \n        AddressComponents ca\n    LEFT JOIN \n        Demographics dm ON ca.ca_address_sk = dm.cd_demo_sk\n)\nSELECT \n    full_address,\n    ca_city,\n    ca_state,\n    ca_zip,\n    gender_label,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n    COUNT(cd_demo_sk) AS customer_count\nFROM \n    JoinData\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    full_address, ca_city, ca_state, ca_zip, gender_label\nORDER BY \n    customer_count DESC\nLIMIT 50;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_sales_price) AS total_sales\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n),\ninventory_data AS (\n    SELECT \n        inv_item_sk,\n        SUM(inv_quantity_on_hand) AS total_inventory\n    FROM \n        inventory\n    GROUP BY \n        inv_item_sk\n)\nSELECT \n    s.ws_item_sk,\n    s.total_quantity,\n    i.total_inventory,\n    (s.total_sales / NULLIF(s.total_quantity, 0)) AS avg_price_per_unit,\n    (i.total_inventory - s.total_quantity) AS remaining_inventory\nFROM \n    sales_data s\nJOIN \n    inventory_data i ON s.ws_item_sk = i.inv_item_sk\nWHERE \n    (i.total_inventory - s.total_quantity) > 0\nORDER BY \n    s.total_quantity DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_sales_price) AS total_sales,\n        COUNT(ws_order_number) AS total_orders\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n), \nitem_data AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_desc,\n        COALESCE(sd.total_sales, 0) AS total_sales,\n        COALESCE(sd.total_orders, 0) AS total_orders\n    FROM \n        item i\n    LEFT JOIN \n        sales_data sd ON i.i_item_sk = sd.ws_item_sk\n)\nSELECT \n    id.i_item_sk,\n    id.i_item_desc,\n    id.total_sales,\n    id.total_orders\nFROM \n    item_data id\nORDER BY \n    id.total_sales DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_bill_cdemo_sk AS customer_demo_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(ws_order_number) AS order_count\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_cdemo_sk\n)\nSELECT \n    cd_gender,\n    cd_marital_status,\n    COUNT(ss.customer_demo_sk) AS customer_count,\n    AVG(ss.total_sales) AS avg_sales,\n    SUM(ss.order_count) AS total_orders\nFROM \n    sales_summary ss\nJOIN \n    customer_demographics cd ON ss.customer_demo_sk = cd.cd_demo_sk\nGROUP BY \n    cd_gender, cd_marital_status\nORDER BY \n    avg_sales DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        cs_item_sk,\n        SUM(cs_quantity) AS total_quantity,\n        SUM(cs_sales_price) AS total_sales_price\n    FROM \n        catalog_sales\n    GROUP BY \n        cs_item_sk\n),\nItemData AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_desc,\n        i.i_current_price\n    FROM \n        item i\n)\nSELECT \n    id.i_item_desc,\n    sd.total_quantity,\n    sd.total_sales_price,\n    id.i_current_price,\n    (sd.total_sales_price - (sd.total_quantity * id.i_current_price)) AS profit_margin\nFROM \n    SalesData sd\nJOIN \n    ItemData id ON sd.cs_item_sk = id.i_item_sk\nWHERE \n    (sd.total_sales_price - (sd.total_quantity * id.i_current_price)) > 0\nORDER BY \n    profit_margin DESC\nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_bill_customer_sk, \n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(ws_order_number) AS order_count,\n        MAX(ws_sold_date_sk) AS last_purchase_date\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN \n        (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 AND \n        (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_bill_customer_sk\n),\ndemographics AS (\n    SELECT \n        cd_demo_sk, \n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_credit_rating\n    FROM \n        customer_demographics\n    WHERE \n        cd_demo_sk IN (SELECT DISTINCT c_current_cdemo_sk FROM customer)\n),\nhigh_value_customers AS (\n    SELECT \n        s.ws_bill_customer_sk,\n        s.total_sales,\n        d.cd_gender,\n        d.cd_marital_status,\n        d.cd_education_status,\n        d.cd_credit_rating\n    FROM \n        sales_summary s\n    JOIN \n        demographics d ON s.ws_bill_customer_sk = d.cd_demo_sk\n    WHERE \n        s.total_sales > 1000\n)\nSELECT \n    COUNT(*) AS high_value_count,\n    AVG(total_sales) AS average_sales,\n    COUNT(DISTINCT cd_gender) AS distinct_genders,\n    COUNT(DISTINCT cd_marital_status) AS distinct_marital_statuses,\n    COUNT(DISTINCT cd_education_status) AS distinct_education_statuses,\n    COUNT(DISTINCT cd_credit_rating) AS distinct_credit_ratings\nFROM \n    high_value_customers;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_item_sk, \n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_net_profit) AS total_net_profit\n    FROM \n        web_sales \n    GROUP BY \n        ws_item_sk\n),\nReturnsData AS (\n    SELECT \n        wr_item_sk, \n        SUM(wr_return_quantity) AS total_return_quantity,\n        SUM(wr_return_amt) AS total_return_amt\n    FROM \n        web_returns \n    GROUP BY \n        wr_item_sk\n)\nSELECT \n    sd.ws_item_sk, \n    sd.total_quantity, \n    sd.total_net_profit, \n    COALESCE(rd.total_return_quantity, 0) AS total_return_quantity, \n    COALESCE(rd.total_return_amt, 0) AS total_return_amt\nFROM \n    SalesData sd\nLEFT JOIN \n    ReturnsData rd ON sd.ws_item_sk = rd.wr_item_sk\nORDER BY \n    sd.total_net_profit DESC\nLIMIT 100;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_sold_date_sk,\n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_net_paid) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim)\n    GROUP BY \n        ws_sold_date_sk, ws_item_sk\n),\nItemDetails AS (\n    SELECT \n        i_item_sk,\n        i_item_id,\n        i_product_name,\n        i_current_price,\n        i_category\n    FROM \n        item\n),\nCategorySales AS (\n    SELECT \n        id.i_item_sk,\n        id.i_item_id,\n        id.i_product_name,\n        id.i_current_price,\n        sd.total_quantity,\n        sd.total_sales,\n        CASE \n            WHEN id.i_category = 'Electronics' THEN 'High Tech'\n            WHEN id.i_category IN ('Clothing', 'Footwear') THEN 'Fashion'\n            ELSE 'Other'\n        END AS category_type\n    FROM \n        SalesData sd\n    JOIN \n        ItemDetails id ON sd.ws_item_sk = id.i_item_sk\n)\nSELECT \n    cs.category_type,\n    SUM(cs.total_sales) AS total_sales_by_category,\n    AVG(cs.total_quantity) AS avg_quantity_sold,\n    COUNT(DISTINCT cs.i_item_id) AS unique_items_sold\nFROM \n    CategorySales cs\nGROUP BY \n    cs.category_type\nORDER BY \n    total_sales_by_category DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_sales_price) AS total_sales,\n        COUNT(ws_order_number) AS total_orders\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n),\nItemDetails AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_desc,\n        i.i_current_price,\n        i.i_brand\n    FROM \n        item i\n)\nSELECT \n    id.i_item_sk,\n    id.i_item_desc,\n    id.i_current_price,\n    id.i_brand,\n    sd.total_quantity,\n    sd.total_sales,\n    sd.total_orders\nFROM \n    ItemDetails id\nJOIN \n    SalesData sd ON id.i_item_sk = sd.ws_item_sk\nORDER BY \n    sd.total_sales DESC\nLIMIT 100;\n",
  "\nWITH processed_addresses AS (\n    SELECT \n        ca_address_sk,\n        TRIM(ca_street_number) || ' ' || TRIM(ca_street_name) || ' ' || TRIM(ca_street_type) || \n        CASE \n            WHEN ca_suite_number IS NOT NULL AND ca_suite_number <> '' THEN ' Suite ' || TRIM(ca_suite_number)\n            ELSE '' \n        END AS full_address\n    FROM customer_address\n), demographics AS (\n    SELECT \n        cd_demo_sk,\n        CASE \n            WHEN cd_gender = 'M' THEN 'Mr.' \n            WHEN cd_gender = 'F' THEN 'Ms.' \n            ELSE 'Unknown' \n        END AS salutation,\n        cd_marital_status AS marital_status,\n        cd_education_status AS education_status,\n        cd_credit_rating,\n        cd_dep_count\n    FROM customer_demographics\n), summarized_data AS (\n    SELECT \n        ca.ca_address_sk,\n        ca.full_address,\n        cd.salutation,\n        cd.marital_status,\n        cd.education_status,\n        COUNT(DISTINCT cd.cd_demo_sk) AS total_demographics\n    FROM processed_addresses ca\n    JOIN demographics cd ON cd.cd_demo_sk = ca.ca_address_sk\n    GROUP BY ca.ca_address_sk, ca.full_address, cd.salutation, cd.marital_status, cd.education_status\n)\nSELECT \n    sd.full_address,\n    sd.salutation,\n    sd.marital_status,\n    sd.education_status,\n    sd.total_demographics\nFROM summarized_data sd\nWHERE sd.total_demographics > 0\nORDER BY sd.total_demographics DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH address_stats AS (\n    SELECT \n        ca_state,\n        COUNT(*) AS address_count,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\ndemographic_stats AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS demographic_count,\n        AVG(cd_dep_count) AS avg_dep_count,\n        MAX(cd_dep_count) AS max_dep_count,\n        MIN(cd_dep_count) AS min_dep_count\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\ncombined_stats AS (\n    SELECT \n        a.ca_state,\n        a.address_count,\n        a.avg_street_name_length,\n        d.cd_gender,\n        d.demographic_count,\n        d.avg_dep_count\n    FROM \n        address_stats a\n    JOIN \n        demographic_stats d ON a.address_count > 100 OR d.demographic_count > 50\n)\nSELECT \n    ca_state,\n    cd_gender,\n    address_count,\n    avg_street_name_length,\n    avg_dep_count\nFROM \n    combined_stats\nWHERE \n    address_count > 50 AND avg_dep_count < 3\nORDER BY \n    address_count DESC, avg_dep_count ASC;\n",
  "\nWITH AddressStats AS (\n    SELECT \n        ca_state,\n        COUNT(*) AS total_addresses,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nDemographics AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS total_demographics,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nCombinedStats AS (\n    SELECT \n        A.ca_state,\n        A.total_addresses,\n        A.avg_street_name_length,\n        A.max_street_name_length,\n        A.min_street_name_length,\n        D.cd_gender,\n        D.total_demographics,\n        D.avg_purchase_estimate\n    FROM \n        AddressStats A\n    JOIN \n        Demographics D ON A.total_addresses BETWEEN D.total_demographics - 10 AND D.total_demographics + 10\n)\nSELECT \n    ca_state,\n    total_addresses,\n    avg_street_name_length,\n    max_street_name_length,\n    min_street_name_length,\n    cd_gender,\n    total_demographics,\n    avg_purchase_estimate\nFROM \n    CombinedStats\nWHERE \n    avg_street_name_length > 30\nORDER BY \n    avg_purchase_estimate DESC, total_addresses DESC;\n",
  "\nWITH AddressStats AS (\n    SELECT \n        ca_state, \n        COUNT(DISTINCT ca_city) AS unique_cities, \n        COUNT(DISTINCT ca_zip) AS unique_zips, \n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nDemographicsStats AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS total_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        MAX(cd_dep_count) AS max_dependents\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nCombinedStats AS (\n    SELECT \n        a.ca_state,\n        a.unique_cities,\n        a.unique_zips,\n        a.avg_street_name_length,\n        d.cd_gender,\n        d.total_customers,\n        d.avg_purchase_estimate,\n        d.max_dependents\n    FROM \n        AddressStats a\n    CROSS JOIN \n        DemographicsStats d\n)\nSELECT \n    ca_state,\n    unique_cities,\n    unique_zips,\n    avg_street_name_length,\n    cd_gender,\n    total_customers,\n    avg_purchase_estimate,\n    max_dependents\nFROM \n    CombinedStats\nWHERE \n    unique_cities > 10 AND \n    avg_purchase_estimate > 500\nORDER BY \n    ca_state, cd_gender;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_sold_date_sk,\n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_sales_price) AS total_sales,\n        SUM(ws_ext_discount_amt) AS total_discount,\n        SUM(ws_net_profit) AS total_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_sold_date_sk, ws_item_sk\n),\nItemDetails AS (\n    SELECT \n        i_item_sk,\n        i_item_id,\n        i_item_desc,\n        i_current_price,\n        i_brand,\n        i_category\n    FROM \n        item\n),\nSalesSummary AS (\n    SELECT \n        i.i_item_id AS item_id,\n        i.i_item_desc AS item_desc,\n        i.i_current_price AS current_price,\n        i.i_brand AS brand,\n        i.i_category AS category,\n        s.total_quantity,\n        s.total_sales,\n        s.total_discount,\n        s.total_profit,\n        (s.total_sales - s.total_discount) AS net_sales_after_discount,\n        (s.total_profit / NULLIF(s.total_sales, 0)) * 100 AS profit_margin\n    FROM \n        SalesData s\n    JOIN \n        ItemDetails i ON s.ws_item_sk = i.i_item_sk\n)\nSELECT \n    item_id,\n    item_desc,\n    current_price,\n    total_quantity,\n    total_sales,\n    total_discount,\n    net_sales_after_discount,\n    profit_margin\nFROM \n    SalesSummary\nORDER BY \n    profit_margin DESC, total_sales DESC\nLIMIT 100;\n",
  "WITH SalesSummary AS (\n    SELECT\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        ws_ship_mode_sk,\n        ws_bill_cdemo_sk\n    FROM web_sales\n    GROUP BY ws_ship_mode_sk, ws_bill_cdemo_sk\n),\nCustomerDemographics AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_credit_rating,\n        cd_dep_count,\n        cd_dep_employed_count,\n        cd_dep_college_count,\n        cd_demo_sk\n    FROM customer_demographics\n    WHERE cd_credit_rating IN ('High', 'Medium') \n),\nJoinedData AS (\n    SELECT\n        sd.*, \n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM SalesSummary sd\n    JOIN CustomerDemographics cd ON sd.ws_bill_cdemo_sk = cd.cd_demo_sk\n)\nSELECT \n    j.cd_gender,\n    j.cd_marital_status,\n    COUNT(j.ws_ship_mode_sk) AS order_count,\n    AVG(j.total_sales) AS avg_sales_per_order,\n    SUM(j.total_profit) AS total_profit\nFROM JoinedData j\nGROUP BY j.cd_gender, j.cd_marital_status\nHAVING COUNT(j.ws_ship_mode_sk) > 10\nORDER BY total_profit DESC\nLIMIT 10;",
  "\nWITH AddressStats AS (\n    SELECT \n        ca_state,\n        COUNT(*) AS address_count,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length,\n        AVG(CAST(LENGTH(ca_street_name) AS FLOAT)) AS avg_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nDemographicStats AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS demographic_count,\n        AVG(CAST(cd_dep_count AS FLOAT)) AS avg_dep_count,\n        AVG(CAST(cd_dep_college_count AS FLOAT)) AS avg_college_count\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nCombinedStats AS (\n    SELECT \n        a.ca_state,\n        a.address_count,\n        a.max_street_name_length,\n        a.min_street_name_length,\n        a.avg_street_name_length,\n        d.cd_gender,\n        d.demographic_count,\n        d.avg_dep_count,\n        d.avg_college_count\n    FROM \n        AddressStats a\n    JOIN \n        DemographicStats d ON a.address_count > d.demographic_count\n)\nSELECT \n    ca_state,\n    cd_gender,\n    address_count,\n    max_street_name_length,\n    min_street_name_length,\n    avg_street_name_length,\n    demographic_count,\n    avg_dep_count,\n    avg_college_count\nFROM \n    CombinedStats\nORDER BY \n    ca_state, cd_gender;\n",
  "\nWITH AddressSummary AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT ca_address_sk) AS total_addresses,\n        COUNT(DISTINCT ca_city) AS unique_cities,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nDemographicSummary AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS total_demographics,\n        AVG(cd_dep_count) AS avg_dependent_count,\n        SUM(cd_purchase_estimate) AS total_purchase_estimates\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n)\nSELECT \n    a.ca_state,\n    a.total_addresses,\n    a.unique_cities,\n    a.max_street_name_length,\n    a.min_street_name_length,\n    a.avg_street_name_length,\n    d.cd_gender,\n    d.total_demographics,\n    d.avg_dependent_count,\n    d.total_purchase_estimates\nFROM \n    AddressSummary a\nJOIN \n    DemographicSummary d ON 1=1\nORDER BY \n    a.total_addresses DESC, d.total_demographics DESC;\n",
  "\nWITH AddressSummary AS (\n    SELECT \n        ca_state, \n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        COUNT(DISTINCT ca_city) AS unique_cities,\n        COUNT(DISTINCT ca_zip) AS unique_zips,\n        AVG(COALESCE(LENGTH(ca_street_name), 0)) AS avg_street_name_length,\n        SUM(COALESCE(CASE WHEN LENGTH(ca_street_name) > 0 THEN 1 ELSE 0 END, 0)) AS non_empty_street_names\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nDemographicsSummary AS (\n    SELECT \n        cd_gender, \n        COUNT(DISTINCT cd_demo_sk) AS demographic_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        COUNT(CASE WHEN cd_marital_status = 'M' THEN 1 END) AS married_count\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n)\nSELECT \n    a.ca_state,\n    a.unique_addresses,\n    a.unique_cities,\n    a.unique_zips,\n    a.avg_street_name_length,\n    a.non_empty_street_names,\n    d.cd_gender,\n    d.demographic_count,\n    d.avg_purchase_estimate,\n    d.married_count\nFROM \n    AddressSummary a\nJOIN \n    DemographicsSummary d ON a.unique_addresses > d.demographic_count\nORDER BY \n    a.ca_state, d.cd_gender;\n",
  "\nWITH Address_Statistics AS (\n    SELECT \n        CA.ca_state,\n        COUNT(DISTINCT CA.ca_address_sk) AS unique_addresses,\n        AVG(LENGTH(CA.ca_street_name)) AS avg_street_name_length,\n        SUM(CASE WHEN CA.ca_street_type IS NOT NULL THEN 1 ELSE 0 END) AS street_type_count,\n        MAX(LENGTH(CA.ca_city)) AS max_city_length\n    FROM \n        customer_address CA\n    GROUP BY \n        CA.ca_state\n),\nCustomer_Demo_Statistics AS (\n    SELECT \n        CD.cd_gender,\n        COUNT(DISTINCT CD.cd_demo_sk) AS total_demographics,\n        AVG(CD.cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(CD.cd_dep_count) AS total_dependents,\n        COUNT(CASE WHEN CD.cd_marital_status = 'M' THEN 1 END) AS married_count\n    FROM \n        customer_demographics CD\n    GROUP BY \n        CD.cd_gender\n),\nCombined_Statistics AS (\n    SELECT \n        A.ca_state,\n        A.unique_addresses,\n        A.avg_street_name_length,\n        A.street_type_count,\n        A.max_city_length,\n        C.cd_gender,\n        C.total_demographics,\n        C.avg_purchase_estimate,\n        C.total_dependents,\n        C.married_count\n    FROM \n        Address_Statistics A\n    JOIN \n        Customer_Demo_Statistics C ON A.ca_state = C.cd_gender\n)\nSELECT \n    CS.ca_state,\n    MAX(CS.unique_addresses) AS max_addresses,\n    AVG(CS.avg_street_name_length) AS overall_avg_street_name_length,\n    SUM(CS.street_type_count) AS total_street_types,\n    MAX(CS.max_city_length) AS overall_max_city_length,\n    SUM(CS.total_demographics) AS overall_demographic_count,\n    AVG(CS.avg_purchase_estimate) AS avg_purchase,\n    SUM(CS.total_dependents) AS total_dependents,\n    SUM(CS.married_count) AS total_married\nFROM \n    Combined_Statistics CS\nGROUP BY \n    CS.ca_state\nORDER BY \n    overall_avg_street_name_length DESC;\n",
  "\nWITH address_counts AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        COUNT(ca_address_id) AS total_addresses,\n        SUM(LENGTH(ca_street_name)) AS total_street_name_length,\n        SUM(LENGTH(ca_city)) AS total_city_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\ndemographic_summary AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT cd_demo_sk) AS total_demographics,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        COUNT(CASE WHEN cd_marital_status = 'M' THEN 1 END) AS married_count,\n        COUNT(CASE WHEN cd_marital_status = 'S' THEN 1 END) AS single_count\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nmerged_data AS (\n    SELECT \n        ac.ca_state,\n        ac.unique_addresses,\n        ac.total_addresses,\n        ac.total_street_name_length,\n        ac.total_city_length,\n        ds.cd_gender,\n        ds.total_demographics,\n        ds.avg_purchase_estimate,\n        ds.married_count,\n        ds.single_count\n    FROM \n        address_counts ac\n    JOIN \n        demographic_summary ds \n    ON \n        SUBSTRING(ac.ca_state FROM 1 FOR 1) = SUBSTRING(ds.cd_gender FROM 1 FOR 1\n    )\n)\nSELECT \n    ca_state,\n    unique_addresses,\n    total_addresses,\n    total_street_name_length,\n    total_city_length,\n    cd_gender,\n    total_demographics,\n    avg_purchase_estimate,\n    married_count,\n    single_count\nFROM \n    merged_data\nORDER BY \n    ca_state;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nhigh_value_customers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.total_net_profit,\n        cs.order_count\n    FROM \n        customer_sales cs\n    WHERE \n        cs.total_net_profit >= (\n            SELECT \n                AVG(total_net_profit) \n            FROM \n                customer_sales\n        )\n),\naverage_order AS (\n    SELECT \n        AVG(total_order_amount) AS average_order_value\n    FROM (\n        SELECT \n            ws.ws_order_number,\n            SUM(ws.ws_net_paid) AS total_order_amount\n        FROM \n            web_sales ws\n        GROUP BY \n            ws.ws_order_number\n    ) AS order_totals\n)\nSELECT \n    hvc.c_first_name,\n    hvc.c_last_name,\n    hvc.total_net_profit,\n    hvc.order_count,\n    ao.average_order_value,\n    CASE \n        WHEN hvc.order_count > 10 THEN 'Frequent Customer'\n        WHEN hvc.order_count > 0 AND hvc.order_count <= 10 THEN 'Occasional Customer'\n        ELSE 'No Orders'\n    END AS customer_type\nFROM \n    high_value_customers hvc,\n    average_order ao\nORDER BY \n    hvc.total_net_profit DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_returned_date_sk,\n        sr_item_sk,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt_inc_tax) AS total_returned_amount\n    FROM \n        store_returns\n    GROUP BY \n        sr_returned_date_sk, sr_item_sk\n),\nWebSales AS (\n    SELECT \n        ws_sold_date_sk,\n        ws_item_sk,\n        SUM(ws_quantity) AS total_sold_quantity,\n        SUM(ws_net_profit) AS total_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_sold_date_sk, ws_item_sk\n),\nCombinedSales AS (\n    SELECT \n        COALESCE(CR.sr_returned_date_sk, WS.ws_sold_date_sk) AS report_date,\n        COALESCE(CR.sr_item_sk, WS.ws_item_sk) AS item_sk,\n        COALESCE(total_sold_quantity, 0) AS total_sold_quantity,\n        COALESCE(total_returned_quantity, 0) AS total_returned_quantity,\n        COALESCE(total_profit, 0) AS total_profit\n    FROM \n        WebSales WS\n    FULL OUTER JOIN \n        CustomerReturns CR ON WS.ws_sold_date_sk = CR.sr_returned_date_sk AND WS.ws_item_sk = CR.sr_item_sk\n)\nSELECT \n    C.item_sk,\n    C.report_date,\n    C.total_sold_quantity,\n    C.total_returned_quantity,\n    C.total_profit,\n    (C.total_sold_quantity - C.total_returned_quantity) AS net_sales,\n    (C.total_profit / NULLIF(C.total_sold_quantity, 0)) AS avg_profit_per_sale\nFROM \n    CombinedSales C\nWHERE \n    C.report_date BETWEEN 20230101 AND 20231231\nORDER BY \n    C.report_date DESC, net_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    ss.ss_quantity, \n    ss.ss_sales_price \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \n    AND ss.ss_sales_price > 100 \nORDER BY \n    d.d_date DESC, \n    ss.ss_sales_price DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    s.ss_quantity, \n    s.ss_sales_price \nFROM \n    customer c \nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk \nJOIN \n    date_dim d ON s.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nORDER BY \n    d.d_date, \n    c.c_last_name;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    sa.ws_sales_price, \n    sa.ws_quantity \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales sa ON c.c_customer_sk = sa.ws_bill_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nAND \n    sa.ws_sold_date_sk IN (\n        SELECT d.d_date_sk \n        FROM date_dim d \n        WHERE d.d_year = 2023\n    ) \nORDER BY \n    sa.ws_sales_price DESC \nLIMIT 100;\n",
  "\nSELECT SUM(ws_ext_sales_price) AS total_sales\nFROM web_sales\nJOIN date_dim ON ws_sold_date_sk = d_date_sk\nJOIN customer ON ws_bill_customer_sk = c_customer_sk\nWHERE d_year = 2023 AND c_birth_country = 'USA';\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ss.ss_sales_price\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\nORDER BY ss.ss_sales_price DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, sd.ss_sales_price \nFROM customer c \nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN store_sales sd ON c.c_customer_sk = sd.ss_customer_sk \nWHERE ca.ca_state = 'NY' \nORDER BY sd.ss_sales_price DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, cd.cd_gender\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE cd.cd_gender = 'F'\nORDER BY ca.ca_city;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state, \n    cd.cd_gender, \n    cd.cd_marital_status \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk \nWHERE \n    cd.cd_gender = 'F' \n    AND ca.ca_state = 'CA';\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    a.ca_state, \n    d.d_date \nFROM \n    customer c \nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk \nJOIN \n    date_dim d ON d.d_date_sk = c.c_first_sales_date_sk \nWHERE \n    d.d_year = 2023 \nORDER BY \n    c.c_last_name;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, cd.cd_gender \nFROM customer c \nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk \nWHERE cd.cd_marital_status = 'M' AND ca.ca_state = 'CA' \nORDER BY c.c_customer_id;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, d_year\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN date_dim d ON c.c_first_sales_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nORDER BY c_first_name, c_last_name;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ss.ss_quantity,\n    ss.ss_sales_price\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nORDER BY \n    ss.ss_sales_price DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, cs.ss_sales_price \nFROM customer c \nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN store_sales cs ON c.c_customer_sk = cs.ss_customer_sk \nWHERE ca.ca_state = 'CA' \nORDER BY cs.ss_sales_price DESC \nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, cd_gender\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\nWHERE cd_gender = 'F'\nORDER BY ca_city, c_last_name;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, cd_gender\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\nWHERE cd_gender = 'F' AND ca_state = 'CA'\nORDER BY c_last_name;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    d.d_date\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim AS d ON d.d_date_sk = c.c_first_shipto_date_sk\nWHERE \n    ca.ca_state = 'CA'\nORDER BY \n    d.d_date DESC\nLIMIT 100;\n",
  "\nSELECT c.c_first_name, c.c_last_name, cc.cc_name, ss.ss_sales_price \nFROM customer c \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN call_center cc ON ss.ss_store_sk = cc.cc_call_center_sk \nWHERE cc.cc_state = 'CA' \nORDER BY ss.ss_sales_price DESC \nLIMIT 10;\n",
  "\nWITH Customer_Address_Concat AS (\n    SELECT \n        ca_address_sk,\n        TRIM(ca_street_number) || ' ' || TRIM(ca_street_name) || ' ' || TRIM(ca_street_type || \n               CASE WHEN ca_suite_number IS NOT NULL THEN ' Suite ' || TRIM(ca_suite_number) ELSE '' END) AS full_address,\n        ca_city,\n        ca_state,\n        ca_zip,\n        ca_country\n    FROM \n        customer_address\n), Customer_Demographics AS (\n    SELECT \n        cd_demo_sk,\n        CASE WHEN cd_gender = 'M' THEN 'Male' ELSE 'Female' END AS gender,\n        CASE WHEN cd_marital_status = 'S' THEN 'Single' ELSE 'Married' END AS marital_status,\n        cd_education_status,\n        cd_purchase_estimate,\n        cd_credit_rating,\n        cd_dep_count || ' Dependents' AS dependents_info\n    FROM \n        customer_demographics\n), Combined AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.gender,\n        cd.marital_status,\n        ca.full_address,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_zip,\n        ca.ca_country,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        cd.dependents_info\n    FROM \n        customer c\n    JOIN \n        Customer_Demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        Customer_Address_Concat ca ON c.c_current_addr_sk = ca.ca_address_sk\n)\nSELECT \n    c_first_name || ' ' || c_last_name AS full_name,\n    gender,\n    marital_status,\n    full_address,\n    ca_city,\n    ca_state,\n    ca_zip || ' ' || ca_country AS location,\n    cd_purchase_estimate,\n    cd_credit_rating,\n    dependents_info\nFROM \n    Combined\nWHERE \n    UPPER(ca_city) LIKE UPPER('%York%')\nORDER BY \n    ca_state, full_name\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    AVG(cd_purchase_estimate) AS average_purchase_estimate\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    ca.ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_net_profit) AS total_net_profit, \n       COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2022\nGROUP BY c.c_customer_id\nORDER BY total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales_amount,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(*) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_net_paid) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS avg_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS num_customers,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY \n    ca_city\nHAVING \n    SUM(ss_sales_price) > 100000\nORDER BY \n    total_sales DESC\nLIMIT 50;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_quantity) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca.ca_country = 'USA' \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ws.ws_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN customer ON ca_address_sk = c_current_addr_sk \nJOIN store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount,\n    AVG(ss.ss_quantity) AS average_quantity_per_sale\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_purchased\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS num_customers, \n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS average_order_value,\n    MAX(ws.ws_sales_price) AS max_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_customers,\n    SUM(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_customers,\n    AVG(cd_purchase_estimate) AS average_purchase_estimate\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_customers DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_ext_sales_price) AS total_sales\nFROM customer AS c\nJOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_net_paid) AS total_sales_amount, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    COUNT(DISTINCT ss.ss_store_sk) AS number_of_stores\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) as total_sales,\n    COUNT(ss.ss_ticket_number) as total_transactions,\n    AVG(ss.ss_sales_price) as average_transaction_value,\n    MAX(ss.ss_sales_price) as max_transaction_value,\n    MIN(ss.ss_sales_price) as min_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nHAVING \n    COUNT(DISTINCT c_customer_sk) > 100\nORDER BY \n    total_profit DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IS NOT NULL \nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "SELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2001\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_sales_price) AS total_sales,\n    AVG(ss_net_profit) AS avg_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON ss.ss_customer_sk = c.c_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_item_sk) AS item_count,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid) AS total_net_paid,\n    AVG(ss.ss_net_profit) AS average_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MIN(d.d_date) AS first_purchase_date,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_ext_sales_price) AS total_sales,\n    AVG(ss_net_profit) AS average_profit\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nHAVING \n    COUNT(DISTINCT c_customer_sk) > 1000 \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    sum(ws.ws_ext_sales_price) AS total_sales,\n    count(ws.ws_order_number) AS total_orders,\n    avg(ws.ws_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(s.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT s.ss_ticket_number) AS transactions,\n    AVG(s.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk\nJOIN \n    date_dim d ON s.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ws_quantity) AS total_quantity_sold,\n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ws_net_paid) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales_count,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT \n    100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS sales_count,\n    AVG(ss.ss_net_profit) AS avg_net_profit\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(DISTINCT ss.ss_ticket_number) AS number_of_purchases\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_item_sk) AS total_items_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders \nFROM \n    customer AS c \nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    cd.cd_marital_status = 'M' \n    AND cd.cd_gender = 'F'\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    MAX(sd.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim sd ON ss.ss_sold_date_sk = sd.d_date_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(i.i_current_price) AS average_item_price,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    item i ON ss.ss_item_sk = i.i_item_sk\nWHERE\n    c.c_current_addr_sk IS NOT NULL\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(*) AS customer_count\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE cd.cd_gender = 'F' AND cd.cd_marital_status = 'M'\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value,\n    COUNT(DISTINCT ss.ss_store_sk) AS store_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount,\n    COUNT(DISTINCT ws.ws_order_number) AS total_web_sales,\n    SUM(ws.ws_sales_price) AS total_web_sales_amount\nFROM \n    customer AS c\nLEFT JOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2022\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    COUNT(DISTINCT ss.ss_store_sk) AS total_stores\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ws_net_profit) AS total_net_profit \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address AS ca \nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid_inc_tax) AS total_revenue,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ws_net_paid) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nWHERE \n    ca_state IS NOT NULL \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    MAX(d.d_date) AS last_order_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_tickets,\n    AVG(ss.ss_sales_price) AS avg_sale_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count,\n    AVG(ws.ws_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS num_customers, \n    SUM(ss_net_paid) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca_state IS NOT NULL \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_net_paid) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(*) AS customer_count,\n    SUM(ws_net_paid) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(s.ss_ticket_number) AS total_sales,\n    SUM(s.ss_net_profit) AS total_net_profit,\n    AVG(s.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk\nJOIN \n    date_dim d ON s.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS number_of_orders,\n    AVG(ws.ws_net_profit) AS average_profit\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_quantity) AS average_quantity\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT \n    10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state IN ('CA', 'TX', 'NY')\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_quantity) AS total_quantity_sold, \n    SUM(ws.ws_ext_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS avg_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS average_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count, SUM(ws_net_profit) AS total_profit\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY ca_state\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales,\n    AVG(ss.ss_sales_price) AS average_sale_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_paid) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_tickets,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_quantity) AS total_sales_quantity, \n    SUM(ss_net_profit) AS total_net_profit \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_country, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_ext_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_country\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders, \n    AVG(ws.ws_sales_price) AS avg_sales_price, \n    COUNT(DISTINCT ws.ws_item_sk) AS total_items_sold\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sale_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales,\n    AVG(ws.ws_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_net_profit) AS total_net_profit \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_net_profit DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count, \n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM\n    customer AS c\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, COUNT(sr.sr_ticket_number) AS return_count, SUM(sr.sr_return_amt_inc_tax) AS total_return_amt\nFROM customer c\nJOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nJOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_return_amt DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales,\n    SUM(ss.ss_net_paid) AS total_sales_amount,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS unique_customer_count,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count, SUM(ws_net_profit) AS total_profit\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nJOIN web_sales ON c_customer_sk = ws_bill_customer_sk\nWHERE ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY ca_city\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c_customer_sk) AS customer_count, \n    AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    MAX(ss.ss_sold_date_sk) AS last_sale_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    d.d_month_seq\nORDER BY \n    d.d_month_seq;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA' \n    AND ws.ws_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_net_paid) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_value\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_value DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_purchases,\n    AVG(ss.ss_sales_price) AS average_purchase_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nWHERE \n    i.i_current_price > 10.00\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ss_net_paid) AS total_sales\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nGROUP BY ca_city\nORDER BY total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ws_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 50;\n",
  "\nSELECT\n    SUM(ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss_customer_sk) AS total_customers,\n    AVG(ss_quantity) AS average_quantity_sold\nFROM\n    store_sales\nJOIN\n    date_dim ON ss_sold_date_sk = d_date_sk\nJOIN\n    customer ON ss_customer_sk = c_customer_sk\nWHERE\n    d_year = 2023\nGROUP BY\n    d_month_seq\nORDER BY\n    d_month_seq;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS num_customers,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_quantity) AS total_quantity_sold, \n    SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_net_paid) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_city,\n    COUNT(DISTINCT c.c_customer_id) AS customer_count,\n    SUM(COALESCE(ss.ss_sales_price, 0)) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count, AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nJOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    COUNT(DISTINCT ss_ticket_number) AS sales_count,\n    SUM(ss_net_paid) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sale_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(c_customer_sk) AS customer_count, SUM(ss_net_profit) AS total_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ss.ss_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\nGROUP BY ca_state\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_paid) AS total_sales\nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n       MAX(d.d_date) AS last_purchase_date\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders, \n    AVG(ws.ws_sales_price) AS average_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    customer_demographics ON c_current_cdemo_sk = cd_demo_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS avg_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS num_customers,\n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address CA\nJOIN \n    customer C ON CA.ca_address_sk = C.c_current_addr_sk\nJOIN \n    store_sales SS ON C.c_customer_sk = SS.ss_customer_sk\nWHERE \n    CA.ca_state IN ('CA', 'TX', 'NY')\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount,\n    AVG(c.c_birth_year) AS avg_customer_birth_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city AS city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS average_order_value\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_paid) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ss_net_profit) AS total_net_profit\nFROM customer_address AS ca\nJOIN customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY ca_state\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_paid) AS total_sales \nFROM \n    customer_address  \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_order_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS avg_sales_price,\n    COUNT(DISTINCT ws.ws_ship_mode_sk) AS distinct_shipping_modes\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n       MAX(d.d_date) AS last_purchase_date \nFROM customer c \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE d.d_year = 2023 \nGROUP BY c.c_customer_id \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws_order_number) AS total_orders,\n    AVG(ws_net_profit) AS average_profit\nFROM \n    web_sales\nJOIN \n    customer ON web_sales.ws_bill_customer_sk = customer.c_customer_sk\nJOIN \n    date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk\nWHERE \n    date_dim.d_year = 2023\nGROUP BY \n    customer.c_birth_country\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS unique_customers, SUM(ss_net_profit) AS total_profit\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nWHERE ca_state IS NOT NULL\nGROUP BY ca_state\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    MAX(d.d_date) AS last_purchase_date\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT sr.sr_ticket_number) AS total_returns,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number \nWHERE \n    c.c_current_cdemo_sk IS NOT NULL \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales, SUM(ss.ss_sales_price) AS total_sales_amount\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    MAX(d.d_date) AS last_purchase_date\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) \n                            AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_net_paid) AS avg_net_paid\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS total_customers, SUM(ws_ext_sales_price) AS total_sales \nFROM customer_address \nJOIN customer ON ca_address_sk = c_current_addr_sk \nJOIN web_sales ON c_customer_sk = ws_bill_customer_sk \nGROUP BY ca_state \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid_inc_tax) AS total_revenue,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_ext_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state = 'CA' \nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nWHERE \n    ca_state = 'CA' \nGROUP BY \n    ca_city \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_county, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nGROUP BY \n    ca_county\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sale\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    AVG(cd_purchase_estimate) AS avg_purchase_estimate \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk \nGROUP BY \n    ca_state \nORDER BY \n    num_customers DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_orders,\n    AVG(ss.ss_sales_price) AS average_order_value\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nHAVING\n    SUM(ss.ss_sales_price) > 1000\nORDER BY\n    total_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    st.s_store_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    store_sales ss\nJOIN \n    store st ON ss.ss_store_sk = st.s_store_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    st.s_store_name\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value,\n    MAX(ss.ss_sales_price) AS max_transaction_value,\n    MIN(ss.ss_sales_price) AS min_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ws.ws_net_paid) AS total_sales,\n       COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n       AVG(ws.ws_net_profit) AS avg_profit\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT(ss.ss_ticket_number)) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    MAX(d.d_date) AS last_order_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders, \n    AVG(ws.ws_sales_price) AS avg_order_value \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n    SUM(ss.ss_net_paid) AS total_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sold_date_sk) AS last_sale_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    d.d_month_seq\nORDER BY \n    d.d_month_seq;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_per_transaction\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) as total_sales, \n    SUM(ss.ss_net_profit) as total_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ws.ws_ext_sales_price) AS total_sales\nFROM customer AS c\nJOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_web_sales,\n    SUM(ss.ss_net_paid) AS total_store_net_paid,\n    SUM(ws.ws_net_paid) AS total_web_net_paid\nFROM \n    customer c\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_store_net_paid DESC, total_web_net_paid DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS average_sale_amount,\n    MAX(ss.ss_sales_price) AS largest_sale_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    w.w_warehouse_id,\n    SUM(cs.cs_sales_price) AS total_sales,\n    COUNT(DISTINCT cs.cs_order_number) AS total_orders,\n    AVG(cs.cs_sales_price) AS avg_sales_price\nFROM \n    warehouse w\nJOIN \n    catalog_sales cs ON w.w_warehouse_sk = cs.cs_warehouse_sk\nJOIN \n    date_dim d ON cs.cs_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    w.w_warehouse_id\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sale_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ss_net_profit) AS total_profit\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nJOIN store_sales ON c_customer_sk = ss_customer_sk\nWHERE ca_state IS NOT NULL\nGROUP BY ca_state\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS unique_customers, \n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state = 'CA' AND \n    ws_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    COUNT(DISTINCT ws_order_number) AS total_orders,\n    SUM(ws_quantity) AS total_quantity_sold,\n    SUM(ws_net_paid) AS total_revenue\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count,\n    MIN(d.d_date) AS first_purchase_date,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ws.ws_order_number) AS total_web_orders,\n    SUM(ws.ws_sales_price) AS total_web_sales\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_web_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_sales_price) AS total_sales,\n    AVG(ss_net_profit) AS average_profit\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_state, \n    COUNT(DISTINCT c.c_customer_sk) AS customer_count, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca.ca_state\nHAVING \n    SUM(ss.ss_net_paid) > 10000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_net_profit) AS total_net_profit,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_paid_inc_tax) AS average_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    AVG(cd_purchase_estimate) AS avg_purchase_estimate \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    customer_demographics ON c_current_cdemo_sk = cd_demo_sk \nGROUP BY \n    ca_city \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count, \n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nWHERE \n    i.i_current_price > 50\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count,\n    AVG(ws.ws_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales_value,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_value DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_net_profit) AS total_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ss.ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales, \n    AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    cd.cd_gender = 'M' \n    AND cd.cd_marital_status = 'M'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    AVG(ss.ss_net_profit) AS avg_net_profit, \n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS average_sale\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS unique_customers, SUM(ss_net_profit) AS total_net_profit\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nGROUP BY ca_city\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS avg_transaction_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    COUNT(DISTINCT ws.ws_web_page_sk) AS unique_pages\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    COUNT(DISTINCT cs.cs_order_number) AS total_catalog_sales,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\nWHERE \n    c.c_preferred_cust_flag = 'Y'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS sales_count,\n    AVG(ss.ss_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS transaction_count \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ws.ws_net_profit) AS total_profit\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS ticket_count,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid_inc_tax) AS total_revenue,\n    AVG(ss.ss_net_profit) AS average_profit,\n    MAX(ss.ss_sold_date_sk) AS last_sale_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nWHERE \n    i.i_current_price > 50.00\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_current_addr_sk, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders, \n    SUM(ws.ws_net_paid_inc_tax) AS total_revenue \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_current_addr_sk \nORDER BY \n    total_revenue DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS total_customers,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count, SUM(ws_ext_sales_price) AS total_sales\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales,\n    SUM(ss.ss_ext_sales_price) AS total_sales_amount,\n    SUM(ss.ss_ext_discount_amt) AS total_discount_amount,\n    COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns,\n    SUM(sr.sr_return_amt) AS total_return_amount\nFROM \n    customer c\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales_amount DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_net_paid) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sale\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nWHERE \n    i.i_current_price > 20.00\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT \n    10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    COUNT(DISTINCT ss.ss_store_sk) AS total_stores\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2022\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_country, \n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_country\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS sales_count, \n    AVG(ss.ss_list_price) AS avg_list_price \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    COUNT(DISTINCT ws.ws_ship_mode_sk) AS total_ship_modes,\n    COUNT(DISTINCT ws.ws_web_page_sk) AS total_web_pages\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IN ('CA', 'NY', 'TX')\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count, SUM(ss_net_profit) AS total_net_profit\nFROM customer_address \nJOIN customer ON ca_address_sk = c_current_addr_sk \nJOIN store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY ca_state \nORDER BY total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    COUNT(DISTINCT ws.ws_sold_date_sk) AS sales_days\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_profit) AS avg_net_profit \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    COUNT(DISTINCT ss.ss_store_sk) AS unique_stores\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_net_paid) AS total_sales, \n       COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_net_profit) AS total_profit \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    SUM(ss.ss_net_paid) AS total_spent,\n    AVG(ss.ss_net_paid) AS average_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_spent DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS unique_customers, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON ss_customer_sk = c_customer_sk\nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS num_customers, SUM(ss_sales_price) AS total_sales\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nJOIN store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid_inc_tax) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ws_net_profit) AS total_profit\nFROM\n    customer_address\nJOIN\n    customer ON ca_address_sk = c_current_addr_sk\nJOIN\n    web_sales ON c_customer_sk = ws_bill_customer_sk\nGROUP BY\n    ca_state\nORDER BY\n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    web_sales ON c_customer_sk = ws_ship_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ss_net_profit) AS total_net_profit \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_purchased\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2022\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(c.c_customer_sk) AS customer_count, \n    SUM(ws_net_profit) AS total_profit \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca_state = 'CA' \nGROUP BY \n    ca_city \nORDER BY \n    total_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ss_net_profit) AS total_profit\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nGROUP BY ca_state\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_ext_sales_price) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(s.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales s ON c.c_customer_sk = s.ws_bill_customer_sk\nJOIN \n    date_dim d ON s.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_net_profit) AS total_net_profit\nFROM\n    customer_address AS ca\nJOIN\n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    ca_city\nORDER BY\n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS avg_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_quantity) AS total_sales_quantity, \n    SUM(ws.ws_sales_price) AS total_sales_amount \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales_amount DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ws.ws_sales_price) as total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(CASE \n            WHEN cd_gender = 'F' THEN 1 \n            ELSE 0 \n        END) AS female_count,\n    SUM(CASE \n            WHEN cd_gender = 'M' THEN 1 \n            ELSE 0 \n        END) AS male_count,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS avg_net_paid,\n    COUNT(DISTINCT ss.ss_store_sk) AS unique_stores\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_revenue,\n    AVG(ws.ws_sales_price) AS average_order_value,\n    MAX(ws.ws_sales_price) AS max_order_value,\n    MIN(ws.ws_sales_price) AS min_order_value\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_quantity) AS total_quantity, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS num_customers, \n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_net_profit) AS total_net_profit,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) as total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) as total_transactions,\n    AVG(ss.ss_sales_price) as average_sales_price,\n    COUNT(DISTINCT ss.ss_store_sk) as unique_stores\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders, \n    SUM(ws.ws_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS unique_customers, \n    SUM(ws_net_profit) AS total_profit \nFROM \n    customer_address AS ca \nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca_state IS NOT NULL \nGROUP BY \n    ca_state \nORDER BY \n    total_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS avg_order_value,\n    MAX(ws.ws_sales_price) AS max_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT sr_ticket_number) AS total_returns,\n    SUM(sr_return_amt) AS total_return_amount,\n    SUM(sr_return_tax) AS total_return_tax\nFROM \n    customer c\nJOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    cd.cd_gender = 'F'\n    AND cd.cd_marital_status = 'M'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_returns DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count,\n    AVG(ws.ws_quantity) AS average_quantity\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) as total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) as total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN date_dim d ON c.c_first_sales_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY ca_state\nORDER BY customer_count DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS average_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    i.i_item_id,\n    SUM(ws.ws_quantity) AS total_quantity_sold,\n    SUM(ws.ws_sales_price) AS total_sales,\n    AVG(ws.ws_net_profit) AS average_net_profit\nFROM \n    web_sales ws\nJOIN \n    item i ON ws.ws_item_sk = i.i_item_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    i.i_item_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_county, COUNT(DISTINCT c_customer_sk) AS unique_customers, SUM(ss_net_profit) AS total_net_profit\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nGROUP BY ca_county\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_count,\n    SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_count,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nGROUP BY \n    ca_city\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state IS NOT NULL AND \n    ws.ws_sales_price > 0\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_paid) AS avg_net_paid,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss_ticket_number) AS total_transactions,\n    SUM(ss_ext_sales_price) AS total_sales,\n    AVG(ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS total_customers,\n    SUM(ws_net_profit) AS total_net_profit\nFROM\n    customer_address\nJOIN\n    customer ON ca_address_sk = c_current_addr_sk\nJOIN\n    web_sales ON c_customer_sk = ws_bill_customer_sk\nGROUP BY\n    ca_state\nORDER BY\n    ca_state;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ss_net_profit) AS total_net_profit\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nGROUP BY ca_city\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS average_transaction_value\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    SUM(ws_net_profit) AS total_net_profit, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "SELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_spent, \n    COUNT(ss.ss_ticket_number) AS purchase_count \nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2001 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_spent DESC \nLIMIT 10;",
  "\nSELECT \n    w.w_warehouse_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    web_sales ws\nJOIN \n    warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    w.w_warehouse_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_ext_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca_state IS NOT NULL \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IN ('CA', 'NY', 'TX')\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IN ('CA', 'TX', 'NY')\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT \n    10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca_state = 'CA' \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS avg_transaction_value \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    w.w_warehouse_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    store_sales ss \nJOIN \n    warehouse w ON ss.ss_store_sk = w.w_warehouse_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    w.w_warehouse_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count,\n    MAX(d.d_date) AS last_purchase_date\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_net_profit) AS total_profit,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_sk) AS unique_customers,\n    SUM(ss.ss_net_paid) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    MAX(ss.ss_sold_date_sk) AS latest_sale_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    d.d_month_seq\nORDER BY \n    d.d_month_seq;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city,\n    count(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ss_net_profit) AS total_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT SUM(ws_ext_sales_price) AS total_sales,\n       COUNT(DISTINCT ws_order_number) AS total_orders,\n       AVG(ws_net_profit) AS average_profit\nFROM web_sales\nJOIN item ON ws_item_sk = i_item_sk\nJOIN date_dim ON ws_sold_date_sk = d_date_sk\nWHERE d_year = 2023\nGROUP BY d_month_seq\nORDER BY d_month_seq;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS unique_customers, SUM(ss_net_profit) AS total_profit\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nJOIN store_sales ON c_customer_sk = ss_customer_sk\nWHERE ca_state IN ('CA', 'NY', 'TX')\nGROUP BY ca_state\nORDER BY total_profit DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    COUNT(DISTINCT ws.ws_item_sk) AS total_items_purchased\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ss_net_paid) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    SUM(ss.ss_ext_discount_amt) AS total_discount,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS unique_customers,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_list_price) AS avg_list_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \n    AND c.c_preferred_cust_flag = 'Y'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ws.ws_sales_price) AS total_sales, \n       COUNT(DISTINCT ws.ws_order_number) AS order_count, \n       AVG(ws.ws_sales_price) AS avg_sales_price \nFROM customer c \nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE d.d_year = 2023 \nGROUP BY c.c_customer_id \nORDER BY total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS num_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca_state = 'CA' \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_sales_price) AS total_sales,\n    AVG(ws_net_profit) AS average_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_profit) AS total_profit,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_ext_discount_amt) AS max_discount,\n    MIN(ss.ss_ext_tax) AS min_tax\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_sk) AS Total_Customers,\n    AVG(i.i_current_price) AS Average_Item_Price,\n    SUM(ws.ws_net_profit) AS Total_Net_Profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    item i ON ws.ws_item_sk = i.i_item_sk\nWHERE \n    c.c_current_cdemo_sk IS NOT NULL\n    AND i.i_current_price > 0\nGROUP BY \n    c.c_current_cdemo_sk;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_net_paid_inc_tax) AS total_revenue, \n    AVG(ss.ss_sales_price) AS average_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(COALESCE(ws_net_profit, 0)) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ss_sales_price) AS total_sales\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca_state = 'CA'\nGROUP BY ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ws.ws_ext_sales_price) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2021\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nWHERE \n    i.i_current_price > 50.00\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) as total_profit,\n    COUNT(ss.ss_ticket_number) as total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_ext_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales,\n    AVG(ws.ws_net_profit) AS avg_profit\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_count, \n    SUM(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_count \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_customers DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(DISTINCT s.ss_ticket_number) AS total_sales, \n    SUM(s.ss_net_paid) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk\nJOIN \n    date_dim d ON s.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 AND c.c_preferred_cust_flag = 'Y'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_quantity) AS total_sales_quantity,\n    SUM(ws.ws_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS average_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    COUNT(DISTINCT sr_item_sk) AS total_returns,\n    SUM(sr_return_amt) AS total_return_amount\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nLEFT JOIN \n    store_returns ON c_customer_sk = sr_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_return_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    cs.cs_item_sk, \n    SUM(cs.cs_quantity) AS total_quantity_sold, \n    SUM(cs.cs_sales_price) AS total_sales_amount, \n    AVG(cs.cs_sales_price) AS avg_sales_price\nFROM \n    catalog_sales cs\nJOIN \n    date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk\nJOIN \n    customer c ON cs.cs_bill_customer_sk = c.c_customer_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    cs.cs_item_sk\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ss_sales_price) AS total_sales\nFROM customer_address AS ca\nJOIN customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders \nFROM \n    customer AS c \nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_net_profit) AS total_profit\nFROM\n    customer_address ca\nJOIN\n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE\n    ca_state IN ('CA', 'NY', 'TX')\nGROUP BY\n    ca_state\nORDER BY\n    total_profit DESC;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ss_net_profit) AS total_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS total_customers,\n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS unique_orders,\n    AVG(ss.ss_sales_price) AS average_order_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 1000;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS avg_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address AS ca \nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS avg_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count,\n    AVG(ss.ss_net_profit) AS avg_net_profit\nFROM\n    customer AS c\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count, \n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \n    AND c.c_preferred_cust_flag = 'Y'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS average_net_paid\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    COUNT(DISTINCT ws.ws_item_sk) AS total_items\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ws_quantity) AS total_sales_quantity,\n    SUM(ws_sales_price) AS total_sales_amount\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state IN ('CA', 'NY', 'TX')\nGROUP BY \n    ca_state\nORDER BY \n    total_sales_amount DESC;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ss_quantity) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_ext_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count, SUM(ss_sales_price) AS total_sales\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nGROUP BY ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_net_paid) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    sum(ss.ss_net_profit) AS total_net_profit,\n    avg(cd.cd_purchase_estimate) AS average_purchase_estimate,\n    count(distinct ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    cd.cd_gender = 'F' AND \n    cd.cd_marital_status = 'M'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(ss.ss_ticket_number) AS transaction_count\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2022\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_ext_sales_price) AS total_sales \nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ws.ws_sales_price) AS total_sales, \n       COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ss_net_paid) AS total_sales\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_city,\n    COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n    SUM(ss.ss_quantity) AS total_sales_quantity,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    ca.ca_city\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS unique_customers,\n    SUM(ss_quantity) AS total_sales,\n    AVG(ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales,\n       COUNT(ss.ss_ticket_number) AS total_transactions\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    AVG(ws.ws_net_profit) AS average_profit \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    sum(ws.ws_net_profit) AS total_profit, \n    count(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_profit) AS avg_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "SELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2001 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS avg_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_ext_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_ext_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_net_paid_inc_tax) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS avg_sale_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    cd.cd_gender = 'F' \n    AND cd.cd_marital_status = 'M'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_ticket_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    COUNT(ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS distinct_customers,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS num_customers,\n    SUM(sr_return_quantity) AS total_returned\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nLEFT JOIN \n    store_returns AS sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    num_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS sales_count,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    COUNT(DISTINCT sr.sr_ticket_number) AS returns_count,\n    SUM(sr.sr_return_amt) AS total_returns,\n    AVG(sr.sr_return_amt) AS average_return_amount\nFROM \n    customer c\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_order_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    AVG(cd_purchase_estimate) AS avg_purchase_estimate \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk \nGROUP BY \n    ca_state \nORDER BY \n    customer_count DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_count,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS average_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    AVG(ss.ss_list_price) AS average_list_price, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT s.ss_ticket_number) AS total_sales,\n    SUM(s.ss_sales_price) AS total_revenue,\n    AVG(s.ss_sales_price) AS average_sales_price,\n    COUNT(DISTINCT sr.sr_ticket_number) AS total_returns,\n    SUM(sr.sr_return_amt_inc_tax) AS total_return_amount\nFROM \n    customer c\nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk\nLEFT JOIN \n    store_returns sr ON s.ss_item_sk = sr.sr_item_sk AND s.ss_ticket_number = sr.sr_ticket_number\nWHERE \n    c.c_preferred_cust_flag = 'Y'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ws.ws_sales_price) AS total_sales, \n       COUNT(DISTINCT ws.ws_order_number) AS total_orders, \n       AVG(ws.ws_sales_price) AS avg_sales_price\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_net_profit) AS average_profit\nFROM\n    customer AS c\nJOIN\n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    AVG(ws.ws_ext_sales_price) AS average_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sale_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS orders_count, \n    AVG(ws.ws_sales_price) AS avg_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_purchases,\n    MAX(d.d_date) AS last_purchase_date\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    cd.cd_gender = 'F'\n    AND cd.cd_marital_status = 'M'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_per_transaction\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS number_of_customers, \n    SUM(ss_net_profit) AS total_net_profit \nFROM \n    customer_address AS ca \nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca_state IN ('CA', 'TX', 'NY') \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address AS ca \nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ws.ws_ext_sales_price) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nGROUP BY \n    c.c_customer_id\nHAVING \n    SUM(ws.ws_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_sold\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_sales_price) AS average_sales,\n    MAX(ss.ss_sales_price) AS max_sales,\n    MIN(ss.ss_sales_price) AS min_sales\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    d.d_month_seq\nORDER BY \n    d.d_month_seq;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_net_paid) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    AVG(ws.ws_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ws_ext_sales_price) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    d.d_year AS sales_year\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nGROUP BY \n    d.d_year\nORDER BY \n    d.d_year;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_quantity) AS total_quantity_sold, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS unique_customers, SUM(ss_sales_price) AS total_sales\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nJOIN store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_tickets\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ss_sales_price) AS total_sales,\n    AVG(ss_quantity) AS average_quantity,\n    d_year\nFROM \n    store_sales ss\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nGROUP BY \n    d_year\nORDER BY \n    d_year DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_date >= '2022-01-01' AND d.d_date <= '2022-12-31'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ws_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca_state IS NOT NULL \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_net_profit) AS total_net_profit,\n       COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM customer AS c\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2022\nGROUP BY c.c_customer_id\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    COUNT(DISTINCT ss.ss_store_sk) AS unique_stores\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_net_paid) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON c_current_addr_sk = ca_address_sk\nJOIN \n    store_sales ON ss_customer_sk = c_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_item_sk) AS total_items_sold\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT \n    100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS unique_customers, \n    SUM(ws_net_paid) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ws_sales_price) AS total_sales, \n    AVG(ws_net_profit) AS avg_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value,\n    MAX(ss.ss_sales_price) AS highest_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_city IS NOT NULL\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales_count\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_orders\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    MAX(d.d_date) AS last_purchase_date\nFROM\n    customer AS c\nJOIN\n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count,\n    AVG(ws.ws_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    MAX(ws.ws_sold_date_sk) AS last_order_date\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_quantity) AS average_quantity_sold,\n    MIN(ss.ss_sold_date_sk) AS first_sale_date,\n    MAX(ss.ss_sold_date_sk) AS last_sale_date\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    d.d_month_seq\nORDER BY \n    d.d_month_seq;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    SUM(ss.ss_quantity) AS total_quantity\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2022\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    SUM(ss_net_paid) AS total_sales \nFROM \n    store_sales \nJOIN \n    customer_address ON ss_addr_sk = ca_address_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_store_sk) AS store_count\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "SELECT \n    c.c_customer_id, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2001\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    MAX(d.d_date) AS last_purchase_date \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS total_items_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sale\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count, \n    AVG(ss.ss_net_paid) AS average_payment \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_profit) AS total_profit\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS distinct_items_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS number_of_customers,\n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(COALESCE(ws_sales_price, 0)) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nLEFT JOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_city\nHAVING \n    COUNT(DISTINCT c_customer_sk) > 100\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales,\n    MAX(ws.ws_net_profit) AS max_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_id) AS unique_customers, \n    SUM(ss.ss_net_paid) AS total_sales, \n    AVG(ss.ss_sales_price) AS average_sales_price \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    d.d_month_seq \nORDER BY \n    d.d_month_seq;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk \nWHERE \n    s.s_city = 'San Francisco' \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    AVG(ss.ss_sales_price) AS avg_sales_price, \n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS avg_sale\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    SUM(ss.ss_ext_discount_amt) AS total_discount,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_net_paid) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders, \n    AVG(ws.ws_net_profit) AS average_profit \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ss_net_profit) AS total_net_profit\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nWHERE ca_state IS NOT NULL\nGROUP BY ca_state\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "SELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2001\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    cd.cd_gender = 'F' \n    AND cd.cd_marital_status = 'M' \n    AND cd.cd_education_status = 'Bachelor''s'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nAND \n    c.c_preferred_cust_flag = 'Y'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS unique_customers, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_purchased\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count,\n    AVG(ws.ws_net_paid) AS average_payment\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    COUNT(DISTINCT ss.ss_store_sk) AS stores_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023 AND\n    c.c_birth_country = 'USA'\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address CA \nJOIN \n    customer C ON CA.ca_address_sk = C.c_current_addr_sk \nJOIN \n    store_sales SS ON C.c_customer_sk = SS.ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_quantity) AS total_sales_quantity, \n    SUM(ss_net_paid) AS total_sales_amount \nFROM \n    customer_address AS ca \nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    ca_city \nORDER BY \n    total_sales_amount DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state AS state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_net_profit) AS total_profit\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nGROUP BY \n    ca_city\nHAVING \n    AVG(cd_purchase_estimate) > 500\nORDER BY \n    customer_count DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM\n    customer AS c\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2022\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_net_profit) AS total_net_profit \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_ext_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_net_profit) AS total_profit\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_profit, \n    COUNT(ss.ss_ticket_number) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_profit DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_net_profit) AS total_net_profit, \n       COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023 \nGROUP BY c.c_customer_id\nORDER BY total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss_ticket_number) AS total_transactions,\n    AVG(ss_net_paid) AS average_net_paid\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS orders_count,\n    MAX(d.d_date) AS last_sale_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_ext_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_sales_price) AS average_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sale_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(COALESCE(ss_net_profit, 0)) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS avg_sales_price \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_net_profit,\n    d.d_year AS sales_year\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nGROUP BY \n    d.d_year\nORDER BY \n    sales_year DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    SUM(ws_net_paid) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ws_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT o.ws_order_number) AS total_orders,\n    SUM(o.ws_ext_sales_price) AS total_sales,\n    AVG(o.ws_ext_sales_price) AS avg_sales,\n    MAX(o.ws_ext_sales_price) AS max_sales,\n    MIN(o.ws_ext_sales_price) AS min_sales\nFROM \n    customer c\nJOIN \n    web_sales o ON c.c_customer_sk = o.ws_bill_customer_sk\nJOIN \n    date_dim d ON o.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT sr.sr_ticket_number) AS total_returns,\n    SUM(sr.sr_return_amt_inc_tax) AS total_return_amount,\n    SUM(sr.sr_return_tax) AS total_return_tax\nFROM \n    customer AS c\nJOIN \n    store_returns AS sr ON c.c_customer_sk = sr.sr_customer_sk\nJOIN \n    date_dim AS dd ON sr.sr_returned_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_returns DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nWHERE \n    s.s_state = 'CA'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2021\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS order_count, \n    MAX(d.d_date) AS last_order_date\nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, COUNT(ss.ss_ticket_number) AS total_sales, SUM(ss.ss_net_paid) AS total_revenue\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_tickets,\n    AVG(ss.ss_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count, AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\nWHERE cd_gender = 'F' AND cd_marital_status = 'M' \nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(COALESCE(ss_quantity, 0)) AS total_sales_quantity, \n    SUM(COALESCE(ss_net_paid, 0)) AS total_net_income\nFROM \n    customer_address ca\nLEFT JOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_net_income DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_ext_sales_price) AS total_revenue,\n    AVG(ss.ss_net_profit) AS average_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nHAVING \n    COUNT(DISTINCT c_customer_sk) > 100\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_profit) AS total_profit,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_quantity) AS total_quantity, \n    SUM(ws.ws_ext_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_list_price) AS avg_list_price,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_paid) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IN ('CA', 'TX', 'NY')\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT sr.sr_ticket_number) AS total_returns\nFROM \n    customer c\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number\nWHERE \n    c.c_current_addr_sk IN (\n        SELECT ca_address_sk \n        FROM customer_address \n        WHERE ca_state = 'CA'\n    )\nGROUP BY \n    c.c_customer_id\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS order_count, \n    MIN(dd.d_date) AS first_purchase_date, \n    MAX(dd.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_country = 'USA'\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS transaction_count, \n    AVG(ss.ss_sales_price) AS avg_sales_price \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    COUNT(DISTINCT sr.sr_ticket_number) AS total_returns,\n    SUM(sr.sr_return_amt) AS total_return_amount\nFROM \n    customer c\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_ext_discount_amt) AS avg_discount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS order_count, \n    AVG(ws.ws_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_transaction_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(DISTINCT sr_ticket_number) AS total_returns, \n    SUM(sr_return_amt_inc_tax) AS total_return_amount\nFROM \n    customer c\nJOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nJOIN \n    date_dim d ON sr.sr_returned_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nHAVING \n    COUNT(DISTINCT sr_ticket_number) > 5\nORDER BY \n    total_returns DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    COUNT(DISTINCT ss.ss_store_sk) AS stores_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_ext_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(sr_return_quantity) AS total_returned_quantity\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY \n    ca_city\nHAVING \n    COUNT(DISTINCT c_customer_sk) > 10\nORDER BY \n    total_returned_quantity DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address AS ca \nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    COUNT(DISTINCT ws.ws_item_sk) AS total_items\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_sales_quantity,\n    SUM(ss.ss_net_paid) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS unique_customers, \n    SUM(ws_net_paid) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk \nWHERE \n    ca_state = 'CA' \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    d.d_year AS sales_year\nFROM\n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nGROUP BY \n    d.d_year\nORDER BY \n    sales_year;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS average_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_net_profit) AS total_net_profit \nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state = 'CA' \nGROUP BY \n    ca_city \nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nGROUP BY \n    c.c_customer_id\nHAVING \n    SUM(ws.ws_ext_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_net_profit) AS average_profit \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_purchased\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sale_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON d.d_date_sk = ws.ws_sold_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_net_paid) AS average_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS unique_customers,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state = 'NY'\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count, SUM(ss_sales_price) AS total_sales\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca_state IN ('CA', 'TX', 'NY')\nGROUP BY ca_state\nORDER BY total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ss_net_profit) AS total_net_profit\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY ca_state\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM\n    customer AS c\nJOIN\n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_purchases \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS avg_payment\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_country, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_net_profit) AS total_profit \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk \nGROUP BY \n    ca_country \nORDER BY \n    total_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_net_paid) AS total_revenue, \n    AVG(ss.ss_net_paid) AS avg_sales_per_order \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_revenue DESC \nLIMIT 100;\n",
  "SELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2001\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS number_of_orders,\n    AVG(ws.ws_sales_price) AS average_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'NY'\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_net_profit) AS total_net_profit,\n    AVG(ws.ws_sales_price) AS avg_sales_price,\n    MAX(ws.ws_sold_date_sk) AS last_order_date\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(distinct ws.ws_order_number) AS total_orders,\n    COUNT(distinct ws.ws_ship_date_sk) AS total_shipments,\n    AVG(ws.ws_net_paid) AS average_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws_ext_sales_price) AS total_sales,\n    COUNT(ws_order_number) AS total_orders,\n    MAX(d_year) AS last_year\nFROM \n    web_sales\nJOIN \n    customer c ON ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_ext_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS unique_customers,\n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_sale\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ws.ws_sales_price) AS total_sales\nFROM customer AS c\nJOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS order_count, \n    MAX(d.d_date) AS last_order_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS total_customers,\n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON ss.ss_customer_sk = c.c_customer_sk\nWHERE \n    ca_state IN ('NY', 'CA', 'TX')\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales,\n       COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_spent\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id\nORDER BY total_spent DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nWHERE \n    ca_state IS NOT NULL \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_sales_price) AS total_revenue \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_revenue DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders, \n    AVG(ws.ws_sales_price) AS avg_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_sold,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(s.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk\nJOIN \n    date_dim d ON s.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    AVG(ss.ss_net_paid_inc_tax) AS avg_net_paid\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_net_paid) AS average_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_ticket_number) AS unique_tickets\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ss_net_paid) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_net_profit) AS total_net_profit,\n    AVG(ws.ws_quantity) AS avg_quantity_per_order,\n    COUNT(DISTINCT ws.ws_item_sk) AS distinct_items_sold\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_net_profit DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    MAX(ss.ss_sales_price) AS max_sale,\n    MIN(ss.ss_sales_price) AS min_sale\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "SELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2001\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ws_quantity) AS total_quantity_sold, \n    SUM(ws_sales_price) AS total_sales \nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ws_net_profit) AS total_profit \nFROM customer_address \nJOIN customer ON ca_address_sk = c_current_addr_sk \nJOIN web_sales ON c_customer_sk = ws_bill_customer_sk \nGROUP BY ca_state \nORDER BY total_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_net_profit) AS total_profit \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca_state IN ('CA', 'NY', 'TX') \nGROUP BY \n    ca_state \nORDER BY \n    total_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ws.ws_order_number) AS total_web_sales,\n    SUM(ws.ws_net_paid) AS total_net_paid,\n    AVG(ws.ws_net_paid_inc_tax) AS avg_net_paid_inc_tax \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_web_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_quantity) AS total_sales_quantity, \n    SUM(ss_net_profit) AS total_net_profit \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count,\n    AVG(ws.ws_sales_price) AS avg_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    SUM(ss_net_profit) AS total_net_profit \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nWHERE \n    ca_state IS NOT NULL \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue,\n    AVG(ss.ss_sales_price) AS average_sale_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ws_order_number) AS total_orders, \n    AVG(ws_net_profit) AS average_profit\nFROM \n    web_sales \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nJOIN \n    item ON ws_item_sk = i_item_sk \nWHERE \n    d_year = 2022 \n    AND i_current_price > 20.00\nGROUP BY \n    d_month_seq \nORDER BY \n    d_month_seq;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    COUNT(DISTINCT ws.ws_web_page_sk) AS unique_pages_viewed\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2022\nGROUP BY c.c_customer_id\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ws_ext_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca_state = 'CA' \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state IS NOT NULL\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_orders,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sale\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS total_customers,\n    SUM(ss_sales_price) AS total_sales,\n    AVG(ss_net_profit) AS average_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nHAVING \n    COUNT(DISTINCT c_customer_id) > 0\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_city \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state = 'CA' \n    AND ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nHAVING\n    SUM(ss.ss_sales_price) > 1000\nORDER BY\n    total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS number_of_customers, \n    SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_count, \n    SUM(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_count \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    customer_demographics ON c_current_cdemo_sk = cd_demo_sk \nGROUP BY \n    ca_state \nORDER BY \n    number_of_customers DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_price DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS avg_net_paid\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT s.ss_ticket_number) AS total_sales,\n    SUM(s.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk\nJOIN \n    date_dim d ON s.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_net_paid) AS total_revenue, \n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "SELECT \n  ca_city, \n  COUNT(DISTINCT c_customer_id) AS customer_count, \n  SUM(ws_net_profit) AS total_profit \nFROM \n  customer_address ca \nJOIN \n  customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n  web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk \nWHERE \n  ca.ca_state = 'CA' \nGROUP BY \n  ca_city \nORDER BY \n  total_profit DESC \nLIMIT 10;",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales_price,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_net_profit) AS total_net_profit,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT s.ss_ticket_number) AS total_sales,\n    SUM(s.ss_net_profit) AS total_net_profit,\n    AVG(s.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk\nJOIN \n    date_dim d ON s.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS dd ON ss.ss_sold_date_sk = dd.d_date_sk \nWHERE \n    dd.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nHAVING \n    SUM(ss.ss_sales_price) > 1000 \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    COUNT(DISTINCT ws.ws_web_page_sk) AS unique_web_pages\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions,\n    AVG(ss.ss_net_paid) AS avg_sales_per_transaction,\n    MAX(ss.ss_net_paid) AS max_sale,\n    MIN(ss.ss_net_paid) AS min_sale\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IN ('CA', 'NY', 'TX')\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_ext_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    SUM(ss_ext_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT s.ss_ticket_number) AS total_store_sales,\n    SUM(s.ss_net_profit) AS total_net_profit,\n    SUM(s.ss_ext_discount_amt) AS total_discount\nFROM \n    customer c\nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk\nJOIN \n    date_dim d ON s.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS num_customers,\n    SUM(ws_quantity) AS total_sales,\n    AVG(ws_net_profit) AS avg_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state IN ('CA', 'TX', 'NY')\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_ext_sales_price) AS total_sales_amount,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item AS i ON ss.ss_item_sk = i.i_item_sk\nWHERE \n    i.i_current_price > 20.00\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_net_profit) AS average_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(cs.cs_sales_price) AS total_sales,\n    COUNT(cs.cs_order_number) AS total_orders\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    catalog_sales cs ON ss.ss_item_sk = cs.cs_item_sk\nWHERE\n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS avg_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS unique_customers, SUM(ss_net_profit) AS total_profit\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY ca_state\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_per_transaction\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_quantity) AS average_quantity\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales_value, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales_value DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 50;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(ss.ss_ticket_number) AS total_transactions \nFROM customer c \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE d.d_year = 2023 \nGROUP BY c.c_customer_id \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_item_sk) AS total_items_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE\n    dd.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_per_transaction\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca_state IN ('CA', 'TX') \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2021 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    d.d_year AS sales_year\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    d.d_year\nORDER BY \n    sales_year;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS unique_customers, SUM(ss_net_profit) AS total_net_profit\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nGROUP BY ca_state\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS unique_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_sales_price) AS avg_sales_price\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS avg_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COALESCE(SUM(ss.ss_sales_price), 0) AS total_store_sales,\n    COALESCE(SUM(ws.ws_sales_price), 0) AS total_web_sales\nFROM \n    customer c\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_store_sales DESC, total_web_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions, \n    AVG(ss.ss_sales_price) AS avg_sales_price \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    sum(ws.ws_sales_price) AS total_sales,\n    count(distinct ws.ws_order_number) AS total_orders,\n    avg(ws.ws_sales_price) AS avg_order_value,\n    min(ws.ws_sales_price) AS min_order_value,\n    max(ws.ws_sales_price) AS max_order_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS average_sales_per_transaction\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    MAX(ws.ws_sold_date_sk) AS last_purchase_date\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE cd.cd_gender = 'F' AND cd.cd_marital_status = 'M'\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT\n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_sales_price) AS total_sales,\n    AVG(ss_net_profit) AS average_net_profit\nFROM\n    customer_address\nJOIN\n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN\n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nGROUP BY\n    ca_city\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS unique_customers,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca_state IS NOT NULL \nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_customers \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    customer_demographics ON c_current_cdemo_sk = cd_demo_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_customers DESC;\n",
  "\nSELECT\n    ca_state,\n    COUNT(c_customer_sk) AS total_customers,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM\n    customer_address AS ca\nJOIN\n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN\n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nGROUP BY\n    ca_state\nORDER BY\n    total_customers DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH processed_addresses AS (\n    SELECT\n        ca_address_sk,\n        TRIM(ca_street_number) || ' ' || TRIM(ca_street_name) || ' ' || TRIM(ca_street_type) || \n        CASE \n            WHEN ca_suite_number IS NOT NULL AND ca_suite_number <> '' THEN ' Suite ' || TRIM(ca_suite_number) \n            ELSE '' \n        END AS full_address,\n        ca_city,\n        ca_state\n    FROM\n        customer_address\n), \nword_count AS (\n    SELECT\n        ca_address_sk,\n        LENGTH(full_address) - LENGTH(REPLACE(full_address, ' ', '')) + 1 AS word_count\n    FROM\n        processed_addresses\n),\ntop_cities AS (\n    SELECT\n        ca_city,\n        COUNT(DISTINCT ca_address_sk) AS address_count\n    FROM\n        processed_addresses\n    GROUP BY\n        ca_city\n    HAVING\n        COUNT(DISTINCT ca_address_sk) > 5\n)\nSELECT \n    pa.ca_address_sk,\n    pa.full_address,\n    wc.word_count,\n    tc.ca_city,\n    tc.address_count\nFROM \n    processed_addresses pa\nJOIN \n    word_count wc ON pa.ca_address_sk = wc.ca_address_sk\nJOIN \n    top_cities tc ON pa.ca_city = tc.ca_city\nWHERE \n    wc.word_count > 3\nORDER BY \n    tc.address_count DESC, wc.word_count DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    d.d_date, \n    SUM(ws.ws_quantity) AS total_quantity_sold, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_city = 'San Francisco'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, \n    ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_item_sk) AS items_sold\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_spent,\n    COUNT(ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_sales,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    sd.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim sd ON ss.ss_sold_date_sk = sd.d_date_sk\nWHERE \n    sd.d_year = 2023\nGROUP BY \n    c.c_customer_id, sd.d_year\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss_quantity) AS total_quantity,\n    SUM(ss_sales_price) AS total_sales,\n    d.d_year AS sales_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_sales_price) AS total_sales_amount, \n    AVG(ss.ss_sales_price) AS avg_sales_price, \n    CD.cd_gender \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    customer_demographics CD ON c.c_current_cdemo_sk = CD.cd_demo_sk \nWHERE \n    CD.cd_marital_status = 'M' \n    AND CD.cd_gender = 'F' \nGROUP BY \n    c.c_customer_id, CD.cd_gender \nORDER BY \n    total_sales_amount DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ws.ws_sales_price) AS total_sales\nFROM customer AS c\nJOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_city = 'San Francisco'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name,\n    c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    count(ss.ss_ticket_number) AS total_sales,\n    sum(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nWHERE \n    s.s_state = 'CA' \nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS sales_count,\n    AVG(ss.ss_list_price) AS avg_list_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ws.ws_net_profit) > 1000\nORDER BY \n    total_net_profit DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS avg_order_value,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_ext_sales_price) as total_sales, \n    avg(ss.ss_net_profit) as average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales_value,\n    d.d_year \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, d.d_year \nORDER BY \n    total_sales_value DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_value\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales_value DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sale,\n    MIN(ss.ss_sales_price) AS min_sale,\n    MAX(ss.ss_sales_price) AS max_sale\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value,\n    d.d_year\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id,\n    d.d_year\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_net_paid) AS total_net_paid \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_net_paid DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sale_price,\n    d.d_year\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, d.d_year\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON d.d_date_sk = ss.ss_sold_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ss.ss_sales_price) > 10000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_sales_quantity,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'NY'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    AVG(ss.ss_net_profit) AS average_profit, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_sales, \n    SUM(ss.ss_sales_price) AS total_sales_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales_value DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(s.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT s.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales s ON c.c_customer_sk = s.ws_bill_customer_sk\nJOIN \n    date_dim d ON s.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2022\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid_inc_tax) AS total_spent \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       ca.ca_city, \n       SUM(ws.ws_ext_sales_price) AS total_sales \nFROM customer c \nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE ca.ca_state = 'CA' \nGROUP BY c.c_customer_id, ca.ca_city \nORDER BY total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ws.ws_net_profit) AS total_profit\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS average_order_value,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(sr.sr_item_sk) AS returns_count, \n    SUM(sr.sr_return_amt) AS total_return_amount\nFROM \n    customer c\nJOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nJOIN \n    date_dim d ON sr.sr_returned_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_return_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk \nWHERE \n    i.i_current_price > 20.00 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_net_profit) AS total_net_profit,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_city = 'San Francisco'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit, \n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \n    AND ss.ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_net_paid) AS total_revenue\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       ca.ca_city, \n       SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE ca.ca_state = 'CA' \nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    sum(ws.ws_sales_price) as total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'NY' \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \n    AND ss.ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2021\nGROUP BY \n    c.c_customer_id, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 50;\n",
  "\nSELECT c.c_customer_id, \n       ca.ca_city, \n       SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name,\n    c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_city = 'San Francisco'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nHAVING \n    SUM(ws.ws_ext_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, \n    ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\n    AND ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sale_price,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_purchases \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, \n    ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS order_count, \n    d.d_year \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_orders\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_sales,\n    SUM(ss.ss_net_paid) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name\nORDER BY \n    total_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales_amount,\n    d.d_year AS sales_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2021\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer AS c\nJOIN\n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ca.ca_state = 'CA'\nGROUP BY\n    c.c_customer_id, ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_net_profit) AS total_profit,\n    SUM(ws.ws_quantity) AS total_quantity\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS order_count \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON d.d_date_sk = ss.ss_sold_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name,\n    c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    SUM(ss.ss_quantity) AS total_quantity,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'NY'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_profit \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales_revenue,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions\nFROM \n    item i\nJOIN \n    store_sales ss ON i.i_item_sk = ss.ss_item_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    i.i_item_id, i.i_item_desc\nORDER BY \n    total_sales_revenue DESC\nLIMIT \n    10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\n    AND ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n    AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    d.d_date, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_year AS sales_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_net_profit) AS total_profit\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_sold_quantity,\n    SUM(ss.ss_net_paid) AS total_net_paid\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_paid DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_city = 'San Francisco'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales_amount, \n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    ca.ca_city\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2022\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_net_profit) AS total_net_profit,\n    d_year,\n    i_category\nFROM \n    web_sales\nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk\nJOIN \n    item ON ws_item_sk = i_item_sk\nGROUP BY \n    d_year, i_category\nORDER BY \n    d_year, total_net_profit DESC;\n",
  "\nSELECT c.c_customer_id, \n       ca.ca_city, \n       SUM(ws.ws_sales_price) AS total_sales, \n       COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_customer_id, ca.ca_city\nHAVING SUM(ws.ws_sales_price) > 1000\nORDER BY total_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_quantity) AS total_quantity_sold,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_sales_price) AS total_sales, \n    count(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS number_of_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent, \n    COUNT(ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_net_profit) AS total_profit,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_quantity) AS total_quantity_sold, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON d.d_date_sk = ss.ss_sold_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM\n    customer AS c\nJOIN\n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ca.ca_state = 'CA'\nGROUP BY\n    c.c_customer_id, ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' AND\n    ss.ss_sold_date_sk IN (SELECT d.d_date_sk FROM date_dim d WHERE d.d_year = 2023)\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    d.d_year AS sales_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price,\n    d.d_year AS sales_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS orders_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT \n    10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_country,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_country = 'USA'\nGROUP BY \n    c.c_customer_id, ca.ca_country\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_quantity) AS total_quantity_sold, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_net_paid_inc_tax) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer AS c \nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales AS ss ON ss.ss_customer_sk = c.c_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_net_profit DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \n    AND ss.ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\n    AND c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    d.d_date_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_date_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON d.d_date_sk = ws.ws_sold_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_sales_quantity,\n    SUM(ss.ss_sales_price) AS total_sales_value\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name,\n    c.c_last_name\nORDER BY\n    total_sales_value DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c_first_name, c_last_name, SUM(ss_ext_sales_price) AS total_sales\nFROM customer\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nJOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\nWHERE d_year = 2023\nGROUP BY c_first_name, c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(DISTINCT ws.ws_order_number) AS total_web_orders,\n    SUM(ws.ws_net_paid_inc_tax) AS total_revenue\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_quantity) AS total_quantity_sold,\n    SUM(ws.ws_sales_price) AS total_sales_value\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales_value DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    d.d_date, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'NY'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON d.d_date_sk = ss.ss_sold_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_first_name, \n       c.c_last_name, \n       SUM(ss.ss_net_profit) AS total_profit\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(sr.sr_item_sk) AS return_count,\n    SUM(sr.sr_return_amt) AS total_return_amount\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_return_amount DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_city IS NOT NULL\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       ca.ca_city, \n       SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\n  AND ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ss.ss_quantity) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_tickets\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    SUM(ss.ss_quantity) AS total_quantity\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_quantity_sold DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, SUM(ws_net_profit) AS total_profit\nFROM customer\nJOIN web_sales ON c_customer_sk = ws_bill_customer_sk\nJOIN date_dim ON ws_sold_date_sk = d_date_sk\nWHERE d_year = 2022\nGROUP BY c_first_name, c_last_name\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_sales_price) AS total_sales,\n    count(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT \n    10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_quantity) AS total_quantity, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 AND d.d_month_seq = 6\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_items_sold, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nWHERE \n    s.s_state = 'CA'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales_value\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales_value DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       ca.ca_city, \n       SUM(ss.ss_net_paid) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_customer_id, ca.ca_city\nHAVING SUM(ss.ss_net_paid) > 1000\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       ca.ca_city, \n       SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_sales_quantity, \n    SUM(ss.ss_sales_price) AS total_sales_amount \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales_amount DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    sum(ss.ss_net_profit) AS total_profit\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ca.ca_state = 'CA'\nGROUP BY\n    c.c_customer_id, ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON d.d_date_sk = ss.ss_sold_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    SUM(ss.ss_quantity) AS total_quantity,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    SUM(ss.ss_ext_tax) AS total_tax,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nWHERE \n    s.s_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_net_paid) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON d.d_date_sk = ss.ss_sold_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk\nWHERE \n    d_year = 2023\nGROUP BY \n    c_first_name, c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_sales_quantity,\n    SUM(ss.ss_sales_price) AS total_sales_amount,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id, ca.ca_city\nORDER BY\n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(*) AS total_transactions\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales, COUNT(ss.ss_ticket_number) AS total_transactions\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    d.d_date,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \n    AND ss.ss_sold_date_sk = (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2022 AND d.d_moy IN (6, 7, 8)\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ca.ca_state = 'CA'\nGROUP BY\n    c.c_customer_id, ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_country = 'USA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(DISTINCT sr.sr_ticket_number) AS total_returns,\n    SUM(sr.sr_return_amt) AS total_return_amount,\n    AVG(sr.sr_return_quantity) AS avg_return_quantity\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_returns DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_value\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales_value DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       ca.ca_city, \n       SUM(ss.ss_sales_price) AS total_sales, \n       COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_spent, \n    COUNT(ws.ws_order_number) AS orders_count \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    d.d_date AS sale_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent, \n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count, \n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS num_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    web_sales ws \nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_net_profit) as total_profit,\n    count(ss.ss_ticket_number) as total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nFETCH FIRST 100 ROWS ONLY;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\n    AND ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n                               AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_purchases \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    COUNT(DISTINCT ws.ws_web_page_sk) AS unique_pages,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA' \n    AND ws.ws_sold_date_sk >= (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS number_of_orders,\n    AVG(ws.ws_net_profit) AS average_profit\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(wo.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    web_sales wo ON c.c_customer_sk = wo.ws_bill_customer_sk\nJOIN \n    date_dim d ON wo.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_value,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS avg_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_net_paid) AS total_spent \nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \n    AND ss.ss_sold_date_sk >= (SELECT MAX(d.d_date_sk) - 30 FROM date_dim d)\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    SUM(ss.ss_quantity) AS total_quantity_sold \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, sum(ss.ss_net_profit) as total_profit\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_spent\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \n    AND d.d_month_seq = 12\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS avg_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS number_of_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON ss.ss_customer_sk = c.c_customer_sk\nWHERE \n    ca.ca_state = 'NY'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    c.c_birth_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_birth_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    sum(ss.ss_quantity) AS total_quantity_sold,\n    sum(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS average_sale_price,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name,\n    c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_paid) AS avg_net_paid\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ws.ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city,\n    sum(ss.ss_sales_price) as total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    MIN(d.d_date) AS first_purchase_date,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_quantity) AS total_items_sold, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT c.c_first_name, c.c_last_name, sum(ss.ss_net_paid) as total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_profit, \n    COUNT(ss.ss_ticket_number) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    count(ss.ss_ticket_number) AS total_purchases,\n    sum(ss.ss_net_paid_inc_tax) AS total_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ws.ws_sales_price) as total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_sales, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON d.d_date_sk = ss.ss_sold_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_items_sold, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer \nJOIN \n    web_sales ON customer.c_customer_sk = web_sales.ws_bill_customer_sk\nJOIN \n    date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk\nWHERE \n    d_year = 2023\nGROUP BY \n    c_first_name, c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS number_of_orders\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name,\n    c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(sr.sr_ticket_number) AS return_count,\n    SUM(sr.sr_return_amt_inc_tax) AS total_return_amount\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_returns AS sr ON sr.sr_customer_sk = c.c_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_return_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    d.d_year, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    SUM(ss.ss_ext_discount_amt) AS total_discount,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    SUM(ss.ss_sales_price) / COUNT(ss.ss_ticket_number) AS avg_sales_per_ticket\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_net_profit) as total_net_profit,\n    count(ss.ss_ticket_number) as total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nFETCH FIRST 10 ROWS ONLY;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_purchases,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ws.ws_sales_price) > 10000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_year \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name,\n    c.c_last_name\nORDER BY\n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_date\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(cs.cs_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\nWHERE \n    c.c_current_addr_sk IS NOT NULL\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    d.d_year, \n    s.s_store_id, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    store_sales ss\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    d.d_year, s.s_store_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_sales_price) AS total_revenue \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk \nWHERE \n    i.i_current_price > 50 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_revenue DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON d.d_date_sk = ss.ss_sold_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(ws.ws_order_number) AS total_orders, \n    SUM(ws.ws_sales_price) AS total_spent\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid) AS total_revenue\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent, \n    COUNT(ss.ss_ticket_number) AS purchase_count \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    sum(ss.ss_sales_price) AS total_sales,\n    count(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 AND \n    d.d_month_seq IN (1, 2, 3)\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_profit) AS total_net_profit, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id, d.d_year \nORDER BY \n    total_net_profit DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'NY' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_net_profit DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_net_profit) AS total_net_profit \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ws.ws_ext_sales_price) as total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk \nWHERE \n    dd.d_year = 2022 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid) AS total_net_paid, \n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_net_paid DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM\n    customer AS c\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_ext_sales_price) AS total_sales_amount \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales_amount DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT(ws.ws_order_number)) AS number_of_orders,\n    AVG(ws.ws_sales_price) AS avg_sales_price,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON d.d_date_sk = ss.ss_sold_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_quantity) AS total_quantity_sold, \n    sum(ss.ss_ext_sales_price) AS total_sales_amount \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_sales_amount DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss \nON \n    c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d \nON \n    ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(s.ss_sales_price) AS total_sales,\n    COUNT(s.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk\nJOIN \n    date_dim d ON s.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_net_paid_inc_tax) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'NY'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    d.d_date,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, d.d_date\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ss.ss_quantity) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ss.ss_sales_price) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, COUNT(ss.ss_ticket_number) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ss.ss_net_paid) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    COUNT(ss.ss_item_sk) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nHAVING SUM(ss.ss_sales_price) > 1000\nORDER BY total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, \n    ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    a.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, a.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ss.ss_sales_price) AS total_sales \nFROM customer c \nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY c.c_customer_id, ca.ca_city \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ss.ss_sales_price) as total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    COUNT(ss.ss_ticket_number) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_quantity DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_quantity) AS total_quantity_sold\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    avg(ws.ws_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    avg_sales_price DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ca.ca_state = 'CA'\nGROUP BY\n    c.c_customer_id, ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ws.ws_ext_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_quantity) AS total_quantity_sold \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_quantity_sold DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) as total_sales\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ws.ws_net_paid) AS total_spent\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nHAVING SUM(ws.ws_net_paid) > 1000\nORDER BY total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    COUNT(ss.ss_ticket_number) AS sales_count, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_net_paid) AS total_net_paid\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_paid DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    sales_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ss.ss_sales_price) AS total_sales\nFROM store_sales ss\nJOIN customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, COUNT(ss.ss_ticket_number) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ss.ss_net_profit) AS total_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       ca.ca_city, \n       COUNT(ss.ss_ticket_number) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_quantity) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) as total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ss.ss_quantity) AS total_quantity\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_quantity DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id, ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_quantity) AS total_sales_quantity, \n    SUM(ss.ss_sales_price) AS total_sales_amount \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales_quantity DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id,\n    ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_ext_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id,\n    ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) as total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM\n    customer AS c\nJOIN\n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id, ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nGROUP BY \n    c.c_customer_id, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_state, \n    ca.ca_city, \n    COUNT(CASE WHEN cd.cd_gender = 'F' THEN 1 END) AS female_count, \n    COUNT(CASE WHEN cd.cd_gender = 'M' THEN 1 END) AS male_count, \n    SUM(CASE WHEN cd.cd_marital_status = 'M' THEN 1 ELSE 0 END) AS married_count, \n    SUM(CASE WHEN cd.cd_marital_status = 'S' THEN 1 ELSE 0 END) AS single_count, \n    AVG(cd.cd_dep_count) AS avg_dependents, \n    AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk \nWHERE \n    ca.ca_city IS NOT NULL \nGROUP BY \n    ca.ca_state, ca.ca_city \nORDER BY \n    ca.ca_state, ca.ca_city;\n",
  "\nWITH Address_City AS (\n    SELECT DISTINCT ca_city\n    FROM customer_address\n    WHERE LENGTH(ca_city) > 5\n), \nCustomer_Info AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_city\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    WHERE ca.ca_city IN (SELECT ca_city FROM Address_City)\n), \nAggregation AS (\n    SELECT \n        ci.ca_city,\n        COUNT(ci.c_customer_id) AS customer_count,\n        SUM(CASE WHEN ci.cd_gender = 'M' THEN 1 ELSE 0 END) AS male_count,\n        SUM(CASE WHEN ci.cd_gender = 'F' THEN 1 ELSE 0 END) AS female_count,\n        AVG(CASE WHEN ci.cd_marital_status = 'S' THEN 1 ELSE NULL END) AS single_ratio\n    FROM Customer_Info ci\n    GROUP BY ci.ca_city\n),\nFinal_Output AS (\n    SELECT \n        ca.ca_city,\n        ca.customer_count,\n        ca.male_count,\n        ca.female_count,\n        ROUND(ca.single_ratio * 100, 2) AS single_percentage\n    FROM Aggregation ca\n    WHERE ca.customer_count > 10\n)\nSELECT *\nFROM Final_Output\nORDER BY ca_city;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    sum(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) as total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) as number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 50;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(ws.ws_order_number) AS order_count, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        t.t_hour,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales\n    FROM \n        web_sales ws\n    JOIN \n        time_dim t ON ws.ws_sold_time_sk = t.t_time_sk\n    GROUP BY \n        t.t_hour\n)\nSELECT \n    s.t_hour,\n    COALESCE(s.total_quantity, 0) AS total_quantity,\n    COALESCE(s.total_sales, 0) AS total_sales\nFROM \n    (SELECT DISTINCT t_hour FROM time_dim) AS t\nLEFT JOIN \n    sales_summary s ON t.t_hour = s.t_hour\nORDER BY \n    t.t_hour;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid_inc_tax) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS order_count \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_city = 'Los Angeles'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_net_paid) AS total_sales_amount \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales_amount DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    c.c_email_address,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, c.c_email_address\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_items_sold,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year, d.d_month_seq\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid_inc_tax) AS total_spent, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name,\n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_sales_quantity, \n    SUM(ss.ss_sales_price) AS total_sales_amount \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales_amount DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales_price DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM\n    customer AS c\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS order_count \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(DISTINCT cr.cr_order_number) AS total_returns,\n    SUM(cr.cr_return_amount) AS total_return_amount\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    catalog_returns cr ON cr.cr_returning_customer_sk = c.c_customer_sk\nWHERE \n    ca.ca_state = 'CA' AND \n    cr.cr_returned_date_sk >= (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023)\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_returns DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    d.d_year \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_spent,\n    COUNT(ws.ws_order_number) AS total_orders,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_sales_price) AS total_sales,\n    count(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent,\n    COUNT(ss.ss_ticket_number) AS total_purchases\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2020\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_sales_price) as total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "SELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2001 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS number_of_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_quantity) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_date AS sales_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    cs.cs_order_number, \n    SUM(cs.cs_quantity) AS total_quantity,\n    SUM(cs.cs_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\nJOIN \n    date_dim d ON cs.cs_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    cs.cs_order_number\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_sales_price) as total_sales,\n    d.d_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales_count\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY\n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_purchases\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_date AS sales_date \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_net_profit) AS total_net_profit,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        ws.ws_item_sk\n)\nSELECT \n    i.i_item_id,\n    sd.total_sales,\n    sd.order_count\nFROM \n    sales_data sd\nJOIN \n    item i ON sd.ws_item_sk = i.i_item_sk\nORDER BY \n    sd.total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_net_profit) AS avg_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       c.c_first_name, \n       c.c_last_name, \n       sum(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2022\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count,\n    d.d_date AS sales_date\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    sum(ws.ws_sales_price) as total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_spent,\n    COUNT(ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    AVG(ss.ss_net_paid) AS avg_net_paid\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ws.ws_ext_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS number_of_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_purchases,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_quantity) AS total_quantity, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) as total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    sum(ws.ws_sales_price * ws.ws_quantity) AS total_sales,\n    count(distinct ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_net_paid) AS total_spent, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \n    AND c.c_preferred_cust_flag = 'Y'\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_per_transaction\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "SELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2001 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_quantity) AS total_quantity_sold,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_sales_quantity, \n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(s.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales s ON c.c_customer_sk = s.ws_bill_customer_sk\nJOIN \n    date_dim d ON s.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name,\n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS num_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date,\n    cd.cd_gender,\n    cd.cd_marital_status\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nGROUP BY \n    c.c_customer_id, cd.cd_gender, cd.cd_marital_status\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_street_name, \n    ca.ca_city, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_street_name, ca.ca_city\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    d.d_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_first_name, c.c_last_name, d.d_date, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name, d.d_date\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales, \n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales, d.d_date\nFROM customer AS c\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name, d.d_date\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM\n    customer AS c\nLEFT JOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY\n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) as total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_tickets\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'NY'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    cd.cd_gender, \n    cd.cd_marital_status \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk \nGROUP BY \n    c.c_customer_id, cd.cd_gender, cd.cd_marital_status \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       c.c_first_name, \n       c.c_last_name, \n       SUM(ss.ss_net_paid) AS total_sales \nFROM customer c \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE d.d_year = 2023 \nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       c.c_first_name, \n       c.c_last_name, \n       SUM(ss.ss_quantity) AS total_quantity_sold, \n       SUM(ss.ss_net_paid) AS total_revenue \nFROM customer c \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE d.d_year = 2023 \nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY total_revenue DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales, \n    d.d_year \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_city = 'Los Angeles'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    count(ss.ss_ticket_number) as total_sales, \n    sum(ss.ss_sales_price) as total_amount_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nHAVING \n    SUM(ss.ss_sales_price) > 10000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count,\n    d.d_date AS sales_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_order_number,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_item_sk) AS item_count,\n        COUNT(DISTINCT ws.ws_ship_customer_sk) AS customer_count\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN \n        customer c ON ws.ws_ship_customer_sk = c.c_customer_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        ws.ws_order_number\n)\n\nSELECT \n    total_sales,\n    item_count,\n    customer_count\nFROM \n    SalesData\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_quantity) as total_quantity,\n    sum(ss.ss_sales_price) as total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent, \n    COUNT(ss.ss_ticket_number) AS purchase_count\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    cm.cd_gender, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_demographics cm ON c.c_current_cdemo_sk = cm.cd_demo_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    cm.cd_marital_status = 'M' \nGROUP BY \n    c.c_first_name, c.c_last_name, cm.cd_gender \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_net_paid) as total_sales, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk \nWHERE \n    dd.d_year = 2023 \nGROUP BY \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS order_count \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nWITH TotalSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n), \nTopCustomers AS (\n    SELECT \n        c.c_customer_id,\n        ts.total_sales\n    FROM \n        TotalSales ts\n    JOIN \n        customer c ON ts.c_customer_sk = c.c_customer_sk\n    ORDER BY \n        ts.total_sales DESC\n    LIMIT 10\n)\nSELECT \n    tc.c_customer_id,\n    tc.total_sales\nFROM \n    TopCustomers tc;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS number_of_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date AS sales_date, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_net_profit) AS total_net_profit,\n    count(ss.ss_ticket_number) AS total_sales,\n    avg(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ca.ca_state = 'CA'\nGROUP BY\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city\nORDER BY\n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nAND \n    c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON d.d_date_sk = ss.ss_sold_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name,\n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    d.d_year\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name,\n    c.c_last_name,\n    d.d_year\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nGROUP BY \n    c.c_first_name,\n    c.c_last_name,\n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name,\n    c.c_last_name,\n    d.d_year\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_sales_quantity,\n    SUM(ss.ss_net_paid) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       c.c_first_name, \n       c.c_last_name, \n       SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_date AS sale_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nHAVING \n    SUM(ss.ss_net_profit) > 1000\nORDER BY \n    total_net_profit DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    SUM(ws.ws_ext_tax) AS total_tax,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS sales_count\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) as total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state \nHAVING \n    SUM(ss.ss_quantity) > 100 \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_net_paid) AS total_net_paid\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_net_paid DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_quantity) AS total_quantity, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name,\n    c.c_last_name,\n    d.d_year\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    s.s_store_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk \nWHERE \n    c.c_current_addr_sk IS NOT NULL \nGROUP BY \n    c.c_first_name, c.c_last_name, s.s_store_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid_inc_tax) AS total_revenue,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    d.d_month_seq,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_month_seq, d.d_year\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_date AS transaction_date\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    sum(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_sales_price) AS total_sales,\n    count(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year, d.d_month_seq\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, ca.ca_state, SUM(ss.ss_sales_price) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name,\n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    AVG(ws.ws_sales_price) AS avg_sales_price,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent, \n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_street_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_street_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS sale_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(ws.ws_ext_sales_price) as total_sales\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS number_of_orders\nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_net_paid,\n    SUM(ss.ss_quantity) AS total_quantity\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_paid DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    c.c_email_address, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, c.c_email_address \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(o.ss_ticket_number) AS total_sales,\n    SUM(o.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nLEFT JOIN \n    store_sales o ON c.c_customer_sk = o.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(s.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales s ON c.c_customer_sk = s.ws_bill_customer_sk\nJOIN \n    date_dim d ON s.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_quantity) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_net_paid) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_street_name,\n    ca.ca_city,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_street_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_sales_price) as total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       SUM(ss.ss_sales_price) AS total_sales, \n       d.d_year, \n       d.d_month_seq \nFROM customer c \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE d.d_year = 2023 \nGROUP BY c.c_customer_id, d.d_year, d.d_month_seq \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "SELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2001\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    cd.cd_gender = 'F'\n    AND cd.cd_marital_status = 'M'\nGROUP BY\n    c.c_customer_id, cd.cd_gender, cd.cd_marital_status\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_sales_quantity,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales, \n    d.d_date AS sales_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent, \n    COUNT(ss.ss_ticket_number) AS total_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nWHERE \n    a.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, a.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    MAX(d.d_date) AS last_purchase_date\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_sales_price) AS total_sales,\n    count(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value,\n    cd.cd_gender,\n    cd.cd_marital_status\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    c.c_first_shipto_date_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id, cd.cd_gender, cd.cd_marital_status\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "SELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2000\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) as total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS order_count \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_city = 'Los Angeles' AND ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer AS c \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_net_profit DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_sales_price) AS total_sales,\n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS purchase_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_quantity) AS total_quantity_sold,\n    SUM(ws.ws_sales_price) AS total_sales_value\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales_value DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) as total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(DISTINCT ss.ss_ticket_number) AS store_sales_count, \n    SUM(ss.ss_net_paid) AS total_store_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_store_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_ext_sales_price) AS total_sales,\n    count(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales_amount,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    c.c_email_address, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, c.c_email_address\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nAND \n    ss.ss_sold_date_sk >= (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022) - 30\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count,\n    AVG(ss.ss_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year, d.d_month_seq\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    cd.cd_gender = 'M'\nGROUP BY \n    c.c_customer_id, cd.cd_gender, cd.cd_marital_status\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    sum(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name,\n    d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    sum(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    COUNT(ws.ws_order_number) AS total_orders, \n    SUM(ws.ws_net_paid) AS total_spent \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS order_count \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales_amount, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year \nORDER BY \n    total_sales_amount DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nHAVING \n    SUM(ss.ss_net_profit) > 1000\nORDER BY \n    total_net_profit DESC;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, COUNT(sr.sr_item_sk) AS return_count\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nLEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY return_count DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, SUM(ss_net_paid) AS total_spent\nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city\nORDER BY total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ss.ss_net_profit) as total_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ss.ss_net_paid) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, ca.ca_state, COUNT(sr.sr_ticket_number) AS total_returns\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nLEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY total_returns DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city\nORDER BY\n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ws.ws_sales_price) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    SUM(ss_net_profit) AS total_profit\nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nWHERE \n    ca_state = 'CA'\nGROUP BY \n    c_first_name, c_last_name, ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, ca.ca_state, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, ca.ca_state, COUNT(ss.ss_ticket_number) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, d.d_date, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name, d.d_date\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, sum(ss.ss_net_paid) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ss.ss_sales_price) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_quantity) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, a.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, COUNT(ss.ss_ticket_number) AS sales_count\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY sales_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_quantity) AS total_quantity \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city \nORDER BY \n    total_quantity DESC \nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, COUNT(ss_ticket_number) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, ca.ca_state, COUNT(ss.ss_ticket_number) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    SUM(ss_net_paid) AS total_sales\nFROM \n    customer \nJOIN \n    customer_address ON c_current_addr_sk = ca_address_sk \nJOIN \n    store_sales ON ss_customer_sk = c_customer_sk \nGROUP BY \n    c_first_name, c_last_name, ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ws.ws_ext_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    a.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, ca.ca_state, SUM(ss.ss_net_paid) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    sum(ss.ss_sales_price) as total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, SUM(ss_sales_price) AS total_sales\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, SUM(ws_ext_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, SUM(ws_net_profit) AS total_profit\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN web_sales ON customer.c_customer_sk = web_sales.ws_bill_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ca.ca_state = 'CA'\nGROUP BY\n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ss.ss_quantity) AS total_quantity_sold\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_quantity) AS total_quantity \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_quantity DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity_sold\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY\n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, SUM(ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, COUNT(ss_ticket_number) AS sales_count\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city\nORDER BY sales_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, COUNT(ss.ss_ticket_number) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_spent\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city\nORDER BY\n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ss.ss_net_paid) AS total_spent\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_spent DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ss.ss_net_profit) AS total_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, d.d_date, SUM(ss.ss_net_paid) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_first_name, c.c_last_name, d.d_date\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    SUM(ws_net_paid) AS total_spent\nFROM \n    customer \nJOIN \n    customer_address ON c_current_addr_sk = ca_address_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nGROUP BY \n    c_first_name, c_last_name, ca_city\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    COUNT(ss.ss_ticket_number) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid) AS total_revenue\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, a.ca_city, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, a.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, COUNT(ss_item_sk) AS total_sales\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_spent \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, ca.ca_state, COUNT(ss.ss_ticket_number) AS sales_count\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY sales_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, COUNT(ss.ss_ticket_number) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state, \n    COUNT(ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ws.ws_ext_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, COUNT(ss_ticket_number) AS total_sales\nFROM customer\nJOIN customer_address ON c_current_addr_sk = ca_address_sk\nJOIN store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) as total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_quantity) AS total_quantity_sold \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_quantity_sold DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_net_paid) AS total_net_paid\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_net_paid DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, COUNT(ss_ticket_number) AS total_sales\nFROM customer\nJOIN customer_address ON c_current_addr_sk = ca_address_sk\nJOIN store_sales ON ss_customer_sk = c_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\nGROUP BY \n    c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_year, \n    d.d_month_seq \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year, d.d_month_seq \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_quantity) AS total_quantity_sold, \n    SUM(ws.ws_net_profit) AS total_net_profit \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales_value\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales_value DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name, ca.ca_city\nHAVING \n    SUM(ws.ws_sales_price) > 1000\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year, d.d_month_seq\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    c.c_email_address,\n    d.d_date,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name,\n    c.c_last_name,\n    c.c_email_address,\n    d.d_date\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    SUM(ss.ss_quantity) AS total_quantity,\n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count,\n    d.d_date AS sales_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    sa.ca_city,\n    sa.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_address sa ON c.c_current_addr_sk = sa.ca_address_sk\nWHERE \n    sa.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    sa.ca_city, \n    sa.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year, d.d_month_seq\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'NY'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    addr.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address addr ON c.c_current_addr_sk = addr.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    addr.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, addr.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_date AS sale_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA' \n    AND ws.ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year, \n    d.d_month_seq\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_purchases\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    C.c_customer_id,\n    C.c_first_name,\n    C.c_last_name,\n    SUM(WS.ws_sales_price) AS total_sales,\n    D.d_year\nFROM \n    customer C\nJOIN \n    web_sales WS ON C.c_customer_sk = WS.ws_bill_customer_sk\nJOIN \n    date_dim D ON WS.ws_sold_date_sk = D.d_date_sk\nWHERE \n    D.d_year = 2022\nGROUP BY \n    C.c_customer_id, C.c_first_name, C.c_last_name, D.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    store_sales ss \nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date \nORDER BY \n    total_net_profit DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        ws.ws_sold_date_sk\n)\nSELECT \n    d.d_date AS sale_date,\n    sd.total_quantity,\n    sd.total_sales,\n    sd.total_profit\nFROM \n    sales_data sd\nJOIN \n    date_dim d ON sd.ws_sold_date_sk = d.d_date_sk\nORDER BY \n    d.d_date;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ss.ss_sold_date_sk, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ss.ss_sold_date_sk\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_spent DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales_price\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales_price DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_net_paid) AS total_net_paid,\n    AVG(ss.ss_net_profit) AS average_net_profit,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_net_paid DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_sales, \n    d.d_month_seq \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_month_seq \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_ext_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city \nHAVING \n    SUM(ss.ss_ext_sales_price) > 1000 \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_date AS sales_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_city = 'San Francisco'\nGROUP BY \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_date BETWEEN '2023-01-01' AND '2023-12-31'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    d.d_year\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_year\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_city = 'San Francisco'\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_sk, c.c_customer_id, ca.ca_city, ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    s.s_store_name, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk \nWHERE \n    s.s_state = 'CA' \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, s.s_store_name \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       c.c_first_name, \n       c.c_last_name, \n       SUM(ss.ss_sales_price) AS total_sales, \n       d.d_year \nFROM customer c \nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE d.d_year = 2023 \nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    sa.ca_city, \n    sa.ca_state, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_net_paid) AS total_revenue \nFROM \n    customer c \nJOIN \n    customer_address sa ON c.c_current_addr_sk = sa.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    sa.ca_state = 'CA' \nGROUP BY \n    c.c_first_name, c.c_last_name, sa.ca_city, sa.ca_state \nORDER BY \n    total_revenue DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    cd.cd_gender, \n    cd.cd_marital_status, \n    SUM(ss.ss_quantity) AS total_quantity, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    cd.cd_gender = 'F' \n    AND cd.cd_marital_status = 'M'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    cd.cd_gender, \n    cd.cd_marital_status\nHAVING \n    SUM(ss.ss_quantity) > 50\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    sum(ss.ss_sales_price) AS total_sales, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    COALESCE(c.c_first_name, 'Unknown') AS customer_first_name,\n    COALESCE(c.c_last_name, 'Unknown') AS customer_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_date AS transaction_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    cd.cd_gender = 'F' AND\n    cd.cd_marital_status = 'M'\nGROUP BY\n    c.c_first_name,\n    c.c_last_name,\n    cd.cd_gender,\n    cd.cd_marital_status\nHAVING\n    SUM(ss.ss_sales_price) > 1000\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_date \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    sum(ws.ws_net_paid) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    d.d_date AS sales_date\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_spent,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year, d.d_month_seq\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_net_profit) AS total_profit,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid) AS total_spent,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\n    AND ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n    AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year, d.d_month_seq\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_items_sold,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    SUM(ss.ss_quantity) AS total_quantity\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    a.ca_city,\n    a.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, a.ca_city, a.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, d.d_date\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_city = 'San Francisco'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ss.ss_sold_date_sk,\n        SUM(ss.ss_sales_price) AS total_sales,\n        COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers,\n        SUM(ss.ss_quantity) AS total_quantity\n    FROM \n        store_sales ss\n    JOIN \n        date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        ss.ss_sold_date_sk\n)\nSELECT \n    d.d_date AS sale_date,\n    ss.total_sales,\n    ss.unique_customers,\n    ss.total_quantity\nFROM \n    sales_summary ss\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nORDER BY \n    sale_date;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ws_net_profit) AS total_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    a.ca_state, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    a.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, COUNT(ss_ticket_number) AS total_sales\nFROM customer\nJOIN customer_address ON c_current_addr_sk = ca_address_sk\nJOIN store_sales ON ss_customer_sk = c_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_quantity) AS total_quantity_sold\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ws.ws_sold_date_sk,\n    SUM(ws.ws_quantity) AS total_quantity\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ws.ws_sold_date_sk\nORDER BY \n    total_quantity DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    a.ca_state, \n    SUM(ss.ss_quantity) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    a.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nHAVING SUM(ss.ss_sales_price) > 1000\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, COUNT(ss_ticket_number) AS sales_count\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY sales_count DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_sales_price) AS total_sales\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk \nGROUP BY \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_quantity) AS total_quantity\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_quantity DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_net_paid) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    sum(ss.ss_net_profit) as total_profit\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state \nORDER BY \n    total_profit DESC \nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, COUNT(ss_ticket_number) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ws_net_paid) AS total_sales\nFROM customer\nJOIN customer_address ON c_current_addr_sk = ca_address_sk\nJOIN web_sales ON c_customer_sk = ws_bill_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, COUNT(ss.ss_item_sk) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_net_profit) as total_profit\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, COUNT(sr_ticket_number) AS return_count\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY return_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_net_profit) AS total_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_quantity) AS total_quantity_sold\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, COUNT(ss.ss_ticket_number) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_sk, ca.ca_city, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, COUNT(ss_ticket_number) AS total_sales\nFROM customer\nJOIN customer_address ON c_current_addr_sk = ca_address_sk\nJOIN store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca_state = 'CA'\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer AS c\nJOIN\n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    COUNT(ss.ss_ticket_number) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_net_profit) AS total_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, a.ca_city, a.ca_state, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, a.ca_city, a.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_net_paid) AS total_spent \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state, \n    SUM(ss_net_paid) AS total_sales \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk \nGROUP BY \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, COUNT(ss_ticket_number) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_quantity) AS total_quantity_sold\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city\nORDER BY\n    total_sales DESC;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ws_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer \nJOIN \n    customer_address ON c_current_addr_sk = ca_address_sk \nJOIN \n    store_sales ON ss_customer_sk = c_customer_sk \nGROUP BY \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_quantity) AS total_quantity \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state \nORDER BY \n    total_quantity DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, SUM(ss.ss_net_profit) AS total_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_net_profit) as total_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_street_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_street_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_quantity) AS total_quantity\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_quantity DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_quantity) AS total_quantity\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_quantity DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_net_paid) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, COUNT(ss_ticket_number) AS total_sales\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_net_profit) AS total_net_profit\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    COUNT(sr.sr_item_sk) AS return_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nLEFT JOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    return_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer AS c \nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_net_paid) AS total_spent\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) as total_sales \nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    COUNT(ss.ss_ticket_number) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_sales_price) AS total_sales \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk \nGROUP BY c_first_name, c_last_name, ca_city, ca_state \nORDER BY total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_net_paid) AS total_spent\nFROM customer\nJOIN customer_address ON c_current_addr_sk = ca_address_sk\nJOIN store_sales ON ss_customer_sk = c_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state, \n    COUNT(ss_ticket_number) AS total_sales\nFROM \n    customer \nJOIN \n    customer_address ON c_current_addr_sk = ca_address_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY \n    c_first_name, c_last_name, ca_city, ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, COUNT(sr_item_sk) AS total_returns\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_returns DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    COUNT(sr.sr_ticket_number) AS return_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nLEFT JOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    return_count DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_net_paid) AS total_sales\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_sales_price) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca_state = 'CA'\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_sales_price) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, COUNT(ss.ss_ticket_number) AS total_purchases\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_purchases DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    a.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, a.ca_city, a.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state, \n    COUNT(ss_ticket_number) AS total_sales \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk \nGROUP BY \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_quantity) AS total_quantity\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_quantity DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state, \n    SUM(ws_net_paid) AS total_sales\nFROM \n    customer \nJOIN \n    customer_address ON c_current_addr_sk = ca_address_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nGROUP BY \n    c_first_name, c_last_name, ca_city, ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    COUNT(sr.sr_ticket_number) AS total_returns\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nLEFT JOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_returns DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    a.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    a.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state, \n    COUNT(ss_ticket_number) AS total_sales \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk \nGROUP BY \n    c_first_name, c_last_name, ca_city, ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, COUNT(ss_ticket_number) AS sales_count\nFROM customer\nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY sales_count DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, sa.ca_city, sa.ca_state, COUNT(ss.ss_ticket_number) AS total_sales\nFROM customer c\nJOIN customer_address sa ON c.c_current_addr_sk = sa.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, sa.ca_city, sa.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_quantity) AS total_quantity_sold\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_ext_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_quantity) AS total_quantity\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_quantity DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_quantity) AS total_quantity_sold\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, COUNT(ss_ticket_number) AS total_purchases \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk \nGROUP BY c_first_name, c_last_name, ca_city, ca_state \nORDER BY total_purchases DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_quantity) AS total_quantity \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state \nORDER BY \n    total_quantity DESC \nLIMIT 10;\n",
  "\nSELECT \n    c_first_name,\n    c_last_name,\n    ca_city,\n    ca_state,\n    SUM(ss_net_profit) AS total_profit\nFROM \n    customer\nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state, \n    SUM(ss_net_paid) AS total_sales\nFROM \n    customer \nJOIN \n    customer_address ON c_current_addr_sk = ca_address_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    COUNT(ss.ss_ticket_number) AS total_sales \nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_sales_price) AS total_sales\nFROM customer\nJOIN customer_address ON c_current_addr_sk = ca_address_sk\nJOIN store_sales ON ss_customer_sk = c_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_net_paid) AS total_sales\nFROM customer\nJOIN customer_address ON c_current_addr_sk = ca_address_sk\nJOIN store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_sales_price) as total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_quantity) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state, \n    COUNT(ss_ticket_number) AS total_sales\nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nGROUP BY \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, COUNT(ss_ticket_number) AS total_purchases\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_purchases DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_net_profit) AS total_net_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_quantity) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c_first_name, \n    c_last_name, \n    ca_city, \n    ca_state, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer \nJOIN \n    customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk \nGROUP BY \n    c_first_name, c_last_name, ca_city, ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c_last_name, c_first_name, ca_city, ca_state, SUM(ss_net_paid) AS total_spent\nFROM customer\nJOIN customer_address ON c_current_addr_sk = ca_address_sk\nJOIN store_sales ON ss_customer_sk = c_customer_sk\nGROUP BY c_last_name, c_first_name, ca_city, ca_state\nORDER BY total_spent DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ws_ext_sales_price) AS total_sales\nFROM customer\nJOIN customer_address ON c_current_addr_sk = ca_address_sk\nJOIN web_sales ON ws_bill_customer_sk = c_customer_sk\nWHERE ca_state = 'CA'\nGROUP BY c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_quantity) AS total_quantity_sold\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_first_name, \n    c.c_last_name,\n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name || ' ' || c.c_last_name AS full_name,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    MAX(ws.ws_sold_date_sk) AS last_order_date,\n    MIN(ws.ws_sold_date_sk) AS first_order_date,\n    CASE \n        WHEN AVG(ws.ws_ext_sales_price) > 50 THEN 'High Value Customer'\n        WHEN AVG(ws.ws_ext_sales_price) BETWEEN 20 AND 50 THEN 'Medium Value Customer'\n        ELSE 'Low Value Customer'\n    END AS customer_value_category\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nHAVING \n    COUNT(DISTINCT ws.ws_order_number) > 5 \nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions, \n    d.d_year, \n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \n    AND d.d_month_seq IN (1, 2, 3)\n    AND c.c_preferred_cust_flag = 'Y'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year, \n    d.d_month_seq\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC, \n    c.c_last_name, \n    c.c_first_name;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    cd.cd_gender = 'F' \n    AND cd.cd_marital_status = 'M'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    ws.ws_sales_price,\n    ws.ws_quantity,\n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    d.d_date, \n    ws.ws_sales_price, \n    ws.ws_quantity\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_sold_date_sk, \n        ws_item_sk, \n        SUM(ws_quantity) AS total_quantity, \n        SUM(ws_sales_price) AS total_sales\n    FROM \n        web_sales\n    GROUP BY \n        ws_sold_date_sk, \n        ws_item_sk\n)\nSELECT \n    d.d_date AS sales_date, \n    i.i_item_id, \n    sd.total_quantity, \n    sd.total_sales\nFROM \n    SalesData sd\nJOIN \n    date_dim d ON sd.ws_sold_date_sk = d.d_date_sk\nJOIN \n    item i ON sd.ws_item_sk = i.i_item_sk\nWHERE \n    d.d_year = 2023\nORDER BY \n    sales_date, \n    total_quantity DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year, \n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year, \n    d.d_month_seq\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       c.c_first_name, \n       c.c_last_name, \n       ca.ca_city, \n       ca.ca_state, \n       SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nHAVING SUM(ws.ws_sales_price) > 1000\nORDER BY total_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    cd.cd_gender, \n    cd.cd_marital_status, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    cd.cd_gender = 'F' \n    AND cd.cd_marital_status = 'M' \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    cd.cd_gender, \n    cd.cd_marital_status \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    a.ca_city,\n    a.ca_state,\n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, a.ca_city, a.ca_state\nHAVING \n    SUM(ss.ss_net_paid) > 1000\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        ws.ws_item_sk\n)\nSELECT \n    i.i_item_id,\n    i.i_product_name,\n    sd.total_quantity,\n    sd.total_sales,\n    sd.total_profit\nFROM \n    sales_data sd\nJOIN \n    item i ON sd.ws_item_sk = i.i_item_sk\nORDER BY \n    sd.total_profit DESC\nLIMIT 10;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ss.ss_sales_price) AS total_sales,\n        COUNT(ss.ss_ticket_number) AS sales_count\n    FROM \n        customer c\n    JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\navg_sales AS (\n    SELECT \n        AVG(total_sales) AS avg_sales_per_customer,\n        AVG(sales_count) AS avg_sales_count_per_customer\n    FROM \n        customer_sales\n),\nhigh_sales_customers AS (\n    SELECT \n        c.c_customer_sk,\n        cs.total_sales\n    FROM \n        customer_sales cs\n    JOIN \n        customer c ON cs.c_customer_sk = c.c_customer_sk\n    WHERE \n        cs.total_sales > (SELECT avg_sales_per_customer FROM avg_sales)\n)\n\nSELECT \n    h.c_customer_sk,\n    h.total_sales,\n    a.avg_sales_per_customer,\n    a.avg_sales_count_per_customer\nFROM \n    high_sales_customers h,\n    avg_sales a;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'NY'\nGROUP BY \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nHAVING \n    SUM(ws.ws_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    c.c_email_address,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name, c.c_email_address, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ca.ca_state = 'CA'\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH sales_data AS (\n    SELECT \n        cs.cs_item_sk,\n        SUM(cs.cs_quantity) AS total_quantity,\n        SUM(cs.cs_net_paid) AS total_net_paid\n    FROM \n        catalog_sales cs\n    INNER JOIN \n        date_dim d ON cs.cs_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        cs.cs_item_sk\n), inventory_data AS (\n    SELECT \n        inv.inv_item_sk,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory\n    FROM \n        inventory inv\n    GROUP BY \n        inv.inv_item_sk\n)\nSELECT \n    s.cs_item_sk,\n    s.total_quantity,\n    s.total_net_paid,\n    i.total_inventory\nFROM \n    sales_data s\nLEFT JOIN \n    inventory_data i ON s.cs_item_sk = i.inv_item_sk\nORDER BY \n    s.total_net_paid DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        web_sales AS ws\n    JOIN \n        date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        ws.ws_item_sk\n)\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    sd.total_quantity,\n    sd.total_sales,\n    sd.total_profit\nFROM \n    item AS i\nJOIN \n    sales_data AS sd ON i.i_item_sk = sd.ws_item_sk\nORDER BY \n    sd.total_profit DESC\nLIMIT 10;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ss.ss_sales_price) AS total_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\n    FROM \n        customer c\n    JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.total_sales,\n    cs.total_transactions,\n    cd.cd_gender,\n    cd.cd_marital_status\nFROM \n    customer_sales cs\nJOIN \n    customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\nWHERE \n    cs.total_sales > 5000\nORDER BY \n    cs.total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_sk, \n       c.c_first_name, \n       c.c_last_name, \n       ca.ca_city, \n       ca.ca_state, \n       SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    dd.d_year, \n    dd.d_month_seq\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, dd.d_year, dd.d_month_seq\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_year,\n    d.d_month_seq\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales,\n    d.d_year,\n    d.d_month_seq\nFROM\n    customer c\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023 AND\n    ws.ws_sales_price > 100\nGROUP BY\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_year,\n    d.d_month_seq\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH SalesData AS (\n    SELECT\n        ss.ss_item_sk,\n        SUM(ss.ss_quantity) AS total_quantity,\n        SUM(ss.ss_sales_price) AS total_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\n    FROM\n        store_sales ss\n    JOIN\n        date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\n    WHERE\n        dd.d_year = 2023\n    GROUP BY\n        ss.ss_item_sk\n)\nSELECT\n    item.i_item_id,\n    item.i_item_desc,\n    sales.total_quantity,\n    sales.total_sales,\n    sales.total_transactions\nFROM\n    SalesData sales\nJOIN\n    item ON sales.ss_item_sk = item.i_item_sk\nORDER BY\n    sales.total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions \nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state IN ('NY', 'CA')\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year, d.d_month_seq\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ca.ca_state = 'CA'\nGROUP BY\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_spent\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state IN ('CA', 'NY')\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    COUNT(ws.ws_order_number) AS total_orders, \n    SUM(ws.ws_net_paid) AS total_spent\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state \nORDER BY \n    total_spent DESC \nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, \n       c.c_first_name, \n       c.c_last_name, \n       ca.ca_city, \n       ca.ca_state, \n       sum(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE ca.ca_state = 'CA'\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year, d.d_month_seq\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_sales_price) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_quantity) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_quantity) AS total_quantity_sold \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state \nORDER BY \n    total_quantity_sold DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    a.ca_city,\n    a.ca_state,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, a.ca_city, a.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, SUM(ss_sales_price) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_sk, c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_quantity) AS total_quantity_sold\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, COUNT(ss.ss_ticket_number) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    COUNT(sr.sr_ticket_number) AS returns_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nLEFT JOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    returns_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, ca_state, COUNT(ss_ticket_number) AS total_sales\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_sk, c_first_name, c_last_name, ca_city, ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nWITH Ranked_Customers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        c.c_email_address,\n        SUBSTRING(c.c_email_address, POSITION('@' IN c.c_email_address) + 1, LENGTH(c.c_email_address) - POSITION('@' IN c.c_email_address)) AS domain,\n        COUNT(ss.ss_item_sk) AS purchase_count\n    FROM \n        customer c\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, c.c_email_address\n),\nTop_Domains AS (\n    SELECT \n        domain,\n        COUNT(*) AS domain_count\n    FROM \n        Ranked_Customers\n    GROUP BY \n        domain\n    ORDER BY \n        domain_count DESC\n    LIMIT 10\n)\nSELECT \n    rd.c_first_name,\n    rd.c_last_name,\n    rd.domain,\n    td.domain_count\nFROM \n    Ranked_Customers rd\nJOIN \n    Top_Domains td ON rd.domain = td.domain\nORDER BY \n    td.domain_count DESC, rd.c_last_name ASC;\n",
  "\nSELECT \n    c.c_first_name || ' ' || c.c_last_name AS full_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS num_orders,\n    AVG((ws.ws_ext_sales_price - ws.ws_ext_discount_amt) / NULLIF(ws.ws_ext_sales_price, 0)) * 100 AS avg_discount_percentage,\n    COALESCE(SUBSTRING(UPPER(ca.ca_street_name), 1, 15), 'UNKNOWN') AS street_name_segment\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE ca.ca_state IN ('CA', 'TX')\nGROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, ca.ca_street_name\nHAVING SUM(ws.ws_ext_sales_price) > 1000\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    d.d_year,\n    d.d_month_seq,\n    d.d_day_name\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\n    AND d.d_month_seq IN (10, 11)\n    AND c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year, d.d_month_seq, d.d_day_name\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC, c.c_last_name ASC, c.c_first_name ASC\nLIMIT 50;\n",
  "\nWITH customer_returns AS (\n    SELECT \n        wr_returning_customer_sk AS customer_sk,\n        SUM(wr_return_quantity) AS total_returned,\n        SUM(wr_return_amt_inc_tax) AS total_returned_amount\n    FROM \n        web_returns\n    GROUP BY \n        wr_returning_customer_sk\n),\ndemographics AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        cd.cd_dep_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nreturns_summary AS (\n    SELECT \n        d.c_customer_sk AS customer_sk,\n        d.c_first_name,\n        d.c_last_name,\n        d.cd_gender,\n        d.cd_marital_status,\n        d.cd_education_status,\n        d.cd_purchase_estimate,\n        d.cd_credit_rating,\n        d.cd_dep_count,\n        COALESCE(c.total_returned, 0) AS total_returned,\n        COALESCE(c.total_returned_amount, 0) AS total_returned_amount\n    FROM \n        demographics d\n    LEFT JOIN \n        customer_returns c ON d.c_customer_sk = c.customer_sk\n)\nSELECT \n    rs.*,\n    CASE \n        WHEN rs.total_returned > 10 THEN 'High Returner'\n        WHEN rs.total_returned > 0 THEN 'Low Returner'\n        ELSE 'No Returner'\n    END AS return_category\nFROM \n    returns_summary rs\nWHERE \n    rs.cd_gender = 'F' \n    AND rs.cd_marital_status = 'S' \n    AND rs.total_returned_amount > 100\nORDER BY \n    rs.total_returned_amount DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    c.c_birth_country,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    SUM(ss.ss_sales_price) AS total_sales,\n    SUM(ss.ss_quantity) AS total_quantity\nFROM \n    customer c\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    c.c_birth_country = 'USA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, c.c_birth_country, cd.cd_gender, cd.cd_marital_status\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year,\n    d.d_month_seq,\n    d.d_week_seq\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name,\n    d.d_year,\n    d.d_month_seq,\n    d.d_week_seq\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nhigh_value_customers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_sales,\n        cs.order_count,\n        CASE \n            WHEN cs.total_sales IS NULL THEN 'No Sales'\n            WHEN cs.total_sales > 10000 THEN 'High Value'\n            ELSE 'Standard Value'\n        END AS customer_value\n    FROM \n        customer_sales cs\n),\ncustomer_addresses AS (\n    SELECT \n        ca.ca_address_sk,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_country\n    FROM \n        customer_address ca\n    WHERE \n        ca.ca_state IN ('CA', 'TX', 'NY')\n)\nSELECT \n    hvc.c_customer_sk,\n    hvc.total_sales,\n    hvc.order_count,\n    hvc.customer_value,\n    ca.ca_city,\n    ca.ca_state,\n    ca.ca_country\nFROM \n    high_value_customers hvc\nLEFT JOIN \n    customer_addresses ca ON hvc.c_customer_sk = ca.ca_address_sk  \nWHERE \n    hvc.total_sales > 2000\nORDER BY \n    hvc.total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt_inc_tax) AS total_returned_amt,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk AS customer_sk,\n        COUNT(ws_order_number) AS total_orders,\n        SUM(ws_net_profit) AS total_profit,\n        AVG(ws_net_paid) AS avg_order_value\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nHighValueCustomers AS (\n    SELECT \n        cs.customer_sk,\n        cs.total_orders,\n        cs.total_profit,\n        cs.avg_order_value,\n        COALESCE(cr.total_returned_quantity, 0) AS total_returned_quantity,\n        COALESCE(cr.total_returned_amt, 0) AS total_returned_amt\n    FROM \n        SalesSummary cs\n    LEFT JOIN \n        CustomerReturns cr ON cs.customer_sk = cr.sr_customer_sk\n    WHERE \n        cs.total_orders > 5 \n        AND cs.total_profit > 1000\n)\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    hvc.total_orders,\n    hvc.total_profit,\n    hvc.avg_order_value,\n    hvc.total_returned_quantity,\n    hvc.total_returned_amt,\n    CASE \n        WHEN hvc.total_returned_quantity > 0 THEN 'Yes' \n        ELSE 'No' \n    END AS has_returns\nFROM \n    customer c\nJOIN \n    HighValueCustomers hvc ON c.c_customer_sk = hvc.customer_sk\nORDER BY \n    hvc.total_profit DESC,\n    hvc.total_orders DESC\nLIMIT 100;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_sales_price) AS total_sales,\n        COUNT(ws_order_number) AS total_orders\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n),\ncustomer_data AS (\n    SELECT \n        c_customer_sk,\n        COUNT(DISTINCT cd_demo_sk) AS demo_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer\n    JOIN \n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY \n        c_customer_sk\n)\nSELECT \n    sd.ws_item_sk,\n    sd.total_sales,\n    sd.total_orders,\n    cd.demo_count,\n    cd.avg_purchase_estimate\nFROM \n    sales_data sd\nJOIN \n    customer_data cd ON sd.ws_item_sk = cd.c_customer_sk\nORDER BY \n    sd.total_sales DESC\nLIMIT 100;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(COALESCE(ss.ss_net_paid, 0)) AS total_spent\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    cs.cd_gender,\n    cs.cd_marital_status,\n    COUNT(cs.c_customer_id) AS customer_count,\n    AVG(cs.total_spent) AS avg_spent\nFROM \n    customer_summary cs\nGROUP BY \n    cs.cd_gender, cs.cd_marital_status\nORDER BY \n    cs.cd_gender, cs.cd_marital_status;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \n    GROUP BY \n        c.c_customer_sk\n),\ncustomer_demographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        customer_demographics cd\n)\nSELECT \n    cs.c_customer_sk,\n    cs.total_sales,\n    cs.total_orders,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status\nFROM \n    customer_sales cs\nJOIN \n    customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\nWHERE \n    cs.total_sales > 1000\nORDER BY \n    cs.total_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "WITH SalesData AS (\n    SELECT\n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_net_paid_inc_tax) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM\n        web_sales\n    WHERE\n        ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2000) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2000)\n    GROUP BY\n        ws_item_sk\n),\nCustomerSatisfaction AS (\n    SELECT\n        sr_item_sk,\n        AVG(sr_return_quantity) AS avg_return_rate\n    FROM\n        store_returns\n    GROUP BY\n        sr_item_sk\n)\nSELECT\n    i.i_item_id,\n    i.i_item_desc,\n    sd.total_quantity,\n    sd.total_sales,\n    COALESCE(cs.avg_return_rate, 0) AS avg_return_rate,\n    CASE \n        WHEN sd.total_sales > 5000 THEN 'High Performer'\n        WHEN sd.total_sales BETWEEN 1000 AND 5000 THEN 'Medium Performer'\n        ELSE 'Low Performer'\n    END AS performance_category\nFROM\n    item i\nLEFT JOIN\n    SalesData sd ON i.i_item_sk = sd.ws_item_sk\nLEFT JOIN\n    CustomerSatisfaction cs ON i.i_item_sk = cs.sr_item_sk\nWHERE\n    i.i_rec_start_date <= cast('2002-10-01' as date)\n    AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > cast('2002-10-01' as date))\n    AND i.i_current_price IS NOT NULL\nORDER BY\n    sd.total_sales DESC,\n    avg_return_rate ASC;",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_returned_date_sk,\n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_return_quantity,\n        SUM(sr_return_amt_inc_tax) AS total_return_amt\n    FROM \n        store_returns\n    GROUP BY \n        sr_returned_date_sk, sr_customer_sk\n),\nWebSalesSummary AS (\n    SELECT \n        ws_sold_date_sk, \n        ws_bill_customer_sk, \n        COUNT(ws_order_number) AS total_orders,\n        SUM(ws_ext_sales_price) AS total_sales\n    FROM \n        web_sales\n    GROUP BY \n        ws_sold_date_sk, ws_bill_customer_sk\n),\nDateRange AS (\n    SELECT \n        d_date_sk, \n        d_date\n    FROM \n        date_dim\n    WHERE \n        d_date BETWEEN '2023-01-01' AND '2023-12-31'\n),\nDetailedSummary AS (\n    SELECT \n        dr.d_date_sk,\n        dr.d_date,\n        COALESCE(cr.total_return_quantity, 0) AS total_return_quantity,\n        COALESCE(ws.total_orders, 0) AS total_orders,\n        COALESCE(ws.total_sales, 0) AS total_sales\n    FROM \n        DateRange dr\n    LEFT JOIN \n        CustomerReturns cr \n        ON dr.d_date_sk = cr.sr_returned_date_sk\n    LEFT JOIN \n        WebSalesSummary ws \n        ON dr.d_date_sk = ws.ws_sold_date_sk\n)\nSELECT \n    ds.d_date,\n    ds.total_orders,\n    ds.total_sales,\n    ds.total_return_quantity,\n    (ds.total_sales - ds.total_return_quantity) AS net_sales,\n    CASE \n        WHEN ds.total_orders = 0 THEN NULL\n        ELSE (ds.total_sales / NULLIF(ds.total_orders, 0))\n    END AS average_order_value\nFROM \n    DetailedSummary ds\nORDER BY \n    ds.d_date;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id, \n        cd.cd_gender, \n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count,\n        AVG(ws.ws_net_paid) AS avg_order_value\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender\n)\n\nSELECT \n    cs.c_customer_id, \n    cs.cd_gender,\n    cs.total_sales,\n    cs.order_count,\n    cs.avg_order_value,\n    CASE \n        WHEN cs.total_sales > 10000 THEN 'High Value'\n        WHEN cs.total_sales BETWEEN 5000 AND 10000 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_category\nFROM \n    CustomerSales cs\nWHERE \n    cs.order_count > 5\nORDER BY \n    cs.total_sales DESC\nLIMIT 50;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        cs_bill_customer_sk,\n        SUM(cs_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT cs_order_number) AS order_count\n    FROM \n        catalog_sales\n    WHERE \n        cs_sold_date_sk BETWEEN \n        (SELECT d_date_sk FROM date_dim WHERE d_year = 2022 AND d_month_seq = 12 LIMIT 1)\n        AND \n        (SELECT d_date_sk FROM date_dim WHERE d_year = 2022 AND d_month_seq = 12 LIMIT 1 OFFSET 1)\n    GROUP BY \n        cs_bill_customer_sk\n),\nTopCustomers AS (\n    SELECT \n        c.c_customer_id,\n        cs.total_sales,\n        cs.order_count,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        CustomerSales cs\n    JOIN \n        customer c ON cs.cs_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        cs.total_sales > (SELECT AVG(total_sales) FROM CustomerSales)\n)\nSELECT \n    tc.c_customer_id,\n    tc.total_sales,\n    tc.order_count,\n    tc.cd_gender,\n    tc.cd_marital_status,\n    tc.cd_education_status\nFROM \n    TopCustomers tc\nORDER BY \n    tc.total_sales DESC\nLIMIT 10;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n),\ncustomer_data AS (\n    SELECT \n        c_customer_sk,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_net_paid) AS total_spent\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_ship_customer_sk = c.c_customer_sk\n    GROUP BY \n        c_customer_sk\n)\nSELECT \n    sd.ws_item_sk,\n    sd.total_quantity,\n    sd.total_sales,\n    cd.total_orders,\n    cd.total_spent,\n    sd.total_profit\nFROM \n    sales_data sd\nJOIN \n    customer_data cd ON sd.ws_item_sk = cd.c_customer_sk\nORDER BY \n    sd.total_sales DESC\nLIMIT 100;\n",
  "WITH SalesData AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_paid) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2001 \n        AND dd.d_month_seq IN (5, 6) \n    GROUP BY \n        ws.ws_sold_date_sk, ws.ws_item_sk\n)\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    SUM(sd.total_quantity) AS total_quantity,\n    SUM(sd.total_sales) AS total_sales,\n    AVG(sd.total_quantity) AS avg_quantity_per_order,\n    AVG(sd.total_sales) AS avg_sales_per_order\nFROM \n    SalesData sd\nJOIN \n    item i ON sd.ws_item_sk = i.i_item_sk\nGROUP BY \n    i.i_item_id, i.i_item_desc\nORDER BY \n    total_sales DESC\nLIMIT 10;",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        ws.ws_item_sk\n), ItemDetails AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_id,\n        i.i_product_name,\n        i.i_brand,\n        i.i_category\n    FROM \n        item i\n), CombinedData AS (\n    SELECT \n        id.i_item_id,\n        id.i_product_name,\n        id.i_brand,\n        id.i_category,\n        sd.total_quantity,\n        sd.total_sales,\n        sd.total_discount,\n        (sd.total_sales - sd.total_discount) AS net_sales\n    FROM \n        ItemDetails id\n    LEFT JOIN \n        SalesData sd ON id.i_item_sk = sd.ws_item_sk\n)\nSELECT \n    cd.i_brand,\n    cd.i_category,\n    COUNT(cd.i_item_id) AS total_items,\n    SUM(cd.total_quantity) AS grand_total_quantity,\n    SUM(cd.net_sales) AS grand_total_sales\nFROM \n    CombinedData cd\nGROUP BY \n    cd.i_brand,\n    cd.i_category\nORDER BY \n    grand_total_sales DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, cd.cd_gender, cd.cd_marital_status\n),\nSalesByGender AS (\n    SELECT \n        cd_gender,\n        AVG(total_sales) AS avg_sales,\n        SUM(total_orders) AS total_orders\n    FROM \n        CustomerSales\n    GROUP BY \n        cd_gender\n)\nSELECT \n    s.cd_gender,\n    s.avg_sales,\n    s.total_orders,\n    CASE \n        WHEN s.avg_sales > 1000 THEN 'High Value'\n        WHEN s.avg_sales BETWEEN 500 AND 1000 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_category\nFROM \n    SalesByGender s\nORDER BY \n    avg_sales DESC;\n",
  "\nWITH ReturnedItems AS (\n    SELECT \n        wr_item_sk,\n        SUM(wr_return_quantity) AS total_returned_qty,\n        SUM(wr_return_amt_inc_tax) AS total_returned_amt\n    FROM \n        web_returns\n    GROUP BY \n        wr_item_sk\n),\nSalesStats AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_sold_qty,\n        SUM(ws_sales_price) AS total_sold_amt\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n),\nSummary AS (\n    SELECT \n        i.i_item_id,\n        i.i_item_desc,\n        COALESCE(ss.total_sold_qty, 0) AS sold_qty,\n        COALESCE(ss.total_sold_amt, 0) AS sold_amt,\n        COALESCE(ri.total_returned_qty, 0) AS returned_qty,\n        COALESCE(ri.total_returned_amt, 0) AS returned_amt,\n        (COALESCE(ss.total_sold_amt, 0) - COALESCE(ri.total_returned_amt, 0)) AS net_revenue\n    FROM \n        item i\n    LEFT JOIN \n        SalesStats ss ON i.i_item_sk = ss.ws_item_sk\n    LEFT JOIN \n        ReturnedItems ri ON i.i_item_sk = ri.wr_item_sk\n    WHERE \n        i.i_current_price > 20.00 AND \n        i.i_category = 'Electronics'\n)\nSELECT \n    s.i_item_id,\n    s.i_item_desc,\n    s.sold_qty,\n    s.sold_amt,\n    s.returned_qty,\n    s.returned_amt,\n    s.net_revenue\nFROM \n    Summary s\nWHERE \n    s.net_revenue > 0\nORDER BY \n    s.net_revenue DESC\nLIMIT 100;\n",
  "\nWITH Customer_Sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        AVG(ws.ws_net_paid_inc_tax) AS avg_spent\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    WHERE \n        ws.ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022)\n    GROUP BY \n        c.c_customer_sk\n),\nCustomer_Demo AS (\n    SELECT \n        cd.cd_demo_sk, \n        cd.cd_gender AS gender, \n        cd.cd_marital_status AS marital_status, \n        cd.cd_education_status\n    FROM \n        customer_demographics cd\n)\nSELECT \n    cd.gender,\n    cd.marital_status,\n    COUNT(cs.c_customer_sk) AS customer_count,\n    AVG(cs.order_count) AS avg_orders,\n    AVG(cs.total_net_profit) AS avg_net_profit,\n    AVG(cs.avg_spent) AS avg_spent\nFROM \n    Customer_Sales cs\nJOIN \n    Customer_Demo cd ON cs.c_customer_sk = cd.cd_demo_sk\nGROUP BY \n    cd.gender, cd.marital_status\nORDER BY \n    customer_count DESC, avg_net_profit DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT\n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM\n        customer c\n    JOIN\n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    WHERE\n        c.c_current_cdemo_sk IN (\n            SELECT cd_demo_sk \n            FROM customer_demographics \n            WHERE cd_gender = 'F' AND cd_marital_status = 'M'\n        )\n    GROUP BY\n        c.c_customer_sk\n),\nSalesSummary AS (\n    SELECT\n        CASE\n            WHEN total_sales < 100 THEN 'Low Value'\n            WHEN total_sales >= 100 AND total_sales < 500 THEN 'Medium Value'\n            ELSE 'High Value'\n        END AS customer_value,\n        COUNT(*) AS customer_count,\n        AVG(order_count) AS avg_orders\n    FROM\n        CustomerSales\n    GROUP BY\n        CASE\n            WHEN total_sales < 100 THEN 'Low Value'\n            WHEN total_sales >= 100 AND total_sales < 500 THEN 'Medium Value'\n            ELSE 'High Value'\n        END\n)\nSELECT\n    s.customer_value,\n    s.customer_count,\n    s.avg_orders,\n    COUNT(DISTINCT cs.c_customer_sk) AS active_customers\nFROM\n    SalesSummary s\nJOIN\n    CustomerSales cs ON s.customer_value = \n        CASE \n            WHEN cs.total_sales < 100 THEN 'Low Value'\n            WHEN cs.total_sales >= 100 AND cs.total_sales < 500 THEN 'Medium Value'\n            ELSE 'High Value'\n        END\nGROUP BY\n    s.customer_value, s.customer_count, s.avg_orders\nORDER BY\n    s.customer_value;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_return_quantity,\n        SUM(sr_return_amt) AS total_return_amount,\n        SUM(sr_return_tax) AS total_return_tax,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM \n        store_returns\n    WHERE \n        sr_returned_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        sr_customer_sk\n),\nWebSales AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_quantity) AS total_web_sales_quantity,\n        SUM(ws_ext_sales_price) AS total_web_sales_amount\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_bill_customer_sk\n),\nSalesComparison AS (\n    SELECT \n        cr.sr_customer_sk,\n        cr.total_return_quantity,\n        cr.total_return_amount,\n        cr.return_count,\n        ws.total_web_sales_quantity,\n        ws.total_web_sales_amount\n    FROM \n        CustomerReturns cr\n    LEFT JOIN \n        WebSales ws ON cr.sr_customer_sk = ws.ws_bill_customer_sk\n)\nSELECT \n    c.c_customer_id,\n    COALESCE(sc.total_return_amount, 0) AS total_return_amount,\n    COALESCE(sc.total_web_sales_amount, 0) AS total_web_sales_amount,\n    (COALESCE(sc.total_web_sales_amount, 0) - COALESCE(sc.total_return_amount, 0)) AS net_sales,\n    sc.return_count\nFROM \n    SalesComparison sc\nJOIN \n    customer c ON sc.sr_customer_sk = c.c_customer_sk\nWHERE \n    sc.return_count > 0\nORDER BY \n    net_sales DESC\nLIMIT 10;\n",
  "\nWITH Total_Sales AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS order_count,\n        SUM(ws_coupon_amt) AS total_coupons,\n        AVG(ws_net_profit) AS avg_net_profit\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023 AND d_month_seq = 12 LIMIT 1)\n        AND (SELECT d_date_sk FROM date_dim WHERE d_year = 2023 AND d_month_seq = 12 LIMIT 1) + 30\n    GROUP BY \n        ws_bill_customer_sk\n),\nCustomer_Details AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        t.total_sales,\n        t.order_count,\n        t.total_coupons,\n        t.avg_net_profit\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        Total_Sales t ON c.c_customer_sk = t.ws_bill_customer_sk\n)\nSELECT \n    cd.c_customer_id,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    cd.total_sales,\n    cd.order_count,\n    cd.total_coupons,\n    cd.avg_net_profit\nFROM \n    Customer_Details cd\nWHERE \n    cd.total_sales > 5000\nORDER BY \n    cd.avg_net_profit DESC\nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        wr_returning_customer_sk,\n        SUM(wr_return_quantity) AS total_returned_quantity,\n        SUM(wr_return_amt_inc_tax) AS total_returned_amt\n    FROM web_returns\n    GROUP BY wr_returning_customer_sk\n),\nStoreReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt_inc_tax) AS total_returned_amt\n    FROM store_returns\n    GROUP BY sr_customer_sk\n),\nReturnComparison AS (\n    SELECT \n        coalesce(cr.wr_returning_customer_sk, sr.sr_customer_sk) AS customer_sk,\n        COALESCE(cr.total_returned_quantity, 0) AS web_return_qty,\n        COALESCE(sr.total_returned_quantity, 0) AS store_return_qty,\n        COALESCE(cr.total_returned_amt, 0) AS web_return_amt,\n        COALESCE(sr.total_returned_amt, 0) AS store_return_amt\n    FROM CustomerReturns cr\n    FULL OUTER JOIN StoreReturns sr ON cr.wr_returning_customer_sk = sr.sr_customer_sk\n),\nHighValueCustomers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        r.web_return_qty,\n        r.store_return_qty,\n        r.web_return_amt,\n        r.store_return_amt,\n        (r.web_return_amt + r.store_return_amt) AS total_return_amt\n    FROM ReturnComparison r\n    JOIN customer c ON c.c_customer_sk = r.customer_sk\n    WHERE r.web_return_amt + r.store_return_amt > 500\n)\n\nSELECT \n    hvc.c_customer_sk,\n    hvc.c_first_name,\n    hvc.c_last_name,\n    hvc.web_return_qty,\n    hvc.store_return_qty,\n    hvc.total_return_amt,\n    CASE \n        WHEN hvc.web_return_qty > hvc.store_return_qty THEN 'More returns from web'\n        WHEN hvc.web_return_qty < hvc.store_return_qty THEN 'More returns from store'\n        ELSE 'Equal returns'\n    END AS return_type\nFROM HighValueCustomers hvc\nORDER BY hvc.total_return_amt DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_credit_rating,\n        cd.cd_dep_count,\n        cd.cd_purchase_estimate\n    FROM \n        customer_demographics cd\n)\nSELECT \n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_sales,\n    d.cd_gender,\n    d.cd_marital_status,\n    d.cd_education_status\nFROM \n    CustomerSales cs\nJOIN \n    Demographics d ON cs.c_customer_sk = d.cd_demo_sk\nWHERE \n    cs.total_sales > (\n        SELECT AVG(total_sales) \n        FROM CustomerSales\n    )\nORDER BY \n    cs.total_sales DESC\nLIMIT 10;\n\n",
  "WITH Address_Stats AS (\n    SELECT \n        ca_state, \n        COUNT(DISTINCT ca_address_id) AS unique_address_count, \n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomer_Stats AS (\n    SELECT \n        cd_gender, \n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        COUNT(DISTINCT c_customer_id) AS customer_count\n    FROM \n        customer\n    JOIN \n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY \n        cd_gender\n),\nCombined_Stats AS (\n    SELECT \n        a.ca_state,\n        a.unique_address_count,\n        a.max_street_name_length,\n        a.min_street_name_length,\n        a.avg_street_name_length,\n        c.cd_gender,\n        c.avg_purchase_estimate,\n        c.customer_count\n    FROM \n        Address_Stats a\n    JOIN \n        Customer_Stats c ON a.ca_state = c.cd_gender \n)\nSELECT \n    ca_state,\n    SUM(unique_address_count) AS total_unique_addresses,\n    AVG(max_street_name_length) AS average_max_street_length,\n    AVG(min_street_name_length) AS average_min_street_length,\n    AVG(avg_street_name_length) AS average_avg_street_length,\n    SUM(customer_count) AS total_customers,\n    COUNT(cd_gender) AS gender_groups\nFROM \n    Combined_Stats\nGROUP BY \n    ca_state\nHAVING \n    COUNT(DISTINCT cd_gender) > 1\nORDER BY \n    total_unique_addresses DESC;",
  "\nWITH ReturnStats AS (\n    SELECT\n        sr_returned_date_sk,\n        COUNT(*) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amt,\n        SUM(sr_return_tax) AS total_return_tax,\n        SUM(sr_return_quantity) AS total_return_quantity,\n        SUM(sr_item_sk) AS total_items_returned\n    FROM store_returns\n    GROUP BY sr_returned_date_sk\n), \nSalesStats AS (\n    SELECT\n        ws_sold_date_sk,\n        SUM(ws_sales_price) AS total_sales,\n        COUNT(ws_order_number) AS total_orders,\n        SUM(ws_quantity) AS total_units_sold\n    FROM web_sales\n    GROUP BY ws_sold_date_sk\n), \nCombinedStats AS (\n    SELECT\n        dd.d_date AS sales_date,\n        COALESCE(rs.total_returns, 0) AS total_returns,\n        COALESCE(rs.total_return_amt, 0) AS total_return_amt,\n        COALESCE(rs.total_return_tax, 0) AS total_return_tax,\n        COALESCE(ss.total_sales, 0) AS total_sales,\n        COALESCE(ss.total_orders, 0) AS total_orders,\n        COALESCE(ss.total_units_sold, 0) AS total_units_sold\n    FROM date_dim dd\n    LEFT JOIN ReturnStats rs ON dd.d_date_sk = rs.sr_returned_date_sk\n    LEFT JOIN SalesStats ss ON dd.d_date_sk = ss.ws_sold_date_sk\n    WHERE dd.d_date BETWEEN '2023-01-01' AND '2023-12-31'\n)\nSELECT\n    sales_date,\n    total_returns,\n    total_return_amt,\n    total_return_tax,\n    total_sales,\n    total_orders,\n    total_units_sold,\n    (total_sales - total_return_amt) AS net_sales,\n    (CASE WHEN total_orders > 0 THEN total_sales / total_orders ELSE NULL END) AS avg_order_value,\n    (CASE WHEN total_units_sold > 0 THEN total_units_sold / NULLIF(total_orders, 0) ELSE NULL END) AS avg_units_per_order\nFROM CombinedStats\nORDER BY sales_date;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022) AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_bill_customer_sk\n),\nDemographics AS (\n    SELECT \n        c_customer_sk,\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_purchase_estimate\n    FROM \n        customer\n    JOIN \n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n),\nCombinedData AS (\n    SELECT \n        d.c_customer_sk AS ws_bill_customer_sk,\n        d.cd_gender,\n        d.cd_marital_status,\n        d.cd_education_status,\n        d.cd_purchase_estimate,\n        s.total_sales,\n        s.total_orders\n    FROM \n        SalesData s\n    LEFT JOIN \n        Demographics d ON s.ws_bill_customer_sk = d.c_customer_sk\n)\nSELECT \n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    COUNT(*) AS num_customers,\n    SUM(total_sales) AS total_sales_amount,\n    AVG(total_orders) AS avg_orders\nFROM \n    CombinedData\nGROUP BY \n    cd_gender,\n    cd_marital_status,\n    cd_education_status\nORDER BY \n    total_sales_amount DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amount,\n        SUM(sr_return_quantity) AS total_return_quantity\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n), \nSalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nCombinedData AS (\n    SELECT \n        cd.cd_demo_sk,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        COALESCE(sd.total_sales, 0) AS total_sales\n    FROM \n        customer_demographics cd\n    LEFT JOIN \n        CustomerReturns cr ON cd.cd_demo_sk = cr.sr_customer_sk\n    LEFT JOIN \n        SalesData sd ON cd.cd_demo_sk = sd.ws_bill_customer_sk\n)\nSELECT \n    cd.cd_demo_sk,\n    SUM(cd.total_returns) AS total_returns,\n    SUM(cd.total_return_amount) AS total_return_amount,\n    SUM(cd.total_sales) AS total_sales,\n    AVG(cd.total_sales) / NULLIF(SUM(cd.total_returns), 0) AS avg_sales_per_return\nFROM \n    CombinedData cd\nGROUP BY \n    cd.cd_demo_sk\nHAVING \n    SUM(cd.total_sales) > 0\nORDER BY \n    avg_sales_per_return DESC\nLIMIT 10;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        wr_returning_customer_sk AS customer_sk,\n        SUM(wr_return_quantity) AS total_returned_items,\n        SUM(wr_return_amt) AS total_return_amount,\n        COUNT(DISTINCT wr_order_number) AS return_count\n    FROM \n        web_returns\n    GROUP BY \n        wr_returning_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nReturnStatistics AS (\n    SELECT \n        cd.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(CASE WHEN cr.return_count > 1 THEN 1 END) AS repeat_returns,\n        AVG(cr.total_return_amount) AS avg_return_amount,\n        SUM(cr.total_returned_items) AS total_returned\n    FROM \n        CustomerDemographics cd\n    LEFT JOIN \n        CustomerReturns cr ON cd.c_customer_sk = cr.customer_sk\n    GROUP BY \n        cd.c_customer_sk, cd.cd_gender, cd.cd_marital_status\n),\nTopReturners AS (\n    SELECT \n        r.cd_gender,\n        r.cd_marital_status,\n        COUNT(*) AS customer_count,\n        SUM(r.total_returned) AS total_items_returned\n    FROM \n        ReturnStatistics r\n    GROUP BY \n        r.cd_gender, r.cd_marital_status\n    ORDER BY \n        total_items_returned DESC\n)\nSELECT \n    t.cd_gender,\n    t.cd_marital_status,\n    t.customer_count,\n    t.total_items_returned\nFROM \n    TopReturners t\nWHERE \n    t.customer_count > 10\nORDER BY \n    t.total_items_returned DESC;\n",
  "\nWITH ItemSales AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_ext_sales_price) AS total_sales\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n), StoreSales AS (\n    SELECT \n        ss_item_sk,\n        SUM(ss_quantity) AS total_quantity,\n        SUM(ss_ext_sales_price) AS total_sales\n    FROM \n        store_sales\n    GROUP BY \n        ss_item_sk\n), TotalSales AS (\n    SELECT \n        item.i_item_id,\n        COALESCE(web.total_quantity, 0) AS web_quantity,\n        COALESCE(store.total_quantity, 0) AS store_quantity,\n        (COALESCE(web.total_sales, 0) + COALESCE(store.total_sales, 0)) AS total_sales\n    FROM \n        item AS item\n    LEFT JOIN \n        ItemSales AS web ON item.i_item_sk = web.ws_item_sk\n    LEFT JOIN \n        StoreSales AS store ON item.i_item_sk = store.ss_item_sk\n)\nSELECT \n    t.i_item_id,\n    t.web_quantity,\n    t.store_quantity,\n    t.total_sales,\n    CASE \n        WHEN t.total_sales >= 1000 THEN 'High Volume'\n        WHEN t.total_sales >= 500 THEN 'Medium Volume'\n        ELSE 'Low Volume'\n    END AS sales_category\nFROM \n    TotalSales t\nORDER BY \n    t.total_sales DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        cr_returning_customer_sk,\n        SUM(cr_return_quantity) AS total_returned_quantity,\n        SUM(cr_return_amount) AS total_returned_amount,\n        SUM(cr_return_tax) AS total_returned_tax\n    FROM \n        catalog_returns\n    GROUP BY \n        cr_returning_customer_sk\n),\nWebSalesSummary AS (\n    SELECT \n        ws_ship_customer_sk,\n        SUM(ws_net_profit) AS total_net_profit,\n        COUNT(ws_order_number) AS total_orders,\n        AVG(ws_net_paid) AS avg_net_paid\n    FROM \n        web_sales\n    GROUP BY \n        ws_ship_customer_sk\n),\nCombinedMetrics AS (\n    SELECT \n        c.c_customer_id,\n        coalesce(cr.total_returned_quantity, 0) AS total_returned_quantity,\n        coalesce(cr.total_returned_amount, 0) AS total_returned_amount,\n        coalesce(cr.total_returned_tax, 0) AS total_returned_tax,\n        ws.total_net_profit,\n        ws.total_orders,\n        ws.avg_net_paid\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\n    LEFT JOIN \n        WebSalesSummary ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n)\nSELECT \n    *,\n    CASE \n        WHEN total_orders > 0 THEN total_net_profit / NULLIF(total_orders, 0)\n        ELSE 0\n    END AS avg_profit_per_order,\n    CASE \n        WHEN total_returned_quantity > 0 THEN total_returned_amount / NULLIF(total_returned_quantity, 0)\n        ELSE 0\n    END AS avg_return_amount_per_item\nFROM \n    CombinedMetrics\nWHERE \n    (total_returned_quantity > 5 OR total_net_profit > 1000.00)\nORDER BY \n    total_net_profit DESC, c_customer_id\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        COUNT(ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        AVG(ws.ws_net_profit) AS avg_profit\n    FROM\n        customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name\n),\nHighValueCustomers AS (\n    SELECT \n        c.c_customer_id,\n        cs.total_orders,\n        cs.total_sales,\n        cs.avg_profit,\n        CASE \n            WHEN cs.total_sales > 10000 THEN 'High Value'\n            ELSE 'Regular'\n        END AS customer_type\n    FROM \n        CustomerSales cs\n    JOIN customer c ON cs.c_customer_id = c.c_customer_id\n    WHERE cs.total_orders > 5\n)\nSELECT \n    hvc.customer_type, \n    hvc.total_orders,\n    hvc.total_sales,\n    hvc.avg_profit,\n    COUNT(hvc.c_customer_id) AS number_of_customers\nFROM \n    HighValueCustomers hvc\nGROUP BY \n    hvc.customer_type, hvc.total_orders, hvc.total_sales, hvc.avg_profit\nORDER BY \n    hvc.total_sales DESC;\n",
  "\nWITH AddressParts AS (\n    SELECT \n        ca_address_sk, \n        TRIM(ca_street_number || ' ' || ca_street_name || ' ' || ca_street_type || CASE WHEN ca_suite_number IS NOT NULL THEN ' Suite ' || ca_suite_number ELSE '' END) AS Full_Address,\n        ca_city,\n        ca_state,\n        ca_zip,\n        ca_country\n    FROM customer_address\n), Demographics AS (\n    SELECT \n        cd_demo_sk,\n        cd_gender,\n        cd_marital_status,\n        TRIM(cd_education_status) AS Education_Status,\n        cd_purchase_estimate,\n        cd_credit_rating,\n        cd_dep_count,\n        cd_dep_employed_count,\n        cd_dep_college_count\n    FROM customer_demographics\n), AggregatedSales AS (\n    SELECT \n        ws_bill_cdemo_sk,\n        COUNT(*) AS Total_Sales,\n        SUM(ws_sales_price) AS Total_Sales_Value,\n        AVG(ws_sales_price) AS Average_Sale_Value\n    FROM web_sales\n    GROUP BY ws_bill_cdemo_sk\n)\nSELECT \n    a.Full_Address,\n    a.ca_city,\n    a.ca_state,\n    a.ca_zip,\n    a.ca_country,\n    d.cd_gender,\n    d.Education_Status,\n    d.cd_purchase_estimate,\n    d.cd_credit_rating,\n    COALESCE(s.Total_Sales, 0) AS Total_Sales,\n    COALESCE(s.Total_Sales_Value, 0) AS Total_Sales_Value,\n    COALESCE(s.Average_Sale_Value, 0) AS Average_Sale_Value\nFROM AddressParts AS a\nJOIN Demographics AS d ON a.ca_address_sk = d.cd_demo_sk\nLEFT JOIN AggregatedSales AS s ON d.cd_demo_sk = s.ws_bill_cdemo_sk\nWHERE a.ca_city LIKE 'San%' \nAND a.ca_state = 'CA' \nAND d.cd_marital_status = 'M'\nORDER BY Total_Sales_Value DESC\nLIMIT 100;\n",
  "\nWITH AddressAnalysis AS (\n    SELECT \n        ca_city,\n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_city, ca_state\n),\nCustomerDemographics AS (\n    SELECT \n        cd_gender,\n        COUNT(c_customer_sk) AS customer_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n        JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_gender\n)\nSELECT \n    a.ca_city,\n    a.ca_state,\n    a.unique_addresses,\n    a.max_street_name_length,\n    a.min_street_name_length,\n    a.avg_street_name_length,\n    c.cd_gender,\n    c.customer_count,\n    c.avg_purchase_estimate\nFROM \n    AddressAnalysis a\nJOIN \n    CustomerDemographics c ON a.ca_state = 'CA'\nORDER BY \n    a.unique_addresses DESC, \n    c.customer_count DESC;\n",
  "\nWITH AddressStats AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        SUM(CASE WHEN ca_city LIKE '%ville%' THEN 1 ELSE 0 END) AS count_ville_cities\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomerStats AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_id) AS customer_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependents\n    FROM \n        customer \n    JOIN \n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY \n        cd_gender\n),\nMergedStats AS (\n    SELECT \n        a.ca_state,\n        a.unique_addresses,\n        a.avg_street_name_length,\n        a.count_ville_cities,\n        c.cd_gender,\n        c.customer_count,\n        c.avg_purchase_estimate,\n        c.total_dependents\n    FROM \n        AddressStats a\n    CROSS JOIN \n        CustomerStats c\n)\nSELECT \n    ms.ca_state,\n    ms.unique_addresses,\n    ms.avg_street_name_length,\n    ms.count_ville_cities,\n    ms.cd_gender,\n    ms.customer_count,\n    ms.avg_purchase_estimate,\n    ms.total_dependents\nFROM \n    MergedStats ms\nORDER BY \n    ms.unique_addresses DESC, ms.customer_count DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        cr_returning_customer_sk,\n        SUM(cr_return_quantity) AS total_returned_quantity,\n        SUM(cr_return_amount) AS total_return_amount\n    FROM \n        catalog_returns\n    GROUP BY \n        cr_returning_customer_sk\n),\nWebSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk,\n        COUNT(ws_order_number) AS total_orders,\n        SUM(ws_sales_price) AS total_sales,\n        SUM(ws_ext_discount_amt) AS total_discount\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nAverageReturns AS (\n    SELECT \n        cr_returning_customer_sk,\n        AVG(total_returned_quantity) AS avg_returned_quantity,\n        AVG(total_return_amount) AS avg_return_amount\n    FROM \n        CustomerReturns \n    GROUP BY \n        cr_returning_customer_sk\n),\nHighValueCustomers AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        ws.total_sales,\n        ar.avg_returned_quantity,\n        ar.avg_return_amount\n    FROM \n        customer c\n    JOIN \n        WebSalesSummary ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        AverageReturns ar ON c.c_customer_sk = ar.cr_returning_customer_sk\n    WHERE \n        ws.total_sales > 1000 \n        AND ar.avg_returned_quantity < 5\n)\nSELECT \n    hvc.c_customer_id,\n    hvc.c_first_name,\n    hvc.c_last_name,\n    hvc.total_sales,\n    hvc.avg_returned_quantity,\n    hvc.avg_return_amount,\n    COALESCE(NULLIF(hvc.avg_return_amount, 0), 1) AS adjusted_return_amount,\n    CASE \n        WHEN hvc.avg_returned_quantity IS NULL THEN 'No Returns'\n        ELSE 'Returns Present'\n    END AS return_status\nFROM \n    HighValueCustomers hvc\nORDER BY \n    hvc.total_sales DESC\nOFFSET 0 ROWS \nFETCH NEXT 10 ROWS ONLY;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk, \n        SUM(sr_return_quantity) AS total_returns,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nSalesPerCustomer AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_paid_inc_tax) AS total_sales\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk >= (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022)\n    GROUP BY \n        ws_bill_customer_sk\n),\nReturnRates AS (\n    SELECT \n        SP.ws_bill_customer_sk,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        SP.total_sales,\n        CASE \n            WHEN SP.total_sales > 0 THEN COALESCE(cr.total_returns, 0) * 1.0 / SP.total_sales\n            ELSE 0\n        END AS return_rate\n    FROM \n        SalesPerCustomer SP\n    LEFT JOIN \n        CustomerReturns cr ON SP.ws_bill_customer_sk = cr.sr_customer_sk\n)\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    RR.ws_bill_customer_sk,\n    RR.total_returns,\n    RR.total_sales,\n    RR.return_rate,\n    CASE \n        WHEN RR.return_rate > 0.1 THEN 'High Return Rate'\n        ELSE 'Normal Return Rate'\n    END AS return_category\nFROM \n    ReturnRates RR\nJOIN \n    customer c ON RR.ws_bill_customer_sk = c.c_customer_sk\nWHERE \n    RR.return_rate IS NOT NULL\nORDER BY \n    RR.return_rate DESC\nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amount,\n        AVG(sr_return_quantity) AS avg_return_quantity\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nWebSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_paid_inc_tax) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS order_count\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk = (SELECT MAX(d_date_sk) FROM date_dim)\n    GROUP BY \n        ws_bill_customer_sk\n),\nSalesRatio AS (\n    SELECT \n        a.sr_customer_sk,\n        COALESCE(b.total_sales, 0) AS total_sales,\n        COALESCE(a.total_returns, 0) AS total_returns,\n        CASE \n            WHEN COALESCE(b.total_sales, 0) > 0 THEN \n                ROUND(COALESCE(a.total_returns, 0) * 100.0 / b.total_sales, 2)\n            ELSE \n                NULL \n        END AS return_ratio\n    FROM \n        CustomerReturns a\n    LEFT JOIN \n        WebSalesSummary b ON a.sr_customer_sk = b.ws_bill_customer_sk\n)\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    s.return_ratio,\n    CASE \n        WHEN s.return_ratio > 10 THEN 'High Return Customer'\n        WHEN s.return_ratio BETWEEN 5 AND 10 THEN 'Moderate Return Customer'\n        ELSE 'Low Return Customer'\n    END AS return_customer_type\nFROM \n    SalesRatio s\nJOIN \n    customer c ON s.sr_customer_sk = c.c_customer_sk\nORDER BY \n    s.return_ratio DESC NULLS LAST;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        COUNT(DISTINCT ws_item_sk) AS unique_items\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 AND \n                               (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_bill_customer_sk\n), \nDemographicData AS (\n    SELECT \n        c_customer_sk,\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_credit_rating\n    FROM \n        customer AS c\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n), \nPerformanceMetrics AS (\n    SELECT \n        dd.ws_bill_customer_sk,\n        dd.total_sales,\n        dd.total_orders,\n        dd.unique_items,\n        d.cd_gender,\n        d.cd_marital_status,\n        d.cd_education_status,\n        d.cd_credit_rating\n    FROM \n        SalesData AS dd\n    JOIN \n        DemographicData AS d ON dd.ws_bill_customer_sk = d.c_customer_sk\n)\nSELECT \n    pm.cd_gender,\n    pm.cd_marital_status,\n    pm.cd_education_status,\n    pm.cd_credit_rating,\n    AVG(pm.total_sales) AS avg_total_sales,\n    AVG(pm.total_orders) AS avg_total_orders,\n    AVG(pm.unique_items) AS avg_unique_items\nFROM \n    PerformanceMetrics AS pm\nGROUP BY \n    pm.cd_gender,\n    pm.cd_marital_status,\n    pm.cd_education_status,\n    pm.cd_credit_rating\nORDER BY \n    avg_total_sales DESC;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_sk) AS customer_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        COUNT(c_customer_sk) FILTER (WHERE cd_marital_status = 'M') AS married_customers\n    FROM \n        customer_demographics\n    JOIN \n        customer ON cd_demo_sk = c_current_cdemo_sk\n    GROUP BY \n        cd_gender\n),\nSalesData AS (\n    SELECT \n        ws_bill_cdemo_sk,\n        SUM(ws_net_paid) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS order_count\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_cdemo_sk\n),\nResults AS (\n    SELECT \n        cs.cd_gender,\n        cs.customer_count,\n        cs.avg_purchase_estimate,\n        cs.married_customers,\n        COALESCE(sd.total_sales, 0) AS total_sales,\n        COALESCE(sd.order_count, 0) AS order_count\n    FROM \n        CustomerStats cs\n    LEFT JOIN \n        SalesData sd ON cs.customer_count = sd.ws_bill_cdemo_sk\n)\nSELECT \n    r.cd_gender,\n    r.customer_count,\n    r.avg_purchase_estimate,\n    r.married_customers,\n    r.total_sales,\n    r.order_count,\n    (r.total_sales / NULLIF(r.order_count, 0)) AS avg_sales_per_order,\n    (r.avg_purchase_estimate - (r.total_sales / NULLIF(r.customer_count, 0))) AS purchase_diff\nFROM \n    Results r\nWHERE \n    r.customer_count > 1000\nORDER BY \n    r.total_sales DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned_qty,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nSalesStats AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_quantity) AS total_sales_qty,\n        COUNT(DISTINCT ws_order_number) AS sales_count,\n        AVG(ws_net_profit) AS avg_net_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nJoinStats AS (\n    SELECT \n        c.c_customer_sk,\n        COALESCE(cr.total_returned_qty, 0) AS total_returned_qty,\n        COALESCE(ss.total_sales_qty, 0) AS total_sales_qty,\n        CASE \n            WHEN COALESCE(ss.total_sales_qty, 0) > 0 \n                THEN CAST(COALESCE(cr.total_returned_qty, 0) AS FLOAT) / COALESCE(ss.total_sales_qty, 0) \n            ELSE NULL \n        END AS return_ratio,\n        ss.avg_net_profit\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN \n        SalesStats ss ON c.c_customer_sk = ss.ws_bill_customer_sk\n)\nSELECT \n    j.c_customer_sk,\n    j.total_returned_qty,\n    j.total_sales_qty,\n    j.return_ratio,\n    j.avg_net_profit,\n    CASE \n        WHEN j.return_ratio IS NOT NULL AND j.return_ratio > 0.2 THEN 'High Return Ratio'\n        WHEN j.return_ratio IS NOT NULL AND j.return_ratio BETWEEN 0.1 AND 0.2 THEN 'Moderate Return Ratio'\n        ELSE 'Low Return Ratio'\n    END AS return_category \nFROM \n    JoinStats j\nWHERE \n    j.avg_net_profit IS NOT NULL \n    AND j.avg_net_profit > (\n        SELECT AVG(avg_net_profit) \n        FROM SalesStats\n    )\nORDER BY \n    j.return_ratio DESC NULLS LAST\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH AddressCounts AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS distinct_address_count,\n        SUM(LENGTH(ca_street_name)) AS total_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nDemographicSummary AS (\n    SELECT \n        cd_gender,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        COUNT(cd_demo_sk) AS demographic_count\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nDateSummary AS (\n    SELECT \n        d_year,\n        COUNT(DISTINCT d_date_id) AS unique_dates,\n        COUNT(CASE WHEN d_holiday = 'Y' THEN 1 END) AS holiday_count\n    FROM \n        date_dim\n    GROUP BY \n        d_year\n)\nSELECT \n    a.ca_state,\n    a.distinct_address_count,\n    a.total_street_name_length,\n    d.cd_gender,\n    d.avg_purchase_estimate,\n    d.demographic_count,\n    dt.d_year,\n    dt.unique_dates,\n    dt.holiday_count\nFROM \n    AddressCounts a\nJOIN \n    DemographicSummary d ON a.distinct_address_count > 10\nJOIN \n    DateSummary dt ON dt.unique_dates > 50\nORDER BY \n    a.ca_state, d.cd_gender;\n",
  "\nWITH AddressStats AS (\n    SELECT \n        ca_state,\n        COUNT(*) AS total_addresses,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        SUM(CASE WHEN ca_city IS NOT NULL THEN 1 ELSE 0 END) AS city_count,\n        SUM(CASE WHEN ca_zip IS NOT NULL THEN 1 ELSE 0 END) AS zip_count\n    FROM customer_address\n    GROUP BY ca_state\n),\nCustomerDemographics AS (\n    SELECT \n        cd_gender,\n        COUNT(c_customer_sk) AS customer_count,\n        AVG(cd_dep_count) AS avg_dep_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM customer \n    JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY cd_gender\n),\nCombinedStats AS (\n    SELECT \n        a.ca_state,\n        a.total_addresses,\n        a.avg_street_name_length,\n        a.city_count,\n        a.zip_count,\n        cd.cd_gender,\n        cd.customer_count,\n        cd.avg_dep_count,\n        cd.avg_purchase_estimate\n    FROM AddressStats a\n    LEFT JOIN CustomerDemographics cd ON a.ca_state = 'NY' AND cd.customer_count > 1000\n)\nSELECT \n    ca_state,\n    total_addresses,\n    avg_street_name_length,\n    city_count, \n    zip_count,\n    cd_gender,\n    customer_count,\n    avg_dep_count,\n    avg_purchase_estimate\nFROM CombinedStats\nORDER BY total_addresses DESC, customer_count DESC;\n",
  "\nWITH customer_stats AS (\n    SELECT \n        cd_demo_sk,\n        SUM(CASE WHEN c.c_current_cdemo_sk IS NOT NULL THEN 1 ELSE 0 END) AS total_customers,\n        AVG(CASE WHEN c.c_birth_year IS NOT NULL THEN 2023 - c.c_birth_year ELSE NULL END) AS avg_age,\n        COUNT(DISTINCT c.c_customer_id) AS unique_customers\n    FROM \n        customer_demographics cd \n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    GROUP BY \n        cd_demo_sk\n),\nsales_data AS (\n    SELECT \n        ws_bill_cdemo_sk,\n        COUNT(ws_order_number) AS total_orders,\n        SUM(ws_net_profit) AS total_net_profit,\n        AVG(ws_sales_price) AS avg_sales_price\n    FROM \n        web_sales \n    GROUP BY \n        ws_bill_cdemo_sk\n),\njoined_data AS (\n    SELECT \n        cs.cd_demo_sk,\n        cs.total_customers,\n        cs.avg_age,\n        COALESCE(sd.total_orders, 0) AS total_orders,\n        COALESCE(sd.total_net_profit, 0) AS total_net_profit,\n        COALESCE(sd.avg_sales_price, 0.00) AS avg_sales_price\n    FROM \n        customer_stats cs \n    LEFT JOIN \n        sales_data sd ON cs.cd_demo_sk = sd.ws_bill_cdemo_sk\n)\nSELECT \n    j.cd_demo_sk,\n    j.total_customers,\n    j.avg_age,\n    j.total_orders,\n    j.total_net_profit,\n    j.avg_sales_price,\n    CASE \n        WHEN j.total_net_profit > 10000 THEN 'High Value Customer'\n        WHEN j.total_net_profit BETWEEN 5000 AND 10000 THEN 'Medium Value Customer'\n        ELSE 'Low Value Customer' \n    END AS customer_value_category\nFROM \n    joined_data j\nORDER BY \n    j.total_net_profit DESC,\n    j.total_orders DESC\nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        wr_returned_date_sk, \n        wr_item_sk, \n        SUM(wr_return_quantity) AS total_return_quantity,\n        COUNT(DISTINCT wr_order_number) AS return_count\n    FROM web_returns\n    GROUP BY wr_returned_date_sk, wr_item_sk\n),\nStoreSales AS (\n    SELECT \n        ss_sold_date_sk,\n        ss_item_sk,\n        SUM(ss_quantity) AS total_sold_quantity,\n        SUM(ss_net_profit) AS total_net_profit\n    FROM store_sales\n    GROUP BY ss_sold_date_sk, ss_item_sk\n),\nReturnAnalysis AS (\n    SELECT \n        cr.wr_item_sk,\n        cs.total_sold_quantity,\n        cr.total_return_quantity,\n        cr.return_count,\n        CASE \n            WHEN cs.total_sold_quantity IS NULL THEN 0 \n            ELSE (CAST(cr.total_return_quantity AS DECIMAL) / cs.total_sold_quantity) * 100 \n        END AS return_rate,\n        cs.total_net_profit\n    FROM CustomerReturns cr\n    LEFT JOIN StoreSales cs ON cr.wr_item_sk = cs.ss_item_sk\n)\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    ra.total_sold_quantity AS quantity_sold,\n    ra.total_return_quantity AS quantity_returned,\n    ra.return_count AS number_of_returns,\n    ra.return_rate,\n    ra.total_net_profit\nFROM item i\nJOIN ReturnAnalysis ra ON i.i_item_sk = ra.wr_item_sk\nWHERE \n    ra.return_rate > 10\nORDER BY \n    ra.return_rate DESC, ra.total_net_profit DESC\nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_ship_date_sk,\n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_net_profit) AS total_net_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_ship_date_sk, ws_item_sk\n),\nitem_details AS (\n    SELECT \n        i_item_sk,\n        i_item_desc,\n        i_current_price,\n        i_brand\n    FROM \n        item\n),\nsales_data AS (\n    SELECT \n        ss.ws_ship_date_sk,\n        ss.ws_item_sk,\n        ss.total_quantity,\n        ss.total_net_profit,\n        id.i_item_desc,\n        id.i_current_price,\n        id.i_brand\n    FROM \n        sales_summary ss\n    JOIN \n        item_details id ON ss.ws_item_sk = id.i_item_sk\n),\ndate_info AS (\n    SELECT \n        d_date_sk,\n        d_year,\n        d_month_seq,\n        d_day_name\n    FROM \n        date_dim\n)\nSELECT \n    di.d_year,\n    di.d_month_seq,\n    di.d_day_name,\n    sd.i_brand,\n    SUM(sd.total_quantity) AS total_quantity_sold,\n    SUM(sd.total_net_profit) AS total_net_profit\nFROM \n    sales_data sd\nJOIN \n    date_info di ON sd.ws_ship_date_sk = di.d_date_sk\nGROUP BY \n    di.d_year, di.d_month_seq, di.d_day_name, sd.i_brand\nORDER BY \n    di.d_year, di.d_month_seq, total_net_profit DESC;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(COALESCE(ss.ss_ext_sales_price, 0)) AS total_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n        AVG(ss.ss_sales_price) AS average_sales_price,\n        SUM(COALESCE(ss.ss_ext_tax, 0)) AS total_tax\n    FROM customer c\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name\n),\ncustomer_segments AS (\n    SELECT \n        cs.c_customer_id,\n        cs.total_sales,\n        cs.total_transactions,\n        CASE \n            WHEN cs.total_sales > 10000 THEN 'High Value'\n            WHEN cs.total_sales > 5000 THEN 'Medium Value'\n            ELSE 'Low Value'\n        END AS customer_segment\n    FROM customer_sales cs\n),\nsales_by_segment AS (\n    SELECT \n        customer_segment,\n        COUNT(*) AS segment_count,\n        SUM(total_sales) AS segment_total_sales,\n        AVG(total_sales) AS average_sales_per_customer,\n        AVG(total_transactions) AS average_transactions_per_customer\n    FROM customer_segments\n    GROUP BY customer_segment\n)\nSELECT \n    sbs.customer_segment,\n    sbs.segment_count,\n    sbs.segment_total_sales,\n    sbs.average_sales_per_customer,\n    sbs.average_transactions_per_customer,\n    wd.d_year\nFROM sales_by_segment sbs\nJOIN date_dim wd ON wd.d_date_sk = (SELECT MAX(d_date_sk) FROM date_dim WHERE d_current_year = 'Y')\nORDER BY sbs.segment_total_sales DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer AS c\n    LEFT JOIN \n        web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(cs.total_sales) AS total_sales\n    FROM \n        customer_demographics AS cd\n    JOIN \n        CustomerSales AS cs ON cd.cd_demo_sk = cs.c_customer_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nSalesAnalysis AS (\n    SELECT \n        d.cd_gender,\n        d.cd_marital_status,\n        d.cd_education_status,\n        AVG(d.total_sales) AS avg_sales,\n        COUNT(d.cd_demo_sk) AS demographic_count\n    FROM \n        Demographics AS d\n    GROUP BY \n        d.cd_gender, d.cd_marital_status, d.cd_education_status\n)\nSELECT \n    sa.cd_gender,\n    sa.cd_marital_status,\n    sa.cd_education_status,\n    sa.avg_sales,\n    sa.demographic_count\nFROM \n    SalesAnalysis AS sa\nWHERE \n    sa.avg_sales > (SELECT AVG(avg_sales) FROM SalesAnalysis)\nORDER BY \n    sa.avg_sales DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_profit) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    WHERE \n        ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2022) \n                                AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022)\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n), \nDemographicAnalysis AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(cs.c_customer_sk) AS customer_count,\n        AVG(cs.total_sales) AS avg_sales,\n        SUM(cs.total_orders) AS total_orders\n    FROM \n        customer_demographics cd\n    JOIN \n        CustomerSales cs ON cd.cd_demo_sk = cs.c_customer_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    da.cd_gender,\n    da.cd_marital_status,\n    COUNT(*) AS demographic_count,\n    SUM(da.avg_sales) AS total_sales_avg,\n    SUM(da.total_orders) AS total_order_count\nFROM \n    DemographicAnalysis da\nGROUP BY \n    da.cd_gender, da.cd_marital_status\nHAVING \n    COUNT(*) > 100\nORDER BY \n    total_sales_avg DESC;\n",
  "\nWITH TotalSales AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_net_paid) AS total_sales,\n        COUNT(ws_order_number) AS order_count,\n        MAX(ws_sold_date_sk) AS last_sold_date\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n),\nReturnStatistics AS (\n    SELECT \n        wr_item_sk,\n        SUM(wr_return_quantity) AS total_returns,\n        SUM(wr_return_amt) AS total_return_amount\n    FROM \n        web_returns\n    GROUP BY \n        wr_item_sk\n),\nSalesAndReturns AS (\n    SELECT \n        ts.ws_item_sk,\n        ts.total_sales,\n        ts.order_count,\n        COALESCE(rs.total_returns, 0) AS total_returns,\n        COALESCE(rs.total_return_amount, 0.00) AS total_return_amount,\n        ts.last_sold_date,\n        (CASE \n            WHEN ts.total_sales > 0 THEN ROUND(COALESCE(rs.total_return_amount, 0) / ts.total_sales * 100, 2)\n            ELSE NULL\n        END) AS return_rate_percentage\n    FROM \n        TotalSales ts\n    LEFT JOIN \n        ReturnStatistics rs ON ts.ws_item_sk = rs.wr_item_sk\n)\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    sar.total_sales,\n    sar.order_count,\n    sar.total_returns,\n    sar.total_return_amount,\n    sar.return_rate_percentage\nFROM \n    SalesAndReturns sar\nJOIN \n    item i ON sar.ws_item_sk = i.i_item_sk\nWHERE \n    (sar.return_rate_percentage IS NOT NULL AND sar.return_rate_percentage > 10) \n    OR (sar.total_sales > 10000)\nORDER BY \n    sar.return_rate_percentage DESC, \n    sar.total_sales DESC\nLIMIT 50;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amount\n    FROM \n        store_returns \n    GROUP BY \n        sr_customer_sk\n),\nSalesData AS (\n    SELECT\n        ss_customer_sk,\n        SUM(ss_net_paid) AS total_net_paid,\n        AVG(ss_net_profit) AS avg_net_profit\n    FROM \n        store_sales \n    WHERE \n        ss_sold_date_sk > (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ss_customer_sk\n),\nRETURN_PROFIT AS (\n    SELECT \n        c.c_customer_id,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        COALESCE(sd.total_net_paid, 0) AS total_net_paid,\n        COALESCE(sd.avg_net_profit, 0) AS avg_net_profit,\n        CASE \n            WHEN COALESCE(sd.total_net_paid, 0) = 0 THEN NULL \n            ELSE (COALESCE(cr.total_return_amount, 0) / COALESCE(sd.total_net_paid, 0)) * 100 \n        END AS return_percentage\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN \n        SalesData sd ON c.c_customer_sk = sd.ss_customer_sk\n)\nSELECT \n    r.c_customer_id,\n    r.total_returns,\n    r.total_return_amount,\n    r.total_net_paid,\n    r.avg_net_profit,\n    r.return_percentage\nFROM \n    RETURN_PROFIT r\nWHERE \n    (r.return_percentage IS NULL OR r.return_percentage > 10) \n    AND (r.total_net_paid > 1000 OR r.total_return_amount > 500)\nORDER BY \n    r.return_percentage DESC NULLS LAST, \n    r.total_net_paid DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_return_qty,\n        SUM(sr_return_amt_inc_tax) AS total_return_amt,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM store_returns\n    GROUP BY sr_customer_sk\n),\nProductSales AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_sold_qty,\n        SUM(ws_ext_sales_price) AS total_sold_amt\n    FROM web_sales\n    GROUP BY ws_item_sk\n),\nReturnRates AS (\n    SELECT\n        cr.sr_customer_sk,\n        COALESCE(pr.total_sold_qty, 0) AS total_sales_qty,\n        cr.total_return_qty,\n        cr.total_return_amt,\n        CASE \n            WHEN COALESCE(pr.total_sold_qty, 0) = 0 THEN NULL\n            ELSE ROUND((cr.total_return_qty / NULLIF(pr.total_sold_qty, 0)) * 100, 2)\n        END AS return_rate\n    FROM CustomerReturns cr\n    LEFT JOIN ProductSales pr ON cr.sr_customer_sk = pr.ws_item_sk\n)\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    r.return_rate,\n    r.total_return_qty,\n    r.total_return_amt,\n    CASE \n        WHEN r.return_rate IS NULL OR r.return_rate > 50 THEN 'High Return'\n        WHEN r.return_rate BETWEEN 20 AND 50 THEN 'Moderate Return'\n        ELSE 'Low Return'\n    END AS return_class\nFROM ReturnRates r\nJOIN customer c ON r.sr_customer_sk = c.c_customer_sk\nWHERE r.return_rate IS NOT NULL\nORDER BY r.return_rate DESC\nLIMIT 100;\n",
  "\nWITH AddressStatistics AS (\n    SELECT \n        ca_state,\n        COUNT(*) AS total_addresses,\n        COUNT(DISTINCT ca_city) AS unique_cities,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length\n    FROM customer_address\n    GROUP BY ca_state\n),\nCustomerStatistics AS (\n    SELECT \n        cd_gender,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        COUNT(c_customer_sk) AS total_customers,\n        MAX(cd_dep_count) AS max_dependents\n    FROM customer_demographics\n    JOIN customer ON cd_demo_sk = c_current_cdemo_sk\n    GROUP BY cd_gender\n),\nFullStatistics AS (\n    SELECT \n        a.ca_state,\n        a.total_addresses,\n        a.unique_cities,\n        a.avg_street_name_length,\n        a.max_street_name_length,\n        a.min_street_name_length,\n        c.cd_gender,\n        c.avg_purchase_estimate,\n        c.total_customers,\n        c.max_dependents\n    FROM AddressStatistics a\n    JOIN CustomerStatistics c ON c.total_customers > 0\n)\nSELECT \n    fs.ca_state,\n    fs.total_addresses,\n    fs.unique_cities,\n    fs.avg_street_name_length,\n    fs.max_street_name_length,\n    fs.min_street_name_length,\n    fs.cd_gender,\n    fs.avg_purchase_estimate,\n    fs.total_customers,\n    fs.max_dependents\nFROM FullStatistics fs\nORDER BY fs.total_addresses DESC, fs.avg_purchase_estimate DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH Address_Statistics AS (\n    SELECT \n        ca_city,\n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        COUNT(DISTINCT ca_street_name) AS unique_streets,\n        SUM(LENGTH(ca_street_name)) AS total_street_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_city,\n        ca_state\n),\nDemographics_Statistics AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS customers,\n        AVG(cd_purchase_estimate) AS average_purchase_estimate\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nSales_Statistics AS (\n    SELECT \n        ws_bill_cdemo_sk AS demographic_sk,\n        SUM(ws_net_paid) AS total_sales,\n        SUM(ws_quantity) AS total_quantity\n    FROM \n        web_sales\n    WHERE \n        ws_bill_cdemo_sk IS NOT NULL\n    GROUP BY \n        ws_bill_cdemo_sk\n),\nFinal_Statistics AS (\n    SELECT \n        a.ca_city,\n        a.ca_state,\n        d.cd_gender,\n        d.customers,\n        d.average_purchase_estimate,\n        s.total_sales,\n        s.total_quantity\n    FROM \n        Address_Statistics a\n    JOIN \n        Demographics_Statistics d ON a.ca_city = d.cd_gender\n    LEFT JOIN \n        Sales_Statistics s ON d.customers = s.demographic_sk\n)\nSELECT \n    ca_city,\n    ca_state,\n    cd_gender,\n    customers,\n    average_purchase_estimate,\n    COALESCE(total_sales, 0) AS total_sales,\n    COALESCE(total_quantity, 0) AS total_quantity\nFROM \n    Final_Statistics\nORDER BY \n    ca_state, \n    ca_city;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        cr_returning_customer_sk,\n        SUM(cr_return_quantity) AS total_returned,\n        COUNT(DISTINCT cr_item_sk) AS distinct_items_returned\n    FROM \n        catalog_returns\n    GROUP BY \n        cr_returning_customer_sk\n),\nSales AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws_order_number) AS unique_orders\n    FROM \n        web_sales\n    WHERE \n        ws_net_profit > 0\n    GROUP BY \n        ws_bill_customer_sk\n),\nCustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        COALESCE(cr.total_returned, 0) AS total_returned,\n        COALESCE(cr.distinct_items_returned, 0) AS distinct_items_returned,\n        COALESCE(s.total_net_profit, 0) AS total_net_profit,\n        COALESCE(s.unique_orders, 0) AS unique_orders\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\n    LEFT JOIN \n        Sales s ON c.c_customer_sk = s.ws_bill_customer_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.total_returned,\n    cs.distinct_items_returned,\n    cs.total_net_profit,\n    cs.unique_orders,\n    CASE \n        WHEN cs.total_net_profit > 1000 THEN 'High Profit'\n        WHEN cs.total_net_profit BETWEEN 500 AND 1000 THEN 'Medium Profit'\n        ELSE 'Low Profit'\n    END AS profit_category,\n    CASE \n        WHEN cs.total_returned > 10 THEN 'Frequent Returns'\n        ELSE 'Rare Returns'\n    END AS return_category\nFROM \n    CustomerStats cs\nWHERE \n    cs.total_returned IS NOT NULL OR cs.total_net_profit IS NOT NULL\nORDER BY \n    cs.total_net_profit DESC, \n    cs.total_returned ASC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        cr_returning_customer_sk,\n        SUM(cr_return_quantity) AS total_returns,\n        COUNT(DISTINCT cr_order_number) AS unique_returns\n    FROM \n        catalog_returns \n    GROUP BY \n        cr_returning_customer_sk\n),\nSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        AVG(ws_net_paid_inc_tax) AS avg_order_value\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nTopCustomers AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(ss.total_net_profit, 0) AS total_net_profit,\n        ss.total_orders,\n        CASE\n            WHEN COALESCE(cr.total_returns, 0) > 0 THEN 'High Risk'\n            WHEN COALESCE(ss.total_net_profit, 0) > 1000 THEN 'High Value'\n            ELSE 'Regular'\n        END AS customer_category\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\n    LEFT JOIN \n        SalesSummary ss ON c.c_customer_sk = ss.ws_bill_customer_sk\n)\nSELECT \n    tc.c_customer_id,\n    tc.c_first_name,\n    tc.c_last_name,\n    tc.total_returns,\n    tc.total_net_profit,\n    tc.total_orders,\n    tc.customer_category\nFROM \n    TopCustomers tc\nWHERE \n    (tc.total_orders > 5 OR tc.total_returns > 0)\nORDER BY \n    tc.total_net_profit DESC,\n    tc.total_returns DESC\nLIMIT 50;\n\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_item_sk, \n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        ws.ws_ship_date_sk,\n        d.d_year,\n        d.d_month_seq\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        ws.ws_item_sk, \n        ws.ws_ship_date_sk, \n        d.d_year, \n        d.d_month_seq\n), \nitem_details AS (\n    SELECT \n        i.i_item_sk, \n        i.i_item_desc, \n        i.i_category, \n        i.i_brand\n    FROM \n        item i\n), \nsales_summary AS (\n    SELECT \n        sd.ws_item_sk, \n        id.i_item_desc, \n        id.i_category,\n        id.i_brand,\n        sd.total_quantity,\n        sd.total_sales,\n        sd.total_discount,\n        sd.d_year,\n        sd.d_month_seq\n    FROM \n        sales_data sd\n    JOIN \n        item_details id ON sd.ws_item_sk = id.i_item_sk\n)\nSELECT \n    ss.i_brand,\n    ss.i_category,\n    ss.d_year,\n    ss.d_month_seq,\n    AVG(ss.total_sales) AS avg_sales,\n    SUM(ss.total_discount) AS total_discount\nFROM \n    sales_summary ss\nGROUP BY \n    ss.i_brand, \n    ss.i_category, \n    ss.d_year, \n    ss.d_month_seq\nORDER BY \n    ss.i_brand, \n    ss.i_category, \n    ss.d_year, \n    ss.d_month_seq;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_ship_date_sk,\n        d.d_year,\n        d.d_quarter_seq,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        COUNT(DISTINCT ws.ws_bill_customer_sk) AS unique_customers\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        ws.ws_ship_date_sk, d.d_year, d.d_quarter_seq\n), \naverage_sales AS (\n    SELECT \n        d_year,\n        d_quarter_seq,\n        AVG(total_sales) AS avg_sales,\n        AVG(total_discount) AS avg_discount,\n        AVG(order_count) AS avg_orders,\n        AVG(unique_customers) AS avg_customers\n    FROM \n        sales_data\n    GROUP BY \n        d_year, d_quarter_seq\n)\nSELECT \n    a.d_year,\n    a.d_quarter_seq,\n    a.avg_sales,\n    a.avg_discount,\n    a.avg_orders,\n    a.avg_customers,\n    CASE \n        WHEN a.avg_sales > b.avg_sales THEN 'Increase'\n        WHEN a.avg_sales < b.avg_sales THEN 'Decrease'\n        ELSE 'Stable'\n    END AS sales_trend\nFROM \n    average_sales a\nLEFT JOIN \n    average_sales b ON a.d_year = b.d_year AND a.d_quarter_seq = b.d_quarter_seq + 1\nORDER BY \n    a.d_year, a.d_quarter_seq;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_amt) AS total_return_amt,\n        COUNT(sr_ticket_number) AS return_count\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nItemSales AS (\n    SELECT \n        ws_ship_customer_sk,\n        SUM(ws_net_profit) AS total_net_profit,\n        COUNT(ws_order_number) AS order_count\n    FROM \n        web_sales\n    GROUP BY \n        ws_ship_customer_sk\n),\nSalesSummary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(cr.total_return_amt, 0) AS total_return_amt,\n        COALESCE(cr.return_count, 0) AS return_count,\n        COALESCE(isales.total_net_profit, 0) AS total_net_profit,\n        COALESCE(isales.order_count, 0) AS order_count\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN \n        ItemSales isales ON c.c_customer_sk = isales.ws_ship_customer_sk\n)\nSELECT \n    s.c_customer_sk,\n    s.c_first_name,\n    s.c_last_name,\n    s.total_return_amt,\n    s.return_count,\n    s.total_net_profit,\n    s.order_count,\n    CASE \n        WHEN s.total_net_profit > s.total_return_amt THEN 'Profitable'\n        WHEN s.total_net_profit < s.total_return_amt THEN 'Unprofitable'\n        ELSE 'Break Even'\n    END AS profitability_status\nFROM \n    SalesSummary s\nWHERE \n    (s.total_return_amt > 1000 OR s.total_net_profit > 5000)\nORDER BY \n    profitability_status DESC,\n    total_net_profit DESC\nLIMIT 100;\n",
  "\nWITH SalesSummary AS (\n    SELECT \n        ws_sold_date_sk, \n        ws_item_sk, \n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_net_paid_inc_tax) AS total_sales\n    FROM web_sales\n    WHERE ws_sold_date_sk >= (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY ws_sold_date_sk, ws_item_sk\n),\nReturnsSummary AS (\n    SELECT \n        wr_item_sk,\n        SUM(wr_return_quantity) AS total_returns,\n        SUM(wr_return_amt_inc_tax) AS total_return_amt\n    FROM web_returns\n    GROUP BY wr_item_sk\n),\nFinalReport AS (\n    SELECT \n        ss.ws_item_sk,\n        COALESCE(ss.total_quantity, 0) AS total_quantity,\n        COALESCE(ss.total_sales, 0) AS total_sales,\n        COALESCE(rs.total_returns, 0) AS total_returns,\n        COALESCE(rs.total_return_amt, 0) AS total_return_amt,\n        CASE \n            WHEN COALESCE(ss.total_sales, 0) = 0 THEN NULL \n            ELSE ((COALESCE(ss.total_sales, 0) - COALESCE(rs.total_return_amt, 0)) / COALESCE(ss.total_sales, 0)) * 100 \n        END AS sales_return_rate\n    FROM SalesSummary ss\n    FULL OUTER JOIN ReturnsSummary rs ON ss.ws_item_sk = rs.wr_item_sk\n)\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    f.total_quantity,\n    f.total_sales,\n    f.total_returns,\n    f.total_return_amt,\n    f.sales_return_rate\nFROM FinalReport f\nJOIN item i ON f.ws_item_sk = i.i_item_sk\nWHERE f.sales_return_rate IS NULL OR f.sales_return_rate > 20.0\nORDER BY f.sales_return_rate DESC NULLS LAST;\n",
  "\nWITH CustomerAddressAnalysis AS (\n    SELECT\n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        SUM(CASE WHEN ca_city LIKE '%ville%' THEN 1 ELSE 0 END) AS cities_with_ville,\n        COUNT(CASE WHEN ca_street_type IN ('St', 'Ave', 'Blvd') THEN 1 END) AS normalized_street_count,\n        AVG(ca_gmt_offset) AS avg_gmt_offset\n    FROM\n        customer_address\n    GROUP BY\n        ca_state\n),\nPromotionsSummary AS (\n    SELECT\n        p.p_promo_name,\n        COUNT(cs.cs_order_number) AS total_orders,\n        SUM(cs.cs_ext_sales_price) AS total_revenue,\n        SUM(cs.cs_ext_discount_amt) AS total_discount,\n        SUM(cs.cs_ext_tax) AS total_tax\n    FROM\n        promotion p\n    LEFT JOIN catalog_sales cs ON p.p_promo_sk = cs.cs_promo_sk\n    GROUP BY\n        p.p_promo_name\n),\nFinalBenchmark AS (\n    SELECT\n        ca.ca_state,\n        ca.unique_addresses,\n        ca.cities_with_ville,\n        ca.normalized_street_count,\n        ca.avg_gmt_offset,\n        ps.p_promo_name,\n        ps.total_orders,\n        ps.total_revenue,\n        ps.total_discount,\n        ps.total_tax\n    FROM\n        CustomerAddressAnalysis ca\n    JOIN PromotionsSummary ps ON ps.total_orders IS NOT NULL\n    ORDER BY\n        ca.ca_state,\n        ps.total_revenue DESC\n)\nSELECT *\nFROM FinalBenchmark\nWHERE total_orders > 5\nAND avg_gmt_offset BETWEEN -5.00 AND 0.00;\n",
  "\nWITH AddressStats AS (\n    SELECT \n        ca_state,\n        COUNT(*) AS total_addresses,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        COUNT(DISTINCT ca_city) AS unique_cities\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomerDemoStats AS (\n    SELECT \n        cd_gender,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependents\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nDateStats AS (\n    SELECT \n        d_year,\n        COUNT(*) AS total_days,\n        COUNT(DISTINCT d_month_seq) AS unique_months\n    FROM \n        date_dim\n    GROUP BY \n        d_year\n),\nFinalBenchmark AS (\n    SELECT \n        a.ca_state AS state,\n        a.total_addresses,\n        a.avg_street_name_length,\n        a.unique_cities,\n        c.cd_gender,\n        c.avg_purchase_estimate,\n        c.total_dependents,\n        d.d_year,\n        d.total_days,\n        d.unique_months\n    FROM \n        AddressStats a\n    JOIN \n        CustomerDemoStats c ON TRUE\n    JOIN \n        DateStats d ON TRUE\n)\nSELECT \n    state,\n    total_addresses,\n    avg_street_name_length,\n    unique_cities,\n    cd_gender,\n    avg_purchase_estimate,\n    total_dependents,\n    d_year,\n    total_days,\n    unique_months \nFROM \n    FinalBenchmark\nORDER BY \n    state, cd_gender, d_year;\n",
  "\nWITH AddressAnalysis AS (\n    SELECT \n        ca_city,\n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS address_count,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        SUM(CASE WHEN ca_city LIKE '%ville%' THEN 1 ELSE 0 END) AS ville_count\n    FROM \n        customer_address\n    GROUP BY \n        ca_city, \n        ca_state\n), \nDemographicsAnalysis AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        COUNT(c_customer_sk) AS customer_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(CASE WHEN cd_credit_rating = 'Fair' THEN 1 ELSE 0 END) AS fair_credit_count\n    FROM \n        customer_demographics\n    JOIN \n        customer ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY \n        cd_gender, \n        cd_marital_status\n)\nSELECT \n    a.ca_city,\n    a.ca_state,\n    a.address_count,\n    a.avg_street_name_length,\n    a.ville_count,\n    d.cd_gender,\n    d.cd_marital_status,\n    d.customer_count,\n    d.avg_purchase_estimate,\n    d.fair_credit_count\nFROM \n    AddressAnalysis a\nJOIN \n    DemographicsAnalysis d ON a.ca_state = d.cd_marital_status\nORDER BY \n    a.ca_city, \n    d.cd_gender;\n",
  "\nWITH address_summary AS (\n    SELECT\n        ca_city,\n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        COUNT(DISTINCT ca_street_name) AS unique_streets,\n        SUM(LENGTH(ca_street_name) - LENGTH(REPLACE(ca_street_name, ' ', '')) + 1) AS total_word_count\n    FROM\n        customer_address\n    GROUP BY\n        ca_city, ca_state\n),\ncustomer_summary AS (\n    SELECT\n        cd_gender,\n        cd_marital_status,\n        COUNT(DISTINCT c_customer_id) AS total_customers,\n        SUM(cd_dep_count) AS total_dependencies,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM\n        customer\n    JOIN\n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY\n        cd_gender, cd_marital_status\n)\nSELECT\n    a.ca_city,\n    a.ca_state,\n    a.unique_addresses,\n    a.unique_streets,\n    a.total_word_count,\n    c.cd_gender,\n    c.cd_marital_status,\n    c.total_customers,\n    c.total_dependencies,\n    c.avg_purchase_estimate\nFROM\n    address_summary a\nJOIN\n    customer_summary c ON a.ca_state = c.cd_marital_status\nORDER BY\n    a.ca_city, a.ca_state, c.total_customers DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk, \n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amount\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nSalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nCustomerSummary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        COALESCE(sd.total_sales, 0) AS total_sales,\n        COALESCE(sd.total_orders, 0) AS total_orders\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN \n        SalesData sd ON c.c_customer_sk = sd.ws_bill_customer_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_returns,\n    cs.total_return_amount,\n    cs.total_sales,\n    cs.total_orders,\n    (CASE WHEN cs.total_orders > 0 THEN cs.total_sales / cs.total_orders ELSE 0 END) AS avg_order_value,\n    (CASE WHEN cs.total_returns > 0 THEN cs.total_return_amount / cs.total_returns ELSE 0 END) AS avg_return_value\nFROM \n    CustomerSummary cs\nWHERE \n    cs.total_sales > 1000\nORDER BY \n    cs.total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        cr_returning_customer_sk,\n        COUNT(DISTINCT cr_order_number) AS return_count,\n        SUM(cr_return_amount) AS total_return_amount\n    FROM \n        catalog_returns\n    GROUP BY \n        cr_returning_customer_sk\n),\nTopCustomers AS (\n    SELECT \n        cr.cr_returning_customer_sk AS returning_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate\n    FROM \n        CustomerReturns cr\n    JOIN \n        customer_demographics cd ON cr.cr_returning_customer_sk = cd.cd_demo_sk\n    WHERE \n        cr.return_count > 5\n),\nSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_paid) AS total_sales,\n        AVG(ws_net_profit) AS avg_net_profit,\n        COUNT(ws_order_number) AS order_count\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nFinalReport AS (\n    SELECT \n        tc.returning_customer_sk,\n        tc.cd_gender,\n        tc.cd_marital_status,\n        tc.cd_education_status,\n        tc.cd_purchase_estimate,\n        ss.total_sales,\n        ss.avg_net_profit,\n        ss.order_count\n    FROM \n        TopCustomers tc\n    LEFT JOIN \n        SalesSummary ss ON tc.returning_customer_sk = ss.ws_bill_customer_sk\n)\nSELECT \n    fr.returning_customer_sk,\n    fr.cd_gender,\n    fr.cd_marital_status,\n    fr.cd_education_status,\n    fr.cd_purchase_estimate,\n    COALESCE(fr.total_sales, 0) AS total_sales,\n    COALESCE(fr.avg_net_profit, 0) AS avg_net_profit,\n    COALESCE(fr.order_count, 0) AS order_count\nFROM \n    FinalReport fr\nORDER BY \n    fr.total_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH LastYearSales AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_net_paid) AS total_sales\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022)\n        AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022)\n    GROUP BY \n        ws_item_sk\n),\nCurrentYearSales AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_net_paid) AS total_sales\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023)\n        AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_item_sk\n),\nComparison AS (\n    SELECT \n        COALESCE(l.ws_item_sk, c.ws_item_sk) AS item_sk,\n        COALESCE(l.total_quantity, 0) AS last_year_quantity,\n        COALESCE(c.total_quantity, 0) AS current_year_quantity,\n        COALESCE(l.total_sales, 0) AS last_year_sales,\n        COALESCE(c.total_sales, 0) AS current_year_sales,\n        CASE \n            WHEN COALESCE(l.total_sales, 0) = 0 THEN NULL\n            ELSE (COALESCE(c.total_sales, 0) - COALESCE(l.total_sales, 0)) / COALESCE(l.total_sales, 0) * 100\n        END AS sales_growth_percentage\n    FROM \n        LastYearSales l\n    FULL OUTER JOIN \n        CurrentYearSales c ON l.ws_item_sk = c.ws_item_sk\n)\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    cmp.last_year_quantity,\n    cmp.current_year_quantity,\n    cmp.last_year_sales,\n    cmp.current_year_sales,\n    cmp.sales_growth_percentage\nFROM \n    Comparison cmp\nJOIN \n    item i ON cmp.item_sk = i.i_item_sk\nORDER BY \n    cmp.sales_growth_percentage DESC\nLIMIT 10;\n",
  "\nWITH Address_City AS (\n    SELECT DISTINCT\n        ca_city,\n        ca_state,\n        COUNT(ca_address_sk) AS address_count\n    FROM customer_address\n    GROUP BY ca_city, ca_state\n),\nDemographics AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        COUNT(cd_demo_sk) AS demographic_count\n    FROM customer_demographics\n    GROUP BY cd_gender, cd_marital_status\n),\nTime_Stats AS (\n    SELECT \n        d_year,\n        d_month_seq,\n        SUM(CASE WHEN d_current_month = 'Y' THEN 1 ELSE 0 END) AS current_month_sales,\n        SUM(CASE WHEN d_current_year = 'Y' THEN 1 ELSE 0 END) AS current_year_sales\n    FROM date_dim\n    GROUP BY d_year, d_month_seq\n)\nSELECT \n    ac.ca_city,\n    ac.ca_state,\n    ac.address_count,\n    d.cd_gender,\n    d.cd_marital_status,\n    d.demographic_count,\n    ts.d_year,\n    ts.d_month_seq,\n    ts.current_month_sales,\n    ts.current_year_sales\nFROM Address_City ac\nJOIN Demographics d ON ac.address_count > d.demographic_count\nJOIN Time_Stats ts ON ts.current_month_sales > 0\nORDER BY ac.ca_state, ac.ca_city, d.cd_gender, d.cd_marital_status, ts.d_year DESC, ts.d_month_seq DESC;\n",
  "\nWITH customer_sales AS (\n    SELECT c.c_customer_sk, \n           SUM(ws.ws_ext_sales_price) AS total_sales, \n           COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM customer c\n    JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n                                  AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY c.c_customer_sk\n), \ndemographic_analysis AS (\n    SELECT cd.cd_demo_sk, \n           cd.cd_gender, \n           cd.cd_marital_status, \n           cd.cd_education_status, \n           cd.cd_purchase_estimate, \n           COUNT(cs.c_customer_sk) AS customer_count,\n           SUM(cs.total_sales) AS total_sales\n    FROM customer_demographics cd\n    LEFT JOIN customer_sales cs ON cd.cd_demo_sk = cs.c_customer_sk\n    GROUP BY cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate\n), \nsales_summary AS (\n    SELECT da.cd_gender, \n           da.cd_marital_status, \n           da.cd_education_status, \n           SUM(da.total_sales) AS total_sales_by_demo,\n           SUM(da.customer_count) AS total_customers\n    FROM demographic_analysis da\n    GROUP BY da.cd_gender, da.cd_marital_status, da.cd_education_status\n)\nSELECT ss.cd_gender, \n       ss.cd_marital_status, \n       ss.cd_education_status, \n       ss.total_sales_by_demo, \n       ss.total_customers,\n       (ss.total_sales_by_demo / NULLIF(ss.total_customers, 0)) AS avg_sales_per_customer\nFROM sales_summary ss\nORDER BY ss.total_sales_by_demo DESC;\n",
  "\nWITH CustomerOrderStats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_paid_inc_tax) AS total_spent,\n        COUNT(ws.ws_order_number) AS total_orders,\n        MIN(ws.ws_sold_date_sk) AS first_order_date,\n        MAX(ws.ws_sold_date_sk) AS last_order_date\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        ws.ws_sold_date_sk >= (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2022)\n        AND ws.ws_sold_date_sk <= (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        customer_demographics cd\n),\nAggregatedData AS (\n    SELECT \n        cos.c_customer_sk,\n        cos.c_first_name,\n        cos.c_last_name,\n        cos.total_spent,\n        cos.total_orders,\n        cos.first_order_date,\n        cos.last_order_date,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        CASE \n            WHEN total_spent > 1000 THEN 'High Value'\n            WHEN total_spent BETWEEN 500 AND 1000 THEN 'Medium Value'\n            ELSE 'Low Value'\n        END AS customer_value_segment\n    FROM \n        CustomerOrderStats cos\n    JOIN \n        CustomerDemographics cd ON cos.c_customer_sk = cd.cd_demo_sk\n),\nFinalOutput AS (\n    SELECT \n        ad.c_customer_sk,\n        ad.c_first_name,\n        ad.c_last_name,\n        ad.total_spent,\n        ad.total_orders,\n        ad.first_order_date,\n        ad.last_order_date,\n        ad.cd_gender,\n        ad.cd_marital_status,\n        ad.cd_education_status,\n        ad.customer_value_segment\n    FROM \n        AggregatedData ad\n    ORDER BY \n        total_spent DESC, total_orders DESC\n)\nSELECT \n    *\nFROM \n    FinalOutput\nLIMIT 100;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_ext_discount_amt) AS total_discount,\n        SUM(ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws_order_number) AS order_count\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 AND \n        (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_bill_customer_sk\n),\nCustomerData AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        COUNT(DISTINCT sd.order_count) AS orders,\n        AVG(sd.total_sales) AS avg_order_value,\n        SUM(sd.total_discount) AS total_discount,\n        SUM(sd.total_profit) AS total_profit\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        SalesData sd ON c.c_customer_sk = sd.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender\n)\nSELECT \n    cd.c_customer_sk,\n    cd.c_first_name,\n    cd.c_last_name,\n    cd.cd_gender,\n    cd.orders,\n    cd.avg_order_value,\n    cd.total_discount,\n    cd.total_profit,\n    CASE \n        WHEN cd.total_profit > 10000 THEN 'High Value'\n        WHEN cd.total_profit BETWEEN 5000 AND 10000 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value\nFROM \n    CustomerData cd\nORDER BY \n    cd.total_profit DESC\nLIMIT 100;\n",
  "\nWITH ReturnAggregates AS (\n    SELECT \n        COALESCE(SUM(sr_return_quantity), 0) AS total_return_quantity,\n        COALESCE(SUM(sr_return_amt), 0) AS total_return_amt,\n        COALESCE(SUM(sr_return_tax), 0) AS total_return_tax,\n        sr_item_sk\n    FROM \n        store_returns\n    WHERE \n        sr_returned_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n                                   AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        sr_item_sk\n),\nSalesAggregates AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_sales_quantity,\n        SUM(ws_sales_price) AS total_sales_price,\n        SUM(ws_net_profit) AS total_net_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n),\nItemDetails AS (\n    SELECT \n        i.i_item_sk,\n        i.i_product_name,\n        i.i_current_price,\n        COALESCE(sa.total_sales_quantity, 0) AS total_sales_quantity,\n        COALESCE(ra.total_return_quantity, 0) AS total_return_quantity,\n        COALESCE(sa.total_net_profit, 0) AS total_net_profit,\n        (COALESCE(sa.total_sales_quantity, 0) - COALESCE(ra.total_return_quantity, 0)) AS net_sales,\n        CASE \n            WHEN i.i_current_price IS NULL THEN 'Price Unavailable' \n            ELSE CASE \n                WHEN (COALESCE(sa.total_net_profit, 0) > 0) THEN 'Profitable'\n                ELSE 'Unprofitable'\n            END\n        END AS profit_status\n    FROM \n        item i\n    LEFT JOIN \n        SalesAggregates sa ON i.i_item_sk = sa.ws_item_sk\n    LEFT JOIN \n        ReturnAggregates ra ON i.i_item_sk = ra.sr_item_sk\n)\nSELECT \n    id.i_item_sk,\n    id.i_product_name,\n    id.i_current_price,\n    id.total_sales_quantity,\n    id.total_return_quantity,\n    id.total_net_profit,\n    id.net_sales,\n    id.profit_status,\n    CASE \n        WHEN id.net_sales = 0 THEN 'No Sales' \n        ELSE CASE \n            WHEN id.net_sales < 100 THEN 'Low Sales'\n            WHEN id.net_sales BETWEEN 100 AND 500 THEN 'Medium Sales'\n            ELSE 'High Sales'\n        END\n    END AS sales_category\nFROM \n    ItemDetails id\nWHERE \n    id.profit_status = 'Profitable'\nORDER BY \n    id.i_current_price DESC, \n    id.total_sales_quantity ASC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH AddressSummary AS (\n    SELECT \n        ca_city,\n        ca_state,\n        COUNT(DISTINCT ca_address_sk) AS address_count,\n        COUNT(DISTINCT ca_zip) AS unique_zip_count\n    FROM \n        customer_address\n    GROUP BY \n        ca_city, ca_state\n), \nCustomerDemographics AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        SUM(cd_purchase_estimate) AS total_purchase_estimate\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender, cd_marital_status, cd_education_status\n),\nDateSummary AS (\n    SELECT \n        d_year,\n        COUNT(DISTINCT d_date_sk) AS total_days,\n        SUM(CASE WHEN d_holiday = 'Y' THEN 1 ELSE 0 END) AS holidays_count\n    FROM \n        date_dim\n    GROUP BY \n        d_year\n)\nSELECT \n    A.ca_city,\n    A.ca_state,\n    A.address_count,\n    A.unique_zip_count,\n    C.cd_gender,\n    C.cd_marital_status,\n    C.cd_education_status,\n    C.total_purchase_estimate,\n    D.d_year,\n    D.total_days,\n    D.holidays_count\nFROM \n    AddressSummary A\nJOIN \n    CustomerDemographics C ON A.ca_city = 'New York' AND C.cd_gender = 'F'\nJOIN \n    DateSummary D ON D.d_year = 2023\nORDER BY \n    A.address_count DESC, \n    C.total_purchase_estimate DESC;\n",
  "\nWITH AddressSummary AS (\n    SELECT \n        ca_state, \n        COUNT(DISTINCT ca_address_id) AS unique_addresses, \n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        SUM(CASE WHEN ca_street_type LIKE '%Ave%' THEN 1 ELSE 0 END) AS ave_count,\n        SUM(CASE WHEN ca_street_type LIKE '%St%' THEN 1 ELSE 0 END) AS st_count\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomerDemographics AS (\n    SELECT \n        cd_gender, \n        COUNT(*) AS demographic_count, \n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nItemDescription AS (\n    SELECT \n        i_category, \n        COUNT(*) AS item_count, \n        MIN(LENGTH(i_item_desc)) AS min_item_desc_length, \n        MAX(LENGTH(i_item_desc)) AS max_item_desc_length\n    FROM \n        item\n    GROUP BY \n        i_category\n)\nSELECT \n    a.ca_state,\n    a.unique_addresses,\n    a.avg_street_name_length,\n    a.ave_count,\n    a.st_count,\n    c.cd_gender,\n    c.demographic_count,\n    c.avg_purchase_estimate,\n    i.i_category,\n    i.item_count,\n    i.min_item_desc_length,\n    i.max_item_desc_length\nFROM \n    AddressSummary a\nJOIN \n    CustomerDemographics c ON a.unique_addresses > 0\nJOIN \n    ItemDescription i ON a.unique_addresses < 1000\nORDER BY \n    a.ca_state, c.cd_gender, i.i_category;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt) AS total_returned_amount,\n        COUNT(sr_ticket_number) AS total_return_count\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nWebSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_sales_price) AS total_sales_value,\n        COUNT(ws_order_number) AS total_sales_count,\n        AVG(ws_sales_price) AS average_order_value\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nTopCustomers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(cr.total_returned_quantity, 0) AS total_returned_quantity,\n        COALESCE(cr.total_returned_amount, 0) AS total_returned_amount,\n        COALESCE(ws.total_sales_value, 0) AS total_sales_value,\n        COALESCE(ws.total_sales_count, 0) AS total_sales_count,\n        CASE \n            WHEN COALESCE(ws.total_sales_value, 0) > 0 \n            THEN COALESCE(cr.total_returned_amount, 0) / ws.total_sales_value \n            ELSE NULL \n        END AS return_rate\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN \n        WebSalesSummary ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n)\nSELECT \n    tc.c_customer_sk,\n    tc.c_first_name,\n    tc.c_last_name,\n    tc.total_returned_quantity,\n    tc.total_returned_amount,\n    tc.total_sales_value,\n    tc.total_sales_count,\n    ROUND(tc.return_rate * 100, 2) AS return_rate_percentage,\n    CASE \n        WHEN tc.total_sales_value > 10000 THEN 'High Value'\n        WHEN tc.total_sales_value BETWEEN 5000 AND 10000 THEN 'Medium Value'\n        ELSE 'Low Value' \n    END AS customer_value_category\nFROM \n    TopCustomers tc\nWHERE \n    tc.return_rate > 0.1 OR tc.total_sales_count > 50\nORDER BY \n    return_rate_percentage DESC NULLS LAST\nLIMIT 100;\n",
  "\nWITH AddressStats AS (\n    SELECT \n        ca_state,\n        COUNT(*) AS total_addresses,\n        COUNT(DISTINCT ca_city) AS unique_cities,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomerStats AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS total_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        COUNT(DISTINCT cd_credit_rating) AS unique_credit_ratings\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nSalesStats AS (\n    SELECT \n        ws_ship_date_sk,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_sales_price) AS total_sales,\n        AVG(ws_quantity) AS avg_items_per_order\n    FROM \n        web_sales\n    WHERE \n        ws_ship_date_sk >= (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023)\n        AND ws_ship_date_sk <= (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_ship_date_sk\n)\nSELECT \n    ads.ca_state,\n    ads.total_addresses,\n    ads.unique_cities,\n    ads.avg_street_name_length,\n    cust.cd_gender,\n    cust.total_customers,\n    cust.avg_purchase_estimate,\n    sales.total_orders,\n    sales.total_sales,\n    sales.avg_items_per_order\nFROM \n    AddressStats ads\nJOIN \n    CustomerStats cust ON 1=1\nJOIN \n    SalesStats sales ON 1=1\nORDER BY \n    ads.total_addresses DESC, \n    cust.total_customers DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_return_quantity,\n        SUM(sr_return_amt_inc_tax) AS total_return_amount,\n        SUM(sr_return_tax) AS total_tax\n    FROM store_returns\n    GROUP BY sr_customer_sk\n),\nTopCustomers AS (\n    SELECT \n        cr.sr_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cr.total_return_quantity,\n        cr.total_return_amount\n    FROM CustomerReturns cr\n    JOIN customer c ON cr.sr_customer_sk = c.c_customer_sk\n    WHERE cr.total_return_quantity > (\n        SELECT AVG(total_return_quantity) \n        FROM CustomerReturns\n    )\n),\nSalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_quantity) AS total_sales_quantity,\n        SUM(ws_ext_sales_price) AS total_sales_amount\n    FROM web_sales\n    GROUP BY ws_bill_customer_sk\n),\nFinalReport AS (\n    SELECT \n        tc.sr_customer_sk,\n        tc.c_first_name,\n        tc.c_last_name,\n        COALESCE(sd.total_sales_quantity, 0) AS total_sales_quantity,\n        COALESCE(sd.total_sales_amount, 0) AS total_sales_amount,\n        tc.total_return_quantity,\n        tc.total_return_amount\n    FROM TopCustomers tc\n    LEFT JOIN SalesData sd ON tc.sr_customer_sk = sd.ws_bill_customer_sk\n)\nSELECT \n    fr.c_first_name,\n    fr.c_last_name,\n    fr.total_sales_quantity,\n    fr.total_sales_amount,\n    fr.total_return_quantity,\n    fr.total_return_amount,\n    (fr.total_sales_amount - fr.total_return_amount) AS net_sales_amount\nFROM FinalReport fr\nWHERE fr.total_sales_quantity > 10\nORDER BY net_sales_amount DESC;\n",
  "WITH CustomerReturns AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COUNT(DISTINCT wr.wr_order_number) AS total_web_returns,\n        SUM(wr.wr_return_amt_inc_tax) AS total_web_return_amount,\n        SUM(wr.wr_return_quantity) AS total_web_return_qty\n    FROM\n        customer c\n    LEFT JOIN \n        web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nRecentSales AS (\n    SELECT\n        ws.ws_ship_customer_sk,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    WHERE \n        ws.ws_sold_date_sk > (\n            SELECT MAX(d.d_date_sk) \n            FROM date_dim d \n            WHERE d.d_date = cast('2002-10-01' as date) - INTERVAL '30' DAY\n        )\n    GROUP BY \n        ws.ws_ship_customer_sk\n),\nFinalReport AS (\n    SELECT \n        cr.c_customer_sk,\n        cr.c_first_name,\n        cr.c_last_name,\n        COALESCE(rs.total_sales, 0) AS total_sales_last_30_days,\n        cr.total_web_returns,\n        cr.total_web_return_amount,\n        cr.total_web_return_qty\n    FROM \n        CustomerReturns cr\n    LEFT JOIN \n        RecentSales rs ON cr.c_customer_sk = rs.ws_ship_customer_sk\n)\nSELECT \n    f.c_customer_sk,\n    f.c_first_name,\n    f.c_last_name,\n    f.total_sales_last_30_days,\n    f.total_web_returns,\n    f.total_web_return_amount,\n    f.total_web_return_qty,\n    CASE \n        WHEN f.total_web_return_amount > 1000 THEN 'High Return Value'\n        WHEN f.total_web_returns > 10 THEN 'Frequent Returner'\n        ELSE 'Normal Customer'\n    END AS customer_category\nFROM \n    FinalReport f\nWHERE \n    f.total_web_return_qty > 0 OR f.total_sales_last_30_days > 0\nORDER BY \n    f.total_web_return_amount DESC, f.total_sales_last_30_days DESC;",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS return_count,\n        SUM(sr_return_amt) AS total_return_amt,\n        SUM(sr_return_quantity) AS total_return_quantity\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n), WebSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk,\n        COUNT(DISTINCT ws_order_number) AS order_count,\n        SUM(ws_net_paid) AS total_sales_amt,\n        AVG(ws_sales_price) AS avg_price\n    FROM \n        web_sales\n    WHERE \n        ws_ship_date_sk IS NOT NULL\n    GROUP BY \n        ws_bill_customer_sk\n), TopCustomers AS (\n    SELECT \n        c.c_customer_id,\n        COALESCE(CR.return_count, 0) AS return_count,\n        COALESCE(WS.order_count, 0) AS order_count,\n        WS.total_sales_amt,\n        CR.total_return_amt,\n        CASE \n            WHEN WS.total_sales_amt > 0 THEN (CR.total_return_amt / WS.total_sales_amt) * 100\n            ELSE NULL \n        END AS return_rate\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns CR ON c.c_customer_sk = CR.sr_customer_sk\n    LEFT JOIN \n        WebSalesSummary WS ON c.c_customer_sk = WS.ws_bill_customer_sk\n)\nSELECT \n    TC.c_customer_id,\n    TC.return_count,\n    TC.order_count,\n    TC.total_sales_amt,\n    TC.total_return_amt,\n    CASE \n        WHEN TC.order_count < 5 THEN 'Low Engagement'\n        WHEN TC.order_count BETWEEN 5 AND 15 THEN 'Moderate Engagement'\n        ELSE 'High Engagement'\n    END AS engagement_level,\n    TC.return_rate,\n    CASE \n        WHEN TC.return_rate IS NULL THEN 'No Sales'\n        WHEN TC.return_rate > 20 THEN 'High Return Rate'\n        ELSE 'Normal Return Rate'\n    END AS return_rate_category\nFROM \n    TopCustomers TC\nWHERE \n    TC.total_sales_amt > 1000\nORDER BY \n    TC.total_sales_amt DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(cr.cr_return_quantity) AS total_returned_items,\n        SUM(cr.cr_return_amount) AS total_return_amount\n    FROM\n        customer c\n    JOIN\n        catalog_returns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nPromotionsApplied AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS total_sales,\n        SUM(ws.ws_sales_price - ws.ws_ext_discount_amt) AS net_sales\n    FROM\n        web_sales ws\n    GROUP BY \n        ws.ws_bill_customer_sk\n),\nCustomerSummary AS (\n    SELECT \n        cr.c_customer_sk,\n        cr.c_first_name,\n        cr.c_last_name,\n        COALESCE(cr.total_returned_items, 0) AS total_returned_items,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        pa.total_sales,\n        pa.net_sales\n    FROM \n        CustomerReturns cr\n    LEFT JOIN \n        PromotionsApplied pa ON cr.c_customer_sk = pa.ws_bill_customer_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_returned_items,\n    cs.total_return_amount,\n    cs.total_sales,\n    cs.net_sales,\n    COALESCE(cs.total_return_amount / NULLIF(cs.total_sales, 0), 0) AS return_to_sales_ratio\nFROM \n    CustomerSummary cs\nORDER BY \n    return_to_sales_ratio DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH AddressMetrics AS (\n    SELECT \n        ca_city,\n        ca_state,\n        COUNT(*) AS total_addresses,\n        SUM(CASE WHEN ca_street_name LIKE '%Ave%' THEN 1 ELSE 0 END) AS ave_streets,\n        AVG(CAST(ca_zip AS INTEGER)) AS avg_zip\n    FROM \n        customer_address\n    GROUP BY \n        ca_city, ca_state\n), GenderMetrics AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS total_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependents\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n), SalesMetrics AS (\n    SELECT \n        ss_store_sk,\n        SUM(ss_sales_price) AS total_sales,\n        SUM(ss_quantity) AS total_items_sold\n    FROM \n        store_sales\n    GROUP BY \n        ss_store_sk\n), CombinedMetrics AS (\n    SELECT \n        a.ca_city, \n        a.ca_state, \n        a.total_addresses, \n        a.ave_streets, \n        a.avg_zip, \n        g.cd_gender, \n        g.total_customers, \n        g.avg_purchase_estimate, \n        g.total_dependents, \n        s.total_sales, \n        s.total_items_sold\n    FROM \n        AddressMetrics a\n    JOIN \n        GenderMetrics g ON a.ca_city = g.cd_gender\n    JOIN \n        SalesMetrics s ON a.total_addresses = s.total_items_sold\n)\nSELECT \n    cm.ca_city, \n    cm.ca_state, \n    cm.total_addresses,\n    cm.ave_streets,\n    cm.avg_zip,\n    cm.cd_gender,\n    cm.total_customers,\n    cm.avg_purchase_estimate,\n    cm.total_dependents,\n    cm.total_sales,\n    cm.total_items_sold\nFROM \n    CombinedMetrics cm\nORDER BY \n    cm.total_sales DESC, \n    cm.total_addresses DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_returned_date_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt_inc_tax) AS total_return_amount\n    FROM \n        store_returns\n    GROUP BY \n        sr_returned_date_sk\n),\nSalesData AS (\n    SELECT \n        ws_sold_date_sk,\n        COUNT(ws_order_number) AS total_sales,\n        SUM(ws_sales_price) AS total_sales_amount,\n        SUM(ws_net_profit) AS total_net_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_sold_date_sk\n),\nDailyPerformance AS (\n    SELECT \n        d.d_date AS sales_date,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        COALESCE(sd.total_sales, 0) AS total_sales,\n        COALESCE(sd.total_sales_amount, 0) AS total_sales_amount,\n        COALESCE(sd.total_net_profit, 0) AS total_net_profit\n    FROM \n        date_dim d\n    LEFT JOIN \n        CustomerReturns cr ON d.d_date_sk = cr.sr_returned_date_sk\n    LEFT JOIN \n        SalesData sd ON d.d_date_sk = sd.ws_sold_date_sk\n)\nSELECT \n    sales_date,\n    total_returns,\n    total_return_amount,\n    total_sales,\n    total_sales_amount,\n    total_net_profit,\n    ROUND((total_sales_amount - total_return_amount) / NULLIF(total_sales_amount, 0) * 100, 2) AS return_rate,\n    ROUND((total_net_profit / NULLIF(total_sales_amount, 0)) * 100, 2) AS profit_margin\nFROM \n    DailyPerformance\nWHERE \n    sales_date BETWEEN DATE '2023-01-01' AND DATE '2023-12-31'\nORDER BY \n    sales_date;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_ext_sales_price) AS total_sales\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\n    GROUP BY \n        ws_bill_customer_sk\n),\nDemographics AS (\n    SELECT \n        cd_demo_sk,\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_credit_rating\n    FROM \n        customer_demographics\n),\nCombinedData AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        coalesce(d.cd_gender, 'N/A') AS gender,\n        coalesce(d.cd_marital_status, 'N/A') AS marital_status,\n        coalesce(d.cd_education_status, 'N/A') AS education_status,\n        coalesce(d.cd_credit_rating, 'N/A') AS credit_rating,\n        coalesce(s.total_quantity, 0) AS total_quantity,\n        coalesce(s.total_sales, 0) AS total_sales\n    FROM \n        customer c\n    LEFT JOIN \n        Demographics d ON c.c_current_cdemo_sk = d.cd_demo_sk\n    LEFT JOIN \n        SalesData s ON c.c_customer_sk = s.ws_bill_customer_sk\n)\nSELECT \n    gender,\n    marital_status,\n    education_status,\n    credit_rating,\n    COUNT(*) AS customer_count,\n    SUM(total_quantity) AS total_quantity_sold,\n    SUM(total_sales) AS total_sales_value,\n    AVG(total_sales) AS average_sales_per_customer\nFROM \n    CombinedData\nGROUP BY \n    gender, marital_status, education_status, credit_rating\nORDER BY \n    total_sales_value DESC\nLIMIT 10;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        cr.cr_item_sk,\n        SUM(cr.cr_return_quantity) AS total_returned_quantity,\n        SUM(cr.cr_return_amount) AS total_return_amount\n    FROM \n        catalog_returns cr\n    GROUP BY \n        cr.cr_item_sk\n),\nStoreSales AS (\n    SELECT \n        ss.ss_item_sk,\n        SUM(ss.ss_sales_price) AS total_sales_price,\n        SUM(ss.ss_quantity) AS total_sales_quantity\n    FROM \n        store_sales ss\n    GROUP BY \n        ss.ss_item_sk\n),\nSalesAndReturns AS (\n    SELECT \n        s.ss_item_sk,\n        COALESCE(c.total_returned_quantity, 0) AS total_returned_quantity,\n        COALESCE(s.total_sales_price, 0) AS total_sales_price,\n        COALESCE(s.total_sales_quantity, 0) AS total_sales_quantity\n    FROM \n        StoreSales s\n    LEFT JOIN \n        CustomerReturns c ON s.ss_item_sk = c.cr_item_sk\n)\nSELECT \n    a.i_item_id,\n    a.i_item_desc,\n    COALESCE(s.total_returned_quantity, 0) AS total_returned_quantity,\n    COALESCE(s.total_sales_price, 0) AS total_sales_price,\n    COALESCE(s.total_sales_quantity, 0) AS total_sales_quantity,\n    ROUND((COALESCE(s.total_returned_quantity, 0) * 100.0 / NULLIF(s.total_sales_quantity, 0)), 2) AS return_rate,\n    ROUND((COALESCE(s.total_sales_price, 0) / NULLIF(s.total_sales_quantity, 0)), 2) AS avg_sales_price\nFROM \n    item a\nLEFT JOIN \n    SalesAndReturns s ON a.i_item_sk = s.ss_item_sk\nGROUP BY \n    a.i_item_id,\n    a.i_item_desc,\n    s.total_returned_quantity,\n    s.total_sales_price,\n    s.total_sales_quantity\nORDER BY \n    return_rate DESC, avg_sales_price DESC\nLIMIT 50;\n",
  "WITH AddressStats AS (\n    SELECT \n        ca_city,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        COUNT(DISTINCT ca_street_name) AS unique_street_names,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        SUM(LENGTH(ca_city)) AS total_city_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_city\n),\nDemographicStats AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS total_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependents\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nSalesStats AS (\n    SELECT \n        ws_ship_date_sk,\n        SUM(ws_quantity) AS total_quantity_sold,\n        SUM(ws_ext_sales_price) AS total_sales_revenue,\n        COUNT(DISTINCT ws_order_number) AS distinct_orders\n    FROM \n        web_sales\n    GROUP BY \n        ws_ship_date_sk\n)\nSELECT \n    A.ca_city,\n    A.unique_addresses,\n    A.unique_street_names,\n    A.avg_street_name_length,\n    A.total_city_length,\n    D.cd_gender,\n    D.total_customers,\n    D.avg_purchase_estimate,\n    D.total_dependents,\n    S.ws_ship_date_sk,\n    S.total_quantity_sold,\n    S.total_sales_revenue,\n    S.distinct_orders\nFROM \n    AddressStats A\nJOIN \n    DemographicStats D ON A.ca_city = 'San Francisco'  \nJOIN \n    SalesStats S ON S.ws_ship_date_sk = (SELECT MAX(ws_ship_date_sk) FROM web_sales)  \nORDER BY \n    A.unique_addresses DESC, D.total_customers DESC;",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amount,\n        SUM(sr_return_tax) AS total_return_tax,\n        AVG(sr_return_ship_cost) AS avg_ship_cost\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nSalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_profit) AS total_profit,\n        COUNT(ws_order_number) AS total_orders,\n        AVG(ws_sales_price) AS avg_sales_price\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nReturnDetails AS (\n    SELECT \n        c.c_customer_sk,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        COALESCE(cr.total_return_tax, 0) AS total_return_tax,\n        COALESCE(cr.avg_ship_cost, 0) AS avg_ship_cost,\n        COALESCE(sd.total_profit, 0) AS total_profit,\n        COALESCE(sd.total_orders, 0) AS total_orders,\n        COALESCE(sd.avg_sales_price, 0) AS avg_sales_price\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN \n        SalesData sd ON c.c_customer_sk = sd.ws_bill_customer_sk\n)\nSELECT \n    r.c_customer_sk,\n    r.total_returns,\n    r.total_return_amount,\n    r.total_return_tax,\n    r.avg_ship_cost,\n    r.total_profit,\n    r.total_orders,\n    r.avg_sales_price,\n    CASE \n        WHEN r.total_returns > 0 THEN 'RETURNING'\n        ELSE 'NEW'\n    END AS customer_type\nFROM \n    ReturnDetails r\nWHERE \n    r.total_profit > (SELECT AVG(total_profit) FROM ReturnDetails)\nORDER BY \n    r.total_profit DESC\nLIMIT 50;\n",
  "\nWITH TotalReturns AS (\n    SELECT\n        sr_item_sk,\n        COUNT(*) AS total_return_count,\n        SUM(sr_return_amt) AS total_return_amount,\n        SUM(sr_return_tax) AS total_return_tax\n    FROM store_returns\n    GROUP BY sr_item_sk\n),\nTopReturningItems AS (\n    SELECT\n        tr.sr_item_sk,\n        i.i_item_desc,\n        i.i_current_price,\n        tr.total_return_count,\n        tr.total_return_amount,\n        tr.total_return_tax\n    FROM TotalReturns tr\n    JOIN item i ON tr.sr_item_sk = i.i_item_sk\n    ORDER BY tr.total_return_count DESC\n    LIMIT 10\n),\nSalesData AS (\n    SELECT\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_sales_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales_amount\n    FROM web_sales ws\n    GROUP BY ws.ws_item_sk\n),\nCombinedData AS (\n    SELECT\n        tui.sr_item_sk,\n        tui.i_item_desc,\n        tui.i_current_price,\n        tui.total_return_count,\n        tui.total_return_amount,\n        tui.total_return_tax,\n        COALESCE(sd.total_sales_quantity, 0) AS total_sales_quantity,\n        COALESCE(sd.total_sales_amount, 0) AS total_sales_amount\n    FROM TopReturningItems tui\n    LEFT JOIN SalesData sd ON tui.sr_item_sk = sd.ws_item_sk\n)\nSELECT\n    cd.sr_item_sk,\n    cd.i_item_desc,\n    cd.i_current_price,\n    cd.total_return_count,\n    cd.total_return_amount,\n    cd.total_return_tax,\n    cd.total_sales_quantity,\n    cd.total_sales_amount,\n    (cd.total_sales_amount - cd.total_return_amount) AS net_sales,\n    (cd.total_return_amount / NULLIF(cd.total_sales_amount, 0)) * 100 AS return_percentage\nFROM CombinedData cd\nORDER BY return_percentage DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        cs_item_sk,\n        SUM(cs_quantity) AS total_quantity,\n        SUM(cs_ext_sales_price) AS total_sales,\n        SUM(cs_ext_discount_amt) AS total_discount,\n        SUM(cs_ext_tax) AS total_tax\n    FROM \n        catalog_sales \n    GROUP BY \n        cs_item_sk\n),\nWarehouseInventory AS (\n    SELECT \n        inv.inv_item_sk,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory\n    FROM \n        inventory inv\n    GROUP BY \n        inv.inv_item_sk\n),\nCustomerReturns AS (\n    SELECT \n        sr_item_sk,\n        SUM(sr_return_quantity) AS total_returned,\n        SUM(sr_return_amt) AS total_return_amount,\n        COUNT(DISTINCT sr_ticket_number) AS total_return_count\n    FROM \n        store_returns\n    GROUP BY \n        sr_item_sk\n),\nFinalSales AS (\n    SELECT \n        sd.cs_item_sk,\n        sd.total_quantity,\n        sd.total_sales,\n        sd.total_discount,\n        sd.total_tax,\n        COALESCE(wi.total_inventory, 0) AS total_inventory,\n        COALESCE(cr.total_returned, 0) AS total_returned,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        cr.total_return_count\n    FROM \n        SalesData sd \n    LEFT JOIN \n        WarehouseInventory wi ON sd.cs_item_sk = wi.inv_item_sk\n    LEFT JOIN \n        CustomerReturns cr ON sd.cs_item_sk = cr.sr_item_sk\n)\nSELECT \n    fs.cs_item_sk,\n    fs.total_quantity,\n    fs.total_sales,\n    fs.total_discount,\n    fs.total_tax,\n    fs.total_inventory,\n    fs.total_returned,\n    fs.total_return_amount,\n    fs.total_return_count,\n    ROUND(fs.total_sales - fs.total_discount + fs.total_tax, 2) AS net_sales,\n    CASE \n        WHEN fs.total_sales = 0 THEN 0\n        ELSE ROUND(((fs.total_sales - fs.total_return_amount) / fs.total_sales) * 100, 2)\n    END AS return_rate_perc\nFROM \n    FinalSales fs\nWHERE \n    fs.total_sales > 1000\nORDER BY \n    return_rate_perc DESC\nLIMIT 10;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_returned_date_sk,\n        sr_item_sk,\n        COUNT(sr_ticket_number) AS return_count,\n        SUM(sr_return_amt) AS total_return_amt\n    FROM \n        store_returns\n    GROUP BY \n        sr_returned_date_sk, sr_item_sk\n),\nSalesData AS (\n    SELECT \n        ss_sold_date_sk,\n        ss_item_sk,\n        SUM(ss_quantity) AS total_sales_quantity,\n        SUM(ss_net_paid) AS total_sales_amt\n    FROM \n        store_sales\n    GROUP BY \n        ss_sold_date_sk, ss_item_sk\n),\nCombinedData AS (\n    SELECT \n        s.ss_sold_date_sk AS date_sk,\n        s.ss_item_sk AS item_sk,\n        COALESCE(r.return_count, 0) AS return_count,\n        COALESCE(r.total_return_amt, 0) AS total_return_amt,\n        s.total_sales_quantity,\n        s.total_sales_amt\n    FROM \n        SalesData s\n    LEFT JOIN \n        CustomerReturns r ON s.ss_sold_date_sk = r.sr_returned_date_sk AND s.ss_item_sk = r.sr_item_sk\n),\nAnalysis AS (\n    SELECT \n        item_sk,\n        SUM(total_sales_quantity) AS total_sales_quantity,\n        SUM(total_sales_amt) AS total_sales_amt,\n        SUM(return_count) AS total_returns,\n        SUM(total_return_amt) AS total_return_amt,\n        CASE \n            WHEN SUM(total_sales_amt) > 0 THEN \n                (SUM(total_return_amt) / SUM(total_sales_amt)) * 100 \n            ELSE 0 \n        END AS return_percentage\n    FROM \n        CombinedData\n    GROUP BY \n        item_sk\n)\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    a.total_sales_quantity,\n    a.total_sales_amt,\n    a.total_returns,\n    a.total_return_amt,\n    a.return_percentage\nFROM \n    Analysis a\nJOIN \n    item i ON a.item_sk = i.i_item_sk\nORDER BY \n    a.return_percentage DESC, a.total_sales_amt DESC\nLIMIT 10;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_item_sk,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt) AS total_returned_amount,\n        AVG(sr_return_ship_cost) AS average_ship_cost\n    FROM \n        store_returns\n    GROUP BY \n        sr_item_sk\n),\nSalesData AS (\n    SELECT \n        ws_item_sk,\n        COUNT(ws_order_number) AS total_orders,\n        SUM(ws_sales_price) AS total_sales_amount,\n        SUM(ws_ext_discount_amt) AS total_discounted_amount,\n        SUM(ws_net_profit) AS total_net_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n),\nItemsSummary AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_desc,\n        COALESCE(cr.total_returned_quantity, 0) AS returned_quantity,\n        COALESCE(cr.total_returned_amount, 0) AS returned_amount,\n        sd.total_orders,\n        sd.total_sales_amount,\n        sd.total_discounted_amount,\n        sd.total_net_profit,\n        (CASE \n            WHEN sd.total_sales_amount > 0 THEN \n                ROUND((COALESCE(cr.total_returned_amount, 0) / sd.total_sales_amount) * 100, 2)\n            ELSE 0\n        END) AS return_percentage\n    FROM \n        item i\n    LEFT JOIN \n        CustomerReturns cr ON i.i_item_sk = cr.sr_item_sk\n    LEFT JOIN \n        SalesData sd ON i.i_item_sk = sd.ws_item_sk\n)\nSELECT \n    i.i_item_desc AS item_description,\n    i.returned_quantity,\n    i.returned_amount,\n    i.total_orders,\n    i.total_sales_amount,\n    i.total_discounted_amount,\n    i.total_net_profit,\n    i.return_percentage\nFROM \n    ItemsSummary i\nWHERE \n    i.return_percentage > 5\nORDER BY \n    i.return_percentage DESC\nLIMIT 10;\n",
  "\nWITH CustomerAddressStats AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        COUNT(ca_address_id) AS total_addresses,\n        SUM(LENGTH(ca_street_name)) AS total_street_name_length,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomerDemographicsStats AS (\n    SELECT \n        cd_marital_status,\n        COUNT(DISTINCT cd_demo_sk) AS unique_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependents,\n        SUM(cd_dep_employed_count) AS total_dependents_employed\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_marital_status\n),\nDateStats AS (\n    SELECT \n        d_year,\n        COUNT(DISTINCT d_date_id) AS unique_days,\n        AVG(d_dom) AS avg_day_of_month,\n        COUNT(CASE WHEN d_holiday = 'Y' THEN 1 END) AS total_holidays\n    FROM \n        date_dim\n    GROUP BY \n        d_year\n),\nCombinedStats AS (\n    SELECT \n        ca.ca_state,\n        ca.unique_addresses,\n        ca.total_addresses,\n        ca.total_street_name_length,\n        ca.avg_street_name_length,\n        cd.cd_marital_status,\n        cd.unique_customers,\n        cd.avg_purchase_estimate,\n        cd.total_dependents,\n        cd.total_dependents_employed,\n        ds.d_year,\n        ds.unique_days,\n        ds.avg_day_of_month,\n        ds.total_holidays\n    FROM \n        CustomerAddressStats ca\n    JOIN \n        CustomerDemographicsStats cd ON 1=1\n    JOIN \n        DateStats ds ON 1=1\n)\nSELECT \n    ca_state, \n    unique_addresses, \n    total_addresses, \n    total_street_name_length, \n    avg_street_name_length,\n    cd_marital_status,\n    unique_customers,\n    avg_purchase_estimate,\n    total_dependents,\n    total_dependents_employed,\n    d_year,\n    unique_days,\n    avg_day_of_month,\n    total_holidays\nFROM \n    CombinedStats\nORDER BY \n    ca_state, cd_marital_status, d_year;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ss.ss_quantity,\n    ss.ss_sales_price,\n    d.d_date\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nORDER BY \n    ss.ss_sales_price DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    s.s_store_name, \n    ss.ss_sales_price, \n    ss.ss_quantity, \n    d.d_date \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \n    AND s.s_state = 'CA' \nORDER BY \n    ss.ss_sales_price DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ss.ss_sales_price, \n    ss.ss_quantity, \n    d.d_date\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nORDER BY \n    ss.ss_sales_price DESC\nLIMIT 100;\n",
  "\nSELECT c_first_name, c_last_name, ca_city, s_store_name, ss_sales_price \nFROM customer \nJOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk \nJOIN store ON store_sales.ss_store_sk = store.s_store_sk \nWHERE ca_city = 'San Francisco' AND ss_sales_price > 100 \nORDER BY ss_sales_price DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY ca_state\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers,\n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk\nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk\nWHERE \n    d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_sales_price) AS total_sales, \n    AVG(cs_sales_price) AS avg_catalog_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    catalog_sales cs ON cs.cs_bill_customer_sk = c.c_customer_sk\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk \nWHERE \n    date_dim.d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca.ca_city, \n    COUNT(DISTINCT c.c_customer_sk) AS customer_count, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_ext_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS unique_customers, SUM(ss_sales_price) AS total_sales\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk\nWHERE date_dim.d_year = 2023\nGROUP BY ca_state\nORDER BY total_sales DESC;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address CA\nJOIN \n    customer C ON CA.ca_address_sk = C.c_current_addr_sk\nJOIN \n    store_sales SS ON C.c_customer_sk = SS.ss_customer_sk\nJOIN \n    date_dim D ON SS.ss_sold_date_sk = D.d_date_sk\nWHERE \n    D.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ws_order_number) AS total_orders, \n    AVG(ws_net_profit) AS average_profit\nFROM \n    web_sales\nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk\nJOIN \n    customer ON ws_bill_customer_sk = c_customer_sk\nJOIN \n    customer_demographics ON c_current_cdemo_sk = cd_demo_sk\nWHERE \n    d_year = 2023 AND \n    cd_gender = 'F'\nGROUP BY \n    d_month_seq\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS total_customers,\n    COUNT(DISTINCT s_store_sk) AS total_stores,\n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store s ON c.c_customer_sk = s.s_store_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    COUNT(sr.sr_return_quantity) AS total_returns,\n    SUM(sr.sr_return_amt_inc_tax) AS total_return_value\nFROM \n    customer c\nJOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nJOIN \n    item i ON sr.sr_item_sk = i.i_item_sk\nJOIN \n    date_dim d ON d.d_date_sk = sr.sr_returned_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_return_value DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS total_customers,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk\nWHERE \n    d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ws_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = ws_sold_date_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_city, \n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ws_ext_sales_price) AS total_sales,\n    AVG(cd_purchase_estimate) AS average_purchase_estimate\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2022\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT\n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS unique_customers,\n    SUM(ws_sales_price) AS total_sales,\n    AVG(ws_quantity) AS average_quantity\nFROM\n    customer_address ca\nJOIN\n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    ca_state\nORDER BY\n    total_sales DESC;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ss_sales_price) AS total_sales,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN \n    customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\nWHERE \n    ca_state IN ('CA', 'TX', 'NY')\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = ws_sold_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\n    AND cd.cd_gender = 'F'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ss_net_paid) AS total_sales,\n    AVG(ws_net_profit) AS avg_web_sales_profit\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS unique_customers, SUM(ss_net_profit) AS total_net_profit\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk\nWHERE date_dim.d_year = 2022\nGROUP BY ca_state\nORDER BY total_net_profit DESC;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS num_customers, SUM(ss_sales_price) AS total_sales\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk\nWHERE date_dim.d_year = 2023\nGROUP BY ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count, SUM(ss_net_profit) AS total_net_profit\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk\nWHERE date_dim.d_year = 2023\nGROUP BY ca_state\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(sr_return_quantity) AS total_returns,\n    AVG(ws_sales_price) AS avg_sales_price\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nLEFT JOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nLEFT JOIN \n    web_sales ws ON ws.ws_bill_customer_sk = c.c_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_customers DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS number_of_customers, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN \n    date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk\nWHERE \n    date_dim.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ws_ext_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = web_sales.ws_sold_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca.ca_city, \n    COUNT(DISTINCT c.c_customer_id) AS num_customers, \n    SUM(ss.ss_sales_price) AS total_sales, \n    AVG(ss.ss_net_profit) AS avg_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS avg_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\n    AND cd.cd_gender = 'F'\n    AND cd.cd_marital_status = 'M'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_customers, \n    SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_customers \nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim AS d ON d.d_date_sk = c.c_first_sales_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_customers DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk \nWHERE \n    date_dim.d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count, SUM(ss_sales_price) AS total_sales\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk\nWHERE date_dim.d_year = 2023\nGROUP BY ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS unique_customers,\n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    COUNT(DISTINCT ss.ss_item_sk) AS distinct_items_sold\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    time_dim AS t ON ss.ss_sold_date_sk = t.t_time_sk\nJOIN \n    date_dim AS d ON t.t_time_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca.ca_city,\n    COUNT(DISTINCT c.c_customer_id) AS customer_count,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_ext_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = ws_sold_date_sk \nWHERE \n    date_dim.d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON d.d_date_sk = ws.ws_sold_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS num_customers,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    date_dim AS d ON d.d_date_sk = ss.ss_sold_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_ext_sales_price) AS total_sales \nFROM \n    customer_address AS ca \nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n    MAX(d.d_date) AS max_date,\n    MIN(d.d_date) AS min_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    d.d_month_seq\nORDER BY \n    d.d_month_seq;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS unique_customers, \n    SUM(ws_ext_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS unique_customers, SUM(ws_net_profit) AS total_net_profit\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nJOIN web_sales ON c_customer_sk = ws_bill_customer_sk\nJOIN date_dim ON ws_sold_date_sk = d_date_sk\nWHERE d_year = 2023\nGROUP BY ca_state\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_city,\n    COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n    SUM(ss.ss_quantity) AS total_sales_quantity,\n    SUM(ss.ss_sales_price) AS total_sales_value\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca.ca_city\nORDER BY \n    total_sales_value DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales, \n    AVG(ws_net_profit) AS average_web_profit \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ws_ext_sales_price) AS total_sales\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nJOIN web_sales ON c_customer_sk = ws_bill_customer_sk\nJOIN date_dim ON ws_sold_date_sk = d_date_sk\nWHERE d_year = 2023\nGROUP BY ca_city\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS num_customers,\n    SUM(ws_sales_price) AS total_sales,\n    AVG(ws_quantity) AS average_quantity\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS number_of_customers, \n    SUM(ws_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_ext_sales_price) AS total_sales \nFROM \n    customer_address AS ca \nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk \nWHERE \n    dd.d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk \nWHERE \n    date_dim.d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_country, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_paid) AS total_sales, \n    SUM(ws_net_profit) AS total_web_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_country\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count, SUM(ws_net_profit) AS total_profit \nFROM customer_address \nJOIN customer ON ca_address_sk = c_current_addr_sk \nJOIN web_sales ON c_customer_sk = ws_bill_customer_sk \nJOIN date_dim ON ws_sold_date_sk = d_date_sk \nWHERE d_date BETWEEN '2023-01-01' AND '2023-12-31' \nGROUP BY ca_city \nORDER BY total_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_sales_price) AS total_sales,\n    AVG(ws_sales_price) AS average_web_sales\nFROM \n    customer_address a\nJOIN \n    customer c ON a.ca_address_sk = c.c_current_addr_sk\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_quantity) AS total_sales_quantity, \n    SUM(ss_net_paid) AS total_sales_amount \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales_amount DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk \nWHERE \n    date_dim.d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ss_sales_price) AS total_sales\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk\nGROUP BY ca_state\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_city, \n    COUNT(DISTINCT c.c_customer_id) AS customer_count, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    ca.ca_city \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS num_customers, SUM(ss_net_profit) AS total_net_profit\nFROM customer_address \nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk\nWHERE date_dim.d_year = 2023\nGROUP BY ca_state\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_state, \n    COUNT(DISTINCT c.c_customer_id) AS customer_count,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    SUM(ws_net_paid) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = ws_sold_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS unique_customers, \n    SUM(ws_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    s.s_state = 'CA' \n    AND cd.cd_gender = 'F' \n    AND cd.cd_marital_status = 'M'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ss_sales_price) AS total_sales,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nJOIN \n    customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk \nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ss_sales_price) AS total_sales\nFROM\n    customer_address\nJOIN\n    customer ON ca_address_sk = c_current_addr_sk\nJOIN\n    store_sales ON c_customer_sk = ss_customer_sk\nJOIN\n    date_dim ON ss_sold_date_sk = d_date_sk\nWHERE\n    d_year = 2023\nGROUP BY\n    ca_state\nORDER BY\n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(CASE WHEN ws.ws_sold_date_sk BETWEEN 20220101 AND 20221231 THEN ws.ws_quantity ELSE 0 END) AS total_web_sales_quantity,\n    SUM(CASE WHEN ss.ss_sold_date_sk BETWEEN 20220101 AND 20221231 THEN ss.ss_quantity ELSE 0 END) AS total_store_sales_quantity,\n    SUM(CASE WHEN cr.cr_returned_date_sk BETWEEN 20220101 AND 20221231 THEN cr.cr_return_quantity ELSE 0 END) AS total_catalog_returns_quantity\nFROM \n    customer c\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    catalog_returns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_web_sales_quantity DESC, total_store_sales_quantity DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS num_customers, \n    SUM(ws_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    ca.ca_state = 'CA' \n    AND cd.cd_marital_status = 'M' \n    AND cd.cd_gender = 'F'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk \nWHERE \n    date_dim.d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price,\n    MAX(ss.ss_sales_price) AS max_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\n    AND cd.cd_gender = 'F'\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ws_sales_price) AS total_sales\nFROM customer_address\nJOIN customer ON ca_address_sk = c_current_addr_sk\nJOIN web_sales ON ws_bill_customer_sk = c_customer_sk\nJOIN date_dim ON ws_sold_date_sk = d_date_sk\nWHERE d_year = 2023\nGROUP BY ca_state\nORDER BY total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS num_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ws_ext_sales_price) AS total_sales\nFROM\n    customer_address\nJOIN\n    customer ON customer_address.ca_address_sk = customer.c_current_addr_sk\nJOIN\n    web_sales ON customer.c_customer_sk = web_sales.ws_bill_customer_sk\nJOIN\n    date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk\nGROUP BY\n    ca_state\nHAVING\n    SUM(ws_ext_sales_price) > 10000\nORDER BY\n    total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ws_quantity) AS total_sales_quantity, \n    AVG(ws_sales_price) AS average_sales_price\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk\nJOIN \n    date_dim ON date_dim.d_date_sk = web_sales.ws_sold_date_sk\nWHERE \n    date_dim.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_sales_quantity DESC;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS unique_customers,\n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk\nJOIN \n    date_dim ON date_dim.d_date_sk = ws_sold_date_sk\nWHERE \n    d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    CA.ca_city, \n    COUNT(DISTINCT C.c_customer_sk) AS num_customers, \n    SUM(SS.ss_sales_price) AS total_sales\nFROM \n    customer C\nJOIN \n    customer_address CA ON C.c_current_addr_sk = CA.ca_address_sk\nJOIN \n    store_sales SS ON C.c_customer_sk = SS.ss_customer_sk\nJOIN \n    date_dim D ON SS.ss_sold_date_sk = D.d_date_sk\nWHERE \n    D.d_year = 2023\nGROUP BY \n    CA.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_city, \n    COUNT(DISTINCT c.c_customer_sk) AS total_customers, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON ws.ws_bill_customer_sk = c.c_customer_sk \nJOIN \n    date_dim d ON d.d_date_sk = ws.ws_sold_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk\nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_sales_price\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_county, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    SUM(ws_net_paid) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk\nJOIN \n    date_dim ON date_dim.d_date_sk = ws_sold_date_sk\nWHERE \n    date_dim.d_year = 2023\nGROUP BY \n    ca_county\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ws_quantity) AS total_quantity_sold,\n    SUM(ws_sales_price) AS total_sales_value\nFROM\n    customer_address\nJOIN\n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN\n    web_sales ON customer.c_customer_sk = web_sales.ws_bill_customer_sk\nJOIN\n    date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk\nWHERE\n    d_year = 2023\nGROUP BY\n    ca_state\nORDER BY\n    total_sales_value DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    cd.cd_gender = 'F' \n    AND d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_sales_price) AS total_sales, \n    AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_customers,\n    SUM(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_customers\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\nJOIN \n    date_dim ON date_dim.d_date_sk = customer.c_first_sales_date_sk\nWHERE \n    date_dim.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_customers DESC;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ws_order_number) AS total_orders, \n    AVG(ws_net_paid_inc_tax) AS avg_order_value \nFROM \n    web_sales \nJOIN \n    web_site ON web_sales.ws_web_site_sk = web_site.web_site_sk \nJOIN \n    customer ON web_sales.ws_bill_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk \nWHERE \n    date_dim.d_year = 2023 \n    AND customer.c_current_cdemo_sk IS NOT NULL \nGROUP BY \n    web_site.web_name \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_sk) AS unique_customers,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(cd.cd_purchase_estimate) AS average_purchase_estimate,\n    d.d_year AS sale_year\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nGROUP BY \n    d.d_year\nORDER BY \n    sale_year DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = ws_sold_date_sk\nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT\n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS total_customers,\n    SUM(ws_quantity) AS total_sales_quantity,\n    SUM(ws_sales_price) AS total_sales_amount\nFROM\n    customer_address ca\nJOIN\n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2022\nGROUP BY\n    ca_state\nORDER BY\n    total_sales_amount DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address CA \nJOIN \n    customer C ON CA.ca_address_sk = C.c_current_addr_sk \nJOIN \n    store_sales SS ON C.c_customer_sk = SS.ss_customer_sk \nJOIN \n    date_dim DD ON SS.ss_sold_date_sk = DD.d_date_sk \nWHERE \n    DD.d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_city,\n    COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS unique_customers, \n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca.ca_city,\n    COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n    AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA' \nGROUP BY \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_ext_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ws_net_profit) AS total_net_profit \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk \nWHERE \n    dd.d_year = 2023 \nGROUP BY \n    ca_city \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customers_count, \n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ss_net_profit) AS total_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_id) AS Unique_Customers,\n    SUM(ws.ws_sales_price) AS Total_Sales_Amount,\n    AVG(cd.cd_purchase_estimate) AS Average_Purchase_Estimate,\n    d.d_year AS Sales_Year\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    d.d_year\nORDER BY \n    d.d_year;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ss_sales_price) AS total_sales,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_net_profit) AS total_net_profit \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    ca_city \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_sk) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT\n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(store_sales.ss_sales_price) AS total_sales\nFROM\n    customer_address\nJOIN\n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN\n    store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk\nJOIN\n    date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\nWHERE\n    date_dim.d_year = 2023\nGROUP BY\n    ca_state\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk\nWHERE \n    d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS total_customers,\n    SUM(ws_ext_sales_price) AS total_sales,\n    AVG(i_current_price) AS average_item_price\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    item i ON ws.ws_item_sk = i.i_item_sk\nWHERE \n    ca_state IN ('CA', 'TX', 'NY')\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN \n    date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk\nWHERE \n    d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(ss_net_profit) AS total_profit\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk\nWHERE date_dim.d_year = 2023\nGROUP BY ca_state\nORDER BY total_profit DESC;\n",
  "\nSELECT \n    COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(cd.cd_purchase_estimate) AS average_purchase_estimate,\n    MAX(ss.ss_sales_price) AS max_sales_price,\n    MIN(ss.ss_sales_price) AS min_sales_price\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    d.d_month_seq\nORDER BY \n    d.d_month_seq;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS unique_customers,\n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_id) AS unique_customers,\n    SUM(ws_net_profit) AS total_net_profit,\n    AVG(ws_net_paid) AS average_net_paid\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_id) AS customer_count, SUM(ss_net_profit) AS total_profit\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk\nWHERE d_year = 2022\nGROUP BY ca_state\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss_ticket_number) AS transaction_count,\n    MAX(ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca.ca_city,\n    COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ss_net_profit) AS total_profit\nFROM \n    customer_address a\nJOIN \n    customer c ON a.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ss_sales_price) AS total_sales,\n    AVG(ss_net_profit) AS average_profit\nFROM\n    customer_address\nJOIN\n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN\n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN\n    date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk\nWHERE\n    date_dim.d_year = 2023\nGROUP BY\n    ca_state\nORDER BY\n    total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_net_profit) AS total_profit\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk \nWHERE \n    date_dim.d_year = 2022\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ss_net_paid) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_city, \n    COUNT(DISTINCT c.c_customer_id) AS customer_count, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_city, \n    COUNT(DISTINCT c.c_customer_id) AS total_customers, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS total_customers, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS unique_customers,\n    SUM(ss_sales_price) AS total_sales,\n    AVG(ss_sales_price) AS avg_sales_price\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_state, COUNT(DISTINCT c_customer_sk) AS num_customers, SUM(ss_net_profit) AS total_profit\nFROM customer_address\nJOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nJOIN store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk\nWHERE date_dim.d_year = 2022\nGROUP BY ca_state\nORDER BY total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS num_customers,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    customer_demographics ON c_current_cdemo_sk = cd_demo_sk\nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_city,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    store_sales AS ss ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    date_dim AS d ON d.d_date_sk = ss.ss_sold_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ws_net_profit) AS total_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_net_profit) AS total_net_profit \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk \nWHERE \n    date_dim.d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers, \n    SUM(ws_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address ca \nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk \nWHERE \n    dd.d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers,\n    SUM(ss_sales_price) AS total_sales,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    customer_demographics ON c_current_cdemo_sk = cd_demo_sk\nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS customer_count, \n    SUM(ss_quantity) AS total_quantity_sold, \n    AVG(ws_net_profit) AS avg_net_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    ca_state\nORDER BY \n    customer_count DESC\nLIMIT 100;\n",
  "\nSELECT ca_city, COUNT(DISTINCT c_customer_id) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE dd.d_year = 2022\nGROUP BY ca_city\nORDER BY customer_count DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    SUM(ws_net_profit) AS total_profit \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = ws_sold_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_profit DESC;\n",
  "\nSELECT \n    ca_city, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk \nJOIN \n    date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk \nWHERE \n    date_dim.d_year = 2023 \nGROUP BY \n    ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS num_customers, \n    SUM(ss_net_profit) AS total_net_profit\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_net_profit DESC;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    SUM(ss_sales_price) AS total_sales\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk\nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk\nWHERE \n    d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    SUM(ws_sales_price) AS total_sales,\n    AVG(cd_purchase_estimate) AS average_purchase_estimate\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    ca_state IN ('CA', 'TX', 'NY')\nGROUP BY \n    ca_state\nORDER BY \n    customer_count DESC;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    SUM(ss_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    store_sales ON c_customer_sk = ss_customer_sk \nJOIN \n    date_dim ON ss_sold_date_sk = d_date_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC;\n",
  "\nSELECT\n    ca.ca_city,\n    COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_paid) AS avg_order_value,\n    SUM(ws.ws_net_profit) AS total_profit\nFROM\n    customer_address ca\nJOIN\n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE\n    dd.d_year = 2023\n    AND (LOWER(ca.ca_city) LIKE '%city%' OR LOWER(ca.ca_city) LIKE '%town%')\n    AND ws.ws_net_profit > 0\nGROUP BY\n    ca.ca_city\nORDER BY\n    total_profit DESC\nLIMIT 10;\n",
  "SELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS unique_customers,\n    SUM(ws_quantity) AS total_quantity_sold,\n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2001 AND \n    d.d_moy IN (11, 12) \nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    AVG(ws.ws_sales_price) AS average_sales_price,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_paid) AS avg_net_paid\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022 \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS num_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    cd.cd_gender,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c \nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, cd.cd_gender \nORDER BY \n    total_net_profit DESC \nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS num_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_sales_quantity,\n    SUM(ss.ss_ext_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS avg_transaction_value\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON d.d_date_sk = ss.ss_sold_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    sum(ss.ss_sales_price) as total_sales,\n    avg(cd.cd_purchase_estimate) as avg_purchase_estimate,\n    count(distinct ss.ss_ticket_number) as total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT \n    10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_ext_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    ca.ca_city \nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales, \n    cd_gender, \n    d_year \nFROM \n    web_sales \nJOIN \n    customer ON ws_bill_customer_sk = c_customer_sk \nJOIN \n    customer_demographics ON c_current_cdemo_sk = cd_demo_sk \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nGROUP BY \n    cd_gender, d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_net_profit) AS total_profit,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS sales_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT c.c_customer_id, \n       cd.cd_gender, \n       SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer c\nJOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2022\nGROUP BY c.c_customer_id, cd.cd_gender\nORDER BY total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    sum(ss.ss_sales_price) AS total_sales,\n    count(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    cd.cd_gender,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    COUNT(ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, cd.cd_gender\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS number_of_orders\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE\n    dd.d_year = 2023\nGROUP BY\n    c.c_customer_id, ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_net_paid) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    cd.cd_gender,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id,\n    ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid) AS total_revenue\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nHAVING \n    SUM(ws.ws_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS orders_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ws.ws_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    cd.cd_gender,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM\n    customer AS c\nJOIN\n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, ca.ca_city\nORDER BY\n    total_revenue DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item AS i ON ss.ss_item_sk = i.i_item_sk\nWHERE \n    ca.ca_state = 'NY' \n    AND i.i_current_price > 20.00\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ss.ss_net_profit) > 1000.00\nORDER BY \n    total_net_profit DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk \nWHERE \n    dd.d_year = 2023 \nGROUP BY \n    c.c_customer_id, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    MIN(d.d_date) AS first_purchase_date,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk \nWHERE \n    dd.d_year = 2023 \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ss.ss_ticket_number) AS sales_count,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count,\n    AVG(ss.ss_net_paid) AS average_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_net_paid) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    cd.cd_gender,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, \n    ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_state,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales,\n    AVG(ws.ws_net_profit) AS average_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_profit) AS total_net_profit \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(w.ws_ext_sales_price) AS total_sales,\n    AVG(i.i_current_price) AS avg_item_price\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales w ON c.c_customer_sk = w.ws_bill_customer_sk\nJOIN \n    item i ON w.ws_item_sk = i.i_item_sk\nWHERE \n    ca.ca_state = 'NY'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, SUM(ws.ws_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2022\nGROUP BY c.c_customer_id, ca.ca_city\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\n    AND ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    a.ca_city,\n    d.d_year,\n    SUM(s.ws_sales_price) AS total_sales\nFROM \n    customer_address AS a \nJOIN \n    customer AS c ON a.ca_address_sk = c.c_current_addr_sk \nJOIN \n    web_sales AS s ON c.c_customer_sk = s.ws_bill_customer_sk \nJOIN \n    date_dim AS d ON s.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2022 \nGROUP BY \n    a.ca_city, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT a.ca_city, d.d_year, SUM(ss.ss_sales_price) AS total_sales\nFROM customer_address a\nJOIN customer c ON a.ca_address_sk = c.c_current_addr_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year = 2023\nGROUP BY a.ca_city, d.d_year\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    C.c_customer_id,\n    CA.ca_city,\n    SUM(WS.ws_sales_price) AS total_sales\nFROM \n    customer C\nJOIN \n    customer_address CA ON C.c_current_addr_sk = CA.ca_address_sk\nJOIN \n    web_sales WS ON C.c_customer_sk = WS.ws_bill_customer_sk\nJOIN \n    date_dim D ON WS.ws_sold_date_sk = D.d_date_sk\nWHERE \n    D.d_year = 2023\nGROUP BY \n    C.c_customer_id, CA.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_net_paid) AS total_net_paid\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_net_paid DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ws.ws_sales_price) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id,\n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales,\n    AVG(ws.ws_sales_price) AS avg_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    COUNT(DISTINCT ws.ws_order_number) > 10\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    C.c_customer_id,\n    CA.ca_city,\n    SUM(WS.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT WS.ws_order_number) AS order_count\nFROM \n    customer C\nJOIN \n    customer_address CA ON C.c_current_addr_sk = CA.ca_address_sk\nJOIN \n    web_sales WS ON C.c_customer_sk = WS.ws_bill_customer_sk\nJOIN \n    date_dim D ON WS.ws_sold_date_sk = D.d_date_sk\nWHERE \n    D.d_year = 2023\nGROUP BY \n    C.c_customer_id, CA.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN\n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca.ca_city,\n    ca.ca_state,\n    COUNT(DISTINCT c.c_customer_id) AS total_customers,\n    AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state IN ('CA', 'TX', 'NY')\n    AND cd.cd_marital_status = 'M'\n    AND cd.cd_gender = 'F'\nGROUP BY \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id AS customer_id,\n    ca.ca_city AS customer_city,\n    SUM(ws.ws_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS average_sales_price,\n    COUNT(DISTINCT ws.ws_ship_date_sk) AS total_days_sold\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 AND \n    ws.ws_net_profit > 100\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ws.ws_net_profit) > 1000\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    SUM(ws.ws_quantity) AS total_quantity_sold, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders, \n    AVG(ws.ws_sales_price) AS avg_sales_price, \n    MAX(ws.ws_ship_date_sk) AS last_shipped_date, \n    COUNT(DISTINCT ws.ws_item_sk) AS unique_items_sold\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023 \n    AND ca.ca_state = 'CA' \n    AND ws.ws_ship_mode_sk IN (\n        SELECT sm.sm_ship_mode_sk \n        FROM ship_mode sm \n        WHERE sm.sm_type = 'Ground'\n    )\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ws.ws_quantity) > 100\nORDER BY \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_city, \n    ca.ca_state, \n    COUNT(DISTINCT c.c_customer_id) AS customer_count, \n    SUM(ws.ws_net_paid) AS total_sales, \n    AVG(ws.ws_net_paid_inc_tax) AS avg_net_paid_inc_tax\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 AND \n    d.d_moy IN (11, 12) \nGROUP BY \n    ca.ca_city, ca.ca_state\nHAVING \n    COUNT(DISTINCT c.c_customer_id) > 100 \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_city, \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS total_customers,\n    SUM(ws_net_paid) AS total_sales,\n    AVG(ws_net_paid) AS avg_order_value,\n    MAX(ws_net_profit) AS max_order_profit,\n    MIN(ws_net_profit) AS min_order_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 AND \n    ca_state IN ('CA', 'TX', 'NY')\nGROUP BY \n    ca_city, ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_net_profit) AS total_profit,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_paid_inc_tax) AS avg_payment\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\n    AND ca.ca_state = 'CA'\n    AND ws.ws_ship_mode_sk IN (SELECT sm_ship_mode_sk FROM ship_mode WHERE sm_type = 'Express')\nGROUP BY \n    c.c_customer_id, ca.ca_city\nHAVING \n    SUM(ws.ws_quantity) > 100\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    d_year,\n    d_month_seq,\n    ca_state\nFROM \n    web_sales \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nJOIN \n    customer ON ws_bill_customer_sk = c_customer_sk \nJOIN \n    customer_address ON c_current_addr_sk = ca_address_sk \nWHERE \n    d_year = 2023 \nGROUP BY \n    d_year, d_month_seq, ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    cd.cd_gender, \n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, cd.cd_gender, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_address_id, \n    d.d_date, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, ca.ca_address_id, d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_spent\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN \n    item i ON ws.ws_item_sk = i.i_item_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT ca_address_id, ca_city, ca_state, COUNT(*) AS customer_count\nFROM customer_address ca\nJOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nLEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE cd.cd_gender = 'F' AND cd.cd_marital_status = 'M'\nGROUP BY ca_address_id, ca_city, ca_state\nORDER BY customer_count DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_state = 'CA' \n    AND cd.cd_marital_status = 'M'\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    d.d_year,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer AS c \nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    cd.cd_gender,\n    cd.cd_marital_status\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, cd.cd_gender, cd.cd_marital_status\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    cd.cd_gender, \n    cd.cd_marital_status, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, cd.cd_gender, cd.cd_marital_status\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    dd.d_year,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, dd.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    d.d_year\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    d.d_year,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    d.d_date,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    d.d_year,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year,\n    w.w_warehouse_id\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN \n    warehouse w ON ss.ss_store_sk = w.w_warehouse_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year, w.w_warehouse_id\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    SUM(ws_ext_sales_price) AS total_sales,\n    d_year,\n    d_month_seq,\n    ca_state\nFROM \n    web_sales\nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk\nJOIN \n    customer ON ws_bill_customer_sk = c_customer_sk\nJOIN \n    customer_address ON c_current_addr_sk = ca_address_sk\nGROUP BY \n    d_year, \n    d_month_seq, \n    ca_state\nORDER BY \n    d_year, \n    d_month_seq, \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(CASE WHEN ws.ws_item_sk IS NOT NULL THEN ws.ws_sales_price ELSE 0 END) AS total_web_sales,\n    SUM(CASE WHEN cs.cs_item_sk IS NOT NULL THEN cs.cs_sales_price ELSE 0 END) AS total_catalog_sales,\n    SUM(CASE WHEN ss.ss_item_sk IS NOT NULL THEN ss.ss_sales_price ELSE 0 END) AS total_store_sales\nFROM \n    customer c\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nLEFT JOIN \n    catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_web_sales DESC, total_catalog_sales DESC, total_store_sales DESC\nLIMIT 1000;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    a.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, a.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_quantity) AS total_quantity,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year,\n    w.w_warehouse_name\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN \n    warehouse w ON ss.ss_store_sk = w.w_warehouse_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, d.d_year, w.w_warehouse_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    d.d_year,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    a.ca_state,\n    d.d_year\nFROM\n    customer c\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, a.ca_state, d.d_year\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    i.i_item_id,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_date\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, i.i_item_id, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN \n    time_dim AS t ON ss.ss_sold_time_sk = t.t_time_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    d.d_date,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id, ca.ca_city, d.d_date\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    d.d_year,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    cd.cd_gender,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS num_orders\nFROM \n    customer c\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    d.d_year,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(COALESCE(ss.ss_sales_price, 0) + COALESCE(cs.cs_sales_price, 0) + COALESCE(ws.ws_sales_price, 0)) AS total_sales\nFROM \n    customer c\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE \n    ca.ca_state = 'CA'\n    AND cd.cd_marital_status = 'M'\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_ship_customer_sk = c.c_customer_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(ss.ss_ticket_number) AS number_of_purchases,\n    ca.ca_city,\n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    COUNT(s.ss_ticket_number) AS total_sales,\n    SUM(s.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales s ON c.c_customer_sk = s.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    ca.ca_state = 'CA' \n    AND cd.cd_gender = 'F'\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city, \n    cd.cd_gender\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    s.s_store_name, \n    d.d_year\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    store AS s ON ss.ss_store_sk = s.s_store_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, s.s_store_name, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 1000;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    d.d_year,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN\n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE\n    d.d_year = 2023\nGROUP BY\n    c.c_customer_id,\n    ca.ca_city,\n    d.d_year\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    d.d_date,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON d.d_date_sk = ss.ss_sold_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    d.d_year,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    sd.d_year,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim sd ON ws.ws_sold_date_sk = sd.d_date_sk\nWHERE \n    sd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, sd.d_year\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    COUNT(ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT c.c_customer_sk, SUM(ss.ss_sales_price) AS total_sales\n    FROM customer c\n    JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY c.c_customer_sk\n),\nTopCustomers AS (\n    SELECT c.c_customer_sk, cs.total_sales\n    FROM CustomerSales cs\n    JOIN customer c ON cs.c_customer_sk = c.c_customer_sk\n    ORDER BY cs.total_sales DESC\n    LIMIT 10\n)\nSELECT c.c_customer_id, c.c_first_name, c.c_last_name, tc.total_sales\nFROM TopCustomers tc\nJOIN customer c ON tc.c_customer_sk = c.c_customer_sk;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, cd.cd_gender, SUM(ss.ss_net_profit) AS total_net_profit\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, cd.cd_gender, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, cd.cd_gender, SUM(ss.ss_net_paid) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    cd.cd_gender, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, cd.cd_gender, COUNT(ss.ss_ticket_number) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    cd.cd_gender, \n    SUM(ss.ss_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    cd.cd_gender, \n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    COUNT(ss.ss_ticket_number) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, d.d_year, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nGROUP BY c.c_customer_id, ca.ca_city, d.d_year\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_city, \n    cd.cd_gender, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY \n    c.c_customer_id, \n    ca.ca_city, \n    cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT c.c_customer_id, ca.ca_city, d.d_date, SUM(ss.ss_sales_price) AS total_sales\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nGROUP BY c.c_customer_id, ca.ca_city, d.d_date\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nSELECT\n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM\n    customer AS c\nJOIN\n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN\n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nGROUP BY\n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY\n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH customer_data AS (\n    SELECT c.c_customer_sk,\n           c.c_first_name,\n           c.c_last_name,\n           cd.cd_gender,\n           cd.cd_marital_status,\n           cd.cd_education_status,\n           cd.cd_purchase_estimate,\n           cd.cd_credit_rating,\n           cd.cd_dep_count,\n           cd.cd_dep_employed_count,\n           cd.cd_dep_college_count,\n           ca.ca_city,\n           ca.ca_state,\n           ca.ca_country\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n),\nsales_data AS (\n    SELECT ws.ws_ship_customer_sk,\n           SUM(ws.ws_net_profit) AS total_net_profit,\n           COUNT(ws.ws_order_number) AS total_orders,\n           COUNT(DISTINCT ws.ws_item_sk) AS unique_items_sold\n    FROM web_sales ws\n    GROUP BY ws.ws_ship_customer_sk\n),\nsummary_data AS (\n    SELECT cd.c_customer_sk,\n           cd.c_first_name,\n           cd.c_last_name,\n           cd.cd_gender,\n           cd.cd_marital_status,\n           cd.cd_education_status,\n           cd.cd_purchase_estimate,\n           cd.cd_credit_rating,\n           sd.total_net_profit,\n           sd.total_orders,\n           sd.unique_items_sold\n    FROM customer_data cd\n    LEFT JOIN sales_data sd ON cd.c_customer_sk = sd.ws_ship_customer_sk\n)\nSELECT *,\n       CASE \n           WHEN total_net_profit IS NULL THEN 'No Sales'\n           WHEN total_net_profit < 0 THEN 'Loss'\n           ELSE 'Profit'\n       END AS sales_status\nFROM summary_data\nORDER BY total_net_profit DESC, total_orders DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_net_paid) AS total_spent\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    cd.cd_gender, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nWHERE \n    ca.ca_state = 'CA' \nAND \n    cd.cd_gender = 'M' \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    cd.cd_gender \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    d.d_date, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, cd.cd_gender, cd.cd_marital_status, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year,\n    w.w_warehouse_name\nFROM \n    customer AS c\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN \n    warehouse AS w ON ss.ss_store_sk = w.w_warehouse_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year, w.w_warehouse_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    cd.cd_gender, \n    cd.cd_marital_status, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    cd.cd_gender, \n    cd.cd_marital_status\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_ext_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year,\n    w.w_warehouse_name\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN \n    warehouse w ON ss.ss_store_sk = w.w_warehouse_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name,\n    d.d_year,\n    w.w_warehouse_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    d.d_date, \n    SUM(ws.ws_sales_price) AS total_sales \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, d.d_date \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    s.s_store_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    s.s_store_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ss.ss_sales_price) AS total_sales, \n    cd.cd_gender, \n    cd.cd_marital_status, \n    d.d_year \nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \nGROUP BY \n    c.c_customer_id, cd.cd_gender, cd.cd_marital_status, d.d_year \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT\n    c.c_customer_sk,\n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(ss.ss_ticket_number) AS number_of_transactions\nFROM\n    customer c\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN\n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN\n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nWHERE\n    ca.ca_city = 'San Jose'\nGROUP BY\n    c.c_customer_sk,\n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender\nORDER BY\n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 AND \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    ca.ca_street_name, \n    ca.ca_city, \n    i.i_item_desc, \n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nWHERE \n    ca.ca_state = 'CA' \n    AND i.i_current_price > 10.00\nGROUP BY \n    c.c_customer_id, \n    ca.ca_street_name, \n    ca.ca_city, \n    i.i_item_desc\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    d.d_date, \n    SUM(s.ws_sales_price) AS total_sales\nFROM \n    customer c \nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    web_sales s ON c.c_customer_sk = s.ws_bill_customer_sk\nJOIN \n    date_dim d ON s.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, ca.ca_city, c.c_first_name, c.c_last_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_street_name, \n    ca_city, \n    cd_gender, \n    cd_marital_status, \n    SUM(ws_quantity) AS total_sales\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    cd_marital_status = 'M' \n    AND cd_gender = 'F' \n    AND ca_state = 'CA'\nGROUP BY \n    ca_street_name, \n    ca_city, \n    cd_gender, \n    cd_marital_status\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    cd.cd_gender, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk \nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_returned_date_sk, \n        sr_item_sk, \n        sr_customer_sk, \n        sr_return_quantity,\n        CASE \n            WHEN sr_return_quantity IS NULL THEN 'Unknown Return'\n            WHEN sr_return_quantity = 0 THEN 'No Return'\n            ELSE 'Returned'\n        END AS return_status\n    FROM \n        store_returns\n    WHERE \n        sr_return_quantity IS NOT NULL\n),\nSalesDetails AS (\n    SELECT \n        ws_item_sk, \n        SUM(ws_quantity) AS total_quantity_sold,\n        SUM(ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n),\nInventoryStatus AS (\n    SELECT \n        inv_item_sk,\n        inv_quantity_on_hand,\n        CASE \n            WHEN inv_quantity_on_hand < 10 THEN 'Low Stock'\n            WHEN inv_quantity_on_hand BETWEEN 10 AND 50 THEN 'Moderate Stock'\n            ELSE 'Sufficient Stock'\n        END AS stock_level\n    FROM \n        inventory\n    WHERE \n        inv_date_sk = (SELECT MAX(inv_date_sk) FROM inventory)\n),\nFinalReport AS (\n    SELECT \n        i.i_item_id,\n        i.i_item_desc,\n        COALESCE(cr.sr_return_quantity, 0) AS return_quantity,\n        COALESCE(sd.total_quantity_sold, 0) AS total_sold,\n        COALESCE(sd.total_net_profit, 0) AS total_profit,\n        inv.inv_quantity_on_hand,\n        inv.stock_level\n    FROM \n        item i\n    LEFT JOIN CustomerReturns cr ON i.i_item_sk = cr.sr_item_sk\n    LEFT JOIN SalesDetails sd ON i.i_item_sk = sd.ws_item_sk\n    JOIN InventoryStatus inv ON i.i_item_sk = inv.inv_item_sk\n)\nSELECT \n    *,\n    CASE \n        WHEN return_quantity > total_sold * 0.5 THEN 'High Return Rate'\n        WHEN total_sold = 0 THEN 'No Sales Recorded'\n        ELSE 'Normal Return Rate'\n    END AS return_rate_category\nFROM \n    FinalReport\nWHERE \n    (return_quantity IS NOT NULL OR total_sold > 0)\nORDER BY \n    return_rate_category DESC, total_profit DESC\nLIMIT 100;\n",
  "\nWITH AddressParts AS (\n    SELECT\n        ca_address_sk,\n        TRIM(ca_street_number) || ' ' || TRIM(ca_street_name) || ' ' || TRIM(ca_street_type) || \n        CASE WHEN ca_suite_number IS NOT NULL AND ca_suite_number <> '' \n             THEN ' Ste ' || TRIM(ca_suite_number) ELSE '' END AS full_address,\n        ca_city,\n        ca_state,\n        ca_zip,\n        ca_country\n    FROM\n        customer_address\n),\nCustomerDetails AS (\n    SELECT\n        c.c_customer_sk,\n        TRIM(c.c_salutation) || ' ' || TRIM(c.c_first_name) || ' ' || TRIM(c.c_last_name) AS full_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        ad.full_address,\n        ad.ca_city,\n        ad.ca_state,\n        ad.ca_zip,\n        ad.ca_country\n    FROM\n        customer c\n    JOIN\n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN\n        AddressParts ad ON c.c_current_addr_sk = ad.ca_address_sk\n),\nSaleDetails AS (\n    SELECT\n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        ws.ws_sales_price,\n        ws.ws_quantity,\n        cd.full_name,\n        cd.ca_city AS city,\n        cd.ca_state AS state,\n        cd.ca_zip AS zip\n    FROM\n        web_sales ws\n    JOIN\n        CustomerDetails cd ON ws.ws_bill_customer_sk = cd.c_customer_sk\n)\nSELECT \n    sd.full_name,\n    sd.city,\n    sd.state,\n    sd.zip,\n    SUM(sd.ws_sales_price * sd.ws_quantity) AS total_sales,\n    COUNT(sd.ws_item_sk) AS total_items_sold\nFROM \n    SaleDetails sd\nGROUP BY \n    sd.full_name, sd.city, sd.state, sd.zip\nHAVING \n    SUM(sd.ws_sales_price * sd.ws_quantity) > 1000\nORDER BY \n    total_sales DESC;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023 \n    AND (c.c_first_name LIKE 'A%' OR c.c_last_name LIKE '%son')\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC, \n    total_quantity DESC;\n",
  "\nSELECT \n    c.c_first_name || ' ' || c.c_last_name AS full_name,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(DISTINCT wr.wr_order_number) AS total_web_returns,\n    COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns,\n    SUM(wr.wr_return_amt) AS total_web_return_amount,\n    SUM(sr.sr_return_amt) AS total_store_return_amount,\n    SUM(CASE WHEN wr.wr_return_tax IS NOT NULL THEN wr.wr_return_tax ELSE 0 END) AS total_web_return_tax,\n    SUM(CASE WHEN sr.sr_return_tax IS NOT NULL THEN sr.sr_return_tax ELSE 0 END) AS total_store_return_tax\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nLEFT JOIN \n    web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\nLEFT JOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nWHERE \n    ca.ca_state IN ('CA', 'NY')\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_web_return_amount DESC, total_store_return_amount DESC\nLIMIT 50;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(DISTINCT ws.ws_order_number) AS total_web_orders,\n    COUNT(DISTINCT cs.cs_order_number) AS total_catalog_orders,\n    SUM(ws.ws_net_profit) AS total_web_profit,\n    SUM(cs.cs_net_profit) AS total_catalog_profit\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nLEFT JOIN \n    catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\nWHERE \n    ca.ca_city LIKE 'San%' \n    AND ca.ca_state = 'CA' \n    AND c.c_preferred_cust_flag = 'Y'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nHAVING \n    COUNT(DISTINCT ws.ws_order_number) > 10\n    AND COUNT(DISTINCT cs.cs_order_number) > 5\nORDER BY \n    total_web_profit DESC, total_catalog_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_net_paid) AS total_spent,\n    AVG(ws.ws_net_paid) AS avg_order_value,\n    MAX(ws.ws_sold_date_sk) AS last_order_date\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nHAVING \n    COUNT(DISTINCT ws.ws_order_number) > 5 \nORDER BY \n    total_spent DESC \nFETCH FIRST 100 ROWS ONLY;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_net_paid_inc_tax) AS total_sales,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    d.d_year,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_sales_price) AS avg_sales_price,\n    COUNT(DISTINCT ws.ws_web_page_sk) AS unique_web_pages_visited,\n    AVG(ws.ws_ext_discount_amt) AS avg_discount_given\nFROM \n    customer AS c\nJOIN \n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales AS ws ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\n    AND cd.cd_gender = 'F'\nGROUP BY \n    c.c_customer_id, \n    cd.cd_gender, \n    cd.cd_marital_status, \n    d.d_year\nHAVING \n    SUM(ws.ws_net_paid_inc_tax) > 1000\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_ext_discount_amt) AS total_discount,\n        AVG(ws_net_profit) AS avg_net_profit\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n                            AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_bill_customer_sk\n),\ncustomer_info AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_education_status,\n        ca.ca_city,\n        ca.ca_state\n    FROM \n        customer c \n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk \n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n),\nperformance AS (\n    SELECT \n        ci.c_customer_sk,\n        ci.c_first_name,\n        ci.c_last_name,\n        ci.cd_gender,\n        ci.cd_marital_status,\n        ci.cd_education_status,\n        ci.ca_city,\n        ci.ca_state,\n        ss.total_quantity,\n        ss.total_sales,\n        ss.total_discount,\n        ss.avg_net_profit\n    FROM \n        customer_info ci\n    LEFT JOIN \n        sales_summary ss ON ci.c_customer_sk = ss.ws_bill_customer_sk\n)\nSELECT \n    *,\n    CASE \n        WHEN total_sales > 10000 THEN 'High Value'\n        WHEN total_sales BETWEEN 5000 AND 10000 THEN 'Medium Value'\n        ELSE 'Low Value' \n    END AS customer_value_category\nFROM \n    performance \nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \nAND \n    ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nHAVING \n    SUM(ss.ss_ext_sales_price) > 10000\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year,\n    w.w_warehouse_name\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN \n    warehouse w ON ss.ss_store_sk = w.w_warehouse_sk\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year, \n    w.w_warehouse_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name,\n    a.ca_city,\n    a.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name,\n    a.ca_city,\n    a.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ws.ws_sales_price, \n    SUM(ss.ss_quantity) AS total_sales_quantity\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    web_sales ws ON ss.ss_item_sk = ws.ws_item_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ws.ws_sales_price\nORDER BY \n    total_sales_quantity DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    a.ca_city,\n    s.s_store_name,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nWHERE \n    a.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, a.ca_city, s.s_store_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    a.ca_city,\n    a.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions\nFROM \n    customer AS c\nJOIN \n    customer_address AS a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON d.d_date_sk = ss.ss_sold_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, a.ca_city, a.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    a.ca_city,\n    a.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, a.ca_city, a.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    a.ca_city,\n    d.d_date,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    a.ca_city,\n    d.d_date\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    a.ca_state, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address a ON c.c_current_addr_sk = a.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    a.ca_city, \n    a.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    i.i_item_id,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_sales_price) AS total_sales_amount\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, i.i_item_id\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n    SUM(ss.ss_net_paid) AS total_revenue\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(SUM(sr_return_quantity), 0) AS total_returns,\n        COALESCE(SUM(sr_return_amt_inc_tax), 0) AS total_return_amount\n    FROM \n        customer c\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_id, \n        c.c_first_name, \n        c.c_last_name\n),\nHighValueCustomers AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id\n    HAVING \n        SUM(ws.ws_net_profit) > 1000\n),\nReturnAnalysis AS (\n    SELECT \n        cr.c_customer_id,\n        cr.total_returns,\n        cr.total_return_amount,\n        CASE \n            WHEN cr.total_returns > 0 AND hv.total_profit IS NOT NULL THEN 'High Return Customer'\n            WHEN cr.total_returns > 0 THEN 'Return Customer'\n            ELSE 'New Customer'\n        END AS customer_type\n    FROM \n        CustomerReturns cr\n    LEFT JOIN \n        HighValueCustomers hv ON cr.c_customer_id = hv.c_customer_id\n)\nSELECT \n    r.customer_type,\n    COUNT(*) AS customer_count,\n    AVG(r.total_return_amount) AS avg_return_amount,\n    SUM(r.total_returns) AS total_returns_sum\nFROM \n    ReturnAnalysis r\nGROUP BY \n    r.customer_type\nORDER BY \n    customer_count DESC;\n",
  "\nSELECT \n    c.c_first_name || ' ' || c.c_last_name AS customer_name,\n    ca.ca_city,\n    ca.ca_state,\n    cd.cd_gender,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_ext_sales_price) AS total_spent,\n    AVG(ws.ws_ext_sales_price) AS avg_order_value\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca.ca_city IS NOT NULL\n    AND ca.ca_state IS NOT NULL\n    AND cd.cd_gender IN ('M', 'F')\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    cd.cd_gender\nORDER BY \n    total_spent DESC\nLIMIT 50;\n",
  "\nWITH FilteredCustomer AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        ca.ca_city,\n        ca.ca_state,\n        cd.cd_gender,\n        cd.cd_marital_status\n    FROM \n        customer c\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        ca.ca_city LIKE '%Springfield%' \n        AND cd.cd_gender = 'M'\n),\nAggregatedSales AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        COUNT(ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_ext_sales_price) AS total_sales\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_bill_customer_sk\n)\nSELECT \n    FC.c_first_name || ' ' || FC.c_last_name AS full_name,\n    FC.ca_city,\n    FC.ca_state,\n    CS.total_orders,\n    CS.total_sales\nFROM \n    FilteredCustomer FC\nLEFT JOIN \n    AggregatedSales CS ON FC.c_customer_sk = CS.ws_bill_customer_sk\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH CustomerGenderCount AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_sk) AS customer_count\n    FROM \n        customer_demographics \n    INNER JOIN \n        customer ON cd_demo_sk = c_current_cdemo_sk\n    GROUP BY \n        cd_gender\n),\nItemPromotionCount AS (\n    SELECT \n        i_brand,\n        COUNT(DISTINCT p_promo_id) AS promo_count\n    FROM \n        item\n    LEFT JOIN \n        promotion ON i_item_sk = p_item_sk\n    GROUP BY \n        i_brand\n),\nCombinedData AS (\n    SELECT \n        c.cd_gender,\n        c.customer_count,\n        i.i_brand AS item_brand,\n        i.promo_count\n    FROM \n        CustomerGenderCount AS c\n    JOIN \n        ItemPromotionCount AS i ON c.cd_gender = (CASE WHEN i.i_brand IS NOT NULL THEN c.cd_gender ELSE 'Unknown' END)\n)\nSELECT \n    cd_gender,\n    SUM(customer_count) AS total_customers,\n    AVG(promo_count) AS average_promotions\nFROM \n    CombinedData\nGROUP BY \n    cd_gender;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_quantity) AS total_quantity, \n    SUM(ws.ws_sales_price) AS total_sales, \n    AVG(ws.ws_net_profit) AS average_net_profit \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \n    AND ca.ca_state IN ('CA', 'TX', 'NY') \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state \nHAVING \n    SUM(ws.ws_quantity) > 10 \nORDER BY \n    total_sales DESC \nLIMIT 50;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_sales_price) AS total_spent,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_paid_inc_tax) AS avg_order_value,\n    d.d_year AS purchase_year,\n    COUNT(DISTINCT ws.ws_ship_mode_sk) AS shipping_methods_used\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year IN (2022, 2023)\n    AND ca.ca_state = 'CA'\n    AND ws.ws_net_paid > 0\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    d.d_year\nHAVING \n    SUM(ws.ws_sales_price) > 500\nORDER BY \n    total_spent DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_quantity) AS total_quantity_sold,\n    SUM(ws.ws_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_sales_price) AS avg_sales_price,\n    MAX(ws.ws_sold_date_sk) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \n    AND d.d_month_seq IN (1, 2, 3) \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nHAVING \n    SUM(ws.ws_net_profit) > 1000\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "SELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    AVG(ws.ws_net_paid_inc_tax) AS avg_net_paid,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    CASE \n        WHEN SUM(ws.ws_ext_sales_price) > 10000 THEN 'High Value Customer'\n        WHEN SUM(ws.ws_ext_sales_price) BETWEEN 5000 AND 10000 THEN 'Medium Value Customer'\n        ELSE 'Low Value Customer'\n    END AS customer_value_segment\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2001\n    AND d.d_moy IN (6, 7, 8)  \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nHAVING \n    SUM(ws.ws_ext_sales_price) > 0\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_net_profit) AS average_profit, \n    COUNT(DISTINCT ws.ws_web_page_sk) AS unique_web_pages_interacted\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nLEFT JOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023 AND \n    ca.ca_state IN ('CA', 'TX', 'NY') \nGROUP BY \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state\nHAVING \n    SUM(ws.ws_sales_price) > 1000\nORDER BY \n    total_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    MAX(d.d_date) AS latest_purchase_date\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\n    AND ca.ca_state IN ('CA', 'TX', 'NY')\n    AND ws.ws_sales_price >= 50.00\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nHAVING \n    SUM(ws.ws_quantity) > 5\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_paid) AS avg_order_value\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023 \n    GROUP BY \n        c.c_customer_id\n), \nHighValueCustomers AS (\n    SELECT \n        cs.c_customer_id,\n        cs.total_profit,\n        cs.total_orders,\n        cs.avg_order_value\n    FROM \n        CustomerSales cs\n    WHERE \n        cs.total_profit > (SELECT AVG(total_profit) FROM CustomerSales)\n    ORDER BY \n        cs.total_profit DESC\n    LIMIT 10\n) \nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    hvc.total_profit,\n    hvc.total_orders,\n    hvc.avg_order_value\nFROM \n    HighValueCustomers hvc\nJOIN \n    customer c ON hvc.c_customer_id = c.c_customer_id\nORDER BY \n    hvc.total_profit DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_net_paid) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_net_profit) AS avg_net_profit,\n    COUNT(DISTINCT ws.ws_web_page_sk) AS distinct_web_pages,\n    MAX(ws.ws_net_paid_inc_tax) AS max_net_paid_inc_tax\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state\nHAVING \n    SUM(ws.ws_net_paid) > 1000\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH enriched_sales AS (\n    SELECT \n        ws.ws_order_number,\n        ws.ws_item_sk,\n        ws.ws_quantity,\n        ws.ws_net_paid,\n        ws.ws_ship_date_sk,\n        d.d_date,\n        d.d_year,\n        d.d_month_seq,\n        d.d_week_seq,\n        d.d_day_name,\n        c.c_first_name,\n        c.c_last_name,\n        c.c_birth_year,\n        cd.cd_gender,\n        cd.cd_marital_status\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n)\nSELECT \n    d_year,\n    d_month_seq,\n    d_week_seq,\n    d_day_name,\n    cd_gender,\n    COUNT(ws_order_number) AS total_orders,\n    SUM(ws_quantity) AS total_quantity,\n    SUM(ws_net_paid) AS total_revenue,\n    AVG(ws_net_paid) AS avg_order_value\nFROM \n    enriched_sales\nWHERE \n    d_year = 2023\nGROUP BY \n    d_year, d_month_seq, d_week_seq, d_day_name, cd_gender\nORDER BY \n    d_year, d_month_seq, d_week_seq, cd_gender;\n",
  "\nWITH top_customers AS (\n    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ss.ss_ext_sales_price) AS total_spent\n    FROM customer c\n    JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name\n    ORDER BY total_spent DESC\n    LIMIT 10\n),\nmonthly_sales AS (\n    SELECT d.d_year, d.d_month_seq, SUM(ss.ss_ext_sales_price) AS monthly_total\n    FROM date_dim d\n    JOIN store_sales ss ON d.d_date_sk = ss.ss_sold_date_sk\n    GROUP BY d.d_year, d.d_month_seq\n    ORDER BY d.d_year, d.d_month_seq\n),\nsales_summary AS (\n    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, t.monthly_total, t.d_year\n    FROM top_customers c\n    JOIN monthly_sales t ON c.total_spent >= 1000\n)\nSELECT s.c_first_name, s.c_last_name, s.d_year, s.monthly_total\nFROM sales_summary s\nORDER BY s.d_year DESC, s.monthly_total DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    cd.cd_gender, \n    cd.cd_marital_status, \n    dd.d_year, \n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    cd.cd_gender, \n    cd.cd_marital_status, \n    dd.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH AddressDetails AS (\n    SELECT \n        ca.ca_address_sk,\n        ca.ca_street_number || ' ' || ca.ca_street_name || ' ' || ca.ca_street_type || \n        CASE WHEN ca.ca_suite_number IS NOT NULL THEN ' Suite ' || ca.ca_suite_number END AS full_address,\n        ca.ca_city,\n        ca.ca_state\n    FROM \n        customer_address ca\n),\nCustomerDetails AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name || ' ' || c.c_last_name AS full_name,\n        cd.cd_gender,\n        cd.cd_marital_status\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nSalesSummary AS (\n    SELECT \n        ws.ws_ship_date_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_paid) AS total_sales\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_ship_date_sk\n)\nSELECT \n    ad.full_address,\n    cd.full_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    ss.total_quantity,\n    ss.total_sales\nFROM \n    AddressDetails ad\nJOIN \n    CustomerDetails cd ON ad.ca_address_sk = cd.c_customer_sk\nJOIN \n    SalesSummary ss ON cd.c_customer_sk = ss.ws_ship_date_sk\nWHERE \n    ad.ca_state = 'CA' \n    AND cd.cd_gender = 'F'\n    AND ss.total_sales > 1000\nORDER BY \n    ss.total_sales DESC\nLIMIT 10;\n",
  "\nWITH FilteredCustomers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        ca.ca_city,\n        ca.ca_state,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        LENGTH(c.c_email_address) AS email_length\n    FROM \n        customer c\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        ca.ca_state = 'CA' \n        AND cd.cd_marital_status = 'M'\n),\nEmailStatistics AS (\n    SELECT \n        AVG(email_length) AS avg_email_length,\n        COUNT(*) AS total_customers\n    FROM \n        FilteredCustomers\n),\nAddressStatistics AS (\n    SELECT \n        ca_city,\n        COUNT(DISTINCT c_customer_sk) AS customer_count\n    FROM \n        FilteredCustomers\n    GROUP BY \n        ca_city\n),\nFinalStatistics AS (\n    SELECT \n        e.avg_email_length,\n        e.total_customers,\n        a.ca_city,\n        a.customer_count\n    FROM \n        EmailStatistics e\n    CROSS JOIN \n        AddressStatistics a\n)\nSELECT \n    fs.avg_email_length,\n    fs.total_customers,\n    fs.ca_city,\n    fs.customer_count,\n    CASE \n        WHEN fs.total_customers > 100 THEN 'High'\n        WHEN fs.total_customers BETWEEN 50 AND 100 THEN 'Medium'\n        ELSE 'Low'\n    END AS customer_segment\nFROM \n    FinalStatistics fs\nORDER BY \n    fs.customer_count DESC;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_street_number || ' ' || ca.ca_street_name || ' ' || ca.ca_street_type AS full_address,\n    d.d_date AS transaction_date,\n    SUM(ws.ws_sales_price) AS total_spent,\n    CASE \n        WHEN SUM(ws.ws_sales_price) > 1000 THEN 'High Value Customer'\n        WHEN SUM(ws.ws_sales_price) BETWEEN 500 AND 1000 THEN 'Medium Value Customer'\n        ELSE 'Low Value Customer'\n    END AS customer_value_segment\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\n    AND c.c_email_address LIKE '%@example.com'\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_street_number, \n    ca.ca_street_name, \n    ca.ca_street_type, \n    d.d_date\nORDER BY \n    total_spent DESC\nLIMIT 50;\n",
  "\nWITH AddressDetails AS (\n    SELECT ca_address_sk, \n           ca_street_number || ' ' || ca_street_name || ' ' || ca_street_type AS full_address,\n           ca_city, \n           ca_state \n    FROM customer_address \n),\nCustomerFullNames AS (\n    SELECT c_customer_sk, \n           c_first_name || ' ' || c_last_name AS full_name, \n           cd_gender,\n           cd_marital_status \n    FROM customer \n    JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n),\nSalesStatistics AS (\n    SELECT ws_bill_customer_sk, \n           COUNT(ws_order_number) AS total_orders, \n           SUM(ws_net_profit) AS total_profit \n    FROM web_sales \n    GROUP BY ws_bill_customer_sk\n)\nSELECT c.full_name, \n       a.full_address, \n       c.cd_gender, \n       c.cd_marital_status, \n       s.total_orders, \n       s.total_profit \nFROM CustomerFullNames c\nJOIN AddressDetails a ON c.c_customer_sk = a.ca_address_sk\nJOIN SalesStatistics s ON c.c_customer_sk = s.ws_bill_customer_sk\nWHERE c.cd_gender = 'M' \n  AND s.total_orders > 5\nORDER BY s.total_profit DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        SUM(cs.cs_net_paid) AS total_catalog_sales,\n        SUM(ss.ss_net_paid) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nSalesComparison AS (\n    SELECT \n        c.c_customer_id,\n        total_web_sales,\n        total_catalog_sales,\n        total_store_sales,\n        CASE \n            WHEN total_web_sales > total_catalog_sales AND total_web_sales > total_store_sales THEN 'Web Sales'\n            WHEN total_catalog_sales > total_web_sales AND total_catalog_sales > total_store_sales THEN 'Catalog Sales'\n            WHEN total_store_sales > total_web_sales AND total_store_sales > total_catalog_sales THEN 'Store Sales'\n            ELSE 'Equal Sales'\n        END AS top_sales_channel\n    FROM \n        CustomerSales c\n)\nSELECT \n    top_sales_channel,\n    COUNT(*) AS customer_count,\n    AVG(total_web_sales) AS avg_web_sales,\n    AVG(total_catalog_sales) AS avg_catalog_sales,\n    AVG(total_store_sales) AS avg_store_sales\nFROM \n    SalesComparison\nGROUP BY \n    top_sales_channel\nORDER BY \n    customer_count DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        SUM(cs.cs_net_paid) AS total_catalog_sales,\n        SUM(ss.ss_net_paid) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nSalesSummary AS (\n    SELECT \n        total_web_sales,\n        total_catalog_sales,\n        total_store_sales,\n        CASE \n            WHEN total_web_sales > total_catalog_sales AND total_web_sales > total_store_sales THEN 'Web'\n            WHEN total_catalog_sales > total_web_sales AND total_catalog_sales > total_store_sales THEN 'Catalog'\n            WHEN total_store_sales > total_web_sales AND total_store_sales > total_catalog_sales THEN 'Store'\n            ELSE 'Equal'\n        END AS highest_sales_channel\n    FROM \n        CustomerSales\n)\nSELECT \n    highest_sales_channel,\n    COUNT(*) AS channel_count,\n    AVG(total_web_sales) AS avg_web_sales,\n    AVG(total_catalog_sales) AS avg_catalog_sales,\n    AVG(total_store_sales) AS avg_store_sales\nFROM \n    SalesSummary\nGROUP BY \n    highest_sales_channel\nORDER BY \n    channel_count DESC;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(CASE WHEN ws.ws_sold_date_sk BETWEEN d.d_date_sk AND d.d_date_sk + 30 THEN ws.ws_sales_price ELSE 0 END) AS total_sales_last_30_days,\n    SUM(CASE WHEN ws.ws_sold_date_sk BETWEEN d.d_date_sk + 31 AND d.d_date_sk + 60 THEN ws.ws_sales_price ELSE 0 END) AS total_sales_next_30_days,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    AVG(ws.ws_net_profit) AS average_profit\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, d.d_date_sk\nORDER BY \n    total_sales_last_30_days DESC, average_profit DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_sales_count,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_sales_count,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_sales_count\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nSalesAnalytics AS (\n    SELECT \n        cs.c_customer_id,\n        cs.total_web_sales,\n        cs.total_catalog_sales,\n        cs.total_store_sales,\n        cs.web_sales_count,\n        cs.catalog_sales_count,\n        cs.store_sales_count,\n        CASE \n            WHEN cs.total_web_sales > cs.total_catalog_sales AND cs.total_web_sales > cs.total_store_sales THEN 'Web Sales Leader'\n            WHEN cs.total_catalog_sales > cs.total_web_sales AND cs.total_catalog_sales > cs.total_store_sales THEN 'Catalog Sales Leader'\n            WHEN cs.total_store_sales > cs.total_web_sales AND cs.total_store_sales > cs.total_catalog_sales THEN 'Store Sales Leader'\n            ELSE 'Equal Sales Performance'\n        END AS sales_leader\n    FROM \n        CustomerSales cs\n)\nSELECT \n    sa.sales_leader,\n    COUNT(*) AS customer_count,\n    AVG(sa.total_web_sales) AS avg_web_sales,\n    AVG(sa.total_catalog_sales) AS avg_catalog_sales,\n    AVG(sa.total_store_sales) AS avg_store_sales\nFROM \n    SalesAnalytics sa\nGROUP BY \n    sa.sales_leader\nORDER BY \n    customer_count DESC;\n",
  "\nSELECT \n    c.c_customer_sk, \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state, \n    SUM(ss.ss_quantity) AS total_sales, \n    SUM(ss.ss_net_paid_inc_tax) AS total_net_sales, \n    d.d_year \nFROM \n    customer c \nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nWHERE \n    d.d_year = 2023 \n    AND ca.ca_state = 'CA' \nGROUP BY \n    c.c_customer_sk, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, d.d_year \nHAVING \n    SUM(ss.ss_quantity) > 50 \nORDER BY \n    total_net_sales DESC \nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nSalesAggregated AS (\n    SELECT \n        total_web_sales,\n        total_catalog_sales,\n        total_store_sales,\n        CASE \n            WHEN total_web_sales > total_catalog_sales AND total_web_sales > total_store_sales THEN 'web'\n            WHEN total_catalog_sales > total_web_sales AND total_catalog_sales > total_store_sales THEN 'catalog'\n            WHEN total_store_sales > total_web_sales AND total_store_sales > total_catalog_sales THEN 'store'\n            ELSE 'equal'\n        END AS primary_sales_channel\n    FROM \n        CustomerSales\n)\nSELECT \n    primary_sales_channel, \n    COUNT(*) AS customer_count,\n    AVG(total_web_sales) AS avg_web_sales,\n    AVG(total_catalog_sales) AS avg_catalog_sales,\n    AVG(total_store_sales) AS avg_store_sales\nFROM \n    SalesAggregated\nGROUP BY \n    primary_sales_channel\nORDER BY \n    customer_count DESC;\n",
  "\nWITH TotalSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_order_count,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_order_count,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_order_count\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    WHERE \n        c.c_current_cdemo_sk IS NOT NULL\n    GROUP BY \n        c.c_customer_id\n),\nSalesInsights AS (\n    SELECT \n        total_web_sales,\n        total_catalog_sales,\n        total_store_sales,\n        web_order_count,\n        catalog_order_count,\n        store_order_count,\n        CASE \n            WHEN total_web_sales > total_catalog_sales AND total_web_sales > total_store_sales THEN 'Web'\n            WHEN total_catalog_sales > total_web_sales AND total_catalog_sales > total_store_sales THEN 'Catalog'\n            ELSE 'Store'\n        END AS preferred_channel\n    FROM \n        TotalSales\n)\nSELECT \n    preferred_channel,\n    COUNT(*) AS customer_count,\n    AVG(total_web_sales) AS avg_web_sales,\n    AVG(total_catalog_sales) AS avg_catalog_sales,\n    AVG(total_store_sales) AS avg_store_sales\nFROM \n    SalesInsights\nGROUP BY \n    preferred_channel\nORDER BY \n    customer_count DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_net_profit) AS total_profit,\n    COUNT(ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_paid_inc_tax) AS average_order_value,\n    d.d_year,\n    d.d_month_seq,\n    sm.sm_carrier\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN \n    ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk\nWHERE \n    d.d_year = 2022\n    AND ws.ws_net_profit > 0\nGROUP BY \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_year,\n    d.d_month_seq,\n    sm.sm_carrier\nHAVING \n    COUNT(ws.ws_order_number) > 5\nORDER BY \n    total_profit DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH TopSellingItems AS (\n    SELECT \n        i.i_item_id,\n        SUM(cs.cs_quantity) AS total_sold_quantity,\n        SUM(cs.cs_ext_sales_price) AS total_sales_value\n    FROM \n        catalog_sales cs\n    JOIN \n        item i ON cs.cs_item_sk = i.i_item_sk\n    WHERE \n        cs.cs_sold_date_sk BETWEEN \n            (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 \n            AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        i.i_item_id\n    ORDER BY \n        total_sales_value DESC\n    LIMIT 10\n),\nCustomerInfo AS (\n    SELECT \n        c.c_customer_id,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        c.c_current_cdemo_sk IS NOT NULL\n    GROUP BY \n        c.c_customer_id\n)\nSELECT \n    ci.c_customer_id,\n    ci.total_orders,\n    ci.total_net_profit,\n    tsi.total_sold_quantity,\n    tsi.total_sales_value\nFROM \n    CustomerInfo ci\nJOIN \n    TopSellingItems tsi ON ci.total_orders > 0\nORDER BY \n    ci.total_net_profit DESC, tsi.total_sales_value DESC\nLIMIT 15;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_net_profit) AS average_profit,\n    MAX(ss.ss_sold_date_sk) AS last_purchase_date,\n    ca.ca_city,\n    ca.ca_state,\n    d.d_year\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2022\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, d.d_year\nHAVING \n    SUM(ss.ss_sales_price) > 5000\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ws.ws_quantity) AS total_quantity_sold,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 AND \n    d.d_month_seq IN (1, 2, 3) AND \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, d.d_year, d.d_month_seq\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH AddressDetails AS (\n    SELECT \n        ca_address_sk,\n        ca_street_number,\n        ca_street_name,\n        ca_city,\n        ca_state,\n        ca_country\n    FROM \n        customer_address\n    WHERE \n        ca_city IS NOT NULL AND ca_country = 'USA'\n),\nCustomerDetails AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        c.c_email_address,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nWebSalesDetails AS (\n    SELECT \n        ws.ws_order_number,\n        ws.ws_item_sk,\n        ws.ws_sales_price,\n        ws.ws_quantity,\n        ws.ws_net_profit,\n        ws.ws_bill_customer_sk\n    FROM \n        web_sales ws\n)\nSELECT \n    ad.ca_street_number || ' ' || ad.ca_street_name AS FullAddress,\n    cd.c_first_name,\n    cd.c_last_name,\n    cd.c_email_address,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    SUM(ws.ws_net_profit) AS TotalProfit\nFROM \n    AddressDetails ad\nJOIN \n    CustomerDetails cd ON cd.c_customer_sk = ad.ca_address_sk\nJOIN \n    WebSalesDetails ws ON ws.ws_bill_customer_sk = cd.c_customer_sk\nGROUP BY \n    ad.ca_street_number, ad.ca_street_name, cd.c_first_name, cd.c_last_name, cd.c_email_address, cd.cd_gender, cd.cd_marital_status\nHAVING \n    SUM(ws.ws_net_profit) > 0\nORDER BY \n    TotalProfit DESC;\n",
  "\nWITH AddressParts AS (\n    SELECT \n        ca_address_sk,\n        ca_street_number,\n        ca_street_name,\n        ca_street_type,\n        ca_city,\n        ca_state,\n        TRIM(ca_street_number) || ' ' || TRIM(ca_street_name) || ' ' || TRIM(ca_street_type) || ', ' || TRIM(ca_city) || ', ' || TRIM(ca_state) AS full_address\n    FROM \n        customer_address\n), \nCustomerDetails AS (\n    SELECT \n        c.c_customer_sk, \n        TRIM(c.c_first_name) || ' ' || TRIM(c.c_last_name) AS full_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ad.full_address\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        AddressParts ad ON c.c_current_addr_sk = ad.ca_address_sk\n), \nSalesData AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_net_profit) AS total_profit,\n        SUM(ws.ws_quantity) AS total_quantity\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_bill_customer_sk\n)\nSELECT \n    cd.full_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    cd.full_address,\n    COALESCE(sd.total_profit, 0) AS profit,\n    COALESCE(sd.total_quantity, 0) AS quantity\nFROM \n    CustomerDetails cd\nLEFT JOIN \n    SalesData sd ON cd.c_customer_sk = sd.ws_bill_customer_sk\nWHERE \n    cd.cd_gender = 'F' AND cd.cd_marital_status = 'M'\nORDER BY \n    profit DESC, quantity DESC\nLIMIT 100;\n",
  "WITH CustomerDetails AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        da.ca_city,\n        da.ca_state,\n        da.ca_country,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating\n    FROM \n        customer c\n    JOIN \n        customer_address da ON c.c_current_addr_sk = da.ca_address_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nSalesDetails AS (\n    SELECT \n        ws.ws_web_page_sk,\n        ws.ws_order_number,\n        SUM(ws.ws_sales_price) AS total_sales,\n        AVG(ws.ws_ext_discount_amt) AS avg_discount,\n        COUNT(DISTINCT ws.ws_ship_customer_sk) AS unique_customers\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_web_page_sk, ws.ws_order_number\n),\nCombinedData AS (\n    SELECT \n        cd.c_customer_id,\n        cd.c_first_name,\n        cd.c_last_name,\n        cd.ca_city,\n        cd.ca_state,\n        cd.ca_country,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        sd.total_sales,\n        sd.avg_discount,\n        sd.unique_customers\n    FROM \n        CustomerDetails cd\n    LEFT JOIN \n        SalesDetails sd ON cd.c_customer_id = CAST(sd.ws_order_number AS CHAR(16))  \n)\nSELECT \n    ca_state,\n    COUNT(*) AS customer_count,\n    SUM(total_sales) AS grand_total_sales,\n    AVG(avg_discount) AS average_discount,\n    COUNT(DISTINCT c_customer_id) AS unique_customers\nFROM \n    CombinedData\nGROUP BY \n    ca_state\nORDER BY \n    grand_total_sales DESC;",
  "\nWITH \n    SalesData AS (\n        SELECT \n            ws_sold_date_sk, \n            ws_item_sk, \n            SUM(ws_quantity) AS total_quantity, \n            SUM(ws_net_paid) AS total_sales, \n            ws_ship_mode_sk\n        FROM web_sales\n        GROUP BY ws_sold_date_sk, ws_item_sk, ws_ship_mode_sk\n    ),\n    ItemDetails AS (\n        SELECT \n            i_item_sk, \n            i_item_desc, \n            i_current_price, \n            i_brand \n        FROM item\n    ),\n    DateDetails AS (\n        SELECT \n            d_date_sk, \n            d_year, \n            d_month_seq \n        FROM date_dim \n        WHERE d_year = 2023\n    ),\n    ShipModeDetails AS (\n        SELECT \n            sm_ship_mode_sk, \n            sm_type \n        FROM ship_mode\n    )\nSELECT \n    dd.d_year,\n    dd.d_month_seq,\n    im.i_item_desc,\n    im.i_brand,\n    sd.total_quantity,\n    sd.total_sales,\n    smd.sm_type\nFROM \n    SalesData sd\nJOIN \n    ItemDetails im ON sd.ws_item_sk = im.i_item_sk\nJOIN \n    DateDetails dd ON sd.ws_sold_date_sk = dd.d_date_sk\nJOIN \n    ShipModeDetails smd ON sd.ws_ship_mode_sk = smd.sm_ship_mode_sk\nWHERE \n    sd.total_sales > 5000\nORDER BY \n    dd.d_year, dd.d_month_seq, sd.total_sales DESC\nLIMIT 100;\n",
  "\nWITH aggregated_sales AS (\n    SELECT \n        cs_item_sk,\n        SUM(cs_quantity) AS total_quantity,\n        SUM(cs_net_profit) AS total_profit,\n        COUNT(DISTINCT cs_order_number) AS total_orders\n    FROM catalog_sales\n    GROUP BY cs_item_sk\n),\ncustomer_details AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nhigh_profit_items AS (\n    SELECT \n        sales.cs_item_sk,\n        sales.total_quantity,\n        sales.total_profit,\n        customer.cd_gender,\n        customer.cd_marital_status\n    FROM aggregated_sales sales\n    JOIN customer_details customer ON sales.cs_item_sk IN (\n        SELECT i_item_sk\n        FROM item\n        WHERE i_current_price > 50\n    )\n    WHERE sales.total_profit > 1000\n)\nSELECT \n    item.i_item_id,\n    item.i_item_desc,\n    h.total_quantity,\n    h.total_profit,\n    h.cd_gender,\n    h.cd_marital_status\nFROM high_profit_items h\nJOIN item ON h.cs_item_sk = item.i_item_sk\nORDER BY h.total_profit DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH sales_data AS (\n    SELECT\n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS order_count\n    FROM\n        web_sales\n    WHERE\n        ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2022) AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022)\n    GROUP BY\n        ws_bill_customer_sk\n),\ncustomer_info AS (\n    SELECT\n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        ca.ca_city,\n        ca.ca_state\n    FROM\n        customer AS c\n    LEFT JOIN customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\n)\nSELECT\n    ci.c_first_name,\n    ci.c_last_name,\n    ci.ca_city,\n    ci.ca_state,\n    si.total_sales,\n    si.order_count\nFROM\n    customer_info AS ci\nJOIN\n    sales_data AS si ON ci.c_customer_sk = si.ws_bill_customer_sk\nWHERE\n    si.total_sales > 1000\nORDER BY\n    si.total_sales DESC\nLIMIT 10;\n",
  "\nWITH CustomerReturns AS (\n    SELECT\n        sr_customer_sk,\n        SUM(sr_return_amt) AS total_return_amount,\n        COUNT(sr_ticket_number) AS total_returns,\n        AVG(sr_return_quantity) AS avg_return_quantity\n    FROM store_returns\n    GROUP BY sr_customer_sk\n),\nPromotions AS (\n    SELECT\n        ws_bill_customer_sk,\n        COUNT(DISTINCT ws_promo_sk) AS total_promotions_used\n    FROM web_sales\n    WHERE ws_sold_date_sk BETWEEN\n        (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) AND\n        (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY ws_bill_customer_sk\n),\nHighReturnCustomers AS (\n    SELECT\n        c.c_customer_id,\n        cr.total_return_amount,\n        cr.total_returns,\n        p.total_promotions_used\n    FROM customer c\n    JOIN CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN Promotions p ON c.c_customer_sk = p.ws_bill_customer_sk\n    WHERE cr.total_return_amount > (\n        SELECT AVG(total_return_amount) FROM CustomerReturns\n    )\n)\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    c.c_email_address,\n    hrc.total_return_amount,\n    hrc.total_returns,\n    COALESCE(hrc.total_promotions_used, 0) AS total_promotions_used\nFROM HighReturnCustomers hrc\nJOIN customer c ON hrc.c_customer_id = c.c_customer_id\nORDER BY hrc.total_return_amount DESC, hrc.total_returns DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_sales,\n    d.d_year,\n    d.d_month_seq,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE \n    d.d_year = 2022 \n    AND c.c_preferred_cust_flag = 'Y'\n    AND ca.ca_state IN ('CA', 'TX', 'NY')\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year, \n    d.d_month_seq, \n    ca.ca_city, \n    ca.ca_state\nHAVING \n    SUM(ws.ws_quantity) > 100\nORDER BY \n    total_sales DESC, \n    total_quantity DESC\nLIMIT 50;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_net_paid) AS total_spent,\n        COUNT(ws.ws_order_number) AS total_orders,\n        MAX(ws.ws_sold_date_sk) AS last_purchase_date\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nHighValueCustomers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_spent,\n        cs.total_orders,\n        cs.last_purchase_date\n    FROM \n        CustomerSales cs\n    WHERE \n        cs.total_spent > (SELECT AVG(total_spent) FROM CustomerSales)\n)\nSELECT \n    ca.ca_city,\n    ca.ca_state,\n    COUNT(DISTINCT hvc.c_customer_sk) AS high_value_customer_count,\n    SUM(hvc.total_orders) AS total_orders_placed,\n    AVG(hvc.total_spent) AS avg_spent_per_customer\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    HighValueCustomers hvc ON c.c_customer_sk = hvc.c_customer_sk\nGROUP BY \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    high_value_customer_count DESC, \n    avg_spent_per_customer DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH SalesSummary AS (\n    SELECT\n        ws_bill_customer_sk,\n        ws_item_sk,\n        SUM(ws_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit,\n        COUNT(ws_order_number) AS total_orders,\n        COUNT(DISTINCT ws_sold_date_sk) AS days_sold\n    FROM\n        web_sales\n    GROUP BY\n        ws_bill_customer_sk,\n        ws_item_sk\n),\nCustomerDemographics AS (\n    SELECT\n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating\n    FROM\n        customer c\n    JOIN\n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nTopItems AS (\n    SELECT\n        s.ws_item_sk,\n        SUM(s.total_sales) AS item_total_sales\n    FROM\n        SalesSummary s\n    GROUP BY\n        s.ws_item_sk\n    ORDER BY\n        item_total_sales DESC\n    LIMIT 10\n)\nSELECT\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    SUM(ss.total_sales) AS total_sales,\n    SUM(ss.total_profit) AS total_profit,\n    AVG(ss.days_sold) AS avg_days_sold\nFROM\n    SalesSummary ss\nJOIN\n    CustomerDemographics cd ON ss.ws_bill_customer_sk = cd.c_customer_sk\nJOIN\n    TopItems ti ON ss.ws_item_sk = ti.ws_item_sk\nGROUP BY\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status\nORDER BY\n    total_sales DESC;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_id, \n        SUM(ss.ss_net_profit) AS total_store_profit,\n        SUM(ws.ws_net_profit) AS total_web_profit,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_purchase_count,\n        COUNT(DISTINCT ws.ws_order_number) AS web_purchase_count\n    FROM \n        customer c\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    WHERE \n        c.c_current_cdemo_sk IS NOT NULL\n    GROUP BY \n        c.c_customer_id\n),\nprofit_analysis AS (\n    SELECT \n        c.c_customer_id,\n        cs.total_store_profit,\n        cs.total_web_profit,\n        cs.store_purchase_count,\n        cs.web_purchase_count,\n        CASE \n            WHEN cs.total_store_profit > cs.total_web_profit THEN 'Store Preferred'\n            WHEN cs.total_web_profit > cs.total_store_profit THEN 'Web Preferred'\n            ELSE 'Equal Preference'\n        END AS preference\n    FROM \n        customer_sales cs\n    JOIN \n        customer c ON cs.c_customer_id = c.c_customer_id\n)\nSELECT \n    preference,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    AVG(total_store_profit) AS avg_store_profit,\n    AVG(total_web_profit) AS avg_web_profit,\n    SUM(store_purchase_count) AS total_store_purchases,\n    SUM(web_purchase_count) AS total_web_purchases\nFROM \n    profit_analysis\nGROUP BY \n    preference\nORDER BY \n    customer_count DESC;\n",
  "\nWITH customer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nsales_summary AS (\n    SELECT\n        ws_bill_customer_sk,\n        SUM(ws_sales_price) AS total_sales,\n        COUNT(ws_order_number) AS total_orders,\n        AVG(ws_net_profit) AS avg_net_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\ntop_customers AS (\n    SELECT \n        ci.c_customer_sk,\n        ci.c_first_name,\n        ci.c_last_name,\n        ss.total_sales,\n        ss.total_orders,\n        ss.avg_net_profit\n    FROM \n        customer_info ci\n    JOIN \n        sales_summary ss ON ci.c_customer_sk = ss.ws_bill_customer_sk\n    ORDER BY \n        total_sales DESC\n    LIMIT 10\n)\nSELECT \n    tc.c_first_name,\n    tc.c_last_name,\n    tc.total_sales,\n    tc.total_orders,\n    tc.avg_net_profit,\n    ci.cd_gender,\n    ci.cd_marital_status,\n    ci.cd_education_status\nFROM \n    top_customers tc\nJOIN \n    customer_info ci ON tc.c_customer_sk = ci.c_customer_sk\nORDER BY \n    tc.total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold, \n    SUM(ss.ss_net_paid) AS total_sales,\n    d.d_year,\n    d.d_month_seq,\n    ca.ca_city,\n    ca.ca_state,\n    COUNT(DISTINCT ss.ss_ticket_number) AS unique_transactions\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE \n    d.d_year = 2023 \n    AND (ca.ca_state = 'CA' OR ca.ca_state = 'NY')\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year, \n    d.d_month_seq, \n    ca.ca_city, \n    ca.ca_state\nORDER BY \n    total_sales DESC, \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_net_paid_inc_tax) AS total_spent,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_purchases,\n    AVG(ss.ss_net_paid_inc_tax) AS average_spent,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \n    AND cd.cd_gender = 'F'\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    cd.cd_gender, \n    cd.cd_marital_status, \n    d.d_year, \n    d.d_month_seq\nHAVING \n    SUM(ss.ss_net_paid_inc_tax) > 1000\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_paid) AS total_net_paid,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        MIN(dd.d_date) AS first_sale_date,\n        MAX(dd.d_date) AS last_sale_date,\n        COUNT(DISTINCT c.c_customer_sk) AS unique_customers\n    FROM web_sales ws\n    JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    WHERE dd.d_year = 2023\n    GROUP BY ws.ws_item_sk\n),\nItemMetrics AS (\n    SELECT \n        i.i_item_id,\n        i.i_product_name,\n        sd.total_quantity,\n        sd.total_net_paid,\n        sd.total_orders,\n        sd.first_sale_date,\n        sd.last_sale_date,\n        sd.unique_customers,\n        CASE \n            WHEN sd.total_net_paid > 10000 THEN 'High Performer'\n            WHEN sd.total_net_paid BETWEEN 5000 AND 10000 THEN 'Moderate Performer'\n            ELSE 'Low Performer'\n        END AS performance_category\n    FROM SalesData sd\n    JOIN item i ON sd.ws_item_sk = i.i_item_sk\n)\nSELECT \n    performance_category,\n    COUNT(*) AS item_count,\n    AVG(total_quantity) AS avg_quantity,\n    AVG(total_net_paid) AS avg_net_paid,\n    MIN(first_sale_date) AS earliest_sale,\n    MAX(last_sale_date) AS latest_sale\nFROM ItemMetrics\nGROUP BY performance_category\nORDER BY item_count DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_customer_id, \n        SUM(COALESCE(ss.ss_net_paid, 0) + COALESCE(ws.ws_net_paid, 0) + COALESCE(cs.cs_net_paid, 0)) AS total_sales,\n        COUNT(DISTINCT CASE WHEN ss.ss_net_paid IS NOT NULL THEN ss.ss_ticket_number END) AS store_trans_count,\n        COUNT(DISTINCT CASE WHEN ws.ws_net_paid IS NOT NULL THEN ws.ws_order_number END) AS web_trans_count\n    FROM customer c\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    GROUP BY c.c_customer_sk, c.c_customer_id\n),\nAvgSales AS (\n    SELECT \n        AVG(total_sales) AS avg_sales,\n        COUNT(c_customer_sk) AS num_customers\n    FROM CustomerSales\n)\nSELECT \n    cs.c_customer_id,\n    cs.total_sales,\n    CASE \n        WHEN cs.total_sales > (SELECT avg_sales FROM AvgSales) THEN 'Above Average'\n        ELSE 'Below Average'\n    END AS sales_comparison,\n    cs.store_trans_count,\n    cs.web_trans_count\nFROM CustomerSales cs\nWHERE cs.total_sales > 100\nORDER BY cs.total_sales DESC\nLIMIT 10;\n",
  "\nWITH AddressFull AS (\n    SELECT \n        ca_address_sk,\n        ca_street_number || ' ' || ca_street_name || ' ' || ca_street_type || \n        COALESCE(' Suite ' || ca_suite_number, '') || ', ' ||\n        ca_city || ', ' || ca_state || ' ' || ca_zip AS full_address\n    FROM \n        customer_address\n),\nCustomerInfo AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        a.full_address,\n        d.cd_gender,\n        d.cd_marital_status,\n        d.cd_education_status\n    FROM \n        customer c\n    JOIN \n        customer_demographics d ON c.c_current_cdemo_sk = d.cd_demo_sk\n    JOIN \n        AddressFull a ON c.c_current_addr_sk = a.ca_address_sk\n),\nSalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_paid) AS total_spent,\n        COUNT(ws_order_number) AS order_count\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n)\nSELECT \n    ci.c_customer_sk,\n    ci.c_first_name,\n    ci.c_last_name,\n    ci.full_address,\n    ci.cd_gender,\n    ci.cd_marital_status,\n    sd.total_spent,\n    sd.order_count\nFROM \n    CustomerInfo ci\nLEFT JOIN \n    SalesData sd ON ci.c_customer_sk = sd.ws_bill_customer_sk\nWHERE \n    ci.cd_gender = 'F' AND \n    ci.cd_marital_status = 'M'\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_paid) AS total_spent\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nHighValueCustomers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_orders,\n        cs.total_spent\n    FROM \n        CustomerSales cs\n    WHERE \n        cs.total_spent > (SELECT AVG(total_spent) FROM CustomerSales)\n),\nFrequentReturners AS (\n    SELECT \n        sr.sr_customer_sk,\n        COUNT(sr.sr_ticket_number) AS return_count\n    FROM \n        store_returns sr\n    GROUP BY \n        sr.sr_customer_sk\n)\nSELECT \n    c.c_customer_id,\n    hvc.total_orders,\n    hvc.total_spent,\n    fr.return_count\nFROM \n    HighValueCustomers hvc\nLEFT JOIN \n    FrequentReturners fr ON hvc.c_customer_sk = fr.sr_customer_sk\nJOIN \n    customer c ON hvc.c_customer_sk = c.c_customer_sk\nORDER BY \n    hvc.total_spent DESC, fr.return_count DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nTopCustomers AS (\n    SELECT \n        c.*, \n        COALESCE(total_web_sales, 0) + COALESCE(total_catalog_sales, 0) + COALESCE(total_store_sales, 0) AS total_sales\n    FROM \n        CustomerSales c\n)\nSELECT \n    tc.c_customer_sk,\n    tc.c_first_name,\n    tc.c_last_name,\n    tc.total_sales,\n    CASE\n        WHEN tc.total_sales = 0 THEN 'No Sales'\n        WHEN tc.total_sales < 100 THEN 'Low Value Customer'\n        WHEN tc.total_sales < 500 THEN 'Medium Value Customer'\n        ELSE 'High Value Customer'\n    END AS customer_segment\nFROM \n    TopCustomers tc\nWHERE \n    tc.total_sales > 0\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nSalesSummary AS (\n    SELECT \n        total_web_sales,\n        total_catalog_sales,\n        total_store_sales,\n        CASE \n            WHEN total_web_sales > total_catalog_sales AND total_web_sales > total_store_sales THEN 'Web Sales'\n            WHEN total_catalog_sales > total_web_sales AND total_catalog_sales > total_store_sales THEN 'Catalog Sales'\n            ELSE 'Store Sales'\n        END AS highest_sales_channel\n    FROM \n        CustomerSales\n)\nSELECT \n    highest_sales_channel,\n    COUNT(*) AS customer_count,\n    AVG(total_web_sales) AS avg_web_sales,\n    AVG(total_catalog_sales) AS avg_catalog_sales,\n    AVG(total_store_sales) AS avg_store_sales\nFROM \n    SalesSummary\nGROUP BY \n    highest_sales_channel\nORDER BY \n    customer_count DESC;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COUNT(DISTINCT ws.ws_order_number) AS TotalPurchaseCount,\n        SUM(ws.ws_sales_price) AS TotalSpent,\n        AVG(ws.ws_sales_price) AS AverageSpent,\n        COUNT(DISTINCT sr.sr_ticket_number) AS TotalReturns\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    WHERE \n        c.c_current_addr_sk IN (\n            SELECT ca_address_sk \n            FROM customer_address \n            WHERE ca_state = 'CA'\n        )\n    GROUP BY \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n), \nHighValueCustomers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.TotalPurchaseCount,\n        cs.TotalSpent,\n        cs.AverageSpent,\n        cs.TotalReturns,\n        CASE \n            WHEN cs.TotalSpent > 1000 THEN 'High Value'\n            WHEN cs.TotalSpent BETWEEN 500 AND 1000 THEN 'Medium Value'\n            ELSE 'Low Value'\n        END AS ValueSegment\n    FROM \n        CustomerStats cs\n)\nSELECT \n    hv.ValueSegment,\n    COUNT(hv.c_customer_sk) AS CustomerCount,\n    AVG(hv.TotalSpent) AS AverageSpentBySegment,\n    SUM(hv.TotalReturns) AS TotalReturnsBySegment\nFROM \n    HighValueCustomers hv\nGROUP BY \n    hv.ValueSegment\nORDER BY \n    CASE hv.ValueSegment\n        WHEN 'High Value' THEN 1\n        WHEN 'Medium Value' THEN 2\n        WHEN 'Low Value' THEN 3\n        ELSE 4\n    END;\n",
  "\nWITH sales_data AS (\n    SELECT\n        ws_sold_date_sk,\n        ws_ship_mode_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_ext_sales_price) AS total_sales,\n        AVG(ws_net_profit) AS avg_net_profit\n    FROM web_sales\n    GROUP BY ws_sold_date_sk, ws_ship_mode_sk\n),\ndate_range AS (\n    SELECT \n        d_date_sk, \n        d_year, \n        d_month_seq\n    FROM date_dim \n    WHERE d_date BETWEEN '2023-01-01' AND '2023-12-31'\n),\nsummary AS (\n    SELECT\n        dr.d_year,\n        dr.d_month_seq,\n        sd.ws_ship_mode_sk,\n        sd.total_quantity,\n        sd.total_sales,\n        sd.avg_net_profit\n    FROM sales_data sd\n    JOIN date_range dr ON sd.ws_sold_date_sk = dr.d_date_sk\n)\nSELECT \n    d.d_year,\n    d.d_month_seq,\n    sm.sm_ship_mode_id,\n    COALESCE(SUM(s.total_quantity), 0) AS total_quantity,\n    COALESCE(SUM(s.total_sales), 0) AS total_sales,\n    COALESCE(AVG(s.avg_net_profit), 0) AS avg_net_profit\nFROM date_range d\nCROSS JOIN ship_mode sm\nLEFT JOIN summary s ON d.d_year = s.d_year \n                     AND d.d_month_seq = s.d_month_seq \n                     AND sm.sm_ship_mode_sk = s.ws_ship_mode_sk\nGROUP BY \n    d.d_year, \n    d.d_month_seq, \n    sm.sm_ship_mode_id\nORDER BY \n    d.d_year, \n    d.d_month_seq, \n    sm.sm_ship_mode_id;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        SUM(cs.cs_net_paid) AS total_catalog_sales,\n        SUM(ss.ss_net_paid) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name\n),\nSalesSummary AS (\n    SELECT \n        total_web_sales,\n        total_catalog_sales,\n        total_store_sales,\n        CASE \n            WHEN total_web_sales > total_catalog_sales AND total_web_sales > total_store_sales THEN 'Web'\n            WHEN total_catalog_sales > total_web_sales AND total_catalog_sales > total_store_sales THEN 'Catalog'\n            WHEN total_store_sales > total_web_sales AND total_store_sales > total_catalog_sales THEN 'Store'\n            ELSE 'Equal Sales'\n        END AS top_channel\n    FROM \n        CustomerSales\n)\nSELECT \n    top_channel, \n    COUNT(*) AS customer_count,\n    AVG(total_web_sales) AS avg_web_sales,\n    AVG(total_catalog_sales) AS avg_catalog_sales,\n    AVG(total_store_sales) AS avg_store_sales\nFROM \n    SalesSummary\nGROUP BY \n    top_channel\nORDER BY \n    customer_count DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        AVG(ws.ws_sales_price) AS avg_sales_price,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        web_sales AS ws\n    JOIN \n        date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2022\n    GROUP BY \n        ws.ws_item_sk\n),\nproduct_info AS (\n    SELECT \n        i.i_item_sk,\n        i.i_product_name,\n        i.i_category,\n        ii.i_brand\n    FROM \n        item AS i\n    JOIN \n        (SELECT DISTINCT i_item_sk, i_brand FROM item) AS ii ON i.i_item_sk = ii.i_item_sk\n)\nSELECT \n    p.i_product_name,\n    p.i_category,\n    p.i_brand,\n    ss.total_quantity,\n    ss.total_sales,\n    ss.avg_sales_price,\n    ss.order_count\nFROM \n    sales_summary AS ss\nJOIN \n    product_info AS p ON ss.ws_item_sk = p.i_item_sk\nWHERE \n    ss.total_quantity > 100\nORDER BY \n    ss.total_sales DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(COALESCE(ws.ws_ext_sales_price, 0) + COALESCE(cs.cs_ext_sales_price, 0) + COALESCE(ss.ss_ext_sales_price, 0)) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_orders,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_orders,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_orders\n    FROM \n        customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nSalesStatistics AS (\n    SELECT \n        AVG(total_sales) AS avg_sales,\n        MAX(total_sales) AS max_sales,\n        MIN(total_sales) AS min_sales,\n        COUNT(c_customer_sk) AS total_customers,\n        COUNT(CASE WHEN total_sales > 0 THEN 1 END) AS active_customers\n    FROM \n        CustomerSales\n)\nSELECT \n    * \nFROM \n    SalesStatistics\nWHERE \n    active_customers > 100\nORDER BY \n    avg_sales DESC\nLIMIT 5;\n",
  "\nWITH CTE_Customer_Sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        COUNT(DISTINCT CASE WHEN ws.ws_ship_date_sk IS NOT NULL THEN ws.ws_order_number END) AS shipped_orders\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nCTE_Income_Bands AS (\n    SELECT \n        h.hd_demo_sk,\n        SUM(CASE \n            WHEN h.hd_income_band_sk IS NULL THEN 0 \n            ELSE h.hd_income_band_sk \n        END) AS total_income_band,\n        COUNT(h.hd_demo_sk) AS demographic_count\n    FROM \n        household_demographics h \n    GROUP BY \n        h.hd_demo_sk\n),\nMax_Sales_Profit AS (\n    SELECT \n        MAX(total_profit) AS max_profit\n    FROM \n        CTE_Customer_Sales\n),\nCTE_Joined_Data AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_profit,\n        ib.total_income_band,\n        ib.demographic_count\n    FROM \n        CTE_Customer_Sales cs\n    JOIN \n        CTE_Income_Bands ib ON cs.c_customer_sk = ib.hd_demo_sk\n)\n\nSELECT \n    js.c_customer_sk,\n    js.total_profit,\n    js.total_income_band,\n    js.demographic_count,\n    CASE\n        WHEN js.total_profit > (SELECT max_profit FROM Max_Sales_Profit) THEN 'High Value'\n        ELSE 'Low Value'\n    END AS customer_value_segment\nFROM \n    CTE_Joined_Data js\nLEFT JOIN \n    customer_demographics cd ON js.c_customer_sk = cd.cd_demo_sk\nWHERE \n    (cd.cd_marital_status = 'M' OR cd.cd_gender = 'F')\n    AND (cd.cd_purchase_estimate IS NOT NULL OR js.demographic_count > 5)\nORDER BY \n    js.total_profit DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH AddressInfo AS (\n    SELECT \n        ca_city,\n        ca_state,\n        SUBSTRING(ca_street_name, 1, 10) AS short_street_name,\n        CHAR_LENGTH(ca_street_name) AS street_name_length,\n        ca_street_type,\n        ca_address_sk\n    FROM \n        customer_address\n    WHERE \n        ca_city IS NOT NULL\n),\nCustomerInfo AS (\n    SELECT \n        cd_gender,\n        CASE \n            WHEN cd_marital_status = 'M' THEN 'Married'\n            WHEN cd_marital_status = 'S' THEN 'Single'\n            ELSE 'Other'\n        END AS marital_status,\n        cd_education_status,\n        TRIM(cd_credit_rating) AS credit_rating,\n        cd_demo_sk\n    FROM \n        customer_demographics\n),\nSalesInfo AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n)\nSELECT \n    ci.cd_gender,\n    ci.marital_status,\n    ci.cd_education_status,\n    ai.ca_city,\n    ai.ca_state,\n    ai.short_street_name,\n    ai.street_name_length,\n    COALESCE(si.total_sales, 0) AS total_sales,\n    COALESCE(si.total_orders, 0) AS total_orders\nFROM \n    CustomerInfo ci\nJOIN \n    customer c ON c.c_current_cdemo_sk = ci.cd_demo_sk\nJOIN \n    AddressInfo ai ON c.c_current_addr_sk = ai.ca_address_sk\nLEFT JOIN \n    SalesInfo si ON c.c_customer_sk = si.ws_bill_customer_sk\nWHERE \n    ai.street_name_length > 5\nORDER BY \n    total_sales DESC, \n    ai.ca_city ASC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(COALESCE(ws.ws_ext_sales_price, 0) + COALESCE(cs.cs_ext_sales_price, 0) + COALESCE(ss.ss_ext_sales_price, 0)) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_order_count,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_order_count,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_order_count\n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nSalesBenchmark AS (\n    SELECT \n        total_sales,\n        web_order_count,\n        catalog_order_count,\n        store_order_count,\n        CASE \n            WHEN total_sales > 10000 THEN 'High Value'\n            WHEN total_sales BETWEEN 5000 AND 10000 THEN 'Medium Value'\n            ELSE 'Low Value'\n        END AS customer_value_category\n    FROM CustomerSales\n)\nSELECT \n    customer_value_category,\n    COUNT(*) AS customer_count,\n    AVG(total_sales) AS average_sales,\n    SUM(web_order_count) AS total_web_orders,\n    SUM(catalog_order_count) AS total_catalog_orders,\n    SUM(store_order_count) AS total_store_orders\nFROM SalesBenchmark\nGROUP BY customer_value_category\nORDER BY customer_value_category;\n",
  "\nWITH CustomerPurchases AS (\n    SELECT\n        c.c_customer_sk,\n        COUNT(ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM\n        customer c\n    LEFT JOIN\n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY\n        c.c_customer_sk\n),\nHighValueCustomers AS (\n    SELECT\n        cp.c_customer_sk,\n        cp.total_orders,\n        cp.total_profit,\n        CASE\n            WHEN cp.total_profit > 1000 THEN 'High Value'\n            WHEN cp.total_profit BETWEEN 500 AND 1000 THEN 'Medium Value'\n            ELSE 'Low Value'\n        END AS customer_value\n    FROM\n        CustomerPurchases cp\n),\nCustomerDemographics AS (\n    SELECT\n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating\n    FROM\n        customer_demographics cd\n    INNER JOIN\n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n)\nSELECT\n    hvc.c_customer_sk,\n    hvc.total_orders,\n    hvc.total_profit,\n    hvc.customer_value,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_credit_rating\nFROM\n    HighValueCustomers hvc\nJOIN\n    CustomerDemographics cd ON hvc.c_customer_sk = cd.cd_demo_sk\nWHERE\n    hvc.total_orders > (SELECT AVG(total_orders) FROM CustomerPurchases)\n    AND cd.cd_credit_rating IS NOT NULL\nORDER BY\n    hvc.total_profit DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_paid_inc_tax) AS total_net_paid\n    FROM \n        web_sales ws\n    WHERE \n        ws.ws_sold_date_sk > (SELECT MAX(d_date_sk) - 30 FROM date_dim)\n    GROUP BY \n        ws.ws_item_sk\n),\npromo_effect AS (\n    SELECT \n        cs.cs_item_sk,\n        COUNT(DISTINCT cs.cs_order_number) AS promo_orders,\n        SUM(CASE WHEN cs.cs_ext_discount_amt > 0 THEN cs.cs_ext_sales_price ELSE 0 END) AS total_discounted_sales\n    FROM \n        catalog_sales cs\n    JOIN \n        promotion p ON cs.cs_promo_sk = p.p_promo_sk\n    WHERE \n        p.p_discount_active = 'Y'\n    GROUP BY \n        cs.cs_item_sk\n)\nSELECT \n    i.i_item_id,\n    COALESCE(ss.total_quantity, 0) AS total_quantity,\n    COALESCE(ss.total_net_paid, 0) AS total_net_paid,\n    COALESCE(pe.promo_orders, 0) AS promo_orders,\n    COALESCE(pe.total_discounted_sales, 0) AS total_discounted_sales,\n    CASE \n        WHEN COALESCE(pe.total_discounted_sales, 0) > 0 THEN \n            (COALESCE(ss.total_net_paid, 0) / NULLIF(pe.total_discounted_sales, 0)) * 100 \n        ELSE 0 \n    END AS promo_sales_ratio\nFROM \n    item i\nLEFT JOIN \n    sales_summary ss ON i.i_item_sk = ss.ws_item_sk\nLEFT JOIN \n    promo_effect pe ON i.i_item_sk = pe.cs_item_sk\nWHERE \n    i.i_current_price > (SELECT AVG(i_current_price) FROM item) \nORDER BY \n    total_net_paid DESC\nLIMIT 10;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk AS customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS return_count,\n        SUM(sr_return_amt_inc_tax) AS total_return_amount,\n        AVG(sr_return_quantity) AS avg_return_quantity\n    FROM \n        store_returns \n    GROUP BY \n        sr_customer_sk\n),\nSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk AS customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS order_count,\n        AVG(ws_sales_price) AS avg_sales_price\n    FROM \n        web_sales \n    GROUP BY \n        ws_bill_customer_sk\n),\nActiveCustomers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        c.c_current_addr_sk IS NOT NULL\n),\nCombinedData AS (\n    SELECT \n        ac.c_customer_sk,\n        ac.c_first_name,\n        ac.c_last_name,\n        ac.cd_gender,\n        ac.cd_marital_status,\n        COALESCE(cr.return_count, 0) AS return_count,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        COALESCE(ss.total_sales, 0) AS total_sales,\n        COALESCE(ss.order_count, 0) AS order_count,\n        COALESCE(ss.avg_sales_price, 0) AS avg_sales_price\n    FROM \n        ActiveCustomers ac\n    LEFT JOIN \n        CustomerReturns cr ON ac.c_customer_sk = cr.customer_sk\n    LEFT JOIN \n        SalesSummary ss ON ac.c_customer_sk = ss.customer_sk\n)\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    c.cd_gender,\n    c.cd_marital_status,\n    c.return_count,\n    c.total_return_amount,\n    c.total_sales,\n    c.order_count,\n    c.avg_sales_price,\n    CASE \n        WHEN c.return_count > 0 THEN 'Returned'\n        ELSE 'No Returns'\n    END AS return_status,\n    CASE \n        WHEN c.total_sales > 1000 THEN 'High Value'\n        WHEN c.total_sales BETWEEN 500 AND 1000 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value\nFROM \n    CombinedData c\nWHERE \n    c.return_count + c.order_count > 5\nORDER BY \n    c.total_sales DESC\nLIMIT 50;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_item_sk, \n        SUM(ws_quantity) AS total_quantity,\n        AVG(ws_sales_price) AS avg_sales_price,\n        SUM(ws_net_profit) AS total_net_profit\n    FROM \n        web_sales \n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n        AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_item_sk\n),\npromotions_summary AS (\n    SELECT \n        p.p_item_sk,\n        COUNT(p.p_promo_sk) AS total_promotions\n    FROM \n        promotion p\n    JOIN \n        web_sales ws ON p.p_item_sk = ws.ws_item_sk\n    WHERE \n        p.p_start_date_sk <= (SELECT MAX(ws_sold_date_sk) FROM web_sales) \n        AND p.p_end_date_sk >= (SELECT MIN(ws_sold_date_sk) FROM web_sales)\n    GROUP BY \n        p.p_item_sk\n),\nfinal_summary AS (\n    SELECT \n        ss.ws_item_sk,\n        ss.total_quantity,\n        ss.avg_sales_price,\n        ss.total_net_profit,\n        COALESCE(ps.total_promotions, 0) AS total_promotions\n    FROM \n        sales_summary ss\n    LEFT JOIN \n        promotions_summary ps ON ss.ws_item_sk = ps.p_item_sk\n)\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    fs.total_quantity,\n    fs.avg_sales_price,\n    fs.total_net_profit,\n    fs.total_promotions\nFROM \n    final_summary fs\nJOIN \n    item i ON fs.ws_item_sk = i.i_item_sk\nORDER BY \n    fs.total_net_profit DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        s.s_store_name,\n        SUM(ss.ss_quantity) AS total_quantity,\n        SUM(ss.ss_sales_price) AS total_sales,\n        AVG(ss.ss_sales_price) AS avg_sales_price,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\n    FROM \n        store s\n    JOIN \n        store_sales ss ON s.s_store_sk = ss.ss_store_sk\n    WHERE \n        ss.ss_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022) - 30 \n        AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022)\n    GROUP BY \n        s.s_store_name\n),\ncustomer_summary AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS total_customers,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n)\nSELECT \n    ss.s_store_name,\n    ss.total_quantity,\n    ss.total_sales,\n    ss.avg_sales_price,\n    cs.cd_gender,\n    cs.total_customers,\n    cs.avg_purchase_estimate\nFROM \n    sales_summary ss\nCROSS JOIN \n    customer_summary cs\nORDER BY \n    ss.total_sales DESC, cs.total_customers DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH sales_summary AS (\n    SELECT\n        cs.cs_item_sk,\n        cs.cs_order_number,\n        SUM(cs.cs_quantity) AS total_quantity,\n        SUM(cs.cs_ext_sales_price) AS total_sales,\n        SUM(cs.cs_net_profit) AS total_net_profit\n    FROM\n        catalog_sales cs\n    JOIN\n        date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk\n    WHERE\n        dd.d_year = 2023\n    GROUP BY\n        cs.cs_item_sk, cs.cs_order_number\n),\ncustomer_summary AS (\n    SELECT\n        c.c_customer_sk,\n        COUNT(DISTINCT s.ss_ticket_number) AS total_orders,\n        SUM(s.ss_net_paid) AS total_spent\n    FROM\n        customer c\n    LEFT JOIN\n        store_sales s ON c.c_customer_sk = s.ss_customer_sk\n    GROUP BY\n        c.c_customer_sk\n)\nSELECT\n    cs.total_orders,\n    cs.total_spent,\n    ss.total_quantity,\n    ss.total_sales,\n    ss.total_net_profit,\n    (CASE\n        WHEN cs.total_spent > 1000 THEN 'High Value'\n        WHEN cs.total_spent BETWEEN 500 AND 1000 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END) AS customer_value_segment\nFROM\n    customer_summary cs\nJOIN\n    sales_summary ss ON cs.total_orders > 0\nORDER BY\n    cs.total_spent DESC, ss.total_sales DESC\nLIMIT 100;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        c.c_current_cdemo_sk IS NOT NULL\n    GROUP BY \n        c.c_customer_sk\n),\naverage_sales AS (\n    SELECT \n        AVG(total_sales) AS avg_sales,\n        AVG(total_orders) AS avg_orders\n    FROM \n        customer_sales\n),\nhigh_value_customers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_sales,\n        cs.total_orders\n    FROM \n        customer_sales cs\n    JOIN \n        average_sales av ON cs.total_sales > av.avg_sales\n)\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    c.c_birth_country,\n    hvc.total_sales,\n    hvc.total_orders\nFROM \n    high_value_customers hvc\nJOIN \n    customer c ON hvc.c_customer_sk = c.c_customer_sk\nORDER BY \n    hvc.total_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH sales_summary AS (\n    SELECT\n        cs.cs_sold_date_sk,\n        cs.cs_item_sk,\n        SUM(cs.cs_quantity) AS total_sold,\n        SUM(cs.cs_net_paid) AS total_revenue,\n        SUM(cs.cs_ext_discount_amt) AS total_discount,\n        MAX(cs.cs_sales_price) AS highest_price,\n        MIN(cs.cs_sales_price) AS lowest_price\n    FROM\n        catalog_sales cs\n    JOIN\n        item i ON cs.cs_item_sk = i.i_item_sk\n    WHERE\n        i.i_current_price > 0\n    GROUP BY\n        cs.cs_sold_date_sk,\n        cs.cs_item_sk\n),\ncustomer_address_summary AS (\n    SELECT\n        c.c_customer_sk,\n        ca.ca_state,\n        COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n        SUM(ss.total_revenue) AS total_spent,\n        AVG(ss.total_sold) AS avg_items_sold\n    FROM\n        customer c\n    JOIN\n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN\n        sales_summary ss ON c.c_customer_sk = ss.cs_item_sk\n    GROUP BY\n        c.c_customer_sk,\n        ca.ca_state\n)\nSELECT\n    cas.ca_state,\n    SUM(cas.unique_customers) AS total_customers,\n    SUM(cas.total_spent) AS state_revenue,\n    AVG(cas.avg_items_sold) AS state_avg_sold\nFROM\n    customer_address_summary cas\nGROUP BY\n    cas.ca_state\nORDER BY\n    state_revenue DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        cd.cd_dep_count\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        c.c_customer_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate, cd.cd_credit_rating, cd.cd_dep_count\n), DemographicsRisk AS (\n    SELECT \n        total_sales,\n        cd.cd_credit_rating,\n        CASE \n            WHEN cd.cd_purchase_estimate < 50000 THEN 'Low Risk'\n            WHEN cd.cd_purchase_estimate BETWEEN 50000 AND 100000 THEN 'Medium Risk'\n            ELSE 'High Risk'\n        END AS risk_level\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n)\nSELECT \n    dr.risk_level,\n    COUNT(*) AS customer_count,\n    AVG(dr.total_sales) AS avg_sales\nFROM \n    DemographicsRisk dr\nGROUP BY \n    dr.risk_level\nORDER BY \n    dr.risk_level;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt_inc_tax) AS total_returned_amount\n    FROM store_returns\n    GROUP BY sr_customer_sk\n),\nCustomerSales AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_quantity) AS total_sales_quantity,\n        SUM(ws_net_paid_inc_tax) AS total_sales_amount\n    FROM web_sales\n    GROUP BY ws_bill_customer_sk\n),\nReturnPercentage AS (\n    SELECT \n        COALESCE(cr.sr_customer_sk, cs.ws_bill_customer_sk) AS customer_sk,\n        COALESCE(cr.total_returned_quantity, 0) AS total_returned_quantity,\n        COALESCE(cs.total_sales_quantity, 0) AS total_sales_quantity,\n        CASE \n            WHEN COALESCE(cs.total_sales_quantity, 0) > 0 THEN \n                ROUND((COALESCE(cr.total_returned_quantity, 0) * 100.0) / cs.total_sales_quantity, 2)\n            ELSE \n                0\n        END AS return_percentage\n    FROM CustomerReturns cr\n    FULL OUTER JOIN CustomerSales cs ON cr.sr_customer_sk = cs.ws_bill_customer_sk\n),\nTopReturnCustomers AS (\n    SELECT \n        customer_sk,\n        return_percentage\n    FROM ReturnPercentage\n    WHERE return_percentage > 0\n    ORDER BY return_percentage DESC\n    LIMIT 10\n)\nSELECT \n    c.c_first_name || ' ' || c.c_last_name AS customer_name,\n    tr.return_percentage,\n    ca.ca_city,\n    ca.ca_state,\n    ca.ca_country\nFROM TopReturnCustomers tr\nJOIN customer c ON tr.customer_sk = c.c_customer_sk\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nORDER BY tr.return_percentage DESC;\n",
  "\nWITH customer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_city,\n        ca.ca_state\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n),\nsales_info AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales\n    FROM web_sales ws\n    GROUP BY ws.ws_bill_customer_sk\n),\ncombined_info AS (\n    SELECT \n        ci.c_customer_sk,\n        ci.c_first_name,\n        ci.c_last_name,\n        ci.cd_gender,\n        ci.cd_marital_status,\n        ci.cd_education_status,\n        ci.ca_city,\n        ci.ca_state,\n        COALESCE(si.total_quantity, 0) AS total_quantity,\n        COALESCE(si.total_sales, 0) AS total_sales\n    FROM customer_info ci\n    LEFT JOIN sales_info si ON ci.c_customer_sk = si.ws_bill_customer_sk\n)\nSELECT \n    c.c_first_name || ' ' || c.c_last_name AS full_name,\n    c.cd_gender,\n    c.cd_marital_status,\n    c.ca_city,\n    c.ca_state,\n    c.total_quantity,\n    c.total_sales,\n    CASE \n        WHEN c.total_sales > 5000 THEN 'High Value'\n        WHEN c.total_sales BETWEEN 1000 AND 5000 THEN 'Medium Value'\n        ELSE 'Low Value' \n    END AS customer_value\nFROM combined_info c\nWHERE c.ca_state = 'CA'\nORDER BY c.total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_net_profit) AS total_profit\n    FROM web_sales\n    GROUP BY ws_item_sk\n),\nreturn_data AS (\n    SELECT \n        wr_item_sk,\n        SUM(wr_return_amt) AS total_return_amt,\n        COUNT(DISTINCT wr_order_number) AS total_returns\n    FROM web_returns\n    GROUP BY wr_item_sk\n),\ninventory_data AS (\n    SELECT \n        inv_item_sk,\n        SUM(inv_quantity_on_hand) AS total_quantity_on_hand\n    FROM inventory\n    GROUP BY inv_item_sk\n)\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    COALESCE(sd.total_sales, 0) AS total_sales,\n    COALESCE(rd.total_return_amt, 0) AS total_return_amt,\n    COALESCE(sd.total_profit, 0) AS total_profit,\n    COALESCE(id.total_quantity_on_hand, 0) AS total_quantity_on_hand,\n    CASE \n        WHEN COALESCE(sd.total_sales, 0) = 0 THEN NULL \n        ELSE (COALESCE(rd.total_return_amt, 0) / COALESCE(sd.total_sales, 0)) * 100 \n    END AS return_percentage\nFROM item i\nLEFT JOIN sales_data sd ON i.i_item_sk = sd.ws_item_sk\nLEFT JOIN return_data rd ON i.i_item_sk = rd.wr_item_sk\nLEFT JOIN inventory_data id ON i.i_item_sk = id.inv_item_sk\nWHERE (i.i_current_price > 20 AND id.total_quantity_on_hand < 50) \n   OR (i.i_current_price <= 20 AND sd.total_orders > 100)\nORDER BY total_profit DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        SUM(cs.cs_net_paid) AS total_catalog_sales,\n        SUM(ss.ss_net_paid) AS total_store_sales\n    FROM \n        customer AS c\n    LEFT JOIN \n        web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales AS cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nSaleSummary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        total_web_sales,\n        total_catalog_sales,\n        total_store_sales,\n        CASE \n            WHEN total_web_sales > total_catalog_sales AND total_web_sales > total_store_sales THEN 'Web Sales'\n            WHEN total_catalog_sales > total_web_sales AND total_catalog_sales > total_store_sales THEN 'Catalog Sales'\n            WHEN total_store_sales > total_web_sales AND total_store_sales > total_catalog_sales THEN 'Store Sales'\n            ELSE 'Equal Sales'\n        END AS top_sales_channel\n    FROM \n        CustomerSales AS c\n)\nSELECT \n    s.c_customer_sk,\n    s.c_first_name,\n    s.c_last_name,\n    s.total_web_sales,\n    s.total_catalog_sales,\n    s.total_store_sales,\n    s.top_sales_channel\nFROM \n    SaleSummary AS s\nWHERE \n    (s.total_web_sales + s.total_catalog_sales + s.total_store_sales) > 1000\nORDER BY \n    s.total_web_sales DESC, \n    s.total_catalog_sales DESC, \n    s.total_store_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n        SUM(ss.ss_ext_sales_price) AS total_sales_amount,\n        SUM(ss.ss_net_profit) AS total_profit\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    WHERE \n        cd.cd_gender = 'F'\n        AND cd.cd_marital_status = 'M'\n    GROUP BY \n        c.c_customer_sk, cd.cd_gender, cd.cd_marital_status\n),\nSalesStats AS (\n    SELECT \n        ws.ws_bill_customer_sk AS customer_sk,\n        SUM(ws.ws_ext_sales_price) AS online_sales_amount\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_bill_customer_sk\n),\nTotalSales AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_sales,\n        cs.total_sales_amount,\n        cs.total_profit,\n        COALESCE(ss.online_sales_amount, 0) AS online_sales\n    FROM \n        CustomerStats cs\n    LEFT JOIN \n        SalesStats ss ON cs.c_customer_sk = ss.customer_sk\n)\nSELECT \n    t.c_customer_sk,\n    t.total_sales,\n    t.total_sales_amount,\n    t.total_profit,\n    t.online_sales,\n    (t.total_sales_amount + t.online_sales) AS combined_sales_amount\nFROM \n    TotalSales t\nORDER BY \n    combined_sales_amount DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        ws.ws_item_sk\n),\nCustomerInfo AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_credit_rating\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n)\nSELECT \n    ci.cd_gender,\n    ci.cd_marital_status,\n    ci.cd_education_status,\n    COUNT(DISTINCT ci.c_customer_sk) AS customer_count,\n    SUM(sd.total_quantity) AS total_sold,\n    SUM(sd.total_sales) AS total_revenue,\n    AVG(sd.total_profit) AS avg_profit_per_item\nFROM \n    CustomerInfo ci\nJOIN \n    SalesData sd ON ci.c_customer_sk = sd.ws_item_sk\nGROUP BY \n    ci.cd_gender, \n    ci.cd_marital_status, \n    ci.cd_education_status\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales,\n        SUM(ws.ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        MAX(ws.ws_sold_date_sk) AS last_purchase_date\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name\n),\ntop_customers AS (\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name,\n        c_last_name,\n        total_sales,\n        total_profit,\n        order_count,\n        last_purchase_date\n    FROM \n        sales_summary\n    WHERE \n        total_sales > 1000\n    ORDER BY \n        total_sales DESC\n    LIMIT 10\n)\nSELECT \n    tc.customer_id,\n    tc.c_first_name,\n    tc.c_last_name,\n    tc.total_sales,\n    tc.total_profit,\n    tc.order_count,\n    tc.last_purchase_date,\n    a.ca_city,\n    a.ca_state\nFROM \n    top_customers tc\nJOIN \n    customer_address a ON tc.customer_id = a.ca_address_id\nWHERE \n    a.ca_state IN ('CA', 'TX', 'NY')\nORDER BY \n    tc.total_profit DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT sr_customer_sk, SUM(sr_return_quantity) AS total_returns\n    FROM store_returns\n    GROUP BY sr_customer_sk\n),\nHighReturnCustomers AS (\n    SELECT c.c_customer_id, c.c_first_name, c.c_last_name, cr.total_returns\n    FROM customer c\n    JOIN CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\n    WHERE cr.total_returns > (SELECT AVG(total_returns) FROM CustomerReturns)\n),\nSalesByCustomer AS (\n    SELECT ws_bill_customer_sk, SUM(ws_net_profit) AS total_sales_profit\n    FROM web_sales\n    GROUP BY ws_bill_customer_sk\n),\nTopProfitableCustomers AS (\n    SELECT c.c_customer_id, c.c_first_name, c.c_last_name, sb.total_sales_profit\n    FROM customer c\n    JOIN SalesByCustomer sb ON c.c_customer_sk = sb.ws_bill_customer_sk\n    ORDER BY sb.total_sales_profit DESC\n    LIMIT 10\n),\nFinalReport AS (\n    SELECT hrc.c_customer_id AS high_return_id, \n           hrc.c_first_name AS high_return_first_name, \n           hrc.c_last_name AS high_return_last_name,\n           tpc.c_customer_id AS top_profit_id, \n           tpc.c_first_name AS top_profit_first_name,\n           tpc.c_last_name AS top_profit_last_name\n    FROM HighReturnCustomers hrc\n    FULL OUTER JOIN TopProfitableCustomers tpc ON hrc.c_customer_id = tpc.c_customer_id\n)\nSELECT * FROM FinalReport;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        MAX(d.d_date) AS last_purchase_date\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name\n),\nHighValueCustomers AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        cs.total_sales,\n        cs.order_count,\n        cs.last_purchase_date\n    FROM \n        CustomerSales cs\n    JOIN \n        customer c ON cs.c_customer_id = c.c_customer_id\n    WHERE \n        cs.total_sales > 1000 AND cs.order_count > 5\n),\nSalesSummary AS (\n    SELECT \n        hv.c_first_name,\n        hv.c_last_name,\n        hv.total_sales,\n        hv.last_purchase_date,\n        CASE \n            WHEN hv.total_sales > 5000 THEN 'VIP'\n            WHEN hv.total_sales > 2000 THEN 'Gold'\n            ELSE 'Silver'\n        END AS customer_tier\n    FROM \n        HighValueCustomers hv\n)\nSELECT \n    customer_tier,\n    COUNT(*) AS customer_count,\n    AVG(total_sales) AS average_sales,\n    MIN(last_purchase_date) AS first_purchase,\n    MAX(last_purchase_date) AS most_recent_purchase\nFROM \n    SalesSummary\nGROUP BY \n    customer_tier\nORDER BY \n    customer_tier DESC;\n",
  "\nWITH CustomerWebSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nHighValueCustomers AS (\n    SELECT \n        cws.c_customer_id,\n        cws.total_web_sales,\n        cws.total_orders\n    FROM \n        CustomerWebSales cws\n    WHERE \n        cws.total_web_sales > (SELECT AVG(total_web_sales) FROM CustomerWebSales)\n),\nWarehouseInventory AS (\n    SELECT \n        i.i_item_id,\n        SUM(inv.inv_quantity_on_hand) AS total_quantity\n    FROM \n        inventory inv\n    JOIN \n        item i ON inv.inv_item_sk = i.i_item_sk\n    GROUP BY \n        i.i_item_id\n),\nFetchedItems AS (\n    SELECT \n        hi.c_customer_id,\n        w_inv.i_item_id,\n        hi.total_web_sales,\n        hi.total_orders,\n        w_inv.total_quantity\n    FROM \n        HighValueCustomers hi\n    JOIN \n        WarehouseInventory w_inv ON (hi.total_web_sales / hi.total_orders) > 100\n)\nSELECT \n    f.c_customer_id,\n    f.i_item_id,\n    f.total_web_sales,\n    f.total_orders,\n    f.total_quantity\nFROM \n    FetchedItems f\nORDER BY \n    f.total_web_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH customer_details AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        ca.ca_city,\n        ca.ca_state\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n), \nsales_summary AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_net_paid) AS total_spent,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_paid) AS avg_order_value\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_bill_customer_sk\n)\nSELECT \n    cd.c_customer_sk,\n    cd.c_first_name,\n    cd.c_last_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    ss.total_spent,\n    ss.total_orders,\n    ss.avg_order_value,\n    cd.ca_city,\n    cd.ca_state\nFROM \n    customer_details cd\nLEFT JOIN \n    sales_summary ss ON cd.c_customer_sk = ss.ws_bill_customer_sk\nWHERE \n    ss.total_spent > 1000\n    AND cd.cd_gender = 'F'\nORDER BY \n    total_spent DESC\nLIMIT 100;\n",
  "\nWITH CustomerDetails AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        ca.ca_city,\n        ca.ca_state\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n),\nSalesData AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_bill_customer_sk\n),\nAggregatedData AS (\n    SELECT \n        cd.c_customer_sk,\n        cd.c_customer_id,\n        cd.ca_city,\n        cd.ca_state,\n        COALESCE(sd.total_sales, 0) AS total_sales,\n        COALESCE(sd.total_discount, 0) AS total_discount,\n        sd.total_orders\n    FROM \n        CustomerDetails cd\n    LEFT JOIN \n        SalesData sd ON cd.c_customer_sk = sd.ws_bill_customer_sk\n)\nSELECT \n    ad.c_customer_id,\n    ad.total_sales,\n    ad.total_discount,\n    ad.total_orders,\n    ad.ca_city,\n    ad.ca_state,\n    CASE \n        WHEN ad.total_sales > 1000 THEN 'High Value Customer'\n        WHEN ad.total_sales BETWEEN 500 AND 1000 THEN 'Medium Value Customer'\n        ELSE 'Low Value Customer'\n    END AS customer_segment\nFROM \n    AggregatedData ad\nWHERE \n    ad.total_orders > 5\nORDER BY \n    ad.total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COUNT(sr.sr_ticket_number) AS total_store_returns,\n        SUM(sr.sr_return_amt_inc_tax) AS total_return_amt_inc_tax,\n        SUM(sr.sr_net_loss) AS total_net_loss\n    FROM \n        customer c\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nWebSalesSummary AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        COUNT(ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_inc_tax\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_bill_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating\n    FROM \n        customer_demographics cd\n)\n\nSELECT \n    cr.c_first_name,\n    cr.c_last_name,\n    cr.total_store_returns,\n    COALESCE(wss.total_orders, 0) AS total_web_orders,\n    COALESCE(wss.total_net_paid_inc_tax, 0) AS total_web_spending,\n    CASE \n        WHEN cr.total_store_returns > 0 THEN 'Returns'\n        ELSE 'No Returns'\n    END AS return_status\nFROM \n    CustomerReturns cr\nLEFT JOIN \n    WebSalesSummary wss ON cr.c_customer_sk = wss.ws_bill_customer_sk\nJOIN \n    CustomerDemographics cd ON cr.c_customer_sk = cd.cd_demo_sk\nWHERE \n    (cd.cd_gender = 'F' AND cr.total_net_loss > 100) OR \n    (cd.cd_gender = 'M' AND cr.total_store_returns > 5)\nORDER BY \n    cr.total_store_returns DESC, \n    wss.total_net_paid_inc_tax DESC\nLIMIT 100;\n",
  "\nWITH customer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        ca.ca_city,\n        ca.ca_state,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_dep_count\n    FROM \n        customer AS c\n    JOIN \n        customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nsales_summary AS (\n    SELECT \n        ws_bill_customer_sk,\n        COUNT(ws_order_number) AS total_orders,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_ext_discount_amt) AS total_discount\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n)\nSELECT\n    ci.c_customer_sk,\n    ci.c_first_name,\n    ci.c_last_name,\n    ci.ca_city,\n    ci.ca_state,\n    ci.cd_gender,\n    ss.total_orders,\n    ss.total_quantity,\n    ss.total_sales,\n    ss.total_discount,\n    CASE\n        WHEN ss.total_sales >= 500 THEN 'High Value'\n        WHEN ss.total_sales >= 100 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_segment\nFROM \n    customer_info AS ci\nLEFT JOIN \n    sales_summary AS ss ON ci.c_customer_sk = ss.ws_bill_customer_sk\nWHERE \n    ci.cd_gender = 'F'\n    AND ci.ca_state IN ('CA', 'NY', 'TX')\nORDER BY \n    ci.c_last_name, ci.c_first_name;\n",
  "\nWITH CustomerData AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        NULLIF(cd.cd_dep_count, 0) AS dep_count,\n        COALESCE(cd.cd_dep_employed_count, 0) AS employed_count,\n        COALESCE(cd.cd_dep_college_count, 0) AS college_count\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nSalesData AS (\n    SELECT\n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        AVG(ws.ws_net_profit) AS average_profit\n    FROM\n        web_sales ws\n    WHERE\n        ws.ws_sold_date_sk = (SELECT MAX(d.d_date_sk) \n                               FROM date_dim d \n                               WHERE d.d_year = 2023)\n    GROUP BY\n        ws.ws_bill_customer_sk\n),\nReturnData AS (\n    SELECT \n        sr.sr_customer_sk,\n        SUM(sr.sr_return_amt_inc_tax) AS total_returns\n    FROM \n        store_returns sr\n    WHERE \n        sr.sr_returned_date_sk >= (SELECT MIN(d.d_date_sk) \n                                     FROM date_dim d \n                                     WHERE d.d_year = 2023)\n    GROUP BY \n        sr.sr_customer_sk\n)\nSELECT \n    cd.c_customer_sk,\n    cd.c_first_name || ' ' || cd.c_last_name AS full_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    COALESCE(sd.total_sales, 0) AS total_sales,\n    COALESCE(sd.order_count, 0) AS order_count,\n    COALESCE(rd.total_returns, 0) AS total_returns,\n    (COALESCE(sd.total_sales, 0) - COALESCE(rd.total_returns, 0)) AS net_sales,\n    CASE \n        WHEN cd.cd_purchase_estimate > 1000 THEN 'High Value'\n        WHEN cd.cd_purchase_estimate BETWEEN 500 AND 1000 THEN 'Medium Value'\n        ELSE 'Low Value' \n    END AS customer_value_category\nFROM \n    CustomerData cd\nLEFT JOIN \n    SalesData sd ON cd.c_customer_sk = sd.ws_bill_customer_sk\nLEFT JOIN \n    ReturnData rd ON cd.c_customer_sk = rd.sr_customer_sk\nWHERE \n    cd.dep_count IS NOT NULL\nORDER BY \n    net_sales DESC\nLIMIT 100;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(SUM(ws.ws_net_paid), 0) AS total_web_sales,\n        COALESCE(SUM(cs.cs_net_paid), 0) AS total_catalog_sales,\n        COALESCE(SUM(ss.ss_net_paid), 0) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nsales_summary AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.total_web_sales,\n        cs.total_catalog_sales,\n        cs.total_store_sales,\n        SUM(cs.total_web_sales + cs.total_catalog_sales + cs.total_store_sales) AS grand_total,\n        CASE \n            WHEN SUM(cs.total_web_sales + cs.total_catalog_sales + cs.total_store_sales) > 1000 THEN 'High Value'\n            WHEN SUM(cs.total_web_sales + cs.total_catalog_sales + cs.total_store_sales) BETWEEN 500 AND 1000 THEN 'Medium Value'\n            ELSE 'Low Value'\n        END AS customer_value\n    FROM \n        customer_sales cs\n    GROUP BY \n        cs.c_customer_sk, cs.c_first_name, cs.c_last_name, cs.total_web_sales, cs.total_catalog_sales, cs.total_store_sales\n    HAVING \n        SUM(cs.total_web_sales + cs.total_catalog_sales + cs.total_store_sales) > 0\n)\nSELECT \n    customer_value, \n    COUNT(*) AS customer_count,\n    AVG(grand_total) AS average_spent,\n    MAX(grand_total) AS max_spent,\n    MIN(grand_total) AS min_spent\nFROM \n    sales_summary\nGROUP BY \n    customer_value\nORDER BY \n    customer_value DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        c.c_customer_id,\n        SUM(CASE WHEN sr_return_quantity > 0 THEN sr_return_quantity ELSE 0 END) AS total_return_quantity,\n        SUM(CASE WHEN sr_return_amt > 0 THEN sr_return_amt ELSE 0 END) AS total_return_amt,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM \n        store_returns sr\n    JOIN \n        customer c ON sr.sr_customer_sk = c.c_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nSalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_sales_price) AS total_sales_amt,\n        COUNT(DISTINCT ws_order_number) AS order_count\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nCombinedData AS (\n    SELECT \n        c.c_customer_id,\n        COALESCE(cr.total_return_quantity, 0) AS total_return_quantity,\n        COALESCE(cr.total_return_amt, 0) AS total_return_amt,\n        COALESCE(sd.total_sales_amt, 0) AS total_sales_amt,\n        COALESCE(sd.order_count, 0) AS order_count\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_id = cr.c_customer_id\n    LEFT JOIN \n        SalesData sd ON c.c_customer_sk = sd.ws_bill_customer_sk\n)\nSELECT \n    total_return_quantity,\n    total_return_amt,\n    total_sales_amt,\n    order_count,\n    CASE \n        WHEN total_sales_amt = 0 THEN 0 \n        ELSE (total_return_amt / total_sales_amt) * 100 \n    END AS return_rate_percentage\nFROM \n    CombinedData\nORDER BY \n    return_rate_percentage DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        SUM(ws.ws_net_paid) AS total_web_sales,\n        SUM(cs.cs_net_paid) AS total_catalog_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_web_orders,\n        COUNT(DISTINCT cs.cs_order_number) AS total_catalog_orders\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    WHERE \n        c.c_current_cdemo_sk IS NOT NULL\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating\n    FROM \n        customer_demographics cd\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_web_sales,\n    cs.total_catalog_sales,\n    d.cd_gender,\n    d.cd_marital_status,\n    d.cd_education_status\nFROM \n    CustomerSales cs\nJOIN \n    Demographics d ON cs.c_customer_sk = d.cd_demo_sk\nWHERE \n    cs.total_web_sales > 1000 \nORDER BY \n    cs.total_web_sales DESC \nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(CASE \n            WHEN ws.ws_ship_date_sk IS NOT NULL THEN ws.ws_ext_sales_price \n            ELSE 0 \n        END) AS web_sales,\n        SUM(CASE \n            WHEN cs.cs_ship_date_sk IS NOT NULL THEN cs.cs_ext_sales_price \n            ELSE 0 \n        END) AS catalog_sales,\n        SUM(CASE \n            WHEN ss.ss_sold_date_sk IS NOT NULL THEN ss.ss_ext_sales_price \n            ELSE 0 \n        END) AS store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nSalesSummary AS (\n    SELECT \n        SUM(web_sales) AS total_web_sales,\n        SUM(catalog_sales) AS total_catalog_sales,\n        SUM(store_sales) AS total_store_sales,\n        COUNT(c_customer_id) AS customer_count\n    FROM \n        CustomerSales\n)\nSELECT \n    total_web_sales,\n    total_catalog_sales,\n    total_store_sales,\n    customer_count,\n    (total_web_sales + total_catalog_sales + total_store_sales) AS total_sales,\n    ROUND((total_web_sales + total_catalog_sales + total_store_sales) / customer_count, 2) AS average_sales_per_customer\nFROM \n    SalesSummary;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        cr_returning_customer_sk, \n        SUM(cr_return_quantity) AS total_returned_quantity, \n        COUNT(DISTINCT cr_order_number) AS total_returns\n    FROM \n        catalog_returns\n    GROUP BY \n        cr_returning_customer_sk\n),\nWebSales AS (\n    SELECT \n        ws_ship_customer_sk, \n        SUM(ws_net_profit) AS total_net_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_ship_customer_sk\n),\nStoreSales AS (\n    SELECT \n        ss_customer_sk, \n        SUM(ss_net_profit) AS total_net_profit\n    FROM \n        store_sales\n    GROUP BY \n        ss_customer_sk\n),\nCombinedSales AS (\n    SELECT \n        COALESCE(ws.ws_ship_customer_sk, ss.ss_customer_sk) AS customer_sk,\n        COALESCE(ws.total_net_profit, 0) + COALESCE(ss.total_net_profit, 0) AS overall_net_profit\n    FROM \n        WebSales ws\n    FULL OUTER JOIN \n        StoreSales ss ON ws.ws_ship_customer_sk = ss.ss_customer_sk\n),\nFinalReport AS (\n    SELECT \n        c.c_customer_id,\n        COALESCE(cr.total_returned_quantity, 0) AS total_returned_quantity,\n        COALESCE(cr.total_returns, 0) AS total_return_count,\n        cs.overall_net_profit\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\n    LEFT JOIN \n        CombinedSales cs ON c.c_customer_sk = cs.customer_sk\n)\nSELECT \n    f.c_customer_id,\n    f.total_returned_quantity,\n    f.total_return_count,\n    f.overall_net_profit\nFROM \n    FinalReport f\nWHERE \n    f.overall_net_profit > 1000\nORDER BY \n    overall_net_profit DESC\nLIMIT 100;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_order_number,\n        ws.ws_quantity,\n        ws.ws_net_paid,\n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        dd.d_year,\n        dd.d_month_seq\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n),\nAggregatedSales AS (\n    SELECT \n        c_customer_id,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_net_paid) AS total_spent,\n        MAX(d_year) AS last_purchase_year,\n        MAX(d_month_seq) AS last_purchase_month,\n        cd_gender,\n        cd_marital_status,\n        cd_education_status\n    FROM \n        SalesData\n    GROUP BY \n        c_customer_id, cd_gender, cd_marital_status, cd_education_status\n)\nSELECT \n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    AVG(total_quantity) AS avg_quantity,\n    AVG(total_spent) AS avg_spent,\n    COUNT(c_customer_id) AS customer_count\nFROM \n    AggregatedSales\nGROUP BY \n    cd_gender, cd_marital_status, cd_education_status\nORDER BY \n    avg_spent DESC\nLIMIT 10;\n",
  "WITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS number_of_orders\n    FROM customer AS c\n    JOIN customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2001 \n        AND d.d_moy IN (11, 12) \n    GROUP BY \n        c.c_customer_id, \n        cd.cd_gender\n),\nSalesSummary AS (\n    SELECT \n        cd_gender,\n        COUNT(c_customer_id) AS customer_count,\n        SUM(total_sales) AS total_sales,\n        AVG(total_sales) AS avg_sales_per_customer,\n        SUM(number_of_orders) AS total_orders\n    FROM CustomerSales\n    GROUP BY cd_gender\n)\nSELECT \n    cd_gender,\n    customer_count,\n    total_sales,\n    avg_sales_per_customer,\n    total_orders,\n    CASE \n        WHEN avg_sales_per_customer >= 1000 THEN 'High Value'\n        WHEN avg_sales_per_customer BETWEEN 500 AND 999 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_segment\nFROM SalesSummary\nORDER BY total_sales DESC;",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nSalesStatistics AS (\n    SELECT \n        total_web_sales,\n        total_catalog_sales,\n        total_store_sales,\n        (total_web_sales + total_catalog_sales + total_store_sales) AS total_sales,\n        CASE \n            WHEN (total_web_sales + total_catalog_sales + total_store_sales) = 0 THEN 0\n            ELSE total_web_sales * 1.0 / (total_web_sales + total_catalog_sales + total_store_sales) \n        END AS web_sales_ratio,\n        CASE \n            WHEN (total_web_sales + total_catalog_sales + total_store_sales) = 0 THEN 0\n            ELSE total_catalog_sales * 1.0 / (total_web_sales + total_catalog_sales + total_store_sales) \n        END AS catalog_sales_ratio,\n        CASE \n            WHEN (total_web_sales + total_catalog_sales + total_store_sales) = 0 THEN 0\n            ELSE total_store_sales * 1.0 / (total_web_sales + total_catalog_sales + total_store_sales) \n        END AS store_sales_ratio\n    FROM \n        CustomerSales\n)\nSELECT \n    AVG(total_web_sales) AS avg_web_sales,\n    AVG(total_catalog_sales) AS avg_catalog_sales,\n    AVG(total_store_sales) AS avg_store_sales,\n    AVG(total_sales) AS avg_total_sales,\n    AVG(web_sales_ratio) AS avg_web_sales_ratio,\n    AVG(catalog_sales_ratio) AS avg_catalog_sales_ratio,\n    AVG(store_sales_ratio) AS avg_store_sales_ratio\nFROM \n    SalesStatistics\nWHERE \n    total_sales > 0\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_net_paid) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count\n    FROM customer c\n    JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY c.c_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM customer_demographics cd\n    JOIN customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n),\nSalesWithDemographics AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_sales,\n        cs.order_count,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM CustomerSales cs\n    JOIN CustomerDemographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n)\nSELECT \n    swd.cd_gender,\n    swd.cd_marital_status,\n    swd.cd_education_status,\n    COUNT(swd.c_customer_sk) AS customer_count,\n    AVG(swd.total_sales) AS average_sales,\n    SUM(swd.order_count) AS total_orders\nFROM SalesWithDemographics swd\nWHERE swd.total_sales > 1000\nGROUP BY \n    swd.cd_gender,\n    swd.cd_marital_status,\n    swd.cd_education_status\nORDER BY average_sales DESC;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        SUM(cd.cd_purchase_estimate) AS total_purchase_estimate,\n        AVG(cd.cd_dep_count) AS avg_dependents\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n),\n\nWebSalesStats AS (\n    SELECT \n        ws.ws_web_site_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_web_site_sk\n),\n\nStoreSalesStats AS (\n    SELECT \n        ss.ss_store_sk,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_store_orders\n    FROM \n        store_sales ss\n    GROUP BY \n        ss.ss_store_sk\n),\n\nSummaryStats AS (\n    SELECT \n        cs.customer_count,\n        cs.total_purchase_estimate,\n        cs.avg_dependents,\n        ws.total_sales AS web_sales,\n        ss.total_store_sales AS store_sales\n    FROM \n        CustomerStats cs\n    JOIN \n        WebSalesStats ws ON cs.customer_count > 100\n    JOIN \n        StoreSalesStats ss ON ws.total_orders > 50\n)\n\nSELECT \n    customer_count,\n    total_purchase_estimate,\n    avg_dependents,\n    web_sales,\n    store_sales,\n    (web_sales + store_sales) AS total_sales_combined\nFROM \n    SummaryStats\nORDER BY \n    total_sales_combined DESC\nLIMIT 10;\n",
  "\nWITH aggregated_sales AS (\n    SELECT \n        ws_sold_date_sk,\n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_ext_sales_price) AS total_sales,\n        AVG(ws_net_profit) AS avg_net_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_sold_date_sk, ws_item_sk\n),\nhigh_sales_items AS (\n    SELECT \n        a.ws_item_sk,\n        a.total_quantity,\n        a.total_sales,\n        a.avg_net_profit,\n        i.i_item_desc,\n        i.i_current_price,\n        i.i_brand,\n        i.i_category\n    FROM \n        aggregated_sales a\n    JOIN \n        item i ON a.ws_item_sk = i.i_item_sk\n    WHERE \n        a.total_sales > 100000\n),\ntop_customers AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_paid) AS total_spent\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n    HAVING \n        SUM(ws_net_paid) > 5000\n)\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    hsi.i_item_desc,\n    hsi.total_quantity,\n    hsi.total_sales,\n    hsi.avg_net_profit,\n    tc.total_spent\nFROM \n    top_customers tc\nJOIN \n    customer c ON tc.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    high_sales_items hsi ON c.c_current_addr_sk = hsi.ws_item_sk\nORDER BY \n    tc.total_spent DESC, hsi.total_sales DESC\nLIMIT 10;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_order_number,\n        ws.ws_item_sk,\n        ws.ws_sales_price,\n        COALESCE(sr.sr_return_quantity, 0) AS return_quantity,\n        COALESCE(sr.sr_return_amt, 0) AS return_amt,\n        COALESCE(cr.cr_return_quantity, 0) AS catalog_return_quantity,\n        COALESCE(cr.cr_return_amount, 0) AS catalog_return_amt,\n        wd.d_week_seq,\n        wd.d_year\n    FROM \n        web_sales ws\n    LEFT JOIN \n        store_returns sr ON ws.ws_order_number = sr.sr_ticket_number AND ws.ws_item_sk = sr.sr_item_sk\n    LEFT JOIN \n        catalog_returns cr ON ws.ws_order_number = cr.cr_order_number AND ws.ws_item_sk = cr.cr_item_sk\n    JOIN \n        date_dim wd ON ws.ws_sold_date_sk = wd.d_date_sk\n),\n\nsummary AS (\n    SELECT \n        d_year,\n        d_week_seq,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_sales_price) AS total_sales,\n        SUM(return_quantity) AS total_returns,\n        SUM(return_amt) AS total_returned_amt,\n        SUM(catalog_return_quantity) AS total_catalog_returns,\n        SUM(catalog_return_amt) AS total_catalog_returned_amt\n    FROM \n        sales_data\n    GROUP BY \n        d_year, d_week_seq\n)\n\nSELECT \n    s.d_year,\n    s.d_week_seq,\n    s.total_orders,\n    s.total_sales,\n    s.total_returns,\n    s.total_returned_amt,\n    s.total_catalog_returns,\n    s.total_catalog_returned_amt,\n    (s.total_sales - s.total_returned_amt - s.total_catalog_returned_amt) AS net_sales,\n    CASE \n        WHEN s.total_orders > 0 THEN (s.total_sales / s.total_orders) \n        ELSE 0 \n    END AS average_order_value\nFROM \n    summary s\nORDER BY \n    s.d_year, s.d_week_seq;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id\n), \nSalesSummary AS (\n    SELECT \n        c.c_customer_id,\n        total_web_sales,\n        total_catalog_sales,\n        total_store_sales,\n        COALESCE(total_web_sales, 0) + COALESCE(total_catalog_sales, 0) + COALESCE(total_store_sales, 0) AS total_sales,\n        CASE \n            WHEN SUM(total_web_sales) > 1000 THEN 'High Spender'\n            WHEN SUM(total_web_sales) > 500 THEN 'Medium Spender'\n            ELSE 'Low Spender'\n        END AS spender_category\n    FROM \n        CustomerSales c\n    GROUP BY \n        c.c_customer_id,\n        total_web_sales,\n        total_catalog_sales,\n        total_store_sales\n)\nSELECT \n    s.c_customer_id,\n    s.total_web_sales,\n    s.total_catalog_sales,\n    s.total_store_sales,\n    s.total_sales,\n    s.spender_category\nFROM \n    SalesSummary s\nWHERE \n    s.total_sales > (SELECT AVG(total_sales) FROM SalesSummary)\nORDER BY \n    s.total_sales DESC\nLIMIT 10;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_ext_discount_amt) AS total_discount,\n        COUNT(ws_order_number) AS order_count,\n        CAST(d_date AS DATE) AS sale_date\n    FROM \n        web_sales \n    JOIN \n        date_dim ON ws_sold_date_sk = d_date_sk\n    GROUP BY \n        ws_bill_customer_sk, CAST(d_date AS DATE)\n),\nCustomerData AS (\n    SELECT \n        c_customer_sk,\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_dep_count,\n        cd_dep_employed_count,\n        cd_dep_college_count\n    FROM \n        customer\n    JOIN \n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n),\nCombinedData AS (\n    SELECT \n        s.ws_bill_customer_sk,\n        c.cd_gender,\n        c.cd_marital_status,\n        c.cd_education_status,\n        c.cd_dep_count,\n        c.cd_dep_employed_count,\n        c.cd_dep_college_count,\n        s.total_sales,\n        s.total_discount,\n        s.order_count,\n        s.sale_date\n    FROM \n        SalesData s\n    JOIN \n        CustomerData c ON s.ws_bill_customer_sk = c.c_customer_sk\n)\nSELECT \n    cd_gender, \n    cd_marital_status, \n    cd_education_status,\n    AVG(total_sales) AS avg_sales,\n    AVG(total_discount) AS avg_discount,\n    COUNT(DISTINCT ws_bill_customer_sk) AS customer_count\nFROM \n    CombinedData\nGROUP BY \n    cd_gender, \n    cd_marital_status, \n    cd_education_status\nHAVING \n    AVG(total_sales) > 1000\nORDER BY \n    avg_sales DESC;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        dd.d_year,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales,\n        SUM(ws.ws_ext_tax) AS total_tax,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        COUNT(DISTINCT ws.ws_bill_customer_sk) AS unique_customers\n    FROM \n        web_sales ws \n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN \n        customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk\n    WHERE \n        dd.d_year = 2022\n        AND cd.cd_marital_status = 'M'\n        AND ca.ca_state = 'CA'\n    GROUP BY \n        ws.ws_sold_date_sk, dd.d_year\n),\naggregated_data AS (\n    SELECT \n        d_year,\n        SUM(total_sales) AS yearly_sales,\n        SUM(total_tax) AS yearly_tax,\n        SUM(order_count) AS total_orders,\n        SUM(unique_customers) AS total_customers\n    FROM \n        sales_data\n    GROUP BY \n        d_year\n)\nSELECT \n    ad.d_year,\n    ad.yearly_sales,\n    ad.yearly_tax,\n    ad.total_orders,\n    ad.total_customers,\n    (ad.yearly_sales - ad.yearly_tax) AS net_sales\nFROM \n    aggregated_data ad\nORDER BY \n    ad.d_year DESC;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        ca_state,\n        cd_gender,\n        COUNT(DISTINCT c_customer_id) AS total_customers,\n        SUM(cd_dep_count) AS total_dependent_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    GROUP BY \n        ca_state, cd_gender\n), \nSalesStats AS (\n    SELECT \n        ws_bill_cdemo_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit\n    FROM \n        web_sales \n    GROUP BY \n        ws_bill_cdemo_sk\n), \nFinalStats AS (\n    SELECT \n        cs.ca_state,\n        cs.cd_gender,\n        cs.total_customers,\n        cs.total_dependent_count,\n        cs.avg_purchase_estimate,\n        ss.total_sales,\n        ss.total_profit\n    FROM \n        CustomerStats cs\n    LEFT JOIN \n        SalesStats ss ON cs.total_customers = ss.ws_bill_cdemo_sk\n)\nSELECT \n    ca_state,\n    cd_gender,\n    total_customers,\n    total_dependent_count,\n    avg_purchase_estimate,\n    COALESCE(total_sales, 0) AS total_sales,\n    COALESCE(total_profit, 0) AS total_profit\nFROM \n    FinalStats\nORDER BY \n    ca_state, cd_gender;\n",
  "WITH AddressCounts AS (\n    SELECT \n        ca_state, \n        COUNT(DISTINCT ca_address_id) AS unique_addresses, \n        COUNT(*) AS total_addresses \n    FROM \n        customer_address \n    GROUP BY \n        ca_state\n), \nDemographicStats AS (\n    SELECT \n        cd_gender,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependents \n    FROM \n        customer_demographics \n    GROUP BY \n        cd_gender\n), \nSalesData AS (\n    SELECT \n        w.w_warehouse_name,\n        SUM(ws_ext_sales_price) AS total_sales \n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk \n    GROUP BY \n        w.w_warehouse_name\n), \nCombinedData AS (\n    SELECT \n        ac.ca_state,\n        ac.unique_addresses,\n        ac.total_addresses,\n        ds.cd_gender,\n        ds.avg_purchase_estimate,\n        ds.total_dependents,\n        sd.w_warehouse_name,\n        sd.total_sales\n    FROM \n        AddressCounts ac\n    JOIN \n        DemographicStats ds ON ac.ca_state = 'CA'  \n    JOIN \n        SalesData sd ON sd.total_sales > 10000  \n)\nSELECT \n    ca_state,\n    unique_addresses,\n    total_addresses,\n    cd_gender,\n    avg_purchase_estimate,\n    total_dependents,\n    w_warehouse_name,\n    total_sales\nFROM \n    CombinedData\nORDER BY \n    unique_addresses DESC, \n    avg_purchase_estimate DESC;",
  "\nWITH CustomerDetails AS (\n    SELECT \n        CONCAT(c.c_first_name, ' ', c.c_last_name) AS full_name,\n        ca.ca_city,\n        ca.ca_state,\n        cd.cd_gender,\n        COUNT(DISTINCT sr.sr_item_sk) AS total_returns,\n        SUM(sr.sr_return_amt) AS total_return_amount\n    FROM customer c\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    WHERE cd.cd_gender IN ('M', 'F')\n    GROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, cd.cd_gender\n),\nReturnStats AS (\n    SELECT \n        ca_state,\n        cd_gender,\n        AVG(total_returns) AS avg_returns,\n        SUM(total_return_amount) AS total_return_volume\n    FROM CustomerDetails\n    GROUP BY ca_state, cd_gender\n)\nSELECT \n    r.ca_state,\n    r.cd_gender,\n    r.avg_returns,\n    r.total_return_volume,\n    CASE \n        WHEN r.avg_returns > 10 THEN 'High Return'\n        WHEN r.avg_returns BETWEEN 5 AND 10 THEN 'Moderate Return'\n        ELSE 'Low Return'\n    END AS return_category\nFROM ReturnStats r\nORDER BY r.ca_state, r.cd_gender;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_paid) AS total_net_paid\n    FROM \n        web_sales ws\n    INNER JOIN \n        item i ON ws.ws_item_sk = i.i_item_sk\n    WHERE \n        i.i_current_price > 20.00\n    GROUP BY \n        ws.ws_sold_date_sk, ws.ws_item_sk\n),\nReturnData AS (\n    SELECT \n        wr.wr_item_sk,\n        SUM(wr.wr_return_quantity) AS total_return_quantity,\n        SUM(wr.wr_return_amt) AS total_return_amt\n    FROM \n        web_returns wr\n    GROUP BY \n        wr.wr_item_sk\n)\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    COALESCE(sd.total_quantity, 0) AS sold_quantity,\n    COALESCE(rd.total_return_quantity, 0) AS returned_quantity,\n    COALESCE(sd.total_net_paid, 0) AS total_sales_amount,\n    COALESCE(rd.total_return_amt, 0) AS total_return_amount,\n    (COALESCE(sd.total_net_paid, 0) - COALESCE(rd.total_return_amt, 0)) AS net_revenue,\n    CASE \n        WHEN COALESCE(sd.total_quantity, 0) = 0 THEN NULL\n        ELSE ROUND((COALESCE(rd.total_return_quantity, 0) * 100.0) / COALESCE(sd.total_quantity, 0), 2)\n    END AS return_rate_percentage\nFROM \n    item i\nLEFT JOIN \n    SalesData sd ON i.i_item_sk = sd.ws_item_sk\nLEFT JOIN \n    ReturnData rd ON i.i_item_sk = rd.wr_item_sk\nWHERE \n    i.i_item_desc LIKE '%Gadget%'\nORDER BY \n    net_revenue DESC\nLIMIT 100;\n",
  "\nWITH CustomerRefunds AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_store_returns,\n        SUM(sr_return_amt_inc_tax) AS total_refund_amount\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nWebRefunds AS (\n    SELECT \n        wr_returning_customer_sk,\n        COUNT(DISTINCT wr_order_number) AS total_web_returns,\n        SUM(wr_return_amt_inc_tax) AS total_web_refund_amount\n    FROM \n        web_returns\n    GROUP BY \n        wr_returning_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_credit_rating\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n)\nSELECT \n    cd.c_customer_sk,\n    COALESCE(cr.total_store_returns, 0) AS store_return_count,\n    COALESCE(cr.total_refund_amount, 0) AS store_refund_amount,\n    COALESCE(wr.total_web_returns, 0) AS web_return_count,\n    COALESCE(wr.total_web_refund_amount, 0) AS web_refund_amount,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    cd.cd_credit_rating\nFROM \n    CustomerDemographics cd\nLEFT JOIN \n    CustomerRefunds cr ON cd.c_customer_sk = cr.sr_customer_sk\nLEFT JOIN \n    WebRefunds wr ON cd.c_customer_sk = wr.wr_returning_customer_sk\nWHERE \n    (cr.total_store_returns > 2 OR wr.total_web_returns > 3)\n    AND cd.cd_gender = 'F'\n    AND cd.cd_marital_status IS NOT NULL\nORDER BY \n    store_refund_amount DESC \nLIMIT 50;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        d.d_year, \n        d.d_month_seq, \n        d.d_quarter_seq, \n        SUM(ws.ws_net_paid) AS total_sales, \n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        COUNT(DISTINCT ws.ws_bill_customer_sk) AS unique_customers\n    FROM \n        web_sales AS ws\n    JOIN \n        date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\n    JOIN \n        customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        d.d_year = 2023\n        AND cd.cd_gender = 'F'\n        AND cd.cd_marital_status = 'M'\n    GROUP BY \n        d.d_year, d.d_month_seq, d.d_quarter_seq\n), avg_sales AS (\n    SELECT \n        d_year, \n        d_month_seq, \n        d_quarter_seq, \n        total_sales, \n        total_orders, \n        unique_customers,\n        total_sales / NULLIF(total_orders, 0) AS avg_order_value,\n        unique_customers / NULLIF(total_orders, 0) AS avg_customers_per_order\n    FROM \n        sales_summary\n)\n\nSELECT \n    d_year, \n    d_month_seq, \n    d_quarter_seq, \n    total_sales, \n    total_orders, \n    unique_customers, \n    avg_order_value, \n    avg_customers_per_order\nFROM \n    avg_sales\nORDER BY \n    d_year, \n    d_quarter_seq, \n    d_month_seq;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_profit) AS avg_net_profit\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2022) \n                               AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        c.c_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COUNT(DISTINCT cs.c_customer_sk) AS associated_customers\n    FROM \n        customer_demographics cd\n    JOIN \n        CustomerSales cs ON cd.cd_demo_sk = cs.c_customer_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    AVG(cs.total_web_sales) AS avg_web_sales,\n    SUM(cs.total_orders) AS total_orders,\n    AVG(cs.avg_net_profit) AS avg_net_profit\nFROM \n    CustomerDemographics cd\nJOIN \n    CustomerSales cs ON cd.associated_customers = cs.c_customer_sk\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\nORDER BY \n    avg_web_sales DESC;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        ws.ws_quantity,\n        ws.ws_sales_price,\n        ck.c_customer_id,\n        ck.c_first_name,\n        ck.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        dd.d_year,\n        dd.d_month_seq,\n        dd.d_week_seq\n    FROM \n        web_sales ws\n        JOIN customer ck ON ws.ws_bill_customer_sk = ck.c_customer_sk\n        JOIN customer_demographics cd ON ck.c_current_cdemo_sk = cd.cd_demo_sk\n        JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n        AND dd.d_month_seq IN (1, 2, 3)\n),\naggregated_sales AS (\n    SELECT \n        d_year,\n        d_month_seq,\n        d_week_seq,\n        cd_gender,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_sales_price) AS total_sales,\n        COUNT(DISTINCT c_customer_id) AS unique_customers\n    FROM \n        sales_data\n    GROUP BY \n        d_year, d_month_seq, d_week_seq, cd_gender\n)\nSELECT \n    d_year,\n    d_month_seq,\n    d_week_seq,\n    cd_gender,\n    total_quantity,\n    total_sales,\n    unique_customers,\n    ROUND(total_sales / NULLIF(unique_customers, 0), 2) AS avg_sales_per_customer\nFROM \n    aggregated_sales\nORDER BY \n    d_year ASC, d_month_seq ASC, d_week_seq ASC, cd_gender;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ss.ss_sales_price) AS total_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        customer c\n    JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\naverage_sales AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        AVG(total_sales) AS avg_sales,\n        AVG(total_transactions) AS avg_transactions\n    FROM \n        customer_sales\n    GROUP BY \n        cd_gender, cd_marital_status, cd_education_status\n)\nSELECT \n    a.cd_gender,\n    a.cd_marital_status,\n    a.cd_education_status,\n    COALESCE(b.avg_sales, 0) AS avg_sales,\n    b.avg_transactions\nFROM \n    (SELECT DISTINCT cd_gender, cd_marital_status, cd_education_status FROM customer_demographics) a\nLEFT JOIN \n    average_sales b ON a.cd_gender = b.cd_gender \n                    AND a.cd_marital_status = b.cd_marital_status \n                    AND a.cd_education_status = b.cd_education_status\nORDER BY \n    a.cd_gender, a.cd_marital_status, a.cd_education_status;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        COUNT(ws.ws_order_number) AS web_order_count,\n        AVG(ws.ws_net_paid) AS avg_web_order_value\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\n\nStoreSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ss.ss_net_paid) AS total_store_sales,\n        COUNT(ss.ss_ticket_number) AS store_order_count,\n        AVG(ss.ss_net_paid) AS avg_store_order_value\n    FROM \n        customer c\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\n\nSalesComparison AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_web_sales,\n        cs.web_order_count,\n        cs.avg_web_order_value,\n        ss.total_store_sales,\n        ss.store_order_count,\n        ss.avg_store_order_value\n    FROM \n        CustomerSales cs\n    JOIN \n        StoreSales ss ON cs.c_customer_sk = ss.c_customer_sk\n)\n\nSELECT \n    s.c_customer_sk,\n    COALESCE(s.total_web_sales, 0) AS total_web_sales,\n    COALESCE(s.web_order_count, 0) AS web_order_count,\n    COALESCE(s.avg_web_order_value, 0) AS avg_web_order_value,\n    COALESCE(s.total_store_sales, 0) AS total_store_sales,\n    COALESCE(s.store_order_count, 0) AS store_order_count,\n    COALESCE(s.avg_store_order_value, 0) AS avg_store_order_value,\n    (CASE \n        WHEN COALESCE(s.total_web_sales, 0) = 0 THEN 0\n        ELSE (COALESCE(s.total_store_sales, 0) / COALESCE(s.total_web_sales, 1))\n    END) AS store_to_web_sales_ratio\nFROM \n    SalesComparison s\nORDER BY \n    s.c_customer_sk;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        AVG(ws.ws_list_price) AS avg_list_price,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023 \n        AND dd.d_month_seq IN (1, 2, 3)\n    GROUP BY \n        ws.ws_item_sk\n),\nCustomerData AS (\n    SELECT \n        cd.cd_demo_sk,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd.cd_dep_college_count) AS total_college_deps\n    FROM \n        customer c \n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        cd.cd_gender = 'F' \n        AND cd.cd_marital_status = 'M'\n    GROUP BY \n        cd.cd_demo_sk\n),\nFinalReport AS (\n    SELECT \n        sd.ws_item_sk,\n        sd.total_quantity,\n        sd.total_sales,\n        sd.avg_list_price,\n        cd.customer_count,\n        cd.avg_purchase_estimate,\n        cd.total_college_deps\n    FROM \n        SalesData sd\n    LEFT JOIN \n        CustomerData cd ON sd.ws_item_sk = cd.cd_demo_sk\n)\nSELECT \n    fr.ws_item_sk,\n    fr.total_quantity,\n    fr.total_sales,\n    fr.avg_list_price,\n    fr.customer_count,\n    fr.avg_purchase_estimate,\n    fr.total_college_deps\nFROM \n    FinalReport fr\nWHERE \n    fr.total_sales > 10000 \nORDER BY \n    fr.total_sales DESC\nLIMIT 50;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_sales_price) AS total_sales,\n        SUM(ws_ext_discount_amt) AS total_discount,\n        ws_ship_mode_sk\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_item_sk, ws_ship_mode_sk\n),\nWarehouseStats AS (\n    SELECT \n        w.w_warehouse_sk, \n        w.w_warehouse_name, \n        COUNT(DISTINCT sd.ws_item_sk) AS items_sold,\n        AVG(sd.total_quantity) AS avg_quantity_per_item,\n        SUM(sd.total_sales) AS total_sales_amount,\n        sd.ws_ship_mode_sk\n    FROM \n        SalesData AS sd\n    JOIN \n        inventory AS inv ON sd.ws_item_sk = inv.inv_item_sk\n    JOIN \n        warehouse AS w ON inv.inv_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        w.w_warehouse_sk, w.w_warehouse_name, sd.ws_ship_mode_sk\n)\nSELECT \n    ws.w_warehouse_name AS warehouse_name,\n    ws.items_sold,\n    ws.avg_quantity_per_item,\n    ws.total_sales_amount,\n    sm.sm_type AS shipping_method\nFROM \n    WarehouseStats AS ws\nJOIN \n    ship_mode AS sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk\nORDER BY \n    ws.total_sales_amount DESC\nLIMIT 10;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        AVG(ws.ws_net_profit) AS avg_net_profit,\n        COUNT(ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nIncomeSegment AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.cd_gender,\n        cs.cd_marital_status,\n        cs.cd_education_status,\n        CASE \n            WHEN hd.hd_income_band_sk BETWEEN 1 AND 3 THEN 'Low Income'\n            WHEN hd.hd_income_band_sk BETWEEN 4 AND 6 THEN 'Middle Income'\n            ELSE 'High Income'\n        END AS income_band,\n        cs.avg_net_profit,\n        cs.order_count\n    FROM \n        CustomerStats cs\n    JOIN \n        household_demographics hd ON cs.c_customer_sk = hd.hd_demo_sk\n),\nFinalReport AS (\n    SELECT \n        income_band,\n        COUNT(*) AS customer_count,\n        AVG(avg_net_profit) AS avg_profit,\n        SUM(order_count) AS total_orders\n    FROM \n        IncomeSegment\n    GROUP BY \n        income_band\n)\nSELECT \n    income_band,\n    customer_count,\n    avg_profit,\n    total_orders,\n    (SELECT SUM(customer_count) FROM FinalReport) AS total_customers\nFROM \n    FinalReport\nORDER BY \n    income_band;\n",
  "\nWITH AddressParts AS (\n    SELECT\n        ca_address_sk,\n        ca_street_number || ' ' || ca_street_name || ' ' || ca_street_type || \n        CASE \n            WHEN ca_suite_number IS NOT NULL THEN ' Suite ' || ca_suite_number \n            ELSE '' \n        END AS full_address,\n        ca_city,\n        ca_state,\n        ca_zip,\n        ca_country\n    FROM customer_address\n),\nCustomerInfo AS (\n    SELECT\n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        ca.full_address,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_zip,\n        ca.ca_country,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN AddressParts ca ON c.c_current_addr_sk = ca.ca_address_sk\n),\nSalesData AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count\n    FROM web_sales ws\n    GROUP BY ws.ws_bill_customer_sk\n)\nSELECT \n    ci.c_customer_sk,\n    ci.c_first_name,\n    ci.c_last_name,\n    ci.full_address,\n    ci.ca_city,\n    ci.ca_state,\n    ci.ca_zip,\n    ci.ca_country,\n    ci.cd_gender,\n    ci.cd_marital_status,\n    ci.cd_education_status,\n    COALESCE(sd.total_sales, 0) AS total_sales,\n    COALESCE(sd.order_count, 0) AS order_count\nFROM CustomerInfo ci\nLEFT JOIN SalesData sd ON ci.c_customer_sk = sd.ws_bill_customer_sk\nWHERE ci.ca_state = 'CA'\nORDER BY total_sales DESC, ci.c_last_name;\n",
  "\nWITH CustomerReturns AS (\n    SELECT\n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt_inc_tax) AS total_returned_amount,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM\n        store_returns\n    GROUP BY\n        sr_customer_sk\n),\nCustomerDemographics AS (\n    SELECT\n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate\n    FROM\n        customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nSalesData AS (\n    SELECT\n        ws_bill_customer_sk,\n        COUNT(ws_order_number) AS order_count,\n        SUM(ws_ext_sales_price) AS total_sales_amount\n    FROM\n        web_sales\n    GROUP BY\n        ws_bill_customer_sk\n)\nSELECT\n    cd.c_customer_sk,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_purchase_estimate,\n    COALESCE(cr.total_returned_quantity, 0) AS total_returned_quantity,\n    COALESCE(cr.total_returned_amount, 0) AS total_returned_amount,\n    COALESCE(sd.order_count, 0) AS order_count,\n    COALESCE(sd.total_sales_amount, 0) AS total_sales_amount,\n    (COALESCE(sd.total_sales_amount, 0) - COALESCE(cr.total_returned_amount, 0)) AS net_sales,\n    CASE \n        WHEN cd.cd_purchase_estimate > 2000 THEN 'High Value'\n        WHEN cd.cd_purchase_estimate BETWEEN 1000 AND 2000 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_segment\nFROM\n    CustomerDemographics cd\nLEFT JOIN\n    CustomerReturns cr ON cd.c_customer_sk = cr.sr_customer_sk\nLEFT JOIN\n    SalesData sd ON cd.c_customer_sk = sd.ws_bill_customer_sk\nWHERE\n    (cd.cd_gender = 'F' OR cd.cd_gender IS NULL)\n    AND (cd.cd_marital_status = 'S' OR cd.cd_marital_status IS NULL)\nORDER BY\n    net_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_order_count\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        ws.ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name\n),\nAggregateSales AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_net_paid) AS warehouse_total_sales,\n        AVG(ws.ws_net_paid_inc_tax) AS avg_net_paid,\n        MAX(ws.ws_net_profit) AS max_profit\n    FROM \n        warehouse w\n    LEFT JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n),\nHighValueCustomers AS (\n    SELECT \n        cs.c_customer_sk, \n        cs.c_first_name, \n        cs.c_last_name,\n        cs.total_web_sales,\n        CASE \n            WHEN cs.total_web_sales IS NULL THEN 'No Sales'\n            WHEN cs.total_web_sales >= 1000 THEN 'High Value'\n            ELSE 'Regular'\n        END AS customer_category\n    FROM \n        CustomerSales cs\n)\nSELECT \n    hvc.c_first_name,\n    hvc.c_last_name,\n    hvc.total_web_sales,\n    hvc.customer_category,\n    asls.warehouse_total_sales,\n    asls.avg_net_paid,\n    asls.max_profit\nFROM \n    HighValueCustomers hvc\nINNER JOIN \n    AggregateSales asls ON hvc.total_web_sales > 1000 \nORDER BY \n    hvc.total_web_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned,\n        SUM(sr_return_amt_inc_tax) AS total_return_amount\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n), \nCustomerDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating,\n        c.c_first_name,\n        c.c_last_name\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n), \nSalesData AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS number_of_sales\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_bill_customer_sk\n)\n\nSELECT \n    CD.c_customer_sk,\n    CD.c_first_name,\n    CD.c_last_name,\n    CD.cd_gender,\n    CD.cd_marital_status,\n    CD.cd_credit_rating,\n    COALESCE(SD.total_sales, 0) AS total_sales,\n    COALESCE(CR.total_returned, 0) AS total_returned,\n    COALESCE(CR.total_return_amount, 0) AS total_return_amount,\n    CASE \n        WHEN COALESCE(SD.total_sales, 0) > 0 THEN\n            (COALESCE(CR.total_returned, 0) * 100.0 / COALESCE(SD.total_sales, 1))\n        ELSE 0 \n    END AS return_rate_percentage\nFROM \n    CustomerDemographics CD\nLEFT JOIN \n    SalesData SD ON CD.c_customer_sk = SD.ws_bill_customer_sk\nLEFT JOIN \n    CustomerReturns CR ON CD.c_customer_sk = CR.sr_customer_sk\nWHERE \n    CD.cd_credit_rating = 'AAA'\n    AND (CD.cd_gender = 'F' OR CD.cd_marital_status = 'M')\nORDER BY \n    return_rate_percentage DESC, \n    total_sales DESC;\n",
  "\nWITH SalesSummary AS (\n    SELECT \n        ws_sold_date_sk,\n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS order_count\n    FROM \n        web_sales\n    GROUP BY \n        ws_sold_date_sk, ws_item_sk\n),\nItemDetails AS (\n    SELECT \n        i.i_item_sk, \n        i.i_item_id, \n        i.i_product_name, \n        COALESCE(i.i_current_price, 0) AS current_price\n    FROM \n        item i\n),\nStoreSales AS (\n    SELECT \n        ss_sold_date_sk,\n        ss_item_sk,\n        SUM(ss_quantity) AS store_total_quantity,\n        SUM(ss_ext_sales_price) AS store_total_sales\n    FROM \n        store_sales\n    GROUP BY \n        ss_sold_date_sk, ss_item_sk\n)\nSELECT \n    ds.d_date AS sales_date,\n    id.i_item_id,\n    id.i_product_name,\n    COALESCE(ss.total_quantity, 0) AS web_total_quantity,\n    COALESCE(ss.total_sales, 0) AS web_total_sales,\n    COALESCE(st.store_total_quantity, 0) AS store_total_quantity,\n    COALESCE(st.store_total_sales, 0) AS store_total_sales,\n    (COALESCE(ss.total_sales, 0) + COALESCE(st.store_total_sales, 0)) AS combined_sales\nFROM \n    date_dim ds\nLEFT JOIN \n    SalesSummary ss ON ds.d_date_sk = ss.ws_sold_date_sk\nLEFT JOIN \n    ItemDetails id ON ss.ws_item_sk = id.i_item_sk\nLEFT JOIN \n    StoreSales st ON ds.d_date_sk = st.ss_sold_date_sk AND id.i_item_sk = st.ss_item_sk\nWHERE \n    ds.d_year = 2023\nORDER BY \n    sales_date, web_total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_email_address,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ss.ss_sales_price) AS total_spent,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n        COUNT(DISTINCT sr.sr_ticket_number) AS total_returns\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_email_address, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nHighValueCustomers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_email_address,\n        cs.cd_gender,\n        cs.cd_marital_status,\n        cs.cd_education_status,\n        cs.total_spent,\n        cs.total_transactions,\n        cs.total_returns\n    FROM \n        CustomerStats cs\n    WHERE \n        cs.total_spent > (SELECT AVG(total_spent) FROM CustomerStats)\n)\nSELECT \n    hvc.c_email_address,\n    hvc.cd_gender,\n    hvc.cd_marital_status,\n    hvc.cd_education_status,\n    hvc.total_spent,\n    hvc.total_transactions,\n    hvc.total_returns,\n    CASE \n        WHEN hvc.total_transactions = 0 THEN 'Inactive'\n        WHEN hvc.total_returns > 2 THEN 'Potential Churn'\n        ELSE 'Active'\n    END AS customer_status\nFROM \n    HighValueCustomers hvc\nORDER BY \n    hvc.total_spent DESC\nLIMIT 100;\n",
  "WITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk AS customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt_inc_tax) AS total_return_amount\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk AS customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM \n        web_sales \n    GROUP BY \n        ws_bill_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        cd_demo_sk,\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_purchase_estimate\n    FROM \n        customer_demographics\n),\nFinalReport AS (\n    SELECT \n        c.c_customer_id,\n        cu.total_sales,\n        cu.total_orders,\n        cr.total_returns,\n        cr.total_return_amount,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate\n    FROM \n        customer c\n    LEFT JOIN \n        SalesSummary cu ON c.c_customer_sk = cu.customer_sk\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.customer_sk\n    LEFT JOIN \n        CustomerDemographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n)\nSELECT \n    f.c_customer_id,\n    f.total_sales,\n    f.total_orders,\n    COALESCE(f.total_returns, 0) AS total_returns,\n    COALESCE(f.total_return_amount, 0) AS total_return_amount,\n    f.cd_gender,\n    f.cd_marital_status,\n    f.cd_education_status,\n    f.cd_purchase_estimate\nFROM \n    FinalReport f\nWHERE \n    f.total_sales > 1000 \nORDER BY \n    total_sales DESC;",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n), Demographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        c.c_customer_sk\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n), SalesWithDemographics AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_sales,\n        cs.order_count,\n        d.cd_gender,\n        d.cd_marital_status,\n        d.cd_education_status\n    FROM \n        CustomerSales cs\n    JOIN \n        Demographics d ON cs.c_customer_sk = d.c_customer_sk\n)\nSELECT \n    sd.cd_gender,\n    sd.cd_marital_status,\n    sd.cd_education_status,\n    AVG(sd.total_sales) AS avg_sales,\n    AVG(sd.order_count) AS avg_order_count,\n    COUNT(*) AS customer_count\nFROM \n    SalesWithDemographics sd\nWHERE \n    sd.total_sales > (SELECT AVG(total_sales) FROM CustomerSales)\nGROUP BY \n    sd.cd_gender,\n    sd.cd_marital_status,\n    sd.cd_education_status\nORDER BY \n    avg_sales DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        wr_returning_customer_sk,\n        SUM(wr_return_amt_inc_tax) AS total_return_amount,\n        COUNT(DISTINCT wr_order_number) AS total_returns,\n        AVG(wr_return_quantity) AS avg_return_quantity\n    FROM \n        web_returns\n    GROUP BY \n        wr_returning_customer_sk\n),\nSalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws_order_number) AS total_sales\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nReturnAnalysis AS (\n    SELECT \n        c.c_customer_id,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        COALESCE(sd.total_profit, 0) AS total_profit,\n        sd.total_sales,\n        CASE \n            WHEN sd.total_profit > 0 \n            THEN ROUND((COALESCE(cr.total_return_amount, 0) / sd.total_profit) * 100, 2)\n            ELSE 0\n        END AS return_percentage\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.wr_returning_customer_sk\n    LEFT JOIN \n        SalesData sd ON c.c_customer_sk = sd.ws_bill_customer_sk\n)\nSELECT \n    c.c_customer_id,\n    c.c_first_name || ' ' || c.c_last_name AS full_name,\n    ra.total_return_amount,\n    ra.total_profit,\n    ra.total_sales,\n    ra.return_percentage,\n    CASE \n        WHEN ra.return_percentage > 30 THEN 'High Return'\n        WHEN ra.return_percentage BETWEEN 10 AND 30 THEN 'Medium Return'\n        ELSE 'Low Return'\n    END AS return_category\nFROM \n    ReturnAnalysis ra\nJOIN \n    customer c ON ra.c_customer_id = c.c_customer_id\nORDER BY \n    ra.return_percentage DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT\n        cr_returning_customer_sk,\n        SUM(cr_return_amount) AS total_return_amt,\n        SUM(cr_return_tax) AS total_return_tax,\n        COUNT(*) AS return_count\n    FROM\n        catalog_returns\n    GROUP BY\n        cr_returning_customer_sk\n), \nCustomerDemographics AS (\n    SELECT\n        cd_demo_sk,\n        cd_gender,\n        COUNT(c_customer_sk) AS customer_count\n    FROM\n        customer c\n        JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY\n        cd_demo_sk, cd_gender\n), \nSalesData AS (\n    SELECT\n        ws_bill_customer_sk,\n        SUM(ws_net_paid_inc_tax) AS total_sales_amt,\n        COUNT(ws_order_number) AS order_count\n    FROM\n        web_sales\n    GROUP BY\n        ws_bill_customer_sk\n)\nSELECT\n    cd.cd_gender AS gender,\n    COALESCE(sr.return_count, 0) AS total_returns,\n    COALESCE(sd.order_count, 0) AS total_orders,\n    COALESCE(sd.total_sales_amt, 0) AS total_sales,\n    CASE\n        WHEN COALESCE(sr.return_count, 0) > 0 THEN 'Returns'\n        ELSE 'No Returns'\n    END AS return_status\nFROM\n    CustomerDemographics cd\nLEFT JOIN CustomerReturns sr ON cd.cd_demo_sk = sr.cr_returning_customer_sk\nLEFT JOIN SalesData sd ON cd.cd_demo_sk = sd.ws_bill_customer_sk\nWHERE\n    cd.customer_count > 10\nGROUP BY\n    cd.cd_demo_sk, cd.cd_gender, sr.return_count, sd.order_count, sd.total_sales_amt\nORDER BY\n    total_sales DESC,\n    total_returns DESC;\n",
  "\nWITH address_counts AS (\n    SELECT \n        ca_state,\n        COUNT(*) AS state_count,\n        AVG(LENGTH(ca_street_name)) AS avg_street_length,\n        SUM(CASE WHEN ca_city LIKE '%city%' THEN 1 ELSE 0 END) AS city_mentions\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\ndemographics AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS gender_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nsales_data AS (\n    SELECT \n        sm.sm_type,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count\n    FROM \n        web_sales ws\n    JOIN \n        ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk\n    GROUP BY \n        sm.sm_type\n)\nSELECT \n    ac.ca_state,\n    ac.state_count,\n    ac.avg_street_length,\n    ac.city_mentions,\n    d.cd_gender,\n    d.gender_count,\n    d.avg_purchase_estimate,\n    sd.sm_type,\n    sd.total_sales,\n    sd.order_count\nFROM \n    address_counts ac\nCROSS JOIN \n    demographics d\nCROSS JOIN \n    sales_data sd\nORDER BY \n    ac.state_count DESC, d.gender_count DESC, sd.total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_returned_date_sk,\n        sr_item_sk,\n        COUNT(sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amount,\n        SUM(sr_return_tax) AS total_return_tax\n    FROM \n        store_returns\n    GROUP BY \n        sr_returned_date_sk, sr_item_sk\n),\nSalesData AS (\n    SELECT \n        ws_sold_date_sk,\n        ws_item_sk,\n        SUM(ws_quantity) AS total_sold,\n        SUM(ws_net_paid) AS total_sales\n    FROM \n        web_sales\n    GROUP BY \n        ws_sold_date_sk, ws_item_sk\n),\nInventoryData AS (\n    SELECT \n        inv_date_sk,\n        inv_item_sk,\n        SUM(inv_quantity_on_hand) AS total_on_hand\n    FROM \n        inventory\n    GROUP BY \n        inv_date_sk, inv_item_sk\n)\nSELECT \n    dd.d_date AS sale_date,\n    id.inv_item_sk,\n    id.total_on_hand,\n    COALESCE(sd.total_sold, 0) AS total_sold,\n    COALESCE(cr.total_returns, 0) AS total_returns,\n    COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n    COALESCE(cr.total_return_tax, 0) AS total_return_tax,\n    (COALESCE(sd.total_sales, 0) - COALESCE(cr.total_return_amount, 0)) AS net_sales_amount\nFROM \n    date_dim dd\nLEFT JOIN InventoryData id ON dd.d_date_sk = id.inv_date_sk\nLEFT JOIN SalesData sd ON dd.d_date_sk = sd.ws_sold_date_sk AND id.inv_item_sk = sd.ws_item_sk\nLEFT JOIN CustomerReturns cr ON dd.d_date_sk = cr.sr_returned_date_sk AND id.inv_item_sk = cr.sr_item_sk\nWHERE \n    dd.d_year = 2023\nORDER BY \n    sale_date, id.inv_item_sk;\n",
  "\nWITH CustomerReturns AS (\n    SELECT\n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returns,\n        SUM(sr_return_amt_inc_tax) AS total_return_value\n    FROM store_returns\n    GROUP BY sr_customer_sk\n),\nSalesData AS (\n    SELECT\n        c.c_customer_sk,\n        COALESCE(SUM(ws.ws_sales_price * ws.ws_quantity), 0) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count\n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY c.c_customer_sk\n),\nCustomerDemographics AS (\n    SELECT\n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating,\n        cd.cd_dep_count,\n        CASE \n            WHEN cd.cd_credit_rating IS NULL THEN 'Unknown' \n            ELSE cd.cd_credit_rating \n        END AS credit_status\n    FROM customer_demographics cd\n),\nSalesWithReturns AS (\n    SELECT\n        sd.c_customer_sk,\n        sd.total_sales,\n        sd.order_count,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(cr.total_return_value, 0) AS total_return_value\n    FROM SalesData sd\n    LEFT JOIN CustomerReturns cr ON sd.c_customer_sk = cr.sr_customer_sk\n)\nSELECT\n    swr.c_customer_sk,\n    swr.total_sales,\n    swr.order_count,\n    swr.total_returns,\n    swr.total_return_value,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.credit_status\nFROM SalesWithReturns swr\nJOIN CustomerDemographics cd ON swr.c_customer_sk = cd.cd_demo_sk\nWHERE swr.total_sales > 1000\nORDER BY swr.total_return_value DESC, swr.total_sales DESC\nLIMIT 50;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        cr_returning_customer_sk,\n        SUM(cr_return_quantity) AS total_return_quantity,\n        SUM(cr_return_amount) AS total_return_amount\n    FROM catalog_returns\n    GROUP BY cr_returning_customer_sk\n),\nWebSalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_quantity) AS total_web_quantity,\n        SUM(ws_net_profit) AS total_web_profit\n    FROM web_sales\n    GROUP BY ws_bill_customer_sk\n),\nStoreSalesData AS (\n    SELECT \n        ss_customer_sk,\n        SUM(ss_quantity) AS total_store_quantity,\n        SUM(ss_net_profit) AS total_store_profit\n    FROM store_sales\n    GROUP BY ss_customer_sk\n),\nSalesComparison AS (\n    SELECT \n        cus.c_customer_id,\n        COALESCE(CR.total_return_quantity, 0) AS total_return_quantity,\n        COALESCE(WS.total_web_quantity, 0) AS total_web_quantity,\n        COALESCE(ST.total_store_quantity, 0) AS total_store_quantity,\n        (COALESCE(WS.total_web_profit, 0) + COALESCE(ST.total_store_profit, 0)) AS total_combined_profit\n    FROM customer cus\n    LEFT JOIN CustomerReturns CR ON cus.c_customer_sk = CR.cr_returning_customer_sk\n    LEFT JOIN WebSalesData WS ON cus.c_customer_sk = WS.ws_bill_customer_sk\n    LEFT JOIN StoreSalesData ST ON cus.c_customer_sk = ST.ss_customer_sk\n)\nSELECT \n    s.c_customer_id,\n    s.total_return_quantity,\n    s.total_web_quantity,\n    s.total_store_quantity,\n    CASE \n        WHEN s.total_web_quantity > s.total_store_quantity THEN 'Web Sales Dominant'\n        WHEN s.total_store_quantity > s.total_web_quantity THEN 'Store Sales Dominant'\n        ELSE 'Equal Sales'\n    END AS sales_preference,\n    s.total_combined_profit\nFROM SalesComparison s\nORDER BY s.total_combined_profit DESC\nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        w.w_warehouse_name,\n        COALESCE(SUM(ws.ws_quantity), 0) AS total_quantity_sold,\n        COALESCE(SUM(ws.ws_net_paid), 0) AS total_sales_amount,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_paid_inc_tax) AS avg_order_value\n    FROM \n        warehouse w\n    LEFT JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    WHERE \n        ws.ws_sold_date_sk IN (SELECT d.d_date_sk FROM date_dim d WHERE d.d_year = 2023)\n    GROUP BY \n        w.w_warehouse_name\n),\ncustomer_demographics_summary AS (\n    SELECT \n        cd.cd_gender, \n        COUNT(DISTINCT c.c_customer_sk) AS total_customers,\n        SUM(CASE WHEN cd.cd_marital_status = 'M' THEN 1 ELSE 0 END) AS married_count,\n        SUM(CASE WHEN cd.cd_marital_status = 'S' THEN 1 ELSE 0 END) AS single_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n)\nSELECT \n    s.w_warehouse_name,\n    s.total_quantity_sold,\n    s.total_sales_amount,\n    s.total_orders,\n    s.avg_order_value,\n    d.cd_gender,\n    d.total_customers,\n    d.married_count,\n    d.single_count,\n    d.avg_purchase_estimate\nFROM \n    sales_summary s\nCROSS JOIN \n    customer_demographics_summary d\nORDER BY \n    s.total_sales_amount DESC, d.total_customers DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_sold_date_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_bill_customer_sk) AS customer_count,\n        COUNT(DISTINCT ws_order_number) AS order_count,\n        AVG(ws_net_profit) AS avg_net_profit,\n        SUM(ws_net_paid_inc_tax) AS total_revenue\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN \n            (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 \n            AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_sold_date_sk\n), \ncustomer_details AS (\n    SELECT \n        cd_demo_sk,\n        cd_gender,\n        cd_marital_status,\n        COUNT(DISTINCT c_customer_sk) AS num_customers,\n        SUM(CASE WHEN c_birth_year IS NOT NULL THEN 1 ELSE 0 END) AS age_verified_count\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_demo_sk, cd_gender, cd_marital_status\n) \nSELECT \n    ds.d_date AS sales_date,\n    ss.total_sales,\n    ss.customer_count,\n    ss.order_count,\n    ss.avg_net_profit,\n    ss.total_revenue,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.num_customers,\n    cd.age_verified_count\nFROM \n    sales_summary ss\nJOIN \n    date_dim ds ON ss.ws_sold_date_sk = ds.d_date_sk\nJOIN \n    customer_details cd ON cd.num_customers > 0\nORDER BY \n    ds.d_date\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ss.ss_net_paid) AS total_store_sales,\n        SUM(ws.ws_net_paid) AS total_web_sales\n    FROM \n        customer c\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n), \ncustomer_demographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        cd.cd_dep_count\n    FROM \n        customer_demographics cd\n), \nhigh_value_customers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.total_store_sales,\n        cs.total_web_sales,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating\n    FROM \n        customer_sales cs\n    INNER JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    WHERE \n        (cs.total_store_sales + cs.total_web_sales) > 1000\n)\nSELECT \n    h.c_first_name,\n    h.c_last_name,\n    h.cd_gender,\n    h.cd_marital_status,\n    h.cd_education_status,\n    h.cd_purchase_estimate,\n    h.cd_credit_rating,\n    (h.total_store_sales + h.total_web_sales) AS total_sales,\n    CASE \n        WHEN h.cd_gender = 'F' THEN 'Female'\n        WHEN h.cd_gender = 'M' THEN 'Male'\n        ELSE 'Other'\n    END AS gender_description\nFROM \n    high_value_customers h\nORDER BY \n    total_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_order_count,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_order_count,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_order_count\n    FROM customer AS c\n    LEFT JOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales AS cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nSalesSummary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(total_web_sales, 0) AS web_sales,\n        COALESCE(total_catalog_sales, 0) AS catalog_sales,\n        COALESCE(total_store_sales, 0) AS store_sales,\n        web_order_count + catalog_order_count + store_order_count AS total_order_count\n    FROM CustomerSales c\n)\nSELECT \n    ss.c_customer_sk,\n    ss.c_first_name,\n    ss.c_last_name,\n    ss.web_sales,\n    ss.catalog_sales,\n    ss.store_sales,\n    ss.total_order_count,\n    CASE \n        WHEN ss.total_order_count = 0 THEN 'No Orders'\n        WHEN ss.web_sales > ss.catalog_sales AND ss.web_sales > ss.store_sales THEN 'Web Sales Dominant'\n        WHEN ss.catalog_sales > ss.store_sales THEN 'Catalog Sales Dominant'\n        ELSE 'Store Sales Dominant'\n    END AS dominant_channel\nFROM SalesSummary ss\nORDER BY ss.total_order_count DESC, ss.web_sales DESC;\n",
  "\nWITH ranked_customers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        COUNT(DISTINCT wr.wr_order_number) AS return_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\ncustomer_metrics AS (\n    SELECT \n        *,\n        CASE \n            WHEN total_sales > 1000 THEN 'High Value'\n            WHEN total_sales BETWEEN 500 AND 1000 THEN 'Medium Value'\n            ELSE 'Low Value'\n        END AS customer_segment\n    FROM \n        ranked_customers\n)\nSELECT \n    cm.c_first_name, \n    cm.c_last_name, \n    cm.cd_gender, \n    cm.cd_marital_status, \n    cm.customer_segment, \n    cm.total_sales, \n    cm.order_count, \n    cm.return_count\nFROM \n    customer_metrics cm\nWHERE \n    cm.return_count <= 1\nORDER BY \n    cm.total_sales DESC\nLIMIT \n    100;\n",
  "\nWITH ReturnSummary AS (\n    SELECT \n        sr_item_sk,\n        SUM(sr_return_quantity) AS total_returns,\n        SUM(sr_return_amt_inc_tax) AS total_return_value,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM \n        store_returns\n    GROUP BY \n        sr_item_sk\n),\nWebSalesSummary AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity_sold,\n        SUM(ws_net_paid) AS total_net_sales,\n        COUNT(DISTINCT ws_order_number) AS sales_count\n    FROM \n        web_sales\n    GROUP BY \n        ws_item_sk\n),\nPromotions AS (\n    SELECT \n        p_item_sk,\n        COUNT(DISTINCT p_promo_sk) AS promo_count\n    FROM \n        promotion\n    GROUP BY \n        p_item_sk\n),\nItemDetails AS (\n    SELECT \n        i_item_sk,\n        i_product_name,\n        i_current_price\n    FROM \n        item\n)\nSELECT \n    id.i_item_sk,\n    id.i_product_name,\n    COALESCE(rs.total_returns, 0) AS total_returns,\n    COALESCE(rs.total_return_value, 0) AS total_return_value,\n    COALESCE(ws.total_quantity_sold, 0) AS total_quantity_sold,\n    COALESCE(ws.total_net_sales, 0) AS total_net_sales,\n    COALESCE(p.promo_count, 0) AS promo_count,\n    (COALESCE(ws.total_quantity_sold, 0) - COALESCE(rs.total_returns, 0)) AS net_sales_after_returns,\n    CASE \n        WHEN COALESCE(ws.total_quantity_sold, 0) > 0 THEN \n            (COALESCE(ws.total_net_sales, 0) / COALESCE(ws.total_quantity_sold, 0))\n        ELSE 0 \n    END AS avg_sales_price,\n    CASE \n        WHEN COALESCE(ws.total_net_sales, 0) > 0 THEN \n            (COALESCE(rs.total_return_value, 0) / COALESCE(ws.total_net_sales, 0)) * 100\n        ELSE 0 \n    END AS return_percentage\nFROM \n    ItemDetails id\nLEFT JOIN \n    ReturnSummary rs ON id.i_item_sk = rs.sr_item_sk\nLEFT JOIN \n    WebSalesSummary ws ON id.i_item_sk = ws.ws_item_sk\nLEFT JOIN \n    Promotions p ON id.i_item_sk = p.p_item_sk\nWHERE \n    COALESCE(ws.total_quantity_sold, 0) > 100 OR COALESCE(rs.total_returns, 0) > 5\nORDER BY \n    total_return_value DESC, \n    net_sales_after_returns DESC;\n",
  "WITH AddressDetails AS (\n    SELECT \n        ca_city,\n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        SUM(LENGTH(ca_street_name)) AS total_street_name_length\n    FROM customer_address\n    GROUP BY ca_city, ca_state\n),\nCustomerDemographics AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        COUNT(*) AS demographic_count\n    FROM customer_demographics\n    GROUP BY cd_gender, cd_marital_status\n),\nSalesData AS (\n    SELECT \n        d.d_year,\n        d.d_month_seq,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_quantity) AS total_quantity,\n        AVG(ws_net_profit) AS avg_net_profit\n    FROM web_sales ws\n    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY d.d_year, d.d_month_seq\n)\nSELECT \n    ad.ca_city,\n    ad.ca_state,\n    ad.unique_addresses,\n    cd.avg_purchase_estimate,\n    sd.total_sales,\n    sd.total_quantity,\n    sd.avg_net_profit\nFROM AddressDetails ad\nJOIN CustomerDemographics cd ON ad.ca_state = 'CA' \nJOIN SalesData sd ON sd.d_year = 2001 \nORDER BY ad.ca_city, ad.ca_state;",
  "\nWITH customer_returns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt_inc_tax) AS total_return_amount,\n        AVG(sr_return_quantity) AS avg_return_quantity\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nhigh_value_customers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        cd.cd_purchase_estimate > (\n            SELECT \n                AVG(cd2.cd_purchase_estimate) \n            FROM \n                customer_demographics cd2\n        )\n),\nrecent_sales AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk > (\n            SELECT \n                MAX(d_date_sk) - 30 \n            FROM \n                date_dim\n        )\n    GROUP BY \n        ws_bill_customer_sk\n)\nSELECT \n    hvc.c_first_name,\n    hvc.c_last_name,\n    hvc.cd_gender,\n    hvc.cd_marital_status,\n    COALESCE(cr.total_returns, 0) AS customer_total_returns,\n    COALESCE(cr.total_return_amount, 0) AS customer_total_return_amount,\n    COALESCE(rs.total_sales, 0) AS recent_sales_total\nFROM \n    high_value_customers hvc\nLEFT JOIN \n    customer_returns cr ON hvc.c_customer_sk = cr.sr_customer_sk\nLEFT JOIN \n    recent_sales rs ON hvc.c_customer_sk = rs.ws_bill_customer_sk\nORDER BY \n    hvc.c_last_name, hvc.c_first_name;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        cs_item_sk,\n        SUM(cs_quantity) AS total_quantity_sold,\n        SUM(cs_sales_price) AS total_sales_amount,\n        COUNT(DISTINCT cs_order_number) AS total_orders,\n        AVG(cs_sales_price) AS average_sales_price\n    FROM \n        catalog_sales\n    WHERE \n        cs_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n        AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        cs_item_sk\n),\ntop_items AS (\n    SELECT \n        cs_item_sk AS ss_item_sk,\n        total_quantity_sold,\n        total_sales_amount,\n        total_orders,\n        average_sales_price\n    FROM \n        sales_summary\n    ORDER BY \n        total_sales_amount DESC\n    FETCH FIRST 10 ROWS ONLY\n),\ncustomer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        d.d_year,\n        SUM(ws.ws_ext_sales_price) AS total_spent,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year\n),\ntop_customers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        c.total_spent,\n        c.total_orders\n    FROM \n        customer_info c\n    ORDER BY \n        c.total_spent DESC\n    FETCH FIRST 10 ROWS ONLY\n)\nSELECT \n    tc.c_customer_sk,\n    tc.c_first_name,\n    tc.c_last_name,\n    tc.total_spent,\n    ti.total_quantity_sold,\n    ti.total_sales_amount,\n    ti.total_orders,\n    ti.average_sales_price\nFROM \n    top_customers tc\nJOIN \n    top_items ti ON tc.total_orders > 5\nORDER BY \n    tc.total_spent DESC, ti.total_sales_amount DESC;\n",
  "\nWITH customer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        cd.cd_dep_count,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_country\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n),\nsales_summary AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_ext_sales_price) AS avg_sales_price\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_bill_customer_sk\n)\nSELECT \n    ci.c_customer_sk,\n    ci.c_first_name,\n    ci.c_last_name,\n    ci.cd_gender,\n    ci.cd_marital_status,\n    ci.cd_education_status,\n    ci.cd_purchase_estimate,\n    ci.cd_credit_rating,\n    ci.cd_dep_count,\n    ci.ca_city,\n    ci.ca_state,\n    ci.ca_country,\n    ss.total_sales,\n    ss.total_orders,\n    ss.avg_sales_price\nFROM \n    customer_info ci\nLEFT JOIN \n    sales_summary ss ON ci.c_customer_sk = ss.ws_bill_customer_sk\nWHERE \n    ss.total_sales > (SELECT AVG(total_sales) FROM sales_summary) \nORDER BY \n    ss.total_sales DESC\nLIMIT 100;\n",
  "\nWITH SalesData AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ss.ss_net_paid) AS total_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        customer c\n    JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nGenderAnalysis AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS num_customers,\n        AVG(total_sales) AS avg_sales,\n        AVG(total_transactions) AS avg_transactions\n    FROM \n        SalesData\n    GROUP BY \n        cd_gender\n),\nEducationAnalysis AS (\n    SELECT \n        cd_education_status,\n        COUNT(*) AS num_customers,\n        AVG(total_sales) AS avg_sales,\n        AVG(total_transactions) AS avg_transactions\n    FROM \n        SalesData\n    GROUP BY \n        cd_education_status\n)\nSELECT \n    ga.cd_gender,\n    ga.num_customers AS gender_customer_count,\n    ga.avg_sales AS gender_avg_sales,\n    ea.cd_education_status,\n    ea.num_customers AS education_customer_count,\n    ea.avg_sales AS education_avg_sales\nFROM \n    GenderAnalysis ga\nCROSS JOIN \n    EducationAnalysis ea\nWHERE \n    ga.avg_sales > (SELECT AVG(total_sales) FROM SalesData) \n    AND ea.avg_sales > (SELECT AVG(total_sales) FROM SalesData)\nORDER BY \n    ga.cd_gender, ea.cd_education_status;\n",
  "\nWITH CTE_CustomerReturns AS (\n    SELECT \n        wr_returned_date_sk,\n        wr_returning_customer_sk,\n        SUM(wr_return_quantity) AS total_return_qty,\n        SUM(wr_return_amt) AS total_return_amt,\n        COUNT(DISTINCT wr_order_number) AS return_count\n    FROM \n        web_returns\n    GROUP BY \n        wr_returned_date_sk, \n        wr_returning_customer_sk\n),\n\nCTE_SalesData AS (\n    SELECT \n        ws_sold_date_sk,\n        ws_ship_date_sk,\n        ws_ship_mode_sk,\n        SUM(ws_quantity) AS total_sold_qty,\n        SUM(ws_sales_price) AS total_sales_amt,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk >= (SELECT MIN(d_date_sk) FROM date_dim) \n        AND ws_sold_date_sk <= (SELECT MAX(d_date_sk) FROM date_dim)\n    GROUP BY \n        ws_sold_date_sk, \n        ws_ship_date_sk, \n        ws_ship_mode_sk\n)\n\nSELECT \n    d.d_date AS sale_date,\n    s.sm_type AS shipping_mode,\n    COALESCE(sd.total_sold_qty, 0) AS total_quantity_sold,\n    COALESCE(sd.total_sales_amt, 0) AS total_sales_amount,\n    COALESCE(cr.return_count, 0) AS total_return_count,\n    COALESCE(cr.total_return_qty, 0) AS total_return_quantity,\n    COALESCE(cr.total_return_amt, 0) AS total_return_amount,\n    (COALESCE(sd.total_sales_amt, 0) - COALESCE(cr.total_return_amt, 0)) AS net_sales\nFROM \n    date_dim d\nLEFT JOIN \n    CTE_SalesData sd ON d.d_date_sk = sd.ws_sold_date_sk\nLEFT JOIN \n    CTE_CustomerReturns cr ON d.d_date_sk = cr.wr_returned_date_sk\nLEFT JOIN \n    ship_mode s ON sd.ws_ship_mode_sk = s.sm_ship_mode_sk\nWHERE \n    d.d_year = 2023\nORDER BY \n    d.d_date, s.sm_type;\n",
  "\nWITH customer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        cd.cd_dep_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nsales_summary AS (\n    SELECT \n        ws_bill_customer_sk AS customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(ws_order_number) AS total_orders,\n        AVG(ws_sales_price) AS average_order_value\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nreturns_summary AS (\n    SELECT \n        wr_returning_customer_sk AS customer_sk,\n        SUM(wr_return_amt_inc_tax) AS total_returns\n    FROM \n        web_returns\n    GROUP BY \n        wr_returning_customer_sk\n),\ndemographic_analysis AS (\n    SELECT \n        ci.c_customer_sk,\n        ci.c_first_name,\n        ci.c_last_name,\n        ci.cd_gender,\n        ci.cd_marital_status,\n        si.total_sales,\n        si.total_orders,\n        si.average_order_value,\n        COALESCE(ri.total_returns, 0) AS total_returns,\n        (COALESCE(si.total_sales, 0) - COALESCE(ri.total_returns, 0)) AS net_sales\n    FROM \n        customer_info ci\n    LEFT JOIN \n        sales_summary si ON ci.c_customer_sk = si.customer_sk\n    LEFT JOIN \n        returns_summary ri ON ci.c_customer_sk = ri.customer_sk\n),\nfinal_output AS (\n    SELECT \n        da.c_customer_sk,\n        da.c_first_name,\n        da.c_last_name,\n        da.cd_gender,\n        da.cd_marital_status,\n        da.total_sales,\n        da.total_orders,\n        da.average_order_value,\n        da.total_returns,\n        da.net_sales,\n        CASE \n            WHEN da.net_sales > 10000 THEN 'Premium Customer'\n            WHEN da.net_sales BETWEEN 5000 AND 10000 THEN 'Regular Customer'\n            ELSE 'Low Value Customer'\n        END AS customer_segment\n    FROM \n        demographic_analysis da\n    ORDER BY \n        da.net_sales DESC\n)\nSELECT \n    * \nFROM \n    final_output \nLIMIT 10;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt_inc_tax) AS total_returned_amt\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nWebSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_net_paid_inc_tax) AS total_sales_amount,\n        AVG(ws_list_price) AS avg_item_price\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk >= (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30\n    GROUP BY \n        ws_bill_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n)\nSELECT \n    cd.c_first_name,\n    cd.c_last_name,\n    SUM(COALESCE(cr.total_returned_quantity, 0)) AS total_returned_quantity,\n    SUM(COALESCE(ws.total_orders, 0)) AS total_orders,\n    SUM(COALESCE(ws.total_sales_amount, 0)) AS total_sales_amount,\n    cd.cd_gender,\n    cd.cd_marital_status\nFROM \n    CustomerDemographics cd\nLEFT JOIN \n    CustomerReturns cr ON cd.c_customer_sk = cr.sr_customer_sk\nLEFT JOIN \n    WebSalesSummary ws ON cd.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    cd.cd_marital_status = 'S' AND \n    (cd.cd_gender = 'F' OR cd.cd_gender IS NULL) \nGROUP BY \n    cd.c_first_name, cd.c_last_name, cd.cd_gender, cd.cd_marital_status\nORDER BY \n    total_sales_amount DESC\nLIMIT 50;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        MAX(ws.ws_sales_price) AS max_sales_price,\n        AVG(ws.ws_sales_price) AS avg_sales_price\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nReturnStats AS (\n    SELECT \n        cr_returning_customer_sk,\n        SUM(cr_return_amount) AS total_returned_amount,\n        COUNT(cr_order_number) AS return_count\n    FROM \n        catalog_returns\n    GROUP BY \n        cr_returning_customer_sk\n),\nCombinedStats AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.total_web_sales,\n        cs.order_count,\n        COALESCE(rs.total_returned_amount, 0) AS total_returned_amount,\n        COALESCE(rs.return_count, 0) AS return_count,\n        (cs.total_web_sales - COALESCE(rs.total_returned_amount, 0)) AS net_sales\n    FROM \n        CustomerSales cs\n    LEFT JOIN \n        ReturnStats rs ON cs.c_customer_sk = rs.cr_returning_customer_sk\n)\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    cs.total_web_sales,\n    cs.order_count,\n    cs.total_returned_amount,\n    cs.return_count,\n    cs.net_sales,\n    CASE \n        WHEN cs.net_sales >= 1000 THEN 'High Value Customer'\n        WHEN cs.net_sales >= 500 THEN 'Medium Value Customer'\n        ELSE 'Low Value Customer'\n    END AS customer_value_category\nFROM \n    CombinedStats cs\nJOIN \n    customer c ON cs.c_customer_sk = c.c_customer_sk\nWHERE \n    cs.net_sales > 0\nORDER BY \n    cs.net_sales DESC\nLIMIT 100;\n",
  "\nWITH AddressSummary AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n), \nCustomerSummary AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_id) AS total_customers,\n        AVG(cd_dep_count) AS avg_dependents,\n        MAX(cd_purchase_estimate) AS max_purchase_estimate\n    FROM \n        customer_demographics\n    JOIN \n        customer ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\n    GROUP BY \n        cd_gender\n), \nWebSiteSummary AS (\n    SELECT \n        web_country,\n        COUNT(DISTINCT web_site_id) AS total_websites,\n        AVG(LENGTH(web_name)) AS avg_web_name_length\n    FROM \n        web_site\n    GROUP BY \n        web_country\n)\nSELECT \n    asum.ca_state,\n    asum.unique_addresses,\n    asum.avg_street_name_length,\n    asum.max_street_name_length,\n    csum.cd_gender,\n    csum.total_customers,\n    csum.avg_dependents,\n    csum.max_purchase_estimate,\n    wsum.web_country,\n    wsum.total_websites,\n    wsum.avg_web_name_length\nFROM \n    AddressSummary asum\nJOIN \n    CustomerSummary csum ON 1=1\nJOIN \n    WebSiteSummary wsum ON 1=1\nORDER BY \n    asum.ca_state, csum.cd_gender, wsum.web_country;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws_order_number) AS order_count\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_item_sk\n),\nCustomerDemographics AS (\n    SELECT \n        cd_demo_sk, \n        cd_gender, \n        cd_marital_status, \n        cd_education_status, \n        COUNT(DISTINCT c_customer_sk) AS customer_count\n    FROM \n        customer_demographics\n    JOIN \n        customer ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\n    GROUP BY \n        cd_demo_sk, cd_gender, cd_marital_status, cd_education_status\n),\nTopItems AS (\n    SELECT \n        i_item_sk,\n        i_product_name,\n        i_brand,\n        sales.total_quantity,\n        sales.total_profit\n    FROM \n        item\n    JOIN \n        SalesData AS sales ON item.i_item_sk = sales.ws_item_sk\n    WHERE \n        sales.total_quantity > (SELECT AVG(total_quantity) FROM SalesData)\n    ORDER BY \n        sales.total_profit DESC\n    LIMIT 10\n)\nSELECT \n    ci.cd_gender,\n    ci.cd_marital_status,\n    ci.cd_education_status,\n    COUNT(DISTINCT ci.cd_demo_sk) AS demographics_count,\n    ti.i_product_name,\n    ti.total_quantity,\n    ti.total_profit\nFROM \n    CustomerDemographics AS ci\nJOIN \n    TopItems AS ti ON ci.customer_count > 0\nGROUP BY \n    ci.cd_gender, ci.cd_marital_status, ci.cd_education_status, ti.i_product_name, ti.total_quantity, ti.total_profit\nORDER BY \n    ti.total_profit DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_returned_date_sk,\n        sr_item_sk,\n        COUNT(sr_ticket_number) AS return_count,\n        SUM(sr_return_amt) AS total_return_amt\n    FROM \n        store_returns\n    GROUP BY \n        sr_returned_date_sk, sr_item_sk\n),\nSalesSummary AS (\n    SELECT \n        ws_sold_date_sk,\n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity_sold,\n        SUM(ws_ext_sales_price) AS total_sales_amt\n    FROM \n        web_sales\n    GROUP BY \n        ws_sold_date_sk, ws_item_sk\n),\nItemPerformance AS (\n    SELECT \n        r.sr_item_sk AS cs_item_sk,\n        COALESCE(cr.return_count, 0) AS return_count,\n        COALESCE(cr.total_return_amt, 0) AS total_return_amt,\n        COALESCE(ss.total_quantity_sold, 0) AS total_quantity_sold,\n        COALESCE(ss.total_sales_amt, 0) AS total_sales_amt\n    FROM \n        (SELECT DISTINCT sr_item_sk FROM CustomerReturns) AS r\n    FULL OUTER JOIN SalesSummary ss ON r.sr_item_sk = ss.ws_item_sk\n    LEFT JOIN CustomerReturns cr ON r.sr_item_sk = cr.sr_item_sk\n),\nFinalReport AS (\n    SELECT \n        ip.cs_item_sk,\n        ip.return_count,\n        ip.total_return_amt,\n        ip.total_quantity_sold,\n        ip.total_sales_amt,\n        CASE \n            WHEN ip.total_quantity_sold > 0 THEN (ip.total_return_amt / ip.total_quantity_sold) * 100\n            ELSE 0\n        END AS return_rate\n    FROM \n        ItemPerformance ip\n)\nSELECT \n    a.i_item_id,\n    a.i_item_desc,\n    f.return_count,\n    f.total_return_amt,\n    f.total_quantity_sold,\n    f.total_sales_amt,\n    f.return_rate\nFROM \n    FinalReport f\nJOIN \n    item a ON f.cs_item_sk = a.i_item_sk\nWHERE \n    f.return_rate > 10\nORDER BY \n    f.return_rate DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_return_quantity,\n        SUM(sr_return_amt_inc_tax) AS total_return_amount,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n), ProductSales AS (\n    SELECT \n        ws_ship_customer_sk,\n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity_sold,\n        SUM(ws_sales_price) AS total_sales_amount\n    FROM \n        web_sales\n    GROUP BY \n        ws_ship_customer_sk, ws_item_sk\n), CustomerDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n), SalesData AS (\n    SELECT \n        cd.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        COALESCE(cr.total_return_quantity, 0) AS total_return_quantity,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        COALESCE(ps.total_quantity_sold, 0) AS total_quantity_sold,\n        COALESCE(ps.total_sales_amount, 0) AS total_sales_amount\n    FROM \n        CustomerDemographics cd\n    LEFT JOIN \n        CustomerReturns cr ON cd.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN \n        ProductSales ps ON cd.c_customer_sk = ps.ws_ship_customer_sk\n), Summary AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(cd.total_return_quantity) AS total_return_quantity,\n        SUM(cd.total_return_amount) AS total_return_amount,\n        SUM(cd.total_quantity_sold) AS total_quantity_sold,\n        SUM(cd.total_sales_amount) AS total_sales_amount\n    FROM \n        SalesData cd\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    *,\n    total_sales_amount - total_return_amount AS net_sales,\n    CASE \n        WHEN total_sales_amount = 0 THEN 0 \n        ELSE (total_return_amount / total_sales_amount) * 100 \n    END AS return_rate_percentage\nFROM \n    Summary\nORDER BY \n    total_sales_amount DESC\nLIMIT 100;\n",
  "\nWITH address_analysis AS (\n    SELECT \n        ca_state,\n        COUNT(*) AS total_addresses,\n        COUNT(DISTINCT ca_city) AS distinct_cities,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        SUM(LENGTH(ca_street_name)) AS total_street_name_length,\n        SUM(LENGTH(ca_street_type)) AS total_street_type_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\ngender_analysis AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS total_customers,\n        AVG(cd_dep_count) AS avg_dependents,\n        MAX(cd_purchase_estimate) AS max_purchase_estimate\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nsales_analysis AS (\n    SELECT \n        d_year,\n        SUM(ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_quantity) AS total_quantity_sold\n    FROM \n        web_sales\n    JOIN \n        date_dim ON ws_sold_date_sk = d_date_sk\n    GROUP BY \n        d_year\n)\nSELECT \n    aa.ca_state,\n    aa.total_addresses,\n    aa.distinct_cities,\n    aa.avg_street_name_length,\n    ga.cd_gender,\n    ga.total_customers,\n    ga.avg_dependents,\n    sa.d_year,\n    sa.total_net_profit,\n    sa.total_orders,\n    sa.total_quantity_sold\nFROM \n    address_analysis aa\nJOIN \n    gender_analysis ga ON aa.total_addresses > (SELECT AVG(total_addresses) FROM address_analysis)\nJOIN \n    sales_analysis sa ON sa.total_net_profit > (SELECT AVG(total_net_profit) FROM sales_analysis)\nORDER BY \n    aa.ca_state, ga.cd_gender, sa.d_year;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amt,\n        AVG(sr_return_quantity) AS avg_return_quantity\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk AS customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_coupon_amt) AS total_coupons\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        COALESCE(cd.cd_dep_count, 0) AS dep_count,\n        COALESCE(cd.cd_credit_rating, 'N/A') AS credit_rating\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nReturnAndSales AS (\n    SELECT \n        cd.c_customer_sk AS customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(cr.total_return_amt, 0) AS total_return_amt,\n        COALESCE(ss.total_sales, 0) AS total_sales,\n        COALESCE(ss.total_coupons, 0) AS total_coupons\n    FROM \n        CustomerDemographics cd\n    LEFT JOIN \n        CustomerReturns cr ON cd.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN \n        SalesSummary ss ON cd.c_customer_sk = ss.customer_sk\n)\nSELECT \n    r.customer_sk,\n    r.cd_gender,\n    r.cd_marital_status,\n    r.total_returns,\n    r.total_return_amt,\n    r.total_sales,\n    r.total_coupons,\n    (r.total_sales - r.total_return_amt) AS net_sales,\n    CASE \n        WHEN r.total_sales > 0 THEN (CAST(r.total_returns AS decimal) / r.total_sales) * 100\n        ELSE NULL \n    END AS return_rate_percentage\nFROM \n    ReturnAndSales r\nWHERE \n    r.total_coupons > 100\nORDER BY \n    net_sales DESC\nLIMIT 10;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_education_status, \n        COUNT(DISTINCT sr_ticket_number) AS return_count, \n        SUM(sr_return_amt) AS total_return_amt\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nSalesStats AS (\n    SELECT \n        ws_bill_customer_sk, \n        SUM(ws_net_profit) AS total_profit, \n        SUM(ws_quantity) AS total_quantity\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.cd_education_status,\n    cs.return_count,\n    cs.total_return_amt,\n    ss.total_profit,\n    ss.total_quantity\nFROM \n    CustomerStats cs\nLEFT JOIN \n    SalesStats ss ON cs.c_customer_sk = ss.ws_bill_customer_sk\nWHERE \n    cs.return_count > 5 AND ss.total_profit IS NOT NULL\nORDER BY \n    cs.total_return_amt DESC, ss.total_profit DESC\nLIMIT 100;\n",
  "\nWITH CustomerSummary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_current_cdemo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        SUM(ss.ss_quantity) AS total_quantity,\n        SUM(ss.ss_sales_price) AS total_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\n    FROM \n        customer AS c\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_current_cdemo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate\n),\nReturnSummary AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(*) AS return_count,\n        SUM(sr_return_amt_inc_tax) AS total_return_amount\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nFinalSummary AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.cd_gender,\n        cs.cd_marital_status,\n        cs.cd_purchase_estimate,\n        cs.total_quantity,\n        cs.total_sales,\n        cs.total_transactions,\n        COALESCE(rs.return_count, 0) AS return_count,\n        COALESCE(rs.total_return_amount, 0) AS total_return_amount,\n        (cs.total_sales - COALESCE(rs.total_return_amount, 0)) AS net_sales\n    FROM \n        CustomerSummary AS cs\n    LEFT JOIN \n        ReturnSummary AS rs ON cs.c_customer_sk = rs.sr_customer_sk\n)\nSELECT \n    fs.cd_gender, \n    fs.cd_marital_status, \n    COUNT(fs.c_customer_sk) AS customer_count,\n    AVG(fs.total_quantity) AS avg_quantity_per_customer,\n    SUM(fs.total_sales) AS total_sales,\n    SUM(fs.net_sales) AS total_net_sales,\n    SUM(fs.return_count) AS total_returns\nFROM \n    FinalSummary AS fs\nGROUP BY \n    fs.cd_gender, fs.cd_marital_status\nORDER BY \n    fs.cd_gender, fs.cd_marital_status;\n",
  "\nWITH CustomerSummary AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_education_status, \n        SUM(ws.ws_ext_sales_price) AS total_spent,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_education_status\n),\nReturnSummary AS (\n    SELECT \n        sr.sr_customer_sk, \n        COUNT(sr.sr_ticket_number) AS total_returns, \n        SUM(sr.sr_return_amt_inc_tax) AS total_returned\n    FROM \n        store_returns sr\n    GROUP BY \n        sr.sr_customer_sk\n)\nSELECT \n    cs.c_customer_sk, \n    cs.c_first_name, \n    cs.c_last_name, \n    cs.cd_gender, \n    cs.cd_marital_status, \n    cs.cd_education_status, \n    cs.total_spent, \n    cs.total_orders, \n    rs.total_returns, \n    rs.total_returned \nFROM \n    CustomerSummary cs\nLEFT JOIN \n    ReturnSummary rs ON cs.c_customer_sk = rs.sr_customer_sk\nWHERE \n    cs.total_spent > 1000 \nORDER BY \n    cs.total_spent DESC\nLIMIT 50;\n",
  "\nWITH CustomerData AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_ext_sales_price) AS total_sales\n    FROM \n        customer AS c\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nReturnData AS (\n    SELECT \n        sr.sr_customer_sk,\n        SUM(sr.sr_return_quantity) AS total_returns\n    FROM \n        store_returns AS sr\n    GROUP BY \n        sr.sr_customer_sk\n),\nSalesPerCustomer AS (\n    SELECT \n        cd.c_customer_sk,\n        cd.c_first_name,\n        cd.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.total_sales,\n        COALESCE(rd.total_returns, 0) AS total_returns,\n        (cd.total_sales - COALESCE(rd.total_returns, 0)) AS net_sales\n    FROM \n        CustomerData AS cd\n    LEFT JOIN \n        ReturnData AS rd ON cd.c_customer_sk = rd.sr_customer_sk\n)\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    c.cd_gender,\n    c.cd_marital_status,\n    c.cd_education_status,\n    c.total_sales,\n    c.total_returns,\n    c.net_sales,\n    CASE \n        WHEN c.net_sales > 10000 THEN 'High Value'\n        WHEN c.net_sales BETWEEN 5000 AND 10000 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_category\nFROM \n    SalesPerCustomer AS c\nORDER BY \n    c.net_sales DESC\nLIMIT 100;\n",
  "\nWITH Customer_Summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        CASE \n            WHEN cd.cd_gender = 'M' THEN 'Male'\n            WHEN cd.cd_gender = 'F' THEN 'Female'\n            ELSE 'Other' \n        END AS gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nReturn_Summary AS (\n    SELECT \n        cr.cr_returning_customer_sk,\n        COUNT(cr.cr_returned_time_sk) AS total_returns,\n        SUM(cr.cr_return_amount) AS total_returned_amount\n    FROM \n        catalog_returns cr\n    GROUP BY \n        cr.cr_returning_customer_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.gender,\n    cs.cd_marital_status,\n    cs.cd_education_status,\n    cs.total_sales,\n    cs.total_orders,\n    COALESCE(rs.total_returns, 0) AS total_returns,\n    COALESCE(rs.total_returned_amount, 0) AS total_returned_amount\nFROM \n    Customer_Summary cs\nLEFT JOIN \n    Return_Summary rs ON cs.c_customer_sk = rs.cr_returning_customer_sk\nWHERE \n    cs.total_sales > 1000\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH AddressStats AS (\n    SELECT \n        ca_city,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        COUNT(ca_zip) AS total_zips,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length\n    FROM customer_address\n    GROUP BY ca_city\n),\nCustomerStats AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_id) AS total_customers,\n        MAX(cd_purchase_estimate) AS max_purchase_estimate,\n        AVG(cd_dep_count) AS avg_dependents\n    FROM customer\n    JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY cd_gender\n),\nDateStats AS (\n    SELECT \n        d_year,\n        COUNT(DISTINCT d_date_id) AS total_days,\n        SUM(d_dom) AS total_days_in_month,\n        MAX(d_week_seq) AS max_week_of_year\n    FROM date_dim\n    GROUP BY d_year\n)\nSELECT \n    a.ca_city,\n    a.unique_addresses,\n    a.total_zips,\n    a.max_street_name_length,\n    c.cd_gender,\n    c.total_customers,\n    c.max_purchase_estimate,\n    c.avg_dependents,\n    d.d_year,\n    d.total_days,\n    d.total_days_in_month,\n    d.max_week_of_year\nFROM AddressStats a\nJOIN CustomerStats c ON a.unique_addresses > 100\nJOIN DateStats d ON d.total_days > 365\nORDER BY a.unique_addresses DESC, c.total_customers DESC;\n",
  "\nWITH Address_Stats AS (\n    SELECT \n        ca_city,\n        COUNT(*) AS address_count,\n        AVG(COALESCE(LENGTH(ca_street_name), 0)) AS avg_street_name_length,\n        SUM(CASE WHEN ca_street_type IS NOT NULL THEN 1 ELSE 0 END) AS street_type_count\n    FROM \n        customer_address\n    GROUP BY \n        ca_city\n),\nDemographics_Stats AS (\n    SELECT \n        CASE \n            WHEN cd_gender = 'M' THEN 'Male'\n            WHEN cd_gender = 'F' THEN 'Female'\n            ELSE 'Other'\n        END AS gender,\n        COUNT(*) AS demographic_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(CASE WHEN cd_credit_rating = 'Good' THEN 1 ELSE 0 END) AS good_credit_count\n    FROM \n        customer_demographics\n    GROUP BY \n        CASE \n            WHEN cd_gender = 'M' THEN 'Male'\n            WHEN cd_gender = 'F' THEN 'Female'\n            ELSE 'Other'\n        END\n),\nSales_Summary AS (\n    SELECT \n        d_year,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_net_paid) AS total_sales,\n        SUM(ws_quantity) AS total_units_sold\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    GROUP BY \n        d_year\n)\nSELECT \n    a.ca_city,\n    a.address_count,\n    a.avg_street_name_length,\n    a.street_type_count,\n    d.gender,\n    d.demographic_count,\n    d.avg_purchase_estimate,\n    d.good_credit_count,\n    s.d_year,\n    s.total_orders,\n    s.total_sales,\n    s.total_units_sold\nFROM \n    Address_Stats a\nJOIN \n    Demographics_Stats d ON TRUE \nJOIN \n    Sales_Summary s ON TRUE \nORDER BY \n    a.address_count DESC, d.demographic_count DESC, s.total_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH AddressStatistics AS (\n    SELECT \n        ca_state,\n        COUNT(ca_address_sk) AS address_count,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomerStatistics AS (\n    SELECT \n        cd_gender,\n        COUNT(c_customer_sk) AS customer_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        MAX(cd_purchase_estimate) AS max_purchase_estimate,\n        MIN(cd_purchase_estimate) AS min_purchase_estimate\n    FROM \n        customer \n    JOIN \n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY \n        cd_gender\n),\nReturnStatistics AS (\n    SELECT \n        sr_reason_sk,\n        COUNT(sr_item_sk) AS return_count,\n        SUM(sr_return_amt) AS total_return_amount,\n        AVG(sr_return_quantity) AS avg_return_quantity\n    FROM \n        store_returns\n    GROUP BY \n        sr_reason_sk\n)\nSELECT \n    a.ca_state,\n    a.address_count,\n    a.avg_street_name_length,\n    a.max_street_name_length,\n    a.min_street_name_length,\n    c.cd_gender,\n    c.customer_count,\n    c.avg_purchase_estimate,\n    r.return_count,\n    r.total_return_amount,\n    r.avg_return_quantity\nFROM \n    AddressStatistics a\nJOIN \n    CustomerStatistics c ON 1=1\nJOIN \n    ReturnStatistics r ON a.ca_state IS NOT NULL\nORDER BY \n    a.ca_state, c.cd_gender;\n",
  "WITH AddressSummary AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT ca_address_sk) AS unique_addresses,\n        COUNT(DISTINCT ca_city) AS unique_cities,\n        SUM(LENGTH(TRIM(ca_street_name))) AS total_street_name_length,\n        AVG(LENGTH(TRIM(ca_street_name))) AS avg_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomerDemographics AS (\n    SELECT \n        cd_gender,\n        COUNT(c_customer_sk) AS customer_count,\n        AVG(cd_dep_count) AS avg_dependents,\n        SUM(cd_purchase_estimate) AS total_purchase_estimate\n    FROM \n        customer\n    INNER JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY \n        cd_gender\n),\nReturnAnalysis AS (\n    SELECT \n        sr_store_sk,\n        SUM(sr_return_quantity) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amount,\n        COUNT(DISTINCT sr_ticket_number) AS unique_return_tickets\n    FROM \n        store_returns\n    GROUP BY \n        sr_store_sk\n)\nSELECT \n    a.ca_state,\n    a.unique_addresses,\n    a.unique_cities,\n    a.total_street_name_length,\n    a.avg_street_name_length,\n    cd.cd_gender,\n    cd.customer_count,\n    cd.avg_dependents,\n    cd.total_purchase_estimate,\n    ra.total_returns,\n    ra.total_return_amount,\n    ra.unique_return_tickets\nFROM \n    AddressSummary a\nJOIN \n    CustomerDemographics cd ON 1=1  \nJOIN \n    ReturnAnalysis ra ON ra.total_returns > 0  \nORDER BY \n    a.unique_addresses DESC, \n    cd.customer_count DESC;",
  "WITH AddressStats AS (\n    SELECT \n        ca_state,\n        COUNT(*) AS address_count,\n        COUNT(DISTINCT ca_city) AS distinct_city_count,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nDemographicStats AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependents\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender, cd_marital_status\n),\nSalesStats AS (\n    SELECT \n        d_year,\n        SUM(ws_net_profit) AS total_net_profit,\n        COUNT(ws_order_number) AS total_orders,\n        SUM(ws_quantity) AS total_quantity_sold\n    FROM \n        web_sales\n    JOIN \n        date_dim ON ws_sold_date_sk = d_date_sk\n    GROUP BY \n        d_year\n)\nSELECT \n    a.ca_state,\n    a.address_count,\n    a.distinct_city_count,\n    a.avg_street_name_length,\n    d.cd_gender,\n    d.cd_marital_status,\n    d.avg_purchase_estimate,\n    d.total_dependents,\n    s.d_year,\n    s.total_net_profit,\n    s.total_orders,\n    s.total_quantity_sold\nFROM \n    AddressStats a\nJOIN \n    DemographicStats d ON a.ca_state = 'CA' \nJOIN \n    SalesStats s ON s.d_year = 2001 \nORDER BY \n    a.address_count DESC, \n    d.avg_purchase_estimate DESC;",
  "\nWITH AddressStats AS (\n    SELECT \n        ca_state, \n        COUNT(*) AS total_addresses,\n        COUNT(DISTINCT ca_city) AS unique_cities,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomerStats AS (\n    SELECT \n        cd_gender, \n        COUNT(*) AS total_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        COUNT(DISTINCT cd_demo_sk) AS unique_demographics\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nSalesStats AS (\n    SELECT \n        ws_ship_date_sk,\n        COUNT(*) AS total_sales,\n        SUM(ws_net_profit) AS total_net_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_ship_date_sk\n),\nDemographicSales AS (\n    SELECT \n        cs_bill_cdemo_sk AS customer_demo_id,\n        SUM(cs_net_profit) AS total_profit\n    FROM \n        catalog_sales\n    GROUP BY \n        cs_bill_cdemo_sk\n)\nSELECT \n    A.ca_state,\n    A.total_addresses,\n    A.unique_cities,\n    A.avg_street_name_length,\n    A.max_street_name_length,\n    A.min_street_name_length,\n    C.cd_gender,\n    C.total_customers,\n    C.avg_purchase_estimate,\n    S.total_sales,\n    S.total_net_profit,\n    D.total_profit AS demographic_profit\nFROM \n    AddressStats A\nJOIN \n    CustomerStats C ON A.ca_state = 'CA' \nJOIN \n    SalesStats S ON S.ws_ship_date_sk = (SELECT MAX(ws_ship_date_sk) FROM web_sales) \nLEFT JOIN \n    DemographicSales D ON D.customer_demo_id = C.unique_demographics\nWHERE \n    C.avg_purchase_estimate > 1000 \nORDER BY \n    A.total_addresses DESC, \n    C.total_customers DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_credit_rating\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n        AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating\n),\nDemographicAnalysis AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_credit_rating,\n        COUNT(cs.c_customer_id) AS customer_count,\n        AVG(cs.total_sales) AS avg_sales,\n        AVG(cs.order_count) AS avg_orders\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_demographics cd ON cs.cd_gender = cd.cd_gender AND cs.cd_marital_status = cd.cd_marital_status\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating\n)\nSELECT \n    da.cd_gender,\n    da.cd_marital_status,\n    da.cd_education_status,\n    da.cd_credit_rating,\n    da.customer_count,\n    da.avg_sales,\n    da.avg_orders,\n    CASE \n        WHEN da.avg_sales > 1000 THEN 'High Value'\n        WHEN da.avg_sales BETWEEN 500 AND 1000 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_category\nFROM \n    DemographicAnalysis da\nORDER BY \n    da.avg_sales DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(sr_item_sk) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amount,\n        SUM(sr_return_tax) AS total_return_tax\n    FROM store_returns\n    GROUP BY sr_customer_sk\n), SalesSummary AS (\n    SELECT \n        ws_bill_customer_sk AS customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_ext_discount_amt) AS total_discount,\n        COUNT(ws_order_number) AS order_count\n    FROM web_sales\n    GROUP BY ws_bill_customer_sk\n), FinalReport AS (\n    SELECT \n        c.c_customer_id,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        COALESCE(cr.total_return_tax, 0) AS total_return_tax,\n        COALESCE(ss.total_sales, 0) AS total_sales,\n        COALESCE(ss.total_discount, 0) AS total_discount,\n        COALESCE(ss.order_count, 0) AS order_count,\n        CASE\n            WHEN COALESCE(ss.total_sales, 0) > 0 THEN (COALESCE(cr.total_return_amount, 0) / COALESCE(ss.total_sales, 0)) * 100\n            ELSE 0\n        END AS return_percentage\n    FROM customer c\n    LEFT JOIN CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN SalesSummary ss ON c.c_customer_sk = ss.customer_sk\n)\nSELECT \n    c.c_customer_id,\n    f.total_returns,\n    f.total_return_amount,\n    f.total_return_tax,\n    f.total_sales,\n    f.total_discount,\n    f.order_count,\n    f.return_percentage\nFROM FinalReport f\nJOIN customer c ON f.c_customer_id = c.c_customer_id\nWHERE f.return_percentage > 0\nORDER BY f.return_percentage DESC\nLIMIT 100;\n",
  "\nWITH Address_Analysis AS (\n    SELECT \n        ca_city,\n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        COUNT(*) AS total_addresses,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        SUM(CASE \n            WHEN ca_street_type LIKE '%St%' THEN 1 \n            ELSE 0 \n        END) AS street_st_count\n    FROM \n        customer_address\n    GROUP BY \n        ca_city, ca_state\n),\nDemographic_Summary AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS total_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nSales_Analysis AS (\n    SELECT \n        d_year,\n        SUM(ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        AVG(ws_net_paid_inc_tax) AS avg_order_value\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    GROUP BY \n        d_year\n)\nSELECT \n    aa.ca_city,\n    aa.ca_state,\n    aa.unique_addresses,\n    aa.total_addresses,\n    aa.avg_street_name_length,\n    aa.street_st_count,\n    da.cd_gender,\n    da.total_customers,\n    da.avg_purchase_estimate,\n    sa.d_year,\n    sa.total_profit,\n    sa.total_orders,\n    sa.avg_order_value\nFROM \n    Address_Analysis aa\nJOIN \n    Demographic_Summary da ON TRUE\nJOIN \n    Sales_Analysis sa ON TRUE\nORDER BY \n    aa.ca_state, \n    aa.ca_city, \n    sa.d_year DESC;\n",
  "\nWITH address_summary AS (\n    SELECT\n        ca_city AS city,\n        ca_state AS state,\n        COUNT(DISTINCT ca_address_sk) AS total_addresses,\n        SUM(LENGTH(ca_street_name) + LENGTH(ca_street_number) + LENGTH(ca_street_type)) AS total_characters,\n        AVG(LENGTH(ca_street_name) + LENGTH(ca_street_number) + LENGTH(ca_street_type)) AS avg_address_length\n    FROM\n        customer_address\n    GROUP BY\n        ca_city, ca_state\n),\ncustomer_summary AS (\n    SELECT\n        cd_gender,\n        COUNT(DISTINCT c_customer_sk) AS total_customers,\n        SUM(cd_dep_count) AS total_dependents,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM\n        customer\n    JOIN\n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY\n        cd_gender\n),\nsales_summary AS (\n    SELECT\n        ws_bill_customer_sk,\n        SUM(ws_net_profit) AS total_profit,\n        COUNT(ws_order_number) AS total_orders,\n        SUM(ws_quantity) AS total_items_sold\n    FROM\n        web_sales\n    GROUP BY\n        ws_bill_customer_sk\n)\nSELECT\n    ca.city AS city,\n    ca.state AS state,\n    ca.total_addresses,\n    ca.total_characters,\n    ca.avg_address_length,\n    cu.cd_gender,\n    cu.total_customers,\n    cu.total_dependents,\n    cu.avg_purchase_estimate,\n    ss.total_profit,\n    ss.total_orders,\n    ss.total_items_sold\nFROM\n    address_summary ca\nJOIN\n    customer_summary cu ON ca.total_addresses > 100  \nJOIN\n    sales_summary ss ON ss.ws_bill_customer_sk = cu.total_customers\nWHERE\n    ca.total_characters > 1000  \nORDER BY\n    ca.city, cu.cd_gender;\n",
  "WITH address_data AS (\n    SELECT \n        ca_state,\n        COUNT(*) AS total_addresses,\n        COUNT(DISTINCT ca_city) AS unique_cities,\n        SUM(CASE WHEN ca_street_type IN ('St', 'Avenue', 'Blvd', 'Rd', 'Ln') THEN 1 ELSE 0 END) AS residential_streets,\n        SUM(CASE WHEN ca_street_type IN ('Pkwy', 'Hwy', 'Bway') THEN 1 ELSE 0 END) AS major_highways\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\ndemographic_data AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS total_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        AVG(cd_dep_count) AS avg_dependency_count\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nsales_data AS (\n    SELECT \n        d_year,\n        SUM(ws_net_profit) AS total_net_profit,\n        SUM(ws_quantity) AS total_quantity_sold,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM \n        web_sales\n    JOIN \n        date_dim ON ws_sold_date_sk = d_date_sk\n    GROUP BY \n        d_year\n)\nSELECT \n    ad.ca_state,\n    ad.total_addresses,\n    ad.unique_cities,\n    ad.residential_streets,\n    ad.major_highways,\n    dd.cd_gender,\n    dd.total_customers,\n    dd.avg_purchase_estimate,\n    dd.avg_dependency_count,\n    sd.d_year,\n    sd.total_net_profit,\n    sd.total_quantity_sold,\n    sd.total_orders\nFROM \n    address_data ad\nJOIN \n    demographic_data dd ON 1=1  \nJOIN \n    sales_data sd ON 1=1  \nORDER BY \n    ad.ca_state, dd.cd_gender, sd.d_year;",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COUNT(DISTINCT cs.c_customer_sk) AS customer_count,\n        AVG(cs.total_web_sales) AS avg_sales\n    FROM \n        customer_demographics cd\n    JOIN \n        CustomerSales cs ON cd.cd_demo_sk = cs.c_customer_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nFinalStats AS (\n    SELECT \n        d.cd_gender,\n        d.cd_marital_status,\n        d.cd_education_status,\n        SUM(d.customer_count) AS total_customers,\n        AVG(d.avg_sales) AS avg_sales_per_customer\n    FROM \n        Demographics d\n    GROUP BY \n        d.cd_gender, d.cd_marital_status, d.cd_education_status\n)\nSELECT \n    fs.cd_gender,\n    fs.cd_marital_status,\n    fs.cd_education_status,\n    fs.total_customers,\n    fs.avg_sales_per_customer\nFROM \n    FinalStats fs\nORDER BY \n    fs.total_customers DESC, fs.avg_sales_per_customer DESC;\n",
  "\nWITH Address_Analysis AS (\n    SELECT \n        ca_city,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        SUM(CASE WHEN ca_street_type LIKE '%Ave%' THEN 1 ELSE 0 END) AS ave_street_count,\n        SUM(CASE WHEN ca_street_type LIKE '%St%' THEN 1 ELSE 0 END) AS st_street_count\n    FROM \n        customer_address\n    GROUP BY \n        ca_city\n),\nDemographics_Analysis AS (\n    SELECT \n        cd_gender, \n        COUNT(*) AS total_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependencies\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nSales_Analysis AS (\n    SELECT \n        CAST(d.d_date AS DATE) AS sales_date,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_quantity) AS total_quantity\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        CAST(d.d_date AS DATE)\n)\nSELECT \n    a.ca_city,\n    a.unique_addresses,\n    a.avg_street_name_length,\n    a.ave_street_count,\n    a.st_street_count,\n    d.cd_gender,\n    d.total_customers,\n    d.avg_purchase_estimate,\n    d.total_dependencies,\n    s.sales_date,\n    s.total_sales,\n    s.total_orders,\n    s.total_quantity\nFROM \n    Address_Analysis a\nJOIN \n    Demographics_Analysis d ON a.unique_addresses > 0\nJOIN \n    Sales_Analysis s ON a.unique_addresses > 100\nWHERE \n    s.total_sales > 10000\nORDER BY \n    a.unique_addresses DESC, s.total_sales DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(sr_returned_date_sk) AS total_returns,\n        SUM(sr_return_amt_inc_tax) AS total_return_amt,\n        SUM(sr_return_quantity) AS total_return_quantity\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        cd_demo_sk,\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_purchase_estimate\n    FROM \n        customer_demographics\n),\nCustomerAddress AS (\n    SELECT \n        ca_address_sk,\n        ca_city,\n        ca_state,\n        ca_country\n    FROM \n        customer_address\n),\nQualifiedCustomers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name || ' ' || c.c_last_name AS customer_name,\n        COALESCE(d.cd_gender, 'U') AS gender,\n        COALESCE(d.cd_marital_status, 'U') AS marital_status,\n        COALESCE(d.cd_education_status, 'Unknown') AS education_status,\n        COALESCE(a.ca_city, 'Unknown') AS city,\n        COALESCE(a.ca_state, 'Unknown') AS state,\n        COALESCE(a.ca_country, 'Unknown') AS country,\n        r.total_returns,\n        r.total_return_amt,\n        d.cd_purchase_estimate\n    FROM \n        customer c\n    LEFT OUTER JOIN CustomerDemographics d ON c.c_current_cdemo_sk = d.cd_demo_sk\n    LEFT OUTER JOIN CustomerAddress a ON c.c_current_addr_sk = a.ca_address_sk\n    LEFT OUTER JOIN CustomerReturns r ON c.c_customer_sk = r.sr_customer_sk\n)\nSELECT \n    city,\n    state,\n    country,\n    COUNT(DISTINCT c.customer_name) AS num_customers,\n    SUM(total_return_amt) AS total_return_amount,\n    AVG(total_returns) AS average_returns_per_customer,\n    MAX(cd_purchase_estimate) AS highest_purchase_estimate\nFROM \n    QualifiedCustomers c\nGROUP BY \n    city, state, country\nHAVING \n    COUNT(DISTINCT c.customer_name) > 10\nORDER BY \n    total_return_amount DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH customer_stats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        COALESCE(SUM(ws.ws_quantity), 0) AS total_quantity,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_sales_price) AS avg_sales_price\n    FROM customer c\n    LEFT JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate\n),\nreturn_stats AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returns,\n        SUM(sr_return_amt_inc_tax) AS total_return_amount\n    FROM store_returns\n    GROUP BY sr_customer_sk\n),\nfinal_stats AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.cd_gender,\n        cs.cd_marital_status,\n        cs.cd_purchase_estimate,\n        cs.total_quantity,\n        cs.total_orders,\n        cs.avg_sales_price,\n        COALESCE(rs.total_returns, 0) AS total_returns,\n        COALESCE(rs.total_return_amount, 0) AS total_return_amount,\n        (CASE \n            WHEN cs.total_orders > 0 THEN ROUND((COALESCE(rs.total_return_amount, 0) / NULLIF(cs.total_orders, 0)), 2)\n            ELSE 0 \n        END) AS return_rate\n    FROM customer_stats cs\n    LEFT JOIN return_stats rs ON cs.c_customer_sk = rs.sr_customer_sk\n)\nSELECT \n    f.c_customer_sk,\n    f.c_first_name || ' ' || f.c_last_name AS full_name,\n    f.cd_gender,\n    f.cd_marital_status,\n    f.total_quantity,\n    f.total_orders,\n    f.avg_sales_price,\n    f.total_returns,\n    f.total_return_amount,\n    f.return_rate\nFROM final_stats f\nWHERE (f.return_rate > 0.1 OR (f.cd_marital_status = 'M' AND f.total_orders > 5))\nORDER BY f.return_rate DESC, f.avg_sales_price ASC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count\n    FROM \n        customer AS c\n    JOIN \n        web_sales AS ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nHighValueCustomers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_sales,\n        cs.order_count,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        CustomerSales AS cs\n    JOIN \n        customer_demographics AS cd ON cs.c_customer_sk = cd.cd_demo_sk\n    WHERE \n        cs.total_sales > 1000\n),\nSalesSummary AS (\n    SELECT \n        COUNT(*) AS num_customers,\n        SUM(total_sales) AS total_sales,\n        AVG(total_sales) AS avg_sales,\n        MIN(total_sales) AS min_sales,\n        MAX(total_sales) AS max_sales\n    FROM \n        HighValueCustomers\n),\nMonthlySales AS (\n    SELECT \n        dd.d_year,\n        dd.d_month_seq,\n        SUM(ws.ws_ext_sales_price) AS monthly_sales\n    FROM \n        web_sales AS ws\n    JOIN \n        date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    GROUP BY \n        dd.d_year, dd.d_month_seq\n)\nSELECT \n    hvc.cd_gender,\n    hvc.cd_marital_status,\n    hvc.cd_education_status,\n    ss.num_customers,\n    ss.total_sales,\n    ss.avg_sales,\n    ss.min_sales,\n    ss.max_sales,\n    ms.d_year,\n    ms.d_month_seq,\n    ms.monthly_sales\nFROM \n    HighValueCustomers AS hvc,\n    SalesSummary AS ss,\n    MonthlySales AS ms\nORDER BY \n    ms.d_year DESC, ms.d_month_seq DESC, hvc.total_sales DESC;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_sk) AS total_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependents,\n        SUM(cd_dep_employed_count) AS total_employed_dependents,\n        SUM(cd_dep_college_count) AS total_college_dependents\n    FROM \n        customer\n    JOIN \n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY \n        cd_gender\n), SalesStats AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws_net_profit) AS total_profit,\n        SUM(ws_net_paid) AS total_paid,\n        COUNT(DISTINCT ws_order_number) AS order_count,\n        SUM(ws_quantity) AS total_quantity_sold\n    FROM \n        web_sales AS w\n    JOIN \n        customer AS c ON c.c_customer_sk = w.ws_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk\n), FinalStats AS (\n    SELECT \n        cs.cd_gender,\n        cs.total_customers,\n        cs.avg_purchase_estimate,\n        COALESCE(SUM(ss.total_profit), 0) AS total_profit,\n        COALESCE(SUM(ss.total_paid), 0) AS total_paid,\n        COALESCE(SUM(ss.order_count), 0) AS total_orders,\n        COALESCE(SUM(ss.total_quantity_sold), 0) AS total_quantity_sold\n    FROM \n        CustomerStats AS cs\n    LEFT JOIN \n        SalesStats AS ss ON cs.total_customers = ss.c_customer_sk\n    GROUP BY \n        cs.cd_gender, cs.total_customers, cs.avg_purchase_estimate\n)\nSELECT \n    cd_gender,\n    total_customers,\n    avg_purchase_estimate,\n    total_profit,\n    total_paid,\n    total_orders,\n    total_quantity_sold\nFROM \n    FinalStats\nORDER BY \n    total_profit DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_paid_inc_tax) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        dd.d_year,\n        dd.d_month_seq,\n        dd.d_week_seq\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    GROUP BY \n        ws.ws_sold_date_sk, ws.ws_item_sk, dd.d_year, dd.d_month_seq, dd.d_week_seq\n), \nCustomerData AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(sd.total_quantity) AS total_quantity,\n        SUM(sd.total_sales) AS total_sales,\n        SUM(sd.total_discount) AS total_discount\n    FROM \n        SalesData sd\n    JOIN \n        customer c ON sd.ws_item_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    COUNT(*) AS customer_count,\n    SUM(cd.total_quantity) AS grand_total_quantity,\n    SUM(cd.total_sales) AS grand_total_sales,\n    SUM(cd.total_discount) AS grand_total_discount,\n    AVG(cd.total_sales) AS avg_sales_per_customer,\n    MAX(cd.total_sales) AS max_sales_per_customer,\n    MIN(cd.total_sales) AS min_sales_per_customer\nFROM \n    CustomerData cd\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\nORDER BY \n    grand_total_sales DESC\nLIMIT 10;\n",
  "\nWITH demographic_analysis AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_sk) AS customer_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependents,\n        SUM(cd_dep_college_count) AS total_college_dependents\n    FROM \n        customer \n    JOIN \n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY \n        cd_gender\n),\nitem_statistics AS (\n    SELECT \n        i_category AS item_category,\n        COUNT(i_item_sk) AS item_count,\n        SUM(i_current_price) AS total_value,\n        MIN(i_current_price) AS min_price,\n        AVG(i_current_price) AS avg_price,\n        MAX(i_current_price) AS max_price\n    FROM \n        item\n    GROUP BY \n        i_category\n),\nsales_summary AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_paid_inc_tax) AS total_sales,\n        COUNT(ws_order_number) AS order_count,\n        DATE '2002-10-01' AS report_date\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk = (SELECT MAX(d_date_sk) FROM date_dim)\n    GROUP BY \n        ws_bill_customer_sk\n),\ncombined_report AS (\n    SELECT \n        da.cd_gender,\n        da.customer_count,\n        da.avg_purchase_estimate,\n        i.item_category,\n        i.item_count,\n        i.total_value,\n        i.min_price,\n        i.avg_price,\n        i.max_price,\n        s.total_sales,\n        s.order_count\n    FROM \n        demographic_analysis da\n    CROSS JOIN \n        item_statistics i\n    JOIN \n        sales_summary s ON s.ws_bill_customer_sk = (\n            SELECT c_customer_sk FROM customer WHERE c_current_cdemo_sk IS NOT NULL LIMIT 1\n        )\n    WHERE \n        da.customer_count > 0 AND i.item_count > 0\n        AND da.avg_purchase_estimate > (SELECT AVG(cd_purchase_estimate) FROM customer_demographics)\n)\nSELECT \n    cd_gender,\n    SUM(customer_count) AS total_customers,\n    AVG(avg_purchase_estimate) AS average_estimates,\n    COUNT(DISTINCT item_category) AS distinct_categories,\n    SUM(total_value) AS total_item_value,\n    MIN(min_price) AS lowest_price,\n    AVG(avg_price) AS average_item_price,\n    MAX(max_price) AS highest_price,\n    SUM(total_sales) AS total_sales,\n    SUM(order_count) AS total_orders\nFROM \n    combined_report\nGROUP BY \n    cd_gender\nHAVING \n    SUM(customer_count) > 10\nORDER BY \n    total_sales DESC, average_item_price ASC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH CustomerReturns AS (\n    SELECT\n        cr_returning_customer_sk,\n        SUM(cr_return_quantity) AS total_returned_quantity,\n        SUM(cr_return_amt_inc_tax) AS total_returned_amount,\n        COUNT(DISTINCT cr_order_number) AS return_count\n    FROM catalog_returns\n    GROUP BY cr_returning_customer_sk\n),\nSalesData AS (\n    SELECT\n        ws_bill_customer_sk,\n        SUM(ws_quantity) AS total_sales_quantity,\n        SUM(ws_sales_price) AS total_sales_amount,\n        AVG(ws_net_paid_inc_tax) AS avg_net_paid,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM web_sales\n    WHERE ws_sold_date_sk >= (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY ws_bill_customer_sk\n),\nCustomerDemographics AS (\n    SELECT c.c_customer_sk,\n           cd.cd_gender,\n           cd.cd_marital_status,\n           cd.cd_purchase_estimate,\n           cd.cd_credit_rating\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nFinalReport AS (\n    SELECT\n        cd.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COALESCE(cr.total_returned_quantity, 0) AS total_returned_quantity,\n        COALESCE(cr.total_returned_amount, 0) AS total_returned_amount,\n        COALESCE(sd.total_sales_quantity, 0) AS total_sales_quantity,\n        COALESCE(sd.total_sales_amount, 0) AS total_sales_amount,\n        COALESCE(sd.avg_net_paid, 0) AS avg_net_paid,\n        CASE\n            WHEN COALESCE(sd.total_orders, 0) > 0 THEN 'Active'\n            ELSE 'Inactive'\n        END AS customer_status\n    FROM CustomerDemographics cd\n    LEFT JOIN CustomerReturns cr ON cd.c_customer_sk = cr.cr_returning_customer_sk\n    LEFT JOIN SalesData sd ON cd.c_customer_sk = sd.ws_bill_customer_sk\n)\nSELECT\n    f.cd_gender,\n    f.cd_marital_status,\n    SUM(f.total_returned_quantity) AS total_returned_quantity,\n    SUM(f.total_returned_amount) AS total_returned_amount,\n    SUM(f.total_sales_quantity) AS total_sales_quantity,\n    SUM(f.total_sales_amount) AS total_sales_amount,\n    AVG(f.avg_net_paid) AS avg_net_paid,\n    f.customer_status\nFROM FinalReport f\nGROUP BY f.cd_gender, f.cd_marital_status, f.customer_status\nHAVING SUM(f.total_sales_quantity) > 0\nORDER BY SUM(f.total_sales_amount) DESC, SUM(f.total_returned_amount) ASC;\n",
  "\nWITH WebSalesSummary AS (\n    SELECT \n        w.ws_order_number,\n        w.ws_item_sk,\n        SUM(w.ws_quantity) AS total_quantity,\n        SUM(w.ws_net_profit) AS total_net_profit,\n        d.d_year,\n        d.d_month_seq,\n        d.d_week_seq\n    FROM \n        web_sales w\n    JOIN \n        date_dim d ON w.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        w.ws_order_number, w.ws_item_sk, d.d_year, d.d_month_seq, d.d_week_seq\n),\nStoreSalesSummary AS (\n    SELECT \n        s.ss_ticket_number,\n        s.ss_item_sk,\n        SUM(s.ss_quantity) AS total_quantity,\n        SUM(s.ss_net_profit) AS total_net_profit,\n        d.d_year,\n        d.d_month_seq,\n        d.d_week_seq\n    FROM \n        store_sales s\n    JOIN \n        date_dim d ON s.ss_sold_date_sk = d.d_date_sk\n    GROUP BY \n        s.ss_ticket_number, s.ss_item_sk, d.d_year, d.d_month_seq, d.d_week_seq\n),\nTotalSales AS (\n    SELECT \n        ws.ws_item_sk,\n        ws.total_quantity AS web_quantity,\n        ws.total_net_profit AS web_net_profit,\n        ss.total_quantity AS store_quantity,\n        ss.total_net_profit AS store_net_profit,\n        ws.d_year,\n        ws.d_month_seq,\n        ws.d_week_seq\n    FROM \n        WebSalesSummary ws\n    FULL OUTER JOIN \n        StoreSalesSummary ss ON ws.ws_item_sk = ss.ss_item_sk AND ws.ws_order_number = ss.ss_ticket_number\n)\nSELECT \n    t.ws_item_sk,\n    COALESCE(web_quantity, 0) AS web_quantity,\n    COALESCE(store_quantity, 0) AS store_quantity,\n    COALESCE(web_net_profit, 0) AS web_net_profit,\n    COALESCE(store_net_profit, 0) AS store_net_profit,\n    t.d_year,\n    t.d_month_seq,\n    t.d_week_seq\nFROM \n    TotalSales t\nWHERE \n    t.d_year = 2023 AND t.d_month_seq IN (1, 2, 3) \nORDER BY \n    t.ws_item_sk, t.d_year, t.d_month_seq, t.d_week_seq;\n",
  "\nWITH date_range AS (\n    SELECT d.d_date_sk, d.d_year\n    FROM date_dim d\n    WHERE d.d_date BETWEEN '2022-01-01' AND '2022-12-31'\n),\ncustomer_info AS (\n    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status,\n           cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nsales_data AS (\n    SELECT ws.ws_item_sk, SUM(ws.ws_sales_price) AS total_sales, SUM(ws.ws_quantity) AS total_quantity,\n           ws.ws_bill_cdemo_sk, dr.d_year\n    FROM web_sales ws\n    JOIN date_range dr ON ws.ws_sold_date_sk = dr.d_date_sk\n    GROUP BY ws.ws_item_sk, ws.ws_bill_cdemo_sk, dr.d_year\n),\ncustomer_sales AS (\n    SELECT ci.c_customer_sk, ci.c_first_name, ci.c_last_name, ci.cd_gender, ci.cd_marital_status,\n           ci.cd_education_status, ci.cd_purchase_estimate, ci.cd_credit_rating,\n           sd.total_sales, sd.total_quantity, sd.d_year\n    FROM customer_info ci\n    JOIN sales_data sd ON ci.c_customer_sk = sd.ws_bill_cdemo_sk\n)\nSELECT c.c_customer_sk, c.c_first_name, c.c_last_name, c.cd_gender, c.cd_marital_status,\n       c.cd_education_status, c.cd_purchase_estimate, c.cd_credit_rating,\n       SUM(COALESCE(c.total_sales, 0)) AS total_sales, \n       SUM(COALESCE(c.total_quantity, 0)) AS total_quantity,\n       c.d_year\nFROM customer_sales c\nGROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, c.cd_gender, \n         c.cd_marital_status, c.cd_education_status, c.cd_purchase_estimate, \n         c.cd_credit_rating, c.d_year\nHAVING SUM(COALESCE(c.total_sales, 0)) > 10000\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(ws_order_number) AS total_orders,\n        MAX(ws_sold_date_sk) AS last_purchase_date\n    FROM web_sales\n    WHERE ws_sold_date_sk BETWEEN \n        (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022) - 90 AND \n        (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022)\n    GROUP BY ws_bill_customer_sk\n), CustomerDemographic AS (\n    SELECT \n        cd_demo_sk,\n        cd_gender,\n        cd_marital_status,\n        cd_purchase_estimate,\n        cd_credit_rating,\n        cd_dep_count,\n        cd_dep_employed_count\n    FROM customer_demographics\n), CustomerDetails AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_country,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        sd.total_sales,\n        sd.total_orders,\n        sd.last_purchase_date\n    FROM customer c\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN CustomerDemographic cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN SalesData sd ON c.c_customer_sk = sd.ws_bill_customer_sk\n)\nSELECT \n    cd.c_first_name || ' ' || cd.c_last_name AS full_name,\n    cd.ca_city,\n    cd.ca_state,\n    cd.ca_country,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_purchase_estimate,\n    cd.total_sales,\n    cd.total_orders,\n    COUNT(CASE WHEN cd.last_purchase_date >= (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 THEN 1 END) AS recent_buyers\nFROM CustomerDetails cd\nGROUP BY \n    cd.c_first_name,\n    cd.c_last_name,\n    cd.ca_city,\n    cd.ca_state,\n    cd.ca_country,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_purchase_estimate,\n    cd.total_sales,\n    cd.total_orders\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_sold_date_sk,\n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity_sold,\n        SUM(ws_net_paid) AS total_net_paid,\n        MAX(ws_net_profit) AS max_net_profit,\n        MIN(ws_net_profit) AS min_net_profit,\n        AVG(ws_net_profit) AS avg_net_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_sold_date_sk, ws_item_sk\n),\ncustomer_summary AS (\n    SELECT \n        c_current_cdemo_sk AS demo_sk,\n        COUNT(DISTINCT c_customer_sk) AS total_customers,\n        COUNT(DISTINCT c_email_address) AS total_emails,\n        AVG(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_ratio,\n        AVG(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_ratio\n    FROM \n        customer \n    JOIN \n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY \n        c_current_cdemo_sk\n)\nSELECT \n    d.d_date AS sale_date,\n    SUM(ss.total_quantity_sold) AS total_quantity,\n    SUM(ss.total_net_paid) AS total_sales,\n    cs.total_customers,\n    cs.total_emails,\n    cs.male_ratio,\n    cs.female_ratio,\n    ss.max_net_profit,\n    ss.min_net_profit,\n    ss.avg_net_profit\nFROM \n    sales_summary ss\nJOIN \n    date_dim d ON d.d_date_sk = ss.ws_sold_date_sk\nJOIN \n    customer_summary cs ON cs.demo_sk = ss.ws_item_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    d.d_date, cs.total_customers, cs.total_emails, cs.male_ratio, cs.female_ratio, ss.max_net_profit, ss.min_net_profit, ss.avg_net_profit\nORDER BY \n    d.d_date;\n",
  "WITH CustomerReturns AS (\n    SELECT\n        sr_item_sk,\n        SUM(sr_return_quantity) AS total_return_quantity,\n        COUNT(DISTINCT sr_ticket_number) AS returns_count,\n        MAX(sr_return_amt_inc_tax) AS max_return_value\n    FROM\n        store_returns\n    GROUP BY\n        sr_item_sk\n),\nItemPerformance AS (\n    SELECT\n        iw.i_item_sk,\n        iw.i_item_desc,\n        iw.i_current_price,\n        COALESCE(CR.total_return_quantity, 0) AS total_returns,\n        COALESCE(CR.returns_count, 0) AS returns_count,\n        COUNT(DISTINCT ws.ws_order_number) AS total_sales,\n        SUM(ws.ws_net_profit) AS net_profit,\n        CASE\n            WHEN COUNT(DISTINCT ws.ws_order_number) = 0 THEN NULL\n            ELSE SUM(ws.ws_net_profit) / COUNT(DISTINCT ws.ws_order_number)\n        END AS avg_profit_per_sale\n    FROM\n        item iw\n    LEFT JOIN\n        web_sales ws ON iw.i_item_sk = ws.ws_item_sk\n    LEFT JOIN\n        CustomerReturns CR ON iw.i_item_sk = CR.sr_item_sk\n    WHERE\n        iw.i_current_price > (\n            SELECT AVG(i_current_price) FROM item WHERE i_rec_start_date < cast('2002-10-01' as date)\n        )\n    GROUP BY\n        iw.i_item_sk, iw.i_item_desc, iw.i_current_price, CR.total_return_quantity, CR.returns_count \n)\nSELECT\n    ip.i_item_sk,\n    ip.i_item_desc,\n    ip.i_current_price,\n    ip.total_returns,\n    ip.returns_count,\n    ip.total_sales,\n    ip.net_profit,\n    ip.avg_profit_per_sale,\n    COUNT(DISTINCT wr.wr_order_number) FILTER (WHERE wr_return_quantity > 0) AS web_returns_count,\n    SUM(CASE WHEN wr_return_amt_inc_tax IS NULL THEN 0 ELSE wr_return_amt_inc_tax END) AS total_web_return_value\nFROM\n    ItemPerformance ip\nLEFT JOIN\n    web_returns wr ON ip.i_item_sk = wr.wr_item_sk\nGROUP BY\n    ip.i_item_sk, ip.i_item_desc, ip.i_current_price, ip.total_returns, ip.returns_count, \n    ip.total_sales, ip.net_profit, ip.avg_profit_per_sale\nHAVING\n    AVG(ip.avg_profit_per_sale) IS NOT NULL OR SUM(ip.total_returns) > 5\nORDER BY\n    ip.total_sales DESC NULLS LAST,\n    ip.avg_profit_per_sale DESC NULLS FIRST\nLIMIT 100;",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_order_number,\n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        ws.ws_quantity,\n        ws.ws_sales_price,\n        ws.ws_ext_sales_price,\n        cs.cs_quantity,\n        cs.cs_sales_price,\n        sr.sr_return_quantity,\n        sr.sr_return_amt,\n        sr.sr_net_loss,\n        cr.cr_return_quantity,\n        cr.cr_return_amount,\n        cr.cr_net_loss,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(sr.sr_return_amt) AS total_returns,\n        SUM(cr.cr_return_amount) AS total_catalog_returns\n    FROM \n        web_sales ws\n    LEFT JOIN \n        catalog_sales cs ON ws.ws_item_sk = cs.cs_item_sk AND ws.ws_order_number = cs.cs_order_number\n    LEFT JOIN \n        store_returns sr ON ws.ws_item_sk = sr.sr_item_sk AND ws.ws_order_number = sr.sr_ticket_number\n    LEFT JOIN \n        catalog_returns cr ON ws.ws_item_sk = cr.cr_item_sk AND ws.ws_order_number = cr.cr_order_number\n    GROUP BY \n        ws.ws_order_number, ws.ws_sold_date_sk, ws.ws_item_sk, ws.ws_quantity, ws.ws_sales_price, ws.ws_ext_sales_price, cs.cs_quantity, cs.cs_sales_price, sr.sr_return_quantity, sr.sr_return_amt, sr.sr_net_loss, cr.cr_return_quantity, cr.cr_return_amount, cr.cr_net_loss\n),\nAggregatedData AS (\n    SELECT \n        sd.ws_order_number,\n        COUNT(sd.ws_item_sk) AS total_items_sold,\n        SUM(sd.ws_quantity) AS total_units_sold,\n        AVG(sd.ws_sales_price) AS avg_sales_price,\n        SUM(sd.total_sales) AS total_sales_value,\n        SUM(sd.total_returns) AS total_returns_value,\n        SUM(sd.total_catalog_returns) AS total_catalog_returns_value,\n        (SUM(sd.total_sales) - SUM(sd.total_returns) - SUM(sd.total_catalog_returns)) AS net_revenue\n    FROM \n        SalesData sd\n    GROUP BY \n        sd.ws_order_number\n)\nSELECT \n    ad.ws_order_number,\n    ad.total_items_sold, \n    ad.total_units_sold,\n    ad.avg_sales_price,\n    ad.total_sales_value, \n    ad.total_returns_value, \n    ad.total_catalog_returns_value,\n    ad.net_revenue\nFROM \n    AggregatedData ad\nORDER BY \n    ad.net_revenue DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ss.ss_quantity,\n    ss.ss_sales_price,\n    d.d_date,\n    t.t_hour\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN \n    time_dim t ON ss.ss_sold_time_sk = t.t_time_sk\nWHERE \n    d.d_year = 2023 \n    AND ca.ca_state = 'CA'\nORDER BY \n    ss.ss_sales_price DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_date,\n    i.i_item_id,\n    ws.ws_sales_price,\n    ss.ss_quantity,\n    ss.ss_net_paid\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nJOIN \n    web_sales ws ON i.i_item_sk = ws.ws_item_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\n    AND c.c_current_cdemo_sk IS NOT NULL\nORDER BY \n    ss.ss_net_paid DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    ss.ss_quantity,\n    ss.ss_sales_price,\n    ws.ws_sales_price,\n    d.d_date\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    ca.ca_state = 'CA' \n    AND d.d_year = 2023\nORDER BY \n    ss.ss_sales_price DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS customer_count, \n    AVG(cd_purchase_estimate) AS avg_purchase_estimate, \n    SUM(ws_ext_sales_price) AS total_sales \nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk \nJOIN \n    customer_demographics ON c_current_cdemo_sk = cd_demo_sk \nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk \nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk \nGROUP BY \n    ca_state \nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_id) AS total_customers, \n    SUM(ws_sales_price) AS total_sales, \n    SUM(ss_sales_price) AS total_store_sales,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address\nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\nLEFT JOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk\nLEFT JOIN \n    store_sales ON store_sales.ss_customer_sk = customer.c_customer_sk\nJOIN \n    customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state, \n    COUNT(DISTINCT c_customer_sk) AS num_customers,\n    AVG(CASE WHEN cd_gender = 'M' THEN cd_dep_count ELSE NULL END) AS avg_male_children,\n    AVG(CASE WHEN cd_gender = 'F' THEN cd_dep_count ELSE NULL END) AS avg_female_children,\n    SUM(ws_ext_sales_price) AS total_sales\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    customer_demographics ON c_current_cdemo_sk = cd_demo_sk\nJOIN \n    web_sales ON c_customer_sk = ws_bill_customer_sk\nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk\nWHERE \n    d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_customers,\n    SUM(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_customers,\n    AVG(cd_purchase_estimate) AS average_purchase_estimate,\n    SUM(ws_net_profit) AS total_net_profit\nFROM \n    customer_address\nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    customer_demographics ON c_current_cdemo_sk = cd_demo_sk\nJOIN \n    web_sales ON ws_bill_customer_sk = c_customer_sk\nJOIN \n    date_dim ON ws_sold_date_sk = d_date_sk\nWHERE \n    d_year = 2023 \n    AND ca_country = 'USA'\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS total_customers,\n    SUM(ws_quantity) AS total_quantity_sold,\n    AVG(ws_net_paid) AS average_order_value,\n    COUNT(DISTINCT ws_order_number) AS total_orders,\n    SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_customers,\n    SUM(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_customers,\n    MIN(d_date) AS first_sale_date,\n    MAX(d_date) AS last_sale_date\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_quantity_sold DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_city,\n    COUNT(DISTINCT c.c_customer_id) AS total_customers,\n    SUM(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_count,\n    SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_count,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n    AVG(cd_dep_count) AS avg_dep_count,\n    SUM(ws_ext_sales_price) AS total_sales,\n    MAX(ws_net_profit) AS max_profit,\n    MIN(ws_net_profit) AS min_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca.ca_city\nHAVING \n    COUNT(DISTINCT c.c_customer_id) > 50\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS customer_count,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n    SUM(ws_net_profit) AS total_net_profit,\n    AVG(ws_net_paid_inc_tax) AS avg_net_income\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\n    AND cd.cd_gender = 'F'\nGROUP BY \n    ca_state\nHAVING \n    COUNT(DISTINCT c_customer_sk) > 100\nORDER BY \n    total_net_profit DESC;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS unique_customers,\n    SUM(ws_quantity) AS total_quantity_sold,\n    SUM(ws_net_profit) AS total_net_profit,\n    AVG(cd_dep_count) AS avg_dependents\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\n    AND ws.ws_net_profit > 0\nGROUP BY \n    ca_state\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_city, \n    cd.cd_gender, \n    COUNT(DISTINCT c.c_customer_id) AS customer_count, \n    SUM(ss.ss_sales_price) AS total_sales, \n    SUM(ss.ss_net_profit) AS total_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    ca.ca_city, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    d.d_year, \n    d.d_month_seq, \n    COUNT(ss.ss_ticket_number) AS total_sales, \n    SUM(ss.ss_sales_price) AS total_revenue\nFROM \n    store_sales ss\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    d.d_year = 2023\n    AND cd.cd_gender = 'F'\nGROUP BY \n    d.d_year, \n    d.d_month_seq\nORDER BY \n    d.d_year, \n    d.d_month_seq;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    COUNT(DISTINCT w.w_warehouse_id) AS warehouse_count,\n    SUM(ss.ss_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store s ON c.c_customer_sk = s.s_store_sk\nJOIN \n    store_sales ss ON ss.ss_store_sk = s.s_store_sk\nJOIN \n    warehouse w ON s.s_store_sk = w.w_warehouse_sk\nWHERE \n    ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, ca.ca_city\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    ca_city, \n    ca_state, \n    COUNT(DISTINCT customer.c_customer_id) AS total_customers, \n    SUM(ws_quantity) AS total_quantity_sold, \n    SUM(ws_net_profit) AS total_net_profit, \n    AVG(cd_purchase_estimate) AS avg_purchase_estimate \nFROM \n    customer_address \nJOIN \n    customer ON customer.c_current_addr_sk = customer_address.ca_address_sk \nJOIN \n    web_sales ON web_sales.ws_bill_customer_sk = customer.c_customer_sk \nJOIN \n    customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk \nJOIN \n    date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk \nWHERE \n    date_dim.d_year = 2022 \n    AND cd_gender = 'F' \n    AND cd_marital_status = 'M' \nGROUP BY \n    ca_city, \n    ca_state \nORDER BY \n    total_net_profit DESC \nLIMIT 10;\n",
  "\nSELECT \n    ca.ca_city, \n    ca.ca_state, \n    COUNT(DISTINCT ws.ws_bill_customer_sk) AS total_customers,\n    SUM(ws.ws_quantity) AS total_quantity_sold,\n    AVG(ws.ws_net_profit) AS avg_net_profit,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    web_sales ws\nJOIN \n    customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nJOIN \n    promotion p ON ws.ws_promo_sk = p.p_promo_sk\nWHERE \n    dd.d_year = 2023 \n    AND p.p_discount_active = 'Y'\nGROUP BY \n    ca.ca_city, ca.ca_state\nHAVING \n    SUM(ws.ws_quantity) > 1000\nORDER BY \n    avg_net_profit DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    SUM(ws.ws_sales_price) AS total_sales, \n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    ca.ca_city,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, d.d_year\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_sales_price) AS total_sales\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS order_count\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH ProcessedAddresses AS (\n    SELECT \n        REPLACE(UPPER(ca_street_name), 'STREET', 'ST') AS processed_street_name,\n        ca_city,\n        ca_zip,\n        ca_state,\n        ca_address_sk\n    FROM \n        customer_address\n    WHERE \n        ca_city IS NOT NULL AND \n        ca_zip IS NOT NULL\n),\nCustomerDetails AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        c.c_email_address,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        pa.processed_street_name,\n        pa.ca_city,\n        pa.ca_state,\n        pa.ca_zip\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        ProcessedAddresses pa ON c.c_current_addr_sk = pa.ca_address_sk\n),\nSalesData AS (\n    SELECT \n        ws.ws_order_number,\n        ws.ws_net_paid,\n        cd.c_customer_sk,\n        cd.c_first_name,\n        cd.c_last_name,\n        cd.c_email_address\n    FROM \n        web_sales ws\n    JOIN \n        CustomerDetails cd ON ws.ws_bill_customer_sk = cd.c_customer_sk\n)\nSELECT \n    cd.c_first_name,\n    cd.c_last_name,\n    cd.c_email_address,\n    SUM(sd.ws_net_paid) AS total_spent,\n    COUNT(DISTINCT sd.ws_order_number) AS order_count\nFROM \n    CustomerDetails cd\nLEFT JOIN \n    SalesData sd ON cd.c_customer_sk = sd.c_customer_sk\nGROUP BY \n    cd.c_first_name, cd.c_last_name, cd.c_email_address\nHAVING \n    SUM(sd.ws_net_paid) > 1000\nORDER BY \n    total_spent DESC;\n",
  "\nSELECT \n    ca.ca_city,\n    ca.ca_state,\n    cd.cd_gender,\n    COUNT(DISTINCT c.c_customer_id) AS num_customers,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    AVG(ws.ws_net_profit) AS avg_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023 \n    AND ca.ca_state IN ('CA', 'NY', 'TX') \n    AND cd.cd_marital_status = 'M' \nGROUP BY \n    ca.ca_city, ca.ca_state, cd.cd_gender\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    w.w_warehouse_name,\n    sum(ss.ss_sales_price) AS total_sales,\n    count(ss.ss_ticket_number) AS total_transactions\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nJOIN \n    warehouse w ON s.s_company_id = w.w_warehouse_sk\nWHERE \n    ca.ca_city = 'San Francisco'\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, w.w_warehouse_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH AddressCounts AS (\n    SELECT \n        ca_state,\n        COUNT(*) AS address_count\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomerCounts AS (\n    SELECT \n        cd_marital_status,\n        COUNT(c.c_customer_sk) AS customer_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_marital_status\n),\nSalesByState AS (\n    SELECT \n        a.ca_state,\n        SUM(ws.ws_ext_sales_price) AS total_sales\n    FROM \n        web_sales ws\n    JOIN \n        customer_address a ON ws.ws_bill_addr_sk = a.ca_address_sk\n    GROUP BY \n        a.ca_state\n),\nFinalBenchmark AS (\n    SELECT \n        ac.ca_state,\n        ac.address_count,\n        cc.customer_count,\n        COALESCE(sbs.total_sales, 0) AS total_sales\n    FROM \n        AddressCounts ac\n    JOIN \n        CustomerCounts cc ON 1 = 1\n    LEFT JOIN \n        SalesByState sbs ON ac.ca_state = sbs.ca_state\n    ORDER BY \n        ac.address_count DESC, \n        cc.customer_count DESC\n)\n\nSELECT \n    ca_state, \n    address_count, \n    customer_count, \n    total_sales\nFROM \n    FinalBenchmark\nWHERE \n    total_sales > 0\nORDER BY \n    address_count ASC, \n    total_sales DESC;\n",
  "\nWITH CustomerFullNames AS (\n    SELECT \n        c.c_customer_sk,\n        CONCAT(TRIM(c.c_first_name), ' ', TRIM(c.c_last_name)) AS full_name\n    FROM \n        customer c\n    WHERE \n        c.c_first_name IS NOT NULL AND \n        c.c_last_name IS NOT NULL\n),\nSalesData AS (\n    SELECT \n        CASE \n            WHEN ws.ws_ship_date_sk IS NOT NULL THEN 'Web Sales'\n            WHEN cs.cs_ship_date_sk IS NOT NULL THEN 'Catalog Sales'\n            ELSE 'Store Sales'\n        END AS sales_type,\n        COALESCE(ws.ws_sales_price, cs.cs_sales_price, ss.ss_sales_price) AS sale_amount,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        web_sales ws\n        FULL OUTER JOIN catalog_sales cs ON ws.ws_order_number = cs.cs_order_number\n        FULL OUTER JOIN store_sales ss ON ws.ws_order_number = ss.ss_ticket_number\n        JOIN customer c ON COALESCE(ws.ws_bill_customer_sk, cs.cs_bill_customer_sk, ss.ss_customer_sk) = c.c_customer_sk\n        JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n)\nSELECT \n    sales_type,\n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    COUNT(*) AS total_sales,\n    AVG(sale_amount) AS avg_sale_amount,\n    SUM(sale_amount) AS total_revenue\nFROM \n    SalesData\nGROUP BY \n    sales_type, cd_gender, cd_marital_status, cd_education_status\nORDER BY \n    sales_type, total_sales DESC;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_net_paid) AS total_spent,\n    COUNT(ss.ss_ticket_number) AS total_purchases,\n    COUNT(DISTINCT ss.ss_item_sk) AS unique_items_purchased,\n    AVG(CASE WHEN ss.ss_sold_date_sk BETWEEN d.d_date_sk AND d.d_date_sk + 30 THEN ss.ss_net_paid ELSE NULL END) AS avg_spent_last_30_days,\n    COUNT(DISTINCT CASE WHEN wr.wr_order_number IS NOT NULL THEN wr.wr_order_number END) AS total_web_returns\nFROM \n    customer AS c\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nLEFT JOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    web_returns AS wr ON c.c_customer_sk = wr.wr_returning_customer_sk\nJOIN \n    date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    ca.ca_state IN ('CA', 'NY')\n    AND d.d_year = 2023\nGROUP BY \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state\nORDER BY \n    total_spent DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    AVG(ws.ws_net_profit) AS average_net_profit,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    COUNT(DISTINCT ws.ws_web_page_sk) AS distinct_web_pages\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nJOIN \n    time_dim td ON ws.ws_sold_time_sk = td.t_time_sk\nWHERE \n    dd.d_year = 2022 \n    AND ca.ca_state = 'CA'\n    AND ws.ws_sales_price > 100\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ca.ca_city\nHAVING \n    SUM(ws.ws_ext_sales_price) > 10000\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    ca.ca_city,\n    cd.cd_gender,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_net_paid) AS total_revenue,\n    AVG(ws.ws_net_profit) AS average_profit,\n    MAX(ws.ws_sales_price) AS max_sales_price,\n    MIN(ws.ws_sales_price) AS min_sales_price,\n    CAST(d.d_date AS DATE) AS transaction_date\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\n    AND ws.ws_net_paid > 0\nGROUP BY \n    c.c_customer_id, ca.ca_city, cd.cd_gender, d.d_date\nHAVING \n    COUNT(DISTINCT ws.ws_order_number) > 5\nORDER BY \n    total_revenue DESC;\n",
  "\nSELECT \n    ca.ca_city, \n    ca.ca_state, \n    cd.cd_gender, \n    cd.cd_marital_status, \n    COUNT(DISTINCT c.c_customer_id) AS customer_count,\n    SUM(ws.ws_quantity) AS total_quantity, \n    SUM(ws.ws_net_paid) AS total_sales, \n    AVG(ws.ws_net_profit) AS average_profit\nFROM \n    customer_address ca\nJOIN \n    customer c ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics cd ON cd.cd_demo_sk = c.c_current_cdemo_sk\nJOIN \n    web_sales ws ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    date_dim dd ON dd.d_date_sk = ws.ws_sold_date_sk\nWHERE \n    dd.d_year = 2023 \n    AND ca.ca_state IN ('NY', 'CA')\nGROUP BY \n    ca.ca_city, ca.ca_state, cd.cd_gender, cd.cd_marital_status\nHAVING \n    SUM(ws.ws_net_paid) > 100000\nORDER BY \n    total_sales DESC, \n    customer_count DESC;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    SUM(ss.ss_sales_price) AS total_sales,\n    d.d_year,\n    t.t_hour\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN \n    time_dim t ON ss.ss_sold_time_sk = t.t_time_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, ca.ca_city, d.d_year, t.t_hour\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT\n        d.d_year,\n        d.d_month_seq,\n        d.d_quarter_seq,\n        ca.ca_state,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_net_paid) AS total_revenue,\n        AVG(ws.ws_net_paid) AS average_order_value\n    FROM\n        date_dim d\n    JOIN web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\n    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    GROUP BY\n        d.d_year, d.d_month_seq, d.d_quarter_seq, ca.ca_state\n),\ntop_states AS (\n    SELECT\n        ca_state,\n        SUM(total_revenue) AS state_revenue\n    FROM\n        sales_summary\n    GROUP BY\n        ca_state\n    ORDER BY\n        state_revenue DESC\n    LIMIT 5\n),\nperformance_metrics AS (\n    SELECT\n        ss.d_year,\n        ss.d_month_seq,\n        ss.d_quarter_seq,\n        ss.ca_state,\n        ss.total_quantity_sold,\n        ss.total_revenue,\n        ss.average_order_value,\n        ts.state_revenue\n    FROM\n        sales_summary ss\n    JOIN top_states ts ON ss.ca_state = ts.ca_state\n)\nSELECT\n    d_year,\n    d_month_seq,\n    d_quarter_seq,\n    ca_state,\n    total_quantity_sold,\n    total_revenue,\n    average_order_value,\n    state_revenue,\n    (total_revenue / NULLIF(total_quantity_sold, 0)) AS revenue_per_unit\nFROM\n    performance_metrics\nORDER BY\n    d_year DESC, d_month_seq DESC, total_revenue DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_net_profit) AS total_net_profit,\n    d.d_year,\n    da.ca_country,\n    COUNT(DISTINCT ws.ws_order_number) AS unique_orders\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN \n    customer_address da ON c.c_current_addr_sk = da.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    d.d_year = 2023\n    AND da.ca_country = 'USA'\n    AND c.c_preferred_cust_flag = 'Y'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year, da.ca_country\nHAVING \n    SUM(ss.ss_net_profit) > 1000\nORDER BY \n    total_net_profit DESC\nLIMIT 50;\n",
  "\nWITH sales_data AS (\n    SELECT\n        ws_sold_date_sk,\n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_ext_sales_price) AS total_sales\n    FROM\n        web_sales\n    GROUP BY\n        ws_sold_date_sk,\n        ws_item_sk\n),\ntop_items AS (\n    SELECT\n        item.i_item_sk,\n        item.i_item_id,\n        SUM(sales.total_quantity) AS total_quantity_sold,\n        SUM(sales.total_sales) AS total_sales_made\n    FROM\n        sales_data sales\n    JOIN\n        item item ON sales.ws_item_sk = item.i_item_sk\n    GROUP BY\n        item.i_item_sk, item.i_item_id\n    ORDER BY\n        total_sales_made DESC\n    LIMIT 10\n)\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ti.i_item_id,\n    ti.total_quantity_sold,\n    ti.total_sales_made\nFROM\n    top_items ti\nJOIN\n    web_sales ws ON ti.i_item_sk = ws.ws_item_sk\nJOIN\n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN\n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE\n    ca.ca_state = 'CA'\n    AND ws.ws_sold_date_sk BETWEEN (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2022) \n                                   AND (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023)\nORDER BY\n    ti.total_sales_made DESC;\n",
  "\nWITH SalesSummary AS (\n    SELECT\n        d.d_year,\n        sm.sm_type,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_ext_tax) AS total_tax\n    FROM\n        web_sales ws\n    JOIN\n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    JOIN\n        ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk\n    GROUP BY\n        d.d_year, sm.sm_type\n),\nCustomerDemographics AS (\n    SELECT\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM\n        customer c\n    JOIN\n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY\n        cd.cd_gender, cd.cd_marital_status\n),\nFinalReport AS (\n    SELECT\n        ss.d_year,\n        ss.sm_type,\n        ss.total_quantity,\n        ss.total_sales,\n        ss.total_tax,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.customer_count\n    FROM\n        SalesSummary ss\n    JOIN\n        CustomerDemographics cd ON ss.d_year = (SELECT MAX(d_year) FROM SalesSummary)\n    ORDER BY\n        ss.total_sales DESC\n)\nSELECT\n    * \nFROM \n    FinalReport\nWHERE\n    customer_count > 100\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH Customer_Sales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_order_count,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_order_count,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_order_count\n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY c.c_customer_id\n),\nSales_Analysis AS (\n    SELECT \n        c.c_customer_id,\n        cs.total_web_sales,\n        cs.total_catalog_sales,\n        cs.total_store_sales,\n        COALESCE(cs.total_web_sales, 0) + COALESCE(cs.total_catalog_sales, 0) + COALESCE(cs.total_store_sales, 0) AS total_sales,\n        CASE \n            WHEN COALESCE(cs.total_web_sales, 0) = 0 AND COALESCE(cs.total_catalog_sales, 0) = 0 AND COALESCE(cs.total_store_sales, 0) = 0 THEN 'No Sales'\n            WHEN COALESCE(cs.total_web_sales, 0) > COALESCE(cs.total_catalog_sales, 0) AND COALESCE(cs.total_web_sales, 0) > COALESCE(cs.total_store_sales, 0) THEN 'Web Sales Leading'\n            WHEN COALESCE(cs.total_catalog_sales, 0) > COALESCE(cs.total_web_sales, 0) AND COALESCE(cs.total_catalog_sales, 0) > COALESCE(cs.total_store_sales, 0) THEN 'Catalog Sales Leading'\n            WHEN COALESCE(cs.total_store_sales, 0) > COALESCE(cs.total_web_sales, 0) AND COALESCE(cs.total_store_sales, 0) > COALESCE(cs.total_catalog_sales, 0) THEN 'Store Sales Leading'\n            ELSE 'Mixed Sales'\n        END AS sales_category\n    FROM Customer_Sales cs\n    JOIN customer c ON cs.c_customer_id = c.c_customer_id\n)\nSELECT \n    sales_category,\n    COUNT(*) AS customer_count,\n    SUM(total_sales) AS aggregate_sales\nFROM Sales_Analysis\nGROUP BY sales_category\nORDER BY customer_count DESC, aggregate_sales DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned,\n        SUM(sr_return_amt_inc_tax) AS total_return_value\n    FROM store_returns\n    GROUP BY sr_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        CASE \n            WHEN cd.cd_purchase_estimate < 5000 THEN 'Low'\n            WHEN cd.cd_purchase_estimate BETWEEN 5000 AND 15000 THEN 'Medium'\n            ELSE 'High'\n        END AS purchase_band\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS order_count\n    FROM web_sales\n    GROUP BY ws_bill_customer_sk\n),\nTopCustomers AS (\n    SELECT \n        cs.ws_bill_customer_sk AS c_customer_sk,\n        SUM(cs.total_sales) AS total_sales_value,\n        SUM(cs.order_count) AS total_orders\n    FROM SalesSummary cs\n    JOIN CustomerDemographics cd ON cs.ws_bill_customer_sk = cd.c_customer_sk\n    GROUP BY cs.ws_bill_customer_sk\n    ORDER BY total_sales_value DESC\n    LIMIT 10\n)\nSELECT \n    tc.c_customer_sk,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    tc.total_sales_value,\n    cd.purchase_band,\n    cr.total_returned,\n    cr.total_return_value\nFROM TopCustomers tc\nLEFT JOIN CustomerDemographics cd ON tc.c_customer_sk = cd.c_customer_sk\nLEFT JOIN CustomerReturns cr ON tc.c_customer_sk = cr.sr_customer_sk\nWHERE (cd.cd_marital_status = 'M' OR cd.cd_gender = 'F') \n      AND (cr.total_returned IS NULL OR cr.total_returned > 5)\nORDER BY tc.total_sales_value DESC;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_sales_price) AS avg_sales_price,\n        COUNT(DISTINCT ws.ws_bill_customer_sk) AS unique_customers\n    FROM web_sales ws\n    JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE dd.d_year = 2022\n    GROUP BY ws.ws_item_sk\n),\ntop_sales AS (\n    SELECT \n        sds.ws_item_sk,\n        sds.total_quantity,\n        sds.total_sales,\n        sd.i_product_name\n    FROM sales_data sds\n    JOIN item sd ON sds.ws_item_sk = sd.i_item_sk\n    ORDER BY sds.total_sales DESC\n    LIMIT 10\n)\nSELECT \n    ts.ws_item_sk,\n    ts.total_quantity,\n    ts.total_sales,\n    ts.i_product_name,\n    COALESCE(sr.sr_return_quantity, 0) AS total_returns,\n    (ts.total_sales - COALESCE(sr.sr_return_quantity, 0) * sd.avg_sales_price) AS net_sales\nFROM top_sales ts\nLEFT JOIN (\n    SELECT \n        cr_item_sk,\n        SUM(cr_return_quantity) AS sr_return_quantity\n    FROM catalog_returns\n    GROUP BY cr_item_sk\n) sr ON ts.ws_item_sk = sr.cr_item_sk\nJOIN (\n    SELECT \n        ws.ws_item_sk,\n        AVG(ws.ws_sales_price) AS avg_sales_price\n    FROM web_sales ws\n    GROUP BY ws.ws_item_sk\n) sd ON ts.ws_item_sk = sd.ws_item_sk\nORDER BY ts.total_sales DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_item_sk,\n        ws.ws_quantity,\n        ws.ws_sales_price,\n        ws.ws_ext_sales_price,\n        w.w_warehouse_id,\n        c.c_first_name,\n        c.c_last_name,\n        d.d_date,\n        cd.cd_gender,\n        cd.cd_marital_status\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023 AND\n        cd.cd_gender = 'F' AND\n        ws.ws_sales_price > 50\n)\nSELECT \n    sd.w_warehouse_id,\n    COUNT(DISTINCT sd.ws_item_sk) AS unique_item_count,\n    SUM(sd.ws_quantity) AS total_quantity,\n    AVG(sd.ws_sales_price) AS avg_sales_price,\n    SUM(sd.ws_ext_sales_price) AS total_sales_value,\n    sd.c_first_name,\n    sd.c_last_name,\n    sd.d_date,\n    sd.cd_gender,\n    sd.cd_marital_status\nFROM \n    SalesData sd\nGROUP BY \n    sd.w_warehouse_id,\n    sd.c_first_name,\n    sd.c_last_name,\n    sd.d_date,\n    sd.cd_gender,\n    sd.cd_marital_status\nORDER BY \n    total_sales_value DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_sold_date_sk AS SoldDate,\n        ws.ws_item_sk AS ItemID,\n        ws.ws_quantity AS QuantitySold,\n        ws.ws_net_paid AS TotalRevenue,\n        w.w_warehouse_id AS WarehouseID,\n        c.c_customer_id AS CustomerID,\n        cd.cd_gender AS CustomerGender,\n        cd.cd_marital_status AS MaritalStatus,\n        dd.d_year AS SaleYear,\n        dd.d_month_seq AS SaleMonth,\n        dd.d_week_seq AS SaleWeek\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        customer c ON ws.ws_ship_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n)\n\nSELECT \n    SaleYear,\n    SaleMonth,\n    SaleWeek,\n    WarehouseID,\n    CustomerGender,\n    MaritalStatus,\n    COUNT(DISTINCT CustomerID) AS UniqueCustomers,\n    SUM(QuantitySold) AS TotalQuantitySold,\n    SUM(TotalRevenue) AS TotalRevenueGenerated\nFROM \n    SalesData\nGROUP BY \n    SaleYear, SaleMonth, SaleWeek, WarehouseID, CustomerGender, MaritalStatus\nORDER BY \n    SaleYear, SaleMonth, SaleWeek, WarehouseID;\n",
  "\nWITH customer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_marital_status,\n        cd.cd_gender,\n        cd.cd_purchase_estimate,\n        ca.ca_city,\n        ca.ca_state\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n),\nsales_data AS (\n    SELECT \n        ws.ws_ship_customer_sk,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_ship_customer_sk\n),\njoined_data AS (\n    SELECT \n        ci.c_customer_sk,\n        ci.c_first_name,\n        ci.c_last_name,\n        ci.cd_marital_status,\n        ci.cd_gender,\n        si.total_sales,\n        si.total_net_profit,\n        ci.ca_city,\n        ci.ca_state\n    FROM \n        customer_info ci\n    LEFT JOIN \n        sales_data si ON ci.c_customer_sk = si.ws_ship_customer_sk\n)\nSELECT \n    ca.ca_city,\n    ca.ca_state,\n    COUNT(DISTINCT jd.c_customer_sk) AS customer_count,\n    AVG(jd.total_sales) AS avg_sales_per_customer,\n    SUM(jd.total_net_profit) AS total_profit\nFROM \n    joined_data jd\nJOIN \n    customer_address ca ON jd.ca_city = ca.ca_city AND jd.ca_state = ca.ca_state\nGROUP BY \n    ca.ca_city,\n    ca.ca_state\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nWITH customer_info AS (\n    SELECT\n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        hd.hd_income_band_sk,\n        hd.hd_buy_potential\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n), sales_data AS (\n    SELECT\n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count,\n        SUM(ws.ws_ext_tax) AS total_tax,\n        SUM(ws.ws_ext_discount_amt) AS total_discount\n    FROM web_sales ws\n    GROUP BY ws.ws_bill_customer_sk\n), combined_data AS (\n    SELECT\n        ci.c_customer_sk,\n        ci.c_first_name,\n        ci.c_last_name,\n        ci.cd_gender,\n        ci.cd_marital_status,\n        ci.cd_purchase_estimate,\n        ci.cd_credit_rating,\n        ci.hd_income_band_sk,\n        ci.hd_buy_potential,\n        sd.total_sales,\n        sd.order_count,\n        sd.total_tax,\n        sd.total_discount\n    FROM customer_info ci\n    LEFT JOIN sales_data sd ON ci.c_customer_sk = sd.ws_bill_customer_sk\n)\nSELECT\n    hd.hd_income_band_sk,\n    COUNT(DISTINCT cd.c_customer_sk) AS customer_count,\n    AVG(cd.total_sales) AS avg_sales,\n    SUM(cd.total_tax) AS total_taxes_collected,\n    AVG(cd.order_count) AS avg_orders,\n    SUM(cd.total_discount) AS total_discount_given\nFROM combined_data cd\nJOIN household_demographics hd ON cd.hd_income_band_sk = hd.hd_income_band_sk\nGROUP BY hd.hd_income_band_sk\nORDER BY hd.hd_income_band_sk;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk, \n        SUM(ws.ws_ext_sales_price) AS total_web_sales, \n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales, \n        SUM(ss.ss_ext_sales_price) AS total_store_sales \n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY c.c_customer_sk\n),\nSalesStatistic AS (\n    SELECT \n        cs.c_customer_sk, \n        cs.total_web_sales, \n        cs.total_catalog_sales, \n        cs.total_store_sales,\n        (cs.total_web_sales + cs.total_catalog_sales + cs.total_store_sales) AS total_sales,\n        CASE \n            WHEN (cs.total_web_sales + cs.total_catalog_sales + cs.total_store_sales) > 10000 THEN 'High'\n            WHEN (cs.total_web_sales + cs.total_catalog_sales + cs.total_store_sales) BETWEEN 5000 AND 10000 THEN 'Medium'\n            ELSE 'Low'\n        END AS sales_category\n    FROM CustomerSales cs\n)\nSELECT \n    cd.cd_gender, \n    cd.cd_marital_status, \n    cd.cd_education_status, \n    ss.total_sales, \n    ss.sales_category\nFROM SalesStatistic ss\nJOIN customer_demographics cd ON ss.c_customer_sk = cd.cd_demo_sk\nWHERE cd.cd_marital_status = 'M'\nAND ss.total_sales > 5000\nORDER BY ss.total_sales DESC;\n",
  "\nWITH TotalSales AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS TotalSalesAmount,\n        COUNT(ws_order_number) AS OrderCount,\n        AVG(ws_net_profit) AS AvgProfit\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_bill_customer_sk\n),\nTopCustomers AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        ts.TotalSalesAmount,\n        ts.OrderCount,\n        ts.AvgProfit\n    FROM \n        TotalSales ts\n    JOIN \n        customer c ON ts.ws_bill_customer_sk = c.c_customer_sk\n    WHERE \n        ts.TotalSalesAmount > 1000\n    ORDER BY \n        ts.TotalSalesAmount DESC\n    LIMIT 10\n),\nCustomerDemographics AS (\n    SELECT \n        cu.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        TopCustomers tc\n    JOIN \n        customer cu ON tc.c_customer_id = cu.c_customer_id\n    LEFT JOIN \n        customer_demographics cd ON cu.c_current_cdemo_sk = cd.cd_demo_sk\n)\nSELECT \n    cdem.c_customer_id,\n    cdem.cd_gender,\n    cdem.cd_marital_status,\n    cdem.cd_education_status,\n    tc.TotalSalesAmount,\n    tc.OrderCount,\n    tc.AvgProfit\nFROM \n    CustomerDemographics cdem\nJOIN \n    TopCustomers tc ON cdem.c_customer_id = tc.c_customer_id\nORDER BY \n    tc.TotalSalesAmount DESC;\n",
  "\nWITH CustomerReturnStats AS (\n    SELECT \n        c.c_customer_id,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(COALESCE(sr_return_amt, 0)) AS total_return_value,\n        AVG(sr_return_quantity) AS avg_return_quantity\n    FROM \n        customer c\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nItemSalesStats AS (\n    SELECT \n        i.i_item_id,\n        SUM(ws.ws_quantity) AS total_sold,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales_value,\n        MAX(ws.ws_sales_price) AS max_sales_price\n    FROM \n        item i\n    LEFT JOIN \n        web_sales ws ON i.i_item_sk = ws.ws_item_sk\n    GROUP BY \n        i.i_item_id\n),\nTopReturningCustomers AS (\n    SELECT \n        c.c_first_name,\n        c.c_last_name,\n        cr.total_returns,\n        cr.total_return_value\n    FROM \n        CustomerReturnStats cr\n    JOIN \n        customer c ON cr.c_customer_id = c.c_customer_id\n    WHERE \n        cr.total_returns > (SELECT AVG(total_returns) FROM CustomerReturnStats)\n    ORDER BY \n        cr.total_return_value DESC\n    LIMIT 10\n)\nSELECT \n    tc.c_first_name,\n    tc.c_last_name,\n    ts.total_sold,\n    ts.total_sales_value,\n    ts.max_sales_price\nFROM \n    TopReturningCustomers tc\nJOIN \n    ItemSalesStats ts ON ts.total_sold > 100\nORDER BY \n    tc.total_return_value DESC, ts.total_sales_value DESC;\n",
  "\nWITH CustomerInfo AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_country\n    FROM\n        customer c\n    JOIN\n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n),\nReturnInfo AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amount\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nSalesInfo AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_quantity) AS total_sales,\n        SUM(ws_sales_price) AS total_sales_amount\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nCombinedInfo AS (\n    SELECT \n        ci.c_customer_sk,\n        ci.c_first_name,\n        ci.c_last_name,\n        ci.ca_city,\n        ci.ca_state,\n        ci.ca_country,\n        COALESCE(ri.total_returns, 0) AS total_returns,\n        COALESCE(ri.total_return_amount, 0) AS total_return_amount,\n        COALESCE(si.total_sales, 0) AS total_sales,\n        COALESCE(si.total_sales_amount, 0) AS total_sales_amount\n    FROM \n        CustomerInfo ci\n    LEFT JOIN \n        ReturnInfo ri ON ci.c_customer_sk = ri.sr_customer_sk\n    LEFT JOIN \n        SalesInfo si ON ci.c_customer_sk = si.ws_bill_customer_sk\n)\nSELECT \n    c.*,\n    CASE \n        WHEN total_sales > total_return_amount THEN 'Low Risk'\n        WHEN total_returns > total_sales THEN 'High Risk'\n        ELSE 'Moderate Risk'\n    END AS customer_risk_level\nFROM \n    CombinedInfo c\nWHERE \n    c.ca_state = 'CA' \nORDER BY \n    c.total_sales_amount DESC\nLIMIT 100;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n        LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n        LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n        LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nsales_summary AS (\n    SELECT \n        cs.c_customer_id,\n        COALESCE(cs.total_web_sales, 0) AS web_sales,\n        COALESCE(cs.total_catalog_sales, 0) AS catalog_sales,\n        COALESCE(cs.total_store_sales, 0) AS store_sales\n    FROM \n        customer_sales cs\n)\nSELECT \n    c.c_customer_id AS customer_id,\n    s.web_sales,\n    s.catalog_sales,\n    s.store_sales,\n    (s.web_sales + s.catalog_sales + s.store_sales) AS total_sales\nFROM \n    sales_summary s\nJOIN customer_sales c ON c.c_customer_id = s.c_customer_id\nWHERE \n    (s.web_sales + s.catalog_sales + s.store_sales) > 0\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH customer_engagement AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_quantity) AS total_purchases,\n        SUM(ws.ws_ext_sales_price) AS total_spent,\n        COUNT(DISTINCT ws.ws_order_number) AS unique_orders\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nincome_distribution AS (\n    SELECT \n        h.hd_income_band_sk,\n        COUNT(c.c_customer_sk) AS customer_count,\n        AVG(ce.total_spent) AS avg_spent\n    FROM \n        household_demographics h\n    JOIN \n        customer c ON h.hd_demo_sk = c.c_current_hdemo_sk\n    JOIN \n        customer_engagement ce ON c.c_customer_sk = ce.c_customer_sk\n    GROUP BY \n        h.hd_income_band_sk\n)\nSELECT \n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    id.customer_count,\n    id.avg_spent\nFROM \n    income_band ib\nJOIN \n    income_distribution id ON ib.ib_income_band_sk = id.hd_income_band_sk\nWHERE \n    id.customer_count > 0\nORDER BY \n    ib.ib_lower_bound;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_item_sk,\n        ws.ws_web_site_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_paid) AS total_sales,\n        AVG(ws.ws_sales_price) AS avg_price,\n        MAX(ws.ws_sold_date_sk) AS last_sale_date\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN \n        customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    WHERE \n        dd.d_year = 2023\n        AND ca.ca_state = 'CA'\n    GROUP BY \n        ws.ws_item_sk, ws.ws_web_site_sk\n),\nItemStats AS (\n    SELECT \n        i.i_item_id,\n        i.i_item_desc,\n        sd.total_quantity,\n        sd.total_sales,\n        sd.avg_price,\n        sd.last_sale_date\n    FROM \n        item i\n    JOIN \n        SalesData sd ON i.i_item_sk = sd.ws_item_sk\n    WHERE \n        sd.total_quantity > 100\n)\nSELECT \n    COUNT(*) AS number_of_items,\n    SUM(total_sales) AS total_revenue,\n    AVG(avg_price) AS average_sales_price,\n    MIN(last_sale_date) AS first_sale_date,\n    MAX(last_sale_date) AS last_sale_date\nFROM \n    ItemStats;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_sales_price) AS total_spent,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    d.d_year,\n    d.d_month_seq,\n    ca.ca_city,\n    ca.ca_state,\n    sm.sm_type\nFROM \n    web_sales ws\nJOIN \n    customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk\nWHERE \n    d.d_year = 2023\n    AND ca.ca_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name,\n    d.d_year, d.d_month_seq, ca.ca_city, ca.ca_state, sm.sm_type\nHAVING \n    SUM(ws.ws_quantity) > 10\nORDER BY \n    total_spent DESC\nLIMIT 100;\n",
  "\nWITH CustomerPurchases AS (\n    SELECT\n        c.c_customer_sk,\n        CD.cd_gender,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count\n    FROM\n        customer c\n    JOIN\n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN\n        customer_demographics CD ON c.c_current_cdemo_sk = CD.cd_demo_sk\n    GROUP BY\n        c.c_customer_sk, CD.cd_gender\n),\nHighValueCustomers AS (\n    SELECT\n        cp.c_customer_sk,\n        cp.total_sales,\n        cp.order_count,\n        CASE\n            WHEN cp.total_sales > 1000 THEN 'High Value'\n            ELSE 'Regular'\n        END AS customer_type\n    FROM\n        CustomerPurchases cp\n)\nSELECT\n    c.c_customer_id,\n    hvc.total_sales,\n    hvc.order_count,\n    hvc.customer_type,\n    da.ca_city,\n    da.ca_state\nFROM\n    HighValueCustomers hvc\nJOIN\n    customer c ON hvc.c_customer_sk = c.c_customer_sk\nJOIN\n    customer_address da ON da.ca_address_sk = c.c_current_addr_sk\nWHERE\n    hvc.customer_type = 'High Value'\nORDER BY\n    hvc.total_sales DESC\nLIMIT 10;\n",
  "\nWITH sales_data AS (\n    SELECT\n        c.c_customer_id,\n        COALESCE(SUM(ws.ws_net_paid), 0) AS total_web_sales,\n        COALESCE(SUM(cs.cs_net_paid), 0) AS total_catalog_sales,\n        COALESCE(SUM(ss.ss_net_paid), 0) AS total_store_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_order_count,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_order_count,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_order_count\n    FROM\n        customer c\n    LEFT JOIN\n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN\n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN\n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY\n        c.c_customer_id\n),\nsales_comparison AS (\n    SELECT\n        sd.c_customer_id,\n        sd.total_web_sales,\n        sd.total_catalog_sales,\n        sd.total_store_sales,\n        CASE\n            WHEN sd.total_web_sales > sd.total_catalog_sales AND sd.total_web_sales > sd.total_store_sales THEN 'Web'\n            WHEN sd.total_catalog_sales > sd.total_web_sales AND sd.total_catalog_sales > sd.total_store_sales THEN 'Catalog'\n            ELSE 'Store'\n        END AS preferred_channel\n    FROM\n        sales_data sd\n)\nSELECT\n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    sc.total_web_sales,\n    sc.total_catalog_sales,\n    sc.total_store_sales,\n    sc.preferred_channel\nFROM\n    customer c\nJOIN\n    sales_comparison sc ON c.c_customer_id = sc.c_customer_id\nWHERE\n    sc.total_web_sales > 1000 AND\n    sc.total_catalog_sales = 0\nORDER BY\n    sc.total_web_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerPurchases AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_paid) AS total_spent\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        IB.ib_lower_bound,\n        IB.ib_upper_bound\n    FROM \n        customer_demographics cd\n    JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    JOIN \n        income_band IB ON hd.hd_income_band_sk = IB.ib_income_band_sk\n)\nSELECT \n    d.cd_gender,\n    d.cd_marital_status,\n    COUNT(p.c_customer_sk) AS customer_count,\n    AVG(p.total_spent) AS avg_spent,\n    MAX(p.total_orders) AS max_orders\nFROM \n    CustomerPurchases p\nJOIN \n    Demographics d ON p.c_customer_sk = d.cd_demo_sk\nWHERE \n    p.total_spent > 1000\nGROUP BY \n    d.cd_gender, d.cd_marital_status\nORDER BY \n    customer_count DESC\nLIMIT 10;\n",
  "\nWITH sales_data AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        COUNT(DISTINCT ws.ws_bill_customer_sk) AS unique_customers,\n        AVG(ws.ws_net_paid) AS avg_net_paid\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        w.w_warehouse_id\n), avg_income AS (\n    SELECT \n        cd.cd_credit_rating,\n        AVG(hd.hd_income_band_sk) AS avg_income_band\n    FROM \n        household_demographics hd\n    JOIN \n        customer_demographics cd ON hd.hd_demo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_credit_rating\n)\nSELECT \n    sd.w_warehouse_id,\n    sd.total_sales,\n    sd.total_orders,\n    sd.unique_customers,\n    sd.avg_net_paid,\n    ai.cd_credit_rating,\n    ai.avg_income_band\nFROM \n    sales_data sd\nJOIN \n    avg_income ai ON sd.unique_customers > 100\nORDER BY \n    sd.total_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH CustomerData AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        cd.cd_gender = 'F' \n        AND cd.cd_marital_status = 'M' \n        AND cd.cd_education_status IN ('Bachelors', 'Masters')\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nPopularItems AS (\n    SELECT \n        i.i_item_id,\n        i.i_item_desc,\n        SUM(ws.ws_quantity) AS total_quantity_sold\n    FROM \n        item i\n    JOIN \n        web_sales ws ON i.i_item_sk = ws.ws_item_sk\n    GROUP BY \n        i.i_item_id, i.i_item_desc\n    ORDER BY \n        total_quantity_sold DESC\n    LIMIT 10\n),\nSalesPerformance AS (\n    SELECT \n        cs.c_customer_id,\n        cs.c_first_name,\n        cs.c_last_name,\n        pi.i_item_id,\n        pi.i_item_desc,\n        cs.total_sales,\n        pi.total_quantity_sold\n    FROM \n        CustomerData cs\n    JOIN \n        PopularItems pi ON cs.total_sales > 1000\n)\nSELECT \n    sp.c_customer_id,\n    sp.c_first_name,\n    sp.c_last_name,\n    sp.i_item_id,\n    sp.i_item_desc,\n    sp.total_sales,\n    sp.total_quantity_sold\nFROM \n    SalesPerformance sp\nORDER BY \n    sp.total_sales DESC, sp.total_quantity_sold DESC;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_paid) AS total_sales,\n        AVG(ws.ws_net_paid) AS average_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        cd.cd_gender = 'F' \n        AND dd.d_year = 2022\n    GROUP BY \n        ws.ws_item_sk\n),\nitem_info AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_desc,\n        i.i_current_price\n    FROM \n        item i\n)\nSELECT \n    ii.i_item_desc,\n    si.total_quantity,\n    si.total_sales,\n    si.average_sales,\n    si.total_discount,\n    ii.i_current_price,\n    si.total_sales / NULLIF(si.total_quantity, 0) AS sales_per_unit\nFROM \n    sales_data si\nJOIN \n    item_info ii ON si.ws_item_sk = ii.i_item_sk\nORDER BY \n    si.total_sales DESC\nLIMIT 10;\n",
  "WITH matched_customers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name || ' ' || c.c_last_name AS full_name,\n        ca.ca_city,\n        ca.ca_state,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating,\n        cd.cd_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        ca.ca_city LIKE '%Spring%' AND \n        (cd.cd_gender = 'M' OR cd.cd_marital_status = 'S')\n),\nitem_summary AS (\n    SELECT\n        i.i_item_sk,\n        COUNT(ws.ws_order_number) AS total_sales,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        item i ON ws.ws_item_sk = i.i_item_sk\n    GROUP BY \n        i.i_item_sk\n),\nfinal_report AS (\n    SELECT \n        mc.full_name,\n        mc.ca_city,\n        mc.ca_state,\n        it.i_item_sk,\n        it.total_sales,\n        it.total_net_profit\n    FROM \n        matched_customers mc\n    JOIN \n        item_summary it ON mc.c_customer_sk = it.i_item_sk \n)\nSELECT \n    full_name,\n    ca_city,\n    ca_state,\n    COUNT(DISTINCT i_item_sk) AS unique_items,\n    SUM(total_net_profit) AS total_net_profit,\n    AVG(total_sales) AS avg_sales_per_item\nFROM \n    final_report\nGROUP BY \n    full_name, ca_city, ca_state\nORDER BY \n    total_net_profit DESC;",
  "\nWITH AddressParts AS (\n    SELECT \n        ca_address_sk,\n        ca_street_number || ' ' || ca_street_name || ' ' || ca_street_type AS full_address,\n        ca_city,\n        ca_state,\n        ca_zip,\n        ca_country\n    FROM \n        customer_address\n),\nCustomerInfo AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name || ' ' || c.c_last_name AS full_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        dt.d_date AS birth_date,\n        dt.d_year AS birth_year\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim dt ON c.c_birth_day = dt.d_dom AND c.c_birth_month = dt.d_moy AND c.c_birth_year = dt.d_year\n),\nSalesInfo AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_bill_customer_sk\n),\nFinalReport AS (\n    SELECT \n        ci.full_name,\n        ci.cd_gender,\n        ci.cd_marital_status,\n        ci.cd_education_status,\n        ap.full_address,\n        COALESCE(si.total_sales, 0) AS total_sales,\n        COALESCE(si.total_orders, 0) AS total_orders\n    FROM \n        CustomerInfo ci\n    LEFT JOIN \n        AddressParts ap ON ci.c_customer_sk = ap.ca_address_sk\n    LEFT JOIN \n        SalesInfo si ON ci.c_customer_sk = si.ws_bill_customer_sk\n)\nSELECT \n    full_name,\n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    full_address,\n    total_sales,\n    total_orders\nFROM \n    FinalReport\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH SalesSummary AS (\n    SELECT \n        c.c_customer_id,\n        SUM(CASE WHEN ws.ws_sold_date_sk IS NOT NULL THEN ws.ws_ext_sales_price ELSE 0 END) AS total_web_sales,\n        SUM(CASE WHEN cs.cs_sold_date_sk IS NOT NULL THEN cs.cs_ext_sales_price ELSE 0 END) AS total_catalog_sales,\n        SUM(CASE WHEN ss.ss_sold_date_sk IS NOT NULL THEN ss.ss_ext_sales_price ELSE 0 END) AS total_store_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_web_orders,\n        COUNT(DISTINCT cs.cs_order_number) AS total_catalog_orders,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_store_orders\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    WHERE \n        c.c_current_addr_sk IS NOT NULL\n    GROUP BY \n        c.c_customer_id\n)\nSELECT \n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.total_web_sales) AS total_web_sales_by_city,\n    SUM(ss.total_catalog_sales) AS total_catalog_sales_by_city,\n    SUM(ss.total_store_sales) AS total_store_sales_by_city,\n    SUM(ss.total_web_orders) AS total_web_orders_by_city,\n    SUM(ss.total_catalog_orders) AS total_catalog_orders_by_city,\n    SUM(ss.total_store_orders) AS total_store_orders_by_city\nFROM \n    SalesSummary ss\nJOIN \n    customer_address ca ON ss.c_customer_id = ca.ca_address_id\nGROUP BY \n    ca.ca_city, ca.ca_state\nORDER BY \n    total_web_sales_by_city DESC, total_catalog_sales_by_city DESC, total_store_sales_by_city DESC\nLIMIT 10;\n",
  "\nWITH SalesData AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        AVG(ws.ws_net_paid_inc_tax) AS avg_order_value\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023 \n        AND d.d_month_seq IN (1, 2, 3) \n    GROUP BY \n        w.w_warehouse_id\n),\nCustomerInfo AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n)\nSELECT \n    sd.w_warehouse_id,\n    sd.total_profit,\n    sd.order_count,\n    sd.avg_order_value,\n    ci.cd_gender,\n    ci.customer_count,\n    ci.avg_purchase_estimate\nFROM \n    SalesData sd\nJOIN \n    CustomerInfo ci ON sd.total_profit > 10000\nORDER BY \n    sd.total_profit DESC, \n    ci.customer_count DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH SalesInfo AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN \n        item i ON ws.ws_item_sk = i.i_item_sk\n    WHERE \n        dd.d_year = 2023 AND \n        i.i_category = 'Electronics'\n    GROUP BY \n        ws.ws_sold_date_sk, ws.ws_item_sk\n),\nPromotionInfo AS (\n    SELECT \n        ps.p_item_sk,\n        ps.p_promo_sk,\n        SUM(ps.p_response_target) AS total_responses,\n        COUNT(DISTINCT ps.p_promo_id) AS total_promotions\n    FROM \n        promotion ps\n    JOIN \n        SalesInfo si ON ps.p_item_sk = si.ws_item_sk\n    GROUP BY \n        ps.p_item_sk, ps.p_promo_sk\n)\nSELECT \n    si.ws_item_sk,\n    si.total_quantity,\n    si.total_sales,\n    COALESCE(pi.total_responses, 0) AS total_responses,\n    COALESCE(pi.total_promotions, 0) AS total_promotions\nFROM \n    SalesInfo si\nLEFT JOIN \n    PromotionInfo pi ON si.ws_item_sk = pi.p_item_sk\nORDER BY \n    si.total_sales DESC\nLIMIT 10;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk, \n        SUM(COALESCE(ss.ss_ext_sales_price, 0) + COALESCE(cs.cs_ext_sales_price, 0) + COALESCE(ws.ws_ext_sales_price, 0)) AS total_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_transactions,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_transactions,\n        COUNT(DISTINCT ws.ws_order_number) AS web_transactions\n    FROM customer c\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY c.c_customer_sk\n),\ncustomer_demographics AS (\n    SELECT \n        cd.cd_demo_sk, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_education_status, \n        cd.cd_purchase_estimate\n    FROM customer_demographics cd\n)\nSELECT \n    cs.c_customer_sk, \n    cd.cd_gender,\n    cd.cd_marital_status, \n    cd.cd_education_status, \n    cs.total_sales, \n    cs.store_transactions, \n    cs.catalog_transactions, \n    cs.web_transactions \nFROM customer_sales cs\nJOIN customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\nWHERE cs.total_sales > 1000\nORDER BY cs.total_sales DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        s.s_store_name, \n        SUM(ss.ss_quantity) AS total_quantity_sold, \n        SUM(ss.ss_net_paid) AS total_net_paid,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n        AVG(ss.ss_sales_price) AS avg_sales_price,\n        SUM(ss.ss_ext_discount_amt) AS total_discount\n    FROM \n        store_sales ss\n    JOIN \n        store s ON ss.ss_store_sk = s.s_store_sk\n    JOIN \n        date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        s.s_store_name\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_gender, \n        cd.cd_marital_status, \n        SUM(sd.total_quantity_sold) AS total_quantity_sold,\n        SUM(sd.total_net_paid) AS total_net_paid\n    FROM \n        SalesData sd\n    JOIN \n        customer c ON sd.s_store_name = c.c_customer_id\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    cd.cd_gender, \n    cd.cd_marital_status, \n    SUM(cd.total_quantity_sold) AS overall_quantity_sold, \n    SUM(cd.total_net_paid) AS overall_net_paid,\n    AVG(cd.total_net_paid / NULLIF(cd.total_quantity_sold, 0)) AS avg_order_value\nFROM \n    CustomerDemographics cd\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status\nORDER BY \n    overall_net_paid DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_sales_price) AS total_sales, \n    SUM(ws.ws_ext_discount_amt) AS total_discounts, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    cd.cd_gender, \n    cd.cd_marital_status, \n    cd.cd_education_status,\n    ca.ca_city,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \n    AND d.d_month_seq IN (1, 2, 3) \n    AND cd.cd_gender = 'F'\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    cd.cd_gender, \n    cd.cd_marital_status, \n    cd.cd_education_status, \n    ca.ca_city, \n    d.d_year, \n    d.d_month_seq\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_sales_price) AS avg_order_value\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        cd.cd_gender = 'F' \n        AND cd.cd_marital_status = 'M'\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nHighValueCustomers AS (\n    SELECT \n        cs.c_customer_id,\n        cs.total_net_profit,\n        cs.total_orders,\n        cs.avg_order_value\n    FROM \n        CustomerStats cs\n    WHERE \n        cs.total_net_profit > 1000\n),\nTopItems AS (\n    SELECT \n        i.i_item_id,\n        SUM(ws.ws_quantity) AS total_quantity_sold\n    FROM \n        web_sales ws\n    JOIN \n        item i ON ws.ws_item_sk = i.i_item_sk\n    GROUP BY \n        i.i_item_id\n    ORDER BY \n        total_quantity_sold DESC\n    FETCH FIRST 5 ROWS ONLY\n)\nSELECT \n    hvc.c_customer_id,\n    hvc.total_net_profit,\n    hvc.total_orders,\n    hvc.avg_order_value,\n    ti.i_item_id,\n    ti.total_quantity_sold\nFROM \n    HighValueCustomers hvc\nJOIN \n    TopItems ti ON ti.total_quantity_sold > 50\nORDER BY \n    hvc.total_net_profit DESC;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        AVG(ws.ws_net_profit) AS avg_net_profit\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_sk\n), demographic_info AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_state,\n        cd.cd_purchase_estimate\n    FROM \n        customer_demographics cd\n    JOIN \n        customer_address ca ON cd.cd_demo_sk = ca.ca_address_sk\n)\n\nSELECT \n    ci.c_customer_sk,\n    di.cd_gender,\n    di.cd_marital_status,\n    di.cd_education_status,\n    ci.total_sales,\n    ci.order_count,\n    ci.avg_net_profit,\n    di.ca_state\nFROM \n    customer_sales ci\nJOIN \n    demographic_info di ON ci.c_customer_sk = di.cd_demo_sk\nWHERE \n    ci.total_sales > (SELECT AVG(total_sales) FROM customer_sales)\nORDER BY \n    ci.total_sales DESC\nLIMIT 10;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        MAX(d.d_date) AS last_purchase_date\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\ntop_customers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cs.total_sales,\n        cs.order_count,\n        cs.last_purchase_date\n    FROM \n        customer_sales cs\n    JOIN \n        customer c ON cs.c_customer_sk = c.c_customer_sk\n    WHERE \n        cs.total_sales > 1000 \n    ORDER BY \n        cs.total_sales DESC\n    LIMIT 10\n)\nSELECT \n    t.c_first_name,\n    t.c_last_name,\n    t.total_sales,\n    t.order_count,\n    t.last_purchase_date,\n    ca.ca_city,\n    ca.ca_state,\n    ca.ca_country\nFROM \n    top_customers t\nJOIN \n    customer_address ca ON t.c_customer_sk = ca.ca_address_sk\nORDER BY \n    t.total_sales DESC;\n",
  "\nWITH CustomerSalesData AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        MAX(ws.ws_sold_date_sk) AS last_purchase_date\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        ws.ws_sold_date_sk >= (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023)\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nTopCustomers AS (\n    SELECT \n        c.*, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_credit_rating \n    FROM \n        CustomerSalesData c\n    JOIN \n        customer_demographics cd ON c.c_customer_sk = cd.cd_demo_sk\n    WHERE \n        c.total_sales > (SELECT AVG(total_sales) FROM CustomerSalesData)\n    ORDER BY \n        c.total_sales DESC\n    LIMIT 10\n),\nWarehouseSales AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_ext_sales_price) AS warehouse_sales\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n),\nFinalReport AS (\n    SELECT \n        tc.c_first_name,\n        tc.c_last_name,\n        tc.cd_gender,\n        tc.cd_marital_status,\n        tc.cd_credit_rating,\n        ws.warehouse_sales\n    FROM \n        TopCustomers tc\n    LEFT JOIN \n        WarehouseSales ws ON ws.warehouse_sales > 0\n)\nSELECT \n    *\nFROM \n    FinalReport\nWHERE \n    warehouse_sales IS NOT NULL\nORDER BY \n    warehouse_sales DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        c.c_customer_id,\n        d.d_year,\n        SUM(ws.ws_net_paid) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_sales_price) AS avg_sales_price\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_id, d.d_year\n), customer_demographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ss.total_sales) AS total_sales_by_demo\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        sales_summary ss ON c.c_customer_id = ss.c_customer_id\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    cd_gender,\n    cd_marital_status,\n    COUNT(cd_demo_sk) AS num_customers,\n    SUM(total_sales_by_demo) AS total_sales\nFROM \n    customer_demographics\nGROUP BY \n    cd_gender, cd_marital_status\nORDER BY \n    total_sales DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT\n        c.c_birth_month,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws_order_number) AS order_count\n    FROM\n        web_sales\n    JOIN customer c ON c.c_customer_sk = ws_bill_customer_sk\n    JOIN date_dim d ON d.d_date_sk = ws_sold_date_sk\n    WHERE\n        d.d_year = 2023\n    GROUP BY\n        c.c_birth_month\n),\ndemographics_summary AS (\n    SELECT\n        cd_education_status,\n        COUNT(distinct c.c_customer_sk) AS customer_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM\n        customer_demographics cd\n    JOIN customer c ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY\n        cd_education_status\n)\nSELECT\n    s.c_birth_month,\n    s.total_sales,\n    s.total_profit,\n    s.order_count,\n    d.cd_education_status,\n    d.customer_count,\n    d.avg_purchase_estimate\nFROM\n    sales_summary s\nJOIN demographics_summary d ON s.c_birth_month = d.customer_count\nORDER BY\n    s.total_sales DESC,\n    d.customer_count DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    ca.ca_city,\n    ca.ca_state,\n    d.d_year\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n    AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_gender, \n    cd.cd_marital_status, cd.cd_education_status, ca.ca_city, ca.ca_state, d.d_year\nHAVING \n    SUM(ws.ws_ext_sales_price) > 1000\nORDER BY \n    total_sales DESC\nLIMIT 50;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_profit) AS total_profit,\n        COUNT(ws_order_number) AS total_orders,\n        COUNT(DISTINCT ws_item_sk) AS unique_items_sold\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2022)\n        AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_bill_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        customer.c_customer_sk,\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_dep_count,\n        cd_credit_rating,\n        income_band.ib_lower_bound,\n        income_band.ib_upper_bound\n    FROM \n        customer\n    JOIN \n        customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\n    LEFT JOIN \n        household_demographics ON household_demographics.hd_demo_sk = customer.c_current_hdemo_sk\n    LEFT JOIN \n        income_band ON household_demographics.hd_income_band_sk = income_band.ib_income_band_sk\n),\nAggregatedData AS (\n    SELECT \n        cd.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_dep_count,\n        cd.cd_credit_rating,\n        cd.ib_lower_bound,\n        cd.ib_upper_bound,\n        sd.total_profit,\n        sd.total_orders,\n        sd.unique_items_sold\n    FROM \n        CustomerDemographics cd\n    JOIN \n        SalesData sd ON cd.c_customer_sk = sd.ws_bill_customer_sk\n)\nSELECT \n    cd_gender,\n    cd_marital_status,\n    COUNT(*) AS customer_count,\n    AVG(total_profit) AS avg_profit,\n    SUM(total_orders) AS total_orders,\n    AVG(unique_items_sold) AS avg_unique_items_sold\nFROM \n    AggregatedData\nGROUP BY \n    cd_gender, \n    cd_marital_status\nORDER BY \n    cd_gender, \n    cd_marital_status;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        w.w_warehouse_id,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders,\n        COUNT(DISTINCT ws.ws_bill_customer_sk) AS unique_customers\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023 \n        AND ws.ws_sales_price > 100\n    GROUP BY \n        w.w_warehouse_id, c.c_first_name, c.c_last_name\n),\nhigh_value_customers AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        s.total_sales,\n        s.total_orders,\n        s.unique_customers\n    FROM \n        customer c\n    JOIN \n        sales_summary s ON c.c_first_name = s.c_first_name AND c.c_last_name = s.c_last_name\n    WHERE \n        s.total_sales > 10000\n)\nSELECT \n    hvc.c_customer_id,\n    hvc.c_first_name,\n    hvc.c_last_name,\n    hvc.total_sales,\n    hvc.total_orders,\n    CASE \n        WHEN hvc.unique_customers > 10 THEN 'Loyal Customer'\n        ELSE 'New Customer'\n    END AS customer_status\nFROM \n    high_value_customers hvc\nORDER BY \n    hvc.total_sales DESC\nLIMIT 50;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        AVG(ws.ws_net_paid) AS avg_net_paid,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nHighSpendingCustomers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.total_sales,\n        cs.avg_net_paid,\n        cs.order_count\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    WHERE \n        cs.total_sales > 1000 AND cd.cd_gender = 'F'\n)\nSELECT \n    hsc.c_first_name,\n    hsc.c_last_name,\n    hsc.total_sales,\n    hsc.avg_net_paid,\n    hsc.order_count,\n    COALESCE(i.i_item_desc, 'No Item Info') AS sample_item\nFROM \n    HighSpendingCustomers hsc\nLEFT JOIN \n    item i ON hsc.c_customer_sk = i.i_item_sk\nORDER BY \n    hsc.total_sales DESC\nLIMIT 10;\n",
  "\nWITH SalesData AS (\n    SELECT \n        s.s_store_name,\n        SUM(ss.ss_sales_price) AS total_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count,\n        AVG(ss.ss_net_profit) AS avg_net_profit\n    FROM \n        store_sales ss\n    JOIN \n        store s ON ss.ss_store_sk = s.s_store_sk\n    JOIN \n        date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        s.s_store_name\n), CustomerData AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        AVG(c.c_birth_year) AS avg_birth_year\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n)\n\nSELECT \n    sd.s_store_name,\n    sd.total_sales,\n    sd.transaction_count,\n    sd.avg_net_profit,\n    cd.cd_gender,\n    cd.customer_count,\n    cd.avg_birth_year\nFROM \n    SalesData sd\nLEFT JOIN \n    CustomerData cd ON sd.total_sales > 10000\nORDER BY \n    sd.total_sales DESC, cd.customer_count DESC;\n",
  "\nWITH customer_data AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        hd.hd_income_band_sk,\n        COALESCE(hd.hd_dep_count, 0) AS dep_count\n    FROM customer c\n    LEFT JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n),\nsales_data AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_paid_inc_tax) AS total_sales\n    FROM web_sales ws\n    GROUP BY ws.ws_sold_date_sk, ws.ws_item_sk\n),\nitem_details AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_desc,\n        i.i_current_price\n    FROM item i\n    WHERE i.i_rec_start_date <= (SELECT MAX(d.d_date) FROM date_dim d)\n      AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > (SELECT MAX(d.d_date) FROM date_dim d))\n)\nSELECT \n    cd.c_customer_sk,\n    cd.c_first_name,\n    cd.c_last_name,\n    cd.cd_gender,\n    SUM(sd.total_quantity) AS total_quantity,\n    SUM(sd.total_sales) AS total_sales,\n    COUNT(DISTINCT sd.ws_item_sk) AS item_count,\n    CASE \n        WHEN cd.dep_count > 3 THEN 'Large Family'\n        WHEN cd.dep_count BETWEEN 1 AND 3 THEN 'Small Family'\n        ELSE 'Single'\n    END AS family_size,\n    MAX(i.i_current_price) AS max_item_price,\n    MIN(i.i_current_price) AS min_item_price\nFROM customer_data cd\nLEFT JOIN sales_data sd ON cd.c_customer_sk = sd.ws_sold_date_sk\nLEFT JOIN item_details i ON sd.ws_item_sk = i.i_item_sk\nGROUP BY \n    cd.c_customer_sk, cd.c_first_name, cd.c_last_name, cd.cd_gender, cd.dep_count\nHAVING \n    SUM(sd.total_sales) > 0\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH customer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        c.c_email_address,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_country\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n),\nsales_data AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM web_sales ws\n    GROUP BY ws.ws_bill_customer_sk\n),\nbenchmarking AS (\n    SELECT \n        ci.c_customer_sk,\n        ci.c_first_name,\n        ci.c_last_name,\n        ci.c_email_address,\n        ci.cd_gender,\n        si.total_sales,\n        si.order_count,\n        CASE \n            WHEN si.total_sales IS NULL THEN 'No Sales'\n            WHEN si.total_sales < 100 THEN 'Low Spender'\n            WHEN si.total_sales BETWEEN 100 AND 500 THEN 'Medium Spender'\n            ELSE 'High Spender'\n        END AS spending_category\n    FROM customer_info ci\n    LEFT JOIN sales_data si ON ci.c_customer_sk = si.ws_bill_customer_sk\n)\nSELECT \n    c.c_first_name || ' ' || c.c_last_name AS full_name,\n    c.c_email_address,\n    c.cd_gender,\n    b.total_sales,\n    b.order_count,\n    b.spending_category,\n    c.ca_city,\n    c.ca_state,\n    c.ca_country\nFROM benchmarking b\nJOIN customer_info c ON b.c_customer_sk = c.c_customer_sk\nORDER BY b.total_sales DESC NULLS LAST, c.c_last_name, c.c_first_name\nLIMIT 100;\n",
  "\nWITH AddressCounts AS (\n    SELECT \n        ca_city,\n        ca_state,\n        COUNT(*) AS address_count\n    FROM \n        customer_address\n    GROUP BY \n        ca_city, ca_state\n),\nCustomerCounts AS (\n    SELECT \n        cd_gender,\n        COUNT(c_customer_sk) AS customer_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_gender\n),\nDailySales AS (\n    SELECT \n        d.d_date,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_date\n)\nSELECT \n    ac.ca_city,\n    ac.ca_state,\n    ac.address_count,\n    cc.cd_gender,\n    cc.customer_count,\n    ds.d_date,\n    ds.total_sales\nFROM \n    AddressCounts ac\nJOIN \n    CustomerCounts cc ON ac.ca_state = (CASE WHEN cc.cd_gender = 'F' THEN 'CA' ELSE 'NY' END)\nJOIN \n    DailySales ds ON ds.total_sales > 1000\nORDER BY \n    ac.address_count DESC, \n    cc.customer_count DESC, \n    ds.total_sales DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_net_paid_inc_tax) AS total_sales,\n        AVG(ws.ws_net_profit) AS average_profit,\n        MAX(ws.ws_sales_price) AS max_price,\n        MIN(ws.ws_sales_price) AS min_price\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        dd.d_year = 2023 AND\n        cd.cd_gender = 'F'\n    GROUP BY \n        ws.ws_item_sk\n),\nitem_details AS (\n    SELECT \n        i.i_item_id,\n        i.i_item_desc,\n        i.i_brand,\n        i.i_category,\n        ss.total_quantity_sold,\n        ss.total_sales,\n        ss.average_profit,\n        ss.max_price,\n        ss.min_price\n    FROM \n        sales_summary ss\n    JOIN \n        item i ON ss.ws_item_sk = i.i_item_sk\n)\nSELECT \n    id.i_item_id,\n    id.i_item_desc,\n    id.i_brand,\n    id.i_category,\n    id.total_quantity_sold,\n    id.total_sales,\n    id.average_profit,\n    id.max_price,\n    id.min_price\nFROM \n    item_details id\nORDER BY \n    id.total_sales DESC\nLIMIT 10;\n",
  "\nWITH CustomerPurchase AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_net_paid) AS total_spent,\n        COUNT(ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_paid) AS avg_order_value\n    FROM customer c\n    JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY c.c_customer_sk\n),\nHighValueCustomers AS (\n    SELECT \n        cp.c_customer_sk,\n        cp.total_spent,\n        cp.total_orders,\n        cp.avg_order_value,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM CustomerPurchase cp\n    JOIN customer_demographics cd ON cp.c_customer_sk = cd.cd_demo_sk\n    WHERE cp.total_spent > 1000\n),\nTopProducts AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_desc,\n        SUM(ws.ws_quantity) AS total_sold,\n        SUM(ws.ws_net_paid) AS total_revenue\n    FROM web_sales ws\n    JOIN item i ON ws.ws_item_sk = i.i_item_sk\n    GROUP BY i.i_item_sk, i.i_item_desc\n    ORDER BY total_revenue DESC\n    LIMIT 10\n)\nSELECT \n    hvc.c_customer_sk,\n    hvc.total_spent,\n    hvc.total_orders,\n    hvc.avg_order_value,\n    hvc.cd_gender,\n    hvc.cd_marital_status,\n    hvc.cd_education_status,\n    tp.i_item_sk,\n    tp.i_item_desc,\n    tp.total_sold,\n    tp.total_revenue\nFROM HighValueCustomers hvc\nCROSS JOIN TopProducts tp\nORDER BY hvc.total_spent DESC, tp.total_revenue DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS number_of_orders,\n        AVG(ws.ws_sales_price) AS average_order_value,\n        COUNT(DISTINCT ws.ws_item_sk) AS unique_items_sold\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n        AND c.c_current_cdemo_sk IS NOT NULL\n    GROUP BY \n        c.c_customer_id\n),\nCustomerDemographics AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating,\n        cd.cd_dep_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n)\nSELECT \n    sd.c_customer_id,\n    sd.total_sales,\n    sd.number_of_orders,\n    sd.average_order_value,\n    sd.unique_items_sold,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_credit_rating,\n    cd.cd_dep_count\nFROM \n    SalesData sd\nJOIN \n    CustomerDemographics cd ON sd.c_customer_id = cd.c_customer_id\nWHERE \n    sd.total_sales > 1000 \nORDER BY \n    sd.total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_profit) AS avg_net_profit\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_sk\n),\ndemographics_summary AS (\n    SELECT \n        cd.cd_demo_sk,\n        COUNT(c.c_customer_sk) AS customer_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n        AVG(cd.cd_dep_count) AS avg_dep_count\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_demo_sk\n)\nSELECT \n    ss.c_customer_sk,\n    ss.total_sales,\n    ss.total_orders,\n    ss.avg_net_profit,\n    ds.customer_count,\n    ds.avg_purchase_estimate,\n    ds.avg_dep_count\nFROM \n    sales_summary ss\nJOIN \n    demographics_summary ds ON ss.c_customer_sk = ds.customer_count\nWHERE \n    ss.total_sales > (SELECT AVG(total_sales) FROM sales_summary)\nORDER BY \n    ss.total_sales DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_paid_inc_tax) AS total_spent,\n        COUNT(ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_paid_inc_tax) AS average_order_value,\n        COUNT(DISTINCT ws.ws_web_site_sk) AS purchase_channels\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name\n),\nhigh_value_customers AS (\n    SELECT \n        s.c_customer_sk,\n        s.c_first_name,\n        s.c_last_name,\n        s.total_spent,\n        s.total_orders,\n        s.average_order_value,\n        s.purchase_channels\n    FROM \n        sales_summary s\n    WHERE \n        s.total_spent > (SELECT AVG(total_spent) FROM sales_summary)\n),\ncustomer_address_details AS (\n    SELECT \n        c.c_customer_sk,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_country\n    FROM \n        customer c\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n)\nSELECT \n    hvc.c_customer_sk,\n    hvc.c_first_name,\n    hvc.c_last_name,\n    hvc.total_spent,\n    hvc.total_orders,\n    hvc.average_order_value,\n    hvc.purchase_channels,\n    cad.ca_city,\n    cad.ca_state,\n    cad.ca_country\nFROM \n    high_value_customers hvc\nJOIN \n    customer_address_details cad ON hvc.c_customer_sk = cad.c_customer_sk\nORDER BY \n    hvc.total_spent DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n    HAVING \n        SUM(ws.ws_net_profit) > 1000\n),\nWarehouseSales AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_net_profit) AS total_net_profit_warehouse,\n        COUNT(ws.ws_order_number) AS total_orders_warehouse\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    cs.c_customer_id,\n    cs.total_net_profit,\n    cs.total_orders,\n    w.total_net_profit_warehouse,\n    w.total_orders_warehouse,\n    (cs.total_net_profit + COALESCE(w.total_net_profit_warehouse, 0)) AS combined_profit\nFROM \n    CustomerSales cs\nLEFT JOIN \n    WarehouseSales w ON cs.total_orders > 5\nORDER BY \n    combined_profit DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2022\n    GROUP BY \n        ws.ws_sold_date_sk\n),\nCustomerData AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n        AVG(cd.cd_dep_count) AS avg_dependents\n    FROM \n        customer c \n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n)\nSELECT \n    d.d_date AS sales_date,\n    s.total_quantity,\n    s.total_sales,\n    s.total_orders,\n    c.customer_count,\n    c.avg_purchase_estimate,\n    c.avg_dependents\nFROM \n    SalesData s\nJOIN \n    date_dim d ON s.ws_sold_date_sk = d.d_date_sk\nJOIN \n    CustomerData c ON c.customer_count > 0\nORDER BY \n    d.d_date;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        CASE \n            WHEN cd.cd_gender = 'M' THEN 'Male'\n            WHEN cd.cd_gender = 'F' THEN 'Female'\n            ELSE 'Other'\n        END AS gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating\n    FROM \n        customer_demographics cd\n),\nSalesSummary AS (\n    SELECT \n        cs.c_customer_sk,\n        cd.gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cs.total_web_sales,\n        cs.total_catalog_sales,\n        cs.total_store_sales,\n        (cs.total_web_sales + cs.total_catalog_sales + cs.total_store_sales) AS total_sales\n    FROM \n        CustomerSales cs\n    JOIN \n        CustomerDemographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n)\nSELECT \n    gender,\n    cd_marital_status,\n    cd_education_status,\n    COUNT(*) AS customer_count,\n    SUM(total_sales) AS total_sales_value,\n    AVG(total_sales) AS avg_sales_value\nFROM \n    SalesSummary\nGROUP BY \n    gender, cd_marital_status, cd_education_status\nORDER BY \n    total_sales_value DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT\n        w.w_warehouse_id,\n        SUM(COALESCE(ws.ws_quantity, 0)) AS total_quantity_sold,\n        SUM(COALESCE(ws.ws_ext_sales_price, 0)) AS total_sales_amount,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(COALESCE(ws.ws_net_profit, 0)) AS average_profit\n    FROM\n        warehouse w\n    LEFT JOIN web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    LEFT JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE\n        d.d_year = 2023\n    GROUP BY\n        w.w_warehouse_id\n),\ndemographic_summary AS (\n    SELECT\n        cd.cd_marital_status,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM\n        customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY\n        cd.cd_marital_status\n)\nSELECT\n    ss.w_warehouse_id,\n    ss.total_quantity_sold,\n    ss.total_sales_amount,\n    ss.total_orders,\n    ss.average_profit,\n    ds.cd_marital_status,\n    ds.customer_count,\n    ds.avg_purchase_estimate\nFROM\n    sales_summary ss\nJOIN demographic_summary ds ON ss.total_orders > 10\nORDER BY \n    ss.total_sales_amount DESC, \n    ds.customer_count DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        w.w_warehouse_name,\n        d.d_year,\n        d.d_month_seq,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_sales_price) AS total_sales_amount,\n        AVG(ws.ws_net_profit) AS average_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        w.w_warehouse_name, d.d_year, d.d_month_seq\n), CustomerDemographics AS (\n    SELECT \n        cd.cd_gender,\n        SUM(sd.total_quantity_sold) AS total_quantity,\n        SUM(sd.total_sales_amount) AS total_sales,\n        AVG(sd.average_net_profit) AS avg_profit\n    FROM \n        SalesData sd\n    JOIN \n        customer c ON sd.total_quantity_sold = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n)\nSELECT \n    cd.cd_gender,\n    cd.total_quantity,\n    cd.total_sales,\n    cd.avg_profit,\n    CASE \n        WHEN cd.total_sales > 100000 THEN 'High Performer'\n        WHEN cd.total_sales BETWEEN 50000 AND 100000 THEN 'Medium Performer'\n        ELSE 'Low Performer'\n    END AS performance_category\nFROM \n    CustomerDemographics cd\nORDER BY \n    cd.total_sales DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws_order_number) AS order_count\n    FROM \n        web_sales \n    WHERE \n        ws_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023 AND d_moy IN (6, 7))\n    GROUP BY \n        ws_bill_customer_sk\n),\ndemographics AS (\n    SELECT \n        cd_demo_sk,\n        cd_gender,\n        ib_income_band_sk\n    FROM \n        customer_demographics\n    JOIN \n        household_demographics ON hd_demo_sk = cd_demo_sk\n    LEFT JOIN \n        income_band ON ib_income_band_sk = hd_income_band_sk\n),\ncustomer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        d.cd_gender,\n        d.ib_income_band_sk,\n        s.total_sales,\n        s.total_profit,\n        s.order_count\n    FROM \n        customer c\n    JOIN \n        sales_summary s ON c.c_customer_sk = s.ws_bill_customer_sk\n    JOIN \n        demographics d ON c.c_current_cdemo_sk = d.cd_demo_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.cd_gender,\n    cs.ib_income_band_sk,\n    cs.total_sales,\n    cs.total_profit,\n    CASE \n        WHEN cs.total_sales > 1000 THEN 'High'\n        WHEN cs.total_sales BETWEEN 500 AND 1000 THEN 'Medium'\n        ELSE 'Low'\n    END AS sales_category\nFROM \n    customer_sales cs\nORDER BY \n    cs.total_profit DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ss.ss_sales_price) AS total_store_sales,\n        SUM(ws.ws_sales_price) AS total_web_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_store_transactions,\n        COUNT(DISTINCT ws.ws_order_number) AS total_web_transactions\n    FROM \n        customer c \n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate\n    FROM \n        customer_demographics cd\n    INNER JOIN customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n),\nSalesSummary AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.total_store_sales,\n        cs.total_web_sales,\n        cs.total_store_transactions,\n        cs.total_web_transactions,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate\n    FROM \n        CustomerSales cs\n    JOIN \n        CustomerDemographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n),\nFinalSummary AS (\n    SELECT \n        *,\n        CASE \n            WHEN total_store_sales > total_web_sales THEN 'Store Dominant' \n            WHEN total_web_sales > total_store_sales THEN 'Web Dominant'\n            ELSE 'Equal Sales'\n        END AS Sales_Dominance\n    FROM \n        SalesSummary\n)\nSELECT \n    Sales_Dominance,\n    COUNT(*) AS Customer_Count,\n    AVG(total_store_sales) AS Avg_Store_Sales,\n    AVG(total_web_sales) AS Avg_Web_Sales,\n    AVG(cd_purchase_estimate) AS Avg_Purchase_Estimate\nFROM \n    FinalSummary\nGROUP BY \n    Sales_Dominance\nORDER BY \n    Customer_Count DESC;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk, \n        SUM(ws.ws_net_paid) AS total_sales_amount,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        COUNT(DISTINCT ws.ws_item_sk) AS unique_item_count\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_sk\n), \ndemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        MAX(cd.cd_purchase_estimate) AS max_purchase_estimate,\n        MIN(cd.cd_purchase_estimate) AS min_purchase_estimate,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    GROUP BY \n        cd.cd_demo_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.total_sales_amount,\n    cs.order_count,\n    cs.unique_item_count,\n    d.max_purchase_estimate,\n    d.min_purchase_estimate,\n    d.avg_purchase_estimate\nFROM \n    customer_sales cs\nJOIN \n    demographics d ON cs.c_customer_sk = d.cd_demo_sk\nORDER BY \n    cs.total_sales_amount DESC\nLIMIT 10;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_order_number,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        MAX(ws.ws_ship_date_sk) AS last_ship_date,\n        COUNT(DISTINCT ws.ws_bill_customer_sk) AS unique_customers\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        store s ON ws.ws_ship_addr_sk = s.s_store_sk\n    WHERE \n        dd.d_year = 2023 \n        AND cd.cd_marital_status = 'M' \n        AND cd.cd_credit_rating = 'Great'\n    GROUP BY \n        ws.ws_order_number\n),\nAverageSales AS (\n    SELECT \n        AVG(total_sales) AS avg_sales,\n        AVG(total_quantity) AS avg_quantity,\n        AVG(total_discount) AS avg_discount,\n        MAX(last_ship_date) AS latest_ship_date,\n        SUM(unique_customers) AS total_unique_customers\n    FROM \n        SalesData\n)\nSELECT \n    avg_sales,\n    avg_quantity,\n    avg_discount,\n    latest_ship_date,\n    total_unique_customers\nFROM \n    AverageSales;\n",
  "WITH SalesData AS (\n    SELECT \n        ws.ws_item_sk AS item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        web_sales AS ws\n    JOIN \n        date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2000\n        AND dd.d_moy IN (3, 4, 5)  \n    GROUP BY \n        ws.ws_item_sk\n),\nInventoryData AS (\n    SELECT \n        inv.inv_item_sk AS item_sk,\n        SUM(inv.inv_quantity_on_hand) AS quantity_on_hand\n    FROM \n        inventory AS inv\n    INNER JOIN \n        warehouse AS w ON inv.inv_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        inv.inv_item_sk\n),\nReturnsData AS (\n    SELECT \n        wr.wr_item_sk AS item_sk,\n        SUM(wr.wr_return_quantity) AS total_returns,\n        SUM(wr.wr_return_amt) AS total_return_amount\n    FROM \n        web_returns AS wr\n    GROUP BY \n        wr.wr_item_sk\n)\nSELECT \n    id.item_sk,\n    sd.total_quantity,\n    sd.total_sales,\n    COALESCE(rd.total_returns, 0) AS total_returns,\n    COALESCE(rd.total_return_amount, 0) AS total_return_amount,\n    id.quantity_on_hand,\n    sd.order_count,\n    CASE \n        WHEN sd.total_sales > 0 THEN (sd.total_sales - sd.total_discount) / sd.total_sales\n        ELSE NULL \n    END AS sales_margin\nFROM \n    SalesData AS sd\nLEFT JOIN \n    InventoryData AS id ON sd.item_sk = id.item_sk\nLEFT JOIN \n    ReturnsData AS rd ON sd.item_sk = rd.item_sk\nORDER BY \n    sd.total_sales DESC\nLIMIT 10;",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS return_count,\n        SUM(sr_return_amt) AS total_return_amount,\n        SUM(sr_return_tax) AS total_return_tax,\n        SUM(sr_return_quantity) AS total_return_quantity\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nSalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_paid_inc_tax) AS total_sales,\n        COUNT(ws_order_number) AS order_count,\n        AVG(ws_net_paid_inc_tax) AS avg_order_value\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n)\nSELECT \n    c.c_customer_sk,\n    COALESCE(cd.cd_gender, 'UNKNOWN') AS gender,\n    COALESCE(cd.cd_marital_status, 'UNKNOWN') AS marital_status,\n    COALESCE(sd.total_sales, 0) AS total_sales,\n    COALESCE(cr.return_count, 0) AS return_count,\n    COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n    CASE \n        WHEN cr.return_count > 0 THEN 'Frequent Returner'\n        ELSE 'General Customer'\n    END AS customer_type\nFROM \n    customer c\nLEFT JOIN \n    CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\nLEFT JOIN \n    SalesData sd ON c.c_customer_sk = sd.ws_bill_customer_sk\nLEFT JOIN \n    CustomerDemographics cd ON c.c_customer_sk = cd.c_customer_sk\nWHERE \n    (sd.total_sales IS NOT NULL AND sd.total_sales > 1000) OR \n    (cr.return_count IS NOT NULL AND cr.return_count > 1)\nORDER BY \n    total_sales DESC, \n    return_count ASC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_item_sk,\n        ws.ws_order_number,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_paid) AS total_net_paid,\n        COUNT(DISTINCT ws.ws_bill_customer_sk) AS customer_count\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        ws.ws_item_sk, ws.ws_order_number\n),\nReturnData AS (\n    SELECT \n        wr.wr_item_sk,\n        SUM(wr.wr_return_quantity) AS total_returned_quantity,\n        SUM(wr.wr_return_amt_inc_tax) AS total_returned_amt\n    FROM \n        web_returns wr\n    JOIN \n        date_dim dd ON wr.wr_returned_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        wr.wr_item_sk\n)\nSELECT \n    i.i_item_id,\n    COALESCE(sd.total_quantity, 0) AS total_quantity_sold,\n    COALESCE(sd.total_net_paid, 0) AS total_net_sales,\n    COALESCE(rd.total_returned_quantity, 0) AS total_returned_quantity,\n    COALESCE(rd.total_returned_amt, 0) AS total_returned_amt,\n    (COALESCE(sd.total_net_paid, 0) - COALESCE(rd.total_returned_amt, 0)) AS net_profit_after_returns,\n    (COALESCE(sd.total_quantity, 0) - COALESCE(rd.total_returned_quantity, 0)) AS net_units_sold\nFROM \n    item i\nLEFT JOIN \n    SalesData sd ON i.i_item_sk = sd.ws_item_sk\nLEFT JOIN \n    ReturnData rd ON i.i_item_sk = rd.wr_item_sk\nWHERE \n    i.i_current_price IS NOT NULL\nORDER BY \n    net_profit_after_returns DESC\nLIMIT 10;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(COALESCE(ws.ws_net_paid, 0) + COALESCE(ss.ss_net_paid, 0) + COALESCE(cs.cs_net_paid, 0)) AS total_spent,\n        COUNT(DISTINCT ws.ws_order_number) AS online_orders,\n        COUNT(DISTINCT ss.ss_ticket_number) AS in_store_orders\n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name\n),\naverage_sales AS (\n    SELECT \n        AVG(total_spent) AS avg_spent,\n        COUNT(*) AS customer_count\n    FROM customer_sales\n)\nSELECT \n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_spent,\n    cs.online_orders,\n    cs.in_store_orders,\n    (cs.total_spent - av.avg_spent) AS spent_difference,\n    CASE \n        WHEN cs.total_spent > av.avg_spent THEN 'Above Average'\n        WHEN cs.total_spent < av.avg_spent THEN 'Below Average'\n        ELSE 'Average'\n    END AS spending_frequency\nFROM customer_sales cs\nCROSS JOIN average_sales av\nWHERE cs.total_spent IS NOT NULL\nORDER BY cs.total_spent DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT\n        c.c_customer_id,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        AVG(ss.ss_net_profit) AS avg_store_profit,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\n    FROM\n        customer c\n    JOIN\n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    WHERE\n        ss.ss_sold_date_sk BETWEEN (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023) - 30\n        AND (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023)\n    GROUP BY\n        c.c_customer_id\n),\nweb_sales_summary AS (\n    SELECT\n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        AVG(ws.ws_net_profit) AS avg_web_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_web_transactions\n    FROM\n        customer c\n    JOIN\n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE\n        ws.ws_sold_date_sk BETWEEN (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023) - 30\n        AND (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023)\n    GROUP BY\n        c.c_customer_id\n)\nSELECT\n    c.c_customer_id,\n    COALESCE(ss.total_store_sales, 0) AS total_store_sales,\n    COALESCE(ws.total_web_sales, 0) AS total_web_sales,\n    COALESCE(ss.avg_store_profit, 0) AS avg_store_profit,\n    COALESCE(ws.avg_web_profit, 0) AS avg_web_profit,\n    (COALESCE(ss.total_store_sales, 0) + COALESCE(ws.total_web_sales, 0)) AS total_sales,\n    (COALESCE(ss.total_transactions, 0) + COALESCE(ws.total_web_transactions, 0)) AS total_transactions\nFROM\n    customer c\nLEFT JOIN\n    sales_summary ss ON c.c_customer_id = ss.c_customer_id\nLEFT JOIN\n    web_sales_summary ws ON c.c_customer_id = ws.c_customer_id\nWHERE\n    (COALESCE(ss.total_store_sales, 0) > 1000 OR COALESCE(ws.total_web_sales, 0) > 1000)\nORDER BY\n    total_sales DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        wr_returning_customer_sk,\n        SUM(wr_return_amt_inc_tax) AS total_returned_amount,\n        COUNT(wr_return_quantity) AS total_returns\n    FROM \n        web_returns\n    GROUP BY \n        wr_returning_customer_sk\n),\nStoreSalesData AS (\n    SELECT \n        ss_customer_sk,\n        SUM(ss_net_paid) AS total_sales,\n        COUNT(ss_ticket_number) AS total_sales_count\n    FROM \n        store_sales\n    WHERE \n        ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n        AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ss_customer_sk\n),\nPromotionsData AS (\n    SELECT \n        ws_bill_customer_sk AS customer_id,\n        COUNT(DISTINCT ws_order_number) AS promo_order_count,\n        SUM(ws_ext_sales_price) AS total_promo_sales\n    FROM \n        web_sales \n    WHERE \n        ws_promo_sk IS NOT NULL\n    GROUP BY \n        ws_bill_customer_sk\n)\nSELECT \n    c.c_customer_id,\n    COALESCE(ca.ca_city, 'Unknown') AS city,\n    COALESCE(CD.total_sales, 0) AS total_store_sales,\n    COALESCE(CR.total_returned_amount, 0) AS total_web_returns,\n    COALESCE(PD.total_promo_sales, 0) AS total_promo_sales\nFROM \n    customer c\nLEFT JOIN \n    CustomerReturns CR ON c.c_customer_sk = CR.wr_returning_customer_sk\nLEFT JOIN \n    StoreSalesData CD ON c.c_customer_sk = CD.ss_customer_sk\nLEFT JOIN \n    PromotionsData PD ON c.c_customer_sk = PD.customer_id\nLEFT JOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE \n    (CD.total_sales > 1000 OR CR.total_returned_amount > 500 OR PD.total_promo_sales > 300)\nORDER BY \n    c.c_customer_id;\n",
  "\nWITH CustomerInfo AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        hd.hd_income_band_sk,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n),\nSalesData AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        COUNT(ws.ws_order_number) AS order_count,\n        AVG(ws.ws_net_profit) AS avg_profit\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_bill_customer_sk\n),\nCombinedData AS (\n    SELECT \n        ci.c_customer_sk,\n        ci.c_first_name,\n        ci.c_last_name,\n        si.total_sales,\n        si.total_discount,\n        si.order_count,\n        si.avg_profit,\n        ci.cd_gender,\n        ci.cd_marital_status,\n        ci.cd_education_status,\n        ci.ib_lower_bound,\n        ci.ib_upper_bound\n    FROM \n        CustomerInfo ci\n    JOIN \n        SalesData si ON ci.c_customer_sk = si.ws_bill_customer_sk\n)\nSELECT \n    cd.c_first_name,\n    cd.c_last_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    cd.total_sales,\n    cd.total_discount,\n    cd.order_count,\n    cd.avg_profit,\n    CASE \n        WHEN cd.total_sales > 10000 THEN 'High Value'\n        WHEN cd.total_sales BETWEEN 5000 AND 10000 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_segment\nFROM \n    CombinedData cd\nWHERE \n    cd.order_count > 5 \nORDER BY \n    cd.total_sales DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        COUNT(DISTINCT ws.ws_web_page_sk) AS unique_web_pages\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        c.c_current_cdemo_sk IS NOT NULL\n    GROUP BY \n        c.c_customer_id\n),\nWarehouseSales AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_ext_sales_price) AS total_sales\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n),\nDemographics AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer_demographics cd\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    cs.c_customer_id,\n    cs.total_web_sales,\n    cs.total_orders,\n    cs.unique_web_pages,\n    ws.total_sales AS warehouse_sales,\n    d.cd_gender,\n    d.cd_marital_status,\n    d.avg_purchase_estimate\nFROM \n    CustomerSales cs\nJOIN \n    WarehouseSales ws ON cs.total_web_sales > 1000\nJOIN \n    Demographics d ON cs.total_orders > 5\nWHERE \n    cs.total_web_sales > 5000\nORDER BY \n    cs.total_web_sales DESC, ws.total_sales DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_web_site_sk,\n        SUM(ws.ws_net_paid) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_quantity) AS avg_quantity,\n        EXTRACT(DAY FROM d.d_date) AS sale_day,\n        EXTRACT(MONTH FROM d.d_date) AS sale_month,\n        EXTRACT(YEAR FROM d.d_date) AS sale_year\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        ws.ws_web_site_sk, \n        EXTRACT(DAY FROM d.d_date),\n        EXTRACT(MONTH FROM d.d_date),\n        EXTRACT(YEAR FROM d.d_date)\n),\nCustomerAnalytics AS (\n    SELECT \n        ca.ca_city,\n        d.d_year,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        SUM(s.total_sales) AS total_sales_by_city\n    FROM \n        SalesData s\n    JOIN \n        customer c ON c.c_current_addr_sk = s.ws_web_site_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        date_dim d ON s.sale_day = EXTRACT(DAY FROM d.d_date) \n                     AND s.sale_month = EXTRACT(MONTH FROM d.d_date) \n                     AND s.sale_year = d.d_year\n    GROUP BY \n        ca.ca_city,\n        d.d_year\n)\nSELECT \n    ca.ca_city,\n    ca.d_year,\n    ca.customer_count,\n    ca.total_sales_by_city,\n    CASE \n        WHEN ca.total_sales_by_city > 100000 THEN 'High'\n        WHEN ca.total_sales_by_city BETWEEN 50000 AND 100000 THEN 'Medium'\n        ELSE 'Low'\n    END AS sales_category\nFROM \n    CustomerAnalytics ca\nORDER BY \n    ca.total_sales_by_city DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ss.ss_ext_sales_price) AS total_sales,\n        COUNT(ss.ss_ticket_number) AS sales_count\n    FROM \n        customer c\n    JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nHighValueCustomers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.total_sales,\n        cs.sales_count,\n        cd.cd_marital_status,\n        cd.cd_gender,\n        hd.hd_income_band_sk\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    WHERE \n        cs.total_sales > (SELECT AVG(total_sales) FROM CustomerSales)\n)\nSELECT \n    hvc.c_customer_sk,\n    hvc.c_first_name,\n    hvc.c_last_name,\n    hvc.total_sales,\n    hvc.sales_count,\n    hd.ib_lower_bound,\n    hd.ib_upper_bound\nFROM \n    HighValueCustomers hvc\nJOIN \n    income_band hd ON hvc.hd_income_band_sk = hd.ib_income_band_sk\nORDER BY \n    hvc.total_sales DESC\nLIMIT 100;\n",
  "\nWITH SalesData AS (\n    SELECT \n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS order_count,\n        AVG(ws_net_profit) AS avg_net_profit,\n        d_year,\n        w_state\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        d_year, w_state\n), DemographicsData AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        COUNT(DISTINCT c_customer_sk) AS customer_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_gender, cd_marital_status\n)\nSELECT \n    sd.d_year,\n    sd.w_state,\n    sd.total_sales,\n    sd.order_count,\n    sd.avg_net_profit,\n    dd.customer_count,\n    dd.cd_gender,\n    dd.cd_marital_status\nFROM \n    SalesData sd\nJOIN \n    DemographicsData dd ON sd.d_year = (SELECT MAX(d_year) FROM SalesData)\nORDER BY \n    sd.total_sales DESC, dd.customer_count DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nHighValueCustomers AS (\n    SELECT \n        ca.ca_address_id AS customer_id,\n        cs.total_sales,\n        cs.total_orders\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_address ca ON cs.c_customer_id = ca.ca_address_id\n    WHERE \n        cs.total_sales > (SELECT AVG(total_sales) FROM CustomerSales)\n        AND ca.ca_city = 'San Francisco'\n),\nSalesByMonth AS (\n    SELECT \n        d.d_year,\n        d.d_month_seq,\n        SUM(ws.ws_ext_sales_price) AS monthly_sales\n    FROM \n        date_dim d\n    JOIN \n        web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\n    GROUP BY \n        d.d_year, d.d_month_seq\n)\nSELECT \n    hvc.customer_id,\n    hvc.total_sales,\n    hvc.total_orders,\n    sbm.d_year,\n    sbm.d_month_seq,\n    sbm.monthly_sales\nFROM \n    HighValueCustomers hvc\nJOIN \n    SalesByMonth sbm ON sbm.monthly_sales > 10000\nORDER BY \n    hvc.total_sales DESC, sbm.d_year, sbm.d_month_seq;\n",
  "\nWITH CustomerPurchases AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_paid) AS total_spent,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name\n),\nHighSpenders AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        cp.total_spent\n    FROM \n        CustomerPurchases cp\n    JOIN \n        customer c ON cp.c_customer_id = c.c_customer_id\n    WHERE \n        cp.total_spent > (SELECT AVG(total_spent) FROM CustomerPurchases)\n),\nLateReturns AS (\n    SELECT \n        c.c_customer_id,\n        COUNT(DISTINCT wr.wr_order_number) AS late_returns_count\n    FROM \n        web_returns wr\n    JOIN \n        customer c ON wr.wr_returning_customer_sk = c.c_customer_sk\n    WHERE \n        wr.wr_returned_date_sk > (SELECT MAX(d.d_date_sk) - 30 FROM date_dim d)\n    GROUP BY \n        c.c_customer_id\n)\nSELECT \n    hs.c_first_name,\n    hs.c_last_name,\n    hs.total_spent,\n    COALESCE(lr.late_returns_count, 0) AS late_returns_count,\n    CASE \n        WHEN COALESCE(lr.late_returns_count, 0) > 5 THEN 'Frequent Returner'\n        ELSE 'Normal Customer'\n    END AS customer_type\nFROM \n    HighSpenders hs\nLEFT JOIN \n    LateReturns lr ON hs.c_customer_id = lr.c_customer_id\nORDER BY \n    hs.total_spent DESC;\n",
  "\nWITH AddressComponents AS (\n    SELECT \n        ca_address_sk,\n        TRIM(ca_street_number || ' ' || ca_street_name || ' ' || ca_street_type || \n             CASE WHEN ca_suite_number IS NOT NULL THEN ' Suite ' || ca_suite_number ELSE '' END) AS full_address,\n        ca_city,\n        ca_state,\n        ca_zip,\n        ca_country\n    FROM \n        customer_address\n),\nDemographicGroups AS (\n    SELECT \n        cd_demo_sk,\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        CASE \n            WHEN cd_purchase_estimate < 1000 THEN 'Low'\n            WHEN cd_purchase_estimate BETWEEN 1000 AND 5000 THEN 'Medium'\n            ELSE 'High'\n        END AS purchase_category\n    FROM \n        customer_demographics\n),\nSalesData AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ss.ss_sales_price) AS total_sales,\n        SUM(ss.ss_quantity) AS total_quantity,\n        AVG(ss.ss_sales_price) AS avg_sales_price\n    FROM \n        store_sales ss\n    JOIN \n        customer c ON ss.ss_customer_sk = c.c_customer_sk\n    GROUP BY \n        c.c_customer_sk\n)\nSELECT \n    a.full_address,\n    a.ca_city,\n    a.ca_state,\n    a.ca_zip,\n    a.ca_country,\n    d.cd_gender,\n    d.cd_marital_status,\n    d.cd_education_status,\n    d.purchase_category,\n    s.total_sales,\n    s.total_quantity,\n    s.avg_sales_price\nFROM \n    AddressComponents a\nJOIN \n    customer c ON a.ca_address_sk = c.c_current_addr_sk\nJOIN \n    DemographicGroups d ON c.c_current_cdemo_sk = d.cd_demo_sk\nLEFT JOIN \n    SalesData s ON c.c_customer_sk = s.c_customer_sk\nWHERE \n    a.ca_state = 'CA' \n    AND d.cd_gender = 'F'\nORDER BY \n    s.total_sales DESC\nLIMIT 100;\n",
  "\nWITH AddressParts AS (\n    SELECT \n        ca_address_sk, \n        TRIM(ca_street_number) || ' ' || TRIM(ca_street_name) || ' ' || TRIM(ca_street_type) AS full_address,\n        ca_city,\n        ca_state,\n        ca_zip,\n        ca_country\n    FROM customer_address\n),\n\nCustomerDetails AS (\n    SELECT \n        c.c_customer_sk,\n        TRIM(c.c_first_name) || ' ' || TRIM(c.c_last_name) AS full_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        ad.full_address,\n        ad.ca_city,\n        ad.ca_state,\n        ad.ca_zip,\n        ad.ca_country\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN AddressParts ad ON c.c_current_addr_sk = ad.ca_address_sk\n),\n\nSalesSummary AS (\n    SELECT \n        c.c_customer_sk AS customer_sk,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count\n    FROM web_sales ws\n    JOIN CustomerDetails c ON ws.ws_ship_customer_sk = c.c_customer_sk\n    GROUP BY c.c_customer_sk\n)\n\nSELECT \n    cd.full_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    cd.cd_purchase_estimate,\n    ss.total_sales,\n    ss.order_count,\n    cd.full_address,\n    cd.ca_city,\n    cd.ca_state,\n    cd.ca_zip,\n    cd.ca_country\nFROM CustomerDetails cd\nLEFT JOIN SalesSummary ss ON cd.c_customer_sk = ss.customer_sk\nORDER BY ss.total_sales DESC, cd.full_name ASC\nLIMIT 100;\n",
  "\nWITH AddressDetails AS (\n    SELECT\n        ca_address_sk,\n        TRIM(ca_street_number) || ' ' || TRIM(ca_street_name) || ' ' || TRIM(ca_street_type) AS full_address,\n        TRIM(ca_city) || ', ' || TRIM(ca_state) || ' ' || TRIM(ca_zip) AS location,\n        ca_country\n    FROM\n        customer_address\n),\nSalesData AS (\n    SELECT\n        ws_item_sk,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit\n    FROM\n        web_sales\n    WHERE\n        ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\n    GROUP BY\n        ws_item_sk\n),\nCustomerStats AS (\n    SELECT\n        c.c_customer_sk,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_net_profit) AS total_profit,\n        MAX(d.d_date) AS last_order_date\n    FROM\n        customer c\n    JOIN\n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    JOIN\n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY\n        c.c_customer_sk\n),\nFinalBenchmark AS (\n    SELECT\n        a.full_address,\n        a.location,\n        a.ca_country,\n        c.total_orders AS customer_orders,\n        c.total_profit AS customer_profit,\n        s.total_orders AS sales_orders,\n        s.total_sales,\n        s.total_profit AS sales_profit\n    FROM\n        AddressDetails a\n    LEFT JOIN\n        CustomerStats c ON a.ca_address_sk = c.c_customer_sk\n    LEFT JOIN\n        SalesData s ON a.ca_address_sk = s.ws_item_sk\n)\nSELECT \n    full_address,\n    location,\n    ca_country,\n    customer_orders,\n    customer_profit,\n    sales_orders,\n    total_sales,\n    sales_profit\nFROM \n    FinalBenchmark\nWHERE \n    customer_orders > 0 OR sales_orders > 0\nORDER BY \n    sales_profit DESC\nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        c.c_customer_id,\n        COALESCE(SUM(sr_return_quantity), 0) AS total_store_returns,\n        COALESCE(SUM(wr_return_quantity), 0) AS total_web_returns,\n        COUNT(DISTINCT sr_ticket_number) AS store_return_count,\n        COUNT(DISTINCT wr_order_number) AS web_return_count\n    FROM \n        customer c\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    LEFT JOIN \n        web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COUNT(c.c_customer_sk) AS customer_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    SUM(cr.total_store_returns + cr.total_web_returns) AS total_returns,\n    AVG(cr.store_return_count + cr.web_return_count) AS avg_returns_per_customer,\n    MAX(cr.total_store_returns) AS max_store_return_quantity,\n    MIN(cr.total_web_returns) AS min_web_return_quantity\nFROM \n    CustomerReturns cr\nJOIN \n    CustomerDemographics cd ON cr.c_customer_id IS NOT NULL\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\nORDER BY \n    total_returns DESC \nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt_inc_tax) AS total_return_amount\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n), \nCustomerDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        cd.cd_dep_count,\n        cd.cd_dep_college_count,\n        CASE \n            WHEN cd.cd_purchase_estimate <= 1000 THEN 'Low'\n            WHEN cd.cd_purchase_estimate BETWEEN 1001 AND 5000 THEN 'Medium'\n            ELSE 'High'\n        END AS income_bracket\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n), \nSalesDetails AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_sales_price) AS total_sales,\n        AVG(ws.ws_net_profit) AS avg_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        CustomerDemographics cd ON ws.ws_bill_customer_sk = cd.c_customer_sk\n    WHERE \n        ws.ws_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws.ws_bill_customer_sk\n)\nSELECT \n    cd.c_customer_sk,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cr.total_returns,\n    cr.total_return_amount,\n    sd.total_sales,\n    sd.avg_net_profit,\n    cd.income_bracket\nFROM \n    CustomerDemographics cd\nLEFT JOIN \n    CustomerReturns cr ON cd.c_customer_sk = cr.sr_customer_sk\nLEFT JOIN \n    SalesDetails sd ON cd.c_customer_sk = sd.ws_bill_customer_sk\nWHERE \n    cd.cd_gender IS NOT NULL\nORDER BY \n    cd.cd_purchase_estimate DESC, \n    total_returns DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nSalesByDemographics AS (\n    SELECT \n        cd.cd_gender AS gender,\n        cd.cd_marital_status AS marital_status,\n        COUNT(cs.c_customer_sk) AS customer_count,\n        SUM(cs.total_web_sales) AS total_web_sales,\n        SUM(cs.total_catalog_sales) AS total_catalog_sales,\n        SUM(cs.total_store_sales) AS total_store_sales\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    gender,\n    marital_status,\n    customer_count,\n    total_web_sales,\n    total_catalog_sales,\n    total_store_sales,\n    (total_web_sales + total_catalog_sales + total_store_sales) AS total_sales\nFROM \n    SalesByDemographics\nORDER BY \n    total_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_sold_date_sk, \n        ws.ws_item_sk, \n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2022\n    GROUP BY \n        ws.ws_sold_date_sk, ws.ws_item_sk\n),\nCustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(CASE WHEN s.ss_quantity > 0 THEN 1 END) AS purchases\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        store_sales s ON c.c_customer_sk = s.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    cs.cd_gender, \n    cs.cd_marital_status, \n    SUM(sd.total_quantity) AS total_quantity,\n    SUM(sd.total_sales) AS total_sales,\n    SUM(sd.total_discount) AS total_discount,\n    SUM(sd.total_net_profit) AS total_net_profit,\n    COUNT(DISTINCT cs.c_customer_sk) AS unique_customers\nFROM \n    SalesData sd\nJOIN \n    CustomerStats cs ON sd.ws_item_sk = cs.c_customer_sk\nGROUP BY \n    cs.cd_gender, cs.cd_marital_status\nORDER BY \n    total_sales DESC \nLIMIT 10;\n",
  "WITH SalesData AS (\n    SELECT \n        ss_store_sk,\n        SUM(ss_sales_price) AS total_sales,\n        SUM(ss_ext_discount_amt) AS total_discount,\n        SUM(ss_net_paid) AS total_net_paid,\n        COUNT(DISTINCT ss_ticket_number) AS total_transactions\n    FROM \n        store_sales\n    WHERE \n        ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2001)\n                             AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2001)\n    GROUP BY \n        ss_store_sk\n),\nCustomerData AS (\n    SELECT \n        c_customer_sk,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        c_customer_sk\n),\nCombinedData AS (\n    SELECT \n        s.s_store_name,\n        sd.total_sales,\n        sd.total_discount,\n        sd.total_net_paid,\n        sd.total_transactions,\n        cd.total_orders,\n        cd.avg_purchase_estimate\n    FROM \n        SalesData sd\n    JOIN \n        store s ON sd.ss_store_sk = s.s_store_sk\n    JOIN \n        CustomerData cd ON cd.c_customer_sk = sd.ss_store_sk  \n)\nSELECT \n    c.s_store_name,\n    c.total_sales,\n    c.total_discount,\n    c.total_net_paid,\n    c.total_transactions,\n    c.total_orders,\n    c.avg_purchase_estimate,\n    (c.total_sales - c.total_discount) AS net_revenue,\n    (c.total_net_paid / NULLIF(c.total_transactions, 0)) AS avg_net_paid_per_transaction\nFROM \n    CombinedData c\nORDER BY \n    net_revenue DESC\nLIMIT 10;",
  "\nWITH SalesData AS (\n    SELECT\n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        ws.ws_quantity,\n        ws.ws_sales_price,\n        ws.ws_ext_sales_price,\n        COALESCE(sr.sr_return_quantity, 0) AS return_quantity,\n        COALESCE(sr.sr_return_amt, 0) AS return_amount,\n        COALESCE(sr.sr_net_loss, 0) AS return_loss,\n        COALESCE(cr.cr_return_quantity, 0) AS catalog_return_quantity,\n        COALESCE(cr.cr_return_amount, 0) AS catalog_return_amount,\n        COALESCE(cr.cr_net_loss, 0) AS catalog_return_loss,\n        COALESCE(wr.wr_return_quantity, 0) AS web_return_quantity,\n        COALESCE(wr.wr_return_amt, 0) AS web_return_amount,\n        COALESCE(wr.wr_net_loss, 0) AS web_return_loss\n    FROM\n        web_sales ws\n    LEFT JOIN\n        store_returns sr ON ws.ws_item_sk = sr.sr_item_sk AND ws.ws_order_number = sr.sr_ticket_number\n    LEFT JOIN\n        catalog_returns cr ON ws.ws_item_sk = cr.cr_item_sk AND ws.ws_order_number = cr.cr_order_number\n    LEFT JOIN\n        web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number\n),\nAggregatedData AS (\n    SELECT\n        d.d_year,\n        d.d_month_seq,\n        SUM(sd.ws_quantity) AS total_quantity_sold,\n        SUM(sd.ws_ext_sales_price) AS total_sales,\n        SUM(sd.return_quantity) AS total_returned_quantity,\n        SUM(sd.return_amount) AS total_returned_amount,\n        SUM(sd.catalog_return_quantity) AS total_catalog_returned_quantity,\n        SUM(sd.catalog_return_amount) AS total_catalog_returned_amount,\n        SUM(sd.web_return_quantity) AS total_web_returned_quantity,\n        SUM(sd.web_return_amount) AS total_web_returned_amount,\n        (SUM(sd.ws_ext_sales_price) - SUM(sd.return_amount) - SUM(sd.catalog_return_amount) - SUM(sd.web_return_amount)) AS net_sales\n    FROM\n        SalesData sd\n    JOIN\n        date_dim d ON sd.ws_sold_date_sk = d.d_date_sk\n    GROUP BY\n        d.d_year, d.d_month_seq\n)\nSELECT\n    ad.d_year,\n    ad.d_month_seq,\n    ad.total_quantity_sold,\n    ad.total_sales,\n    ad.total_returned_quantity,\n    ad.total_returned_amount,\n    ad.total_catalog_returned_quantity,\n    ad.total_catalog_returned_amount,\n    ad.total_web_returned_quantity,\n    ad.total_web_returned_amount,\n    ad.net_sales\nFROM\n    AggregatedData ad\nORDER BY\n    ad.d_year, ad.d_month_seq;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nSalesData AS (\n    SELECT \n        cs.c_customer_sk,\n        COALESCE(cs.total_web_sales, 0) AS web_sales,\n        COALESCE(cs.total_catalog_sales, 0) AS catalog_sales,\n        COALESCE(cs.total_store_sales, 0) AS store_sales,\n        (COALESCE(cs.total_web_sales, 0) + COALESCE(cs.total_catalog_sales, 0) + COALESCE(cs.total_store_sales, 0)) AS total_sales\n    FROM \n        CustomerSales cs\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    COUNT(sd.c_customer_sk) AS customer_count,\n    SUM(sd.web_sales) AS total_web_sales,\n    SUM(sd.catalog_sales) AS total_catalog_sales,\n    SUM(sd.store_sales) AS total_store_sales,\n    SUM(sd.total_sales) AS grand_total_sales\nFROM \n    SalesData sd\nJOIN customer_demographics cd ON sd.c_customer_sk = cd.cd_demo_sk\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status\nORDER BY \n    grand_total_sales DESC\nLIMIT 10;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_order_number,\n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        ws.ws_quantity,\n        ws.ws_sales_price,\n        ws.ws_net_profit,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_country,\n        d.d_year,\n        d.d_month_seq,\n        d.d_week_seq\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023 AND \n        ws.ws_sales_price > 100.00\n), \nProfitAnalysis AS (\n    SELECT \n        d_year,\n        d_month_seq,\n        d_week_seq,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT CASE WHEN cd_gender = 'F' THEN ws_order_number END) AS total_female_orders,\n        COUNT(DISTINCT CASE WHEN cd_gender = 'M' THEN ws_order_number END) AS total_male_orders,\n        AVG(ws_sales_price) AS average_sales_price\n    FROM \n        SalesData\n    GROUP BY \n        d_year, d_month_seq, d_week_seq\n)\nSELECT \n    d_year,\n    d_month_seq,\n    d_week_seq,\n    total_orders,\n    total_quantity,\n    total_net_profit,\n    total_female_orders,\n    total_male_orders,\n    average_sales_price,\n    CASE \n        WHEN total_net_profit > 50000 THEN 'High Profit'\n        WHEN total_net_profit BETWEEN 20000 AND 50000 THEN 'Moderate Profit'\n        ELSE 'Low Profit'\n    END AS profit_category\nFROM \n    ProfitAnalysis\nORDER BY \n    d_year, d_month_seq, d_week_seq;\n",
  "\nWITH customer_purchases AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(COALESCE(ws.ws_quantity, 0) + COALESCE(cs.cs_quantity, 0)) AS total_purchases,\n        SUM(COALESCE(ws.ws_net_paid_inc_tax, 0) + COALESCE(cs.cs_net_paid_inc_tax, 0)) AS total_spent\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nhigh_value_customers AS (\n    SELECT \n        cp.c_customer_sk,\n        cp.c_first_name,\n        cp.c_last_name,\n        cp.total_purchases,\n        cp.total_spent,\n        cd.cd_marital_status,\n        cd.cd_credit_rating\n    FROM \n        customer_purchases cp\n    JOIN \n        customer_demographics cd ON cp.c_customer_sk = cd.cd_demo_sk\n    WHERE \n        cp.total_spent > (SELECT AVG(total_spent) FROM customer_purchases)\n),\ncustomer_addresses AS (\n    SELECT \n        ca.ca_address_sk,\n        ca.ca_city,\n        ca.ca_state,\n        hv.c_customer_sk,\n        hv.c_first_name,\n        hv.c_last_name,\n        hv.total_purchases,\n        hv.total_spent,\n        hv.cd_marital_status,\n        hv.cd_credit_rating\n    FROM \n        high_value_customers hv\n    JOIN \n        customer_address ca ON hv.c_customer_sk = ca.ca_address_sk\n)\nSELECT \n    a.ca_city,\n    a.ca_state,\n    COUNT(a.c_customer_sk) AS customer_count,\n    SUM(a.total_spent) AS total_revenue,\n    AVG(a.total_spent) AS average_spent,\n    COUNT(DISTINCT a.cd_credit_rating) AS unique_credit_ratings\nFROM \n    customer_addresses a\nGROUP BY \n    a.ca_city, a.ca_state\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(COALESCE(ws.ws_net_paid, 0) + COALESCE(cs.cs_net_paid, 0) + COALESCE(ss.ss_net_paid, 0)) AS total_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n), customer_demographics AS (\n    SELECT \n        d.cd_demo_sk,\n        d.cd_gender,\n        d.cd_marital_status,\n        d.cd_education_status,\n        COUNT(cs.c_customer_sk) AS customer_count,\n        AVG(cs.total_sales) AS avg_sales\n    FROM \n        customer_sales cs\n    JOIN \n        customer_demographics d ON cs.c_customer_sk = d.cd_demo_sk\n    GROUP BY \n        d.cd_demo_sk, d.cd_gender, d.cd_marital_status, d.cd_education_status\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    COUNT(*) AS demographic_group_count,\n    SUM(cd.avg_sales) AS total_avg_sales\nFROM \n    customer_demographics cd\nGROUP BY \n    cd.cd_gender, \n    cd.cd_marital_status, \n    cd.cd_education_status\nORDER BY \n    total_avg_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS return_count,\n        SUM(sr_return_quantity) AS total_returned_quantity\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n), \nSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_ext_discount_amt) AS total_discount\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n), \nCustomerDemographics AS (\n    SELECT \n        cd_demo_sk,\n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        cd_purchase_estimate\n    FROM \n        customer_demographics\n), \nDetailedReturns AS (\n    SELECT \n        c.c_customer_id,\n        ca.ca_city,\n        ca.ca_state,\n        cr.return_count,\n        cr.total_returned_quantity,\n        ss.total_sales,\n        ss.total_discount,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        CustomerReturns cr\n    JOIN \n        customer c ON cr.sr_customer_sk = c.c_customer_sk\n    JOIN \n        CustomerDemographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        SalesSummary ss ON c.c_customer_sk = ss.ws_bill_customer_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n)\nSELECT \n    cd_gender,\n    cd_marital_status,\n    COUNT(DISTINCT c_customer_id) AS customer_count,\n    AVG(total_sales) AS avg_sales,\n    SUM(total_returned_quantity) AS total_returns,\n    SUM(total_discount) AS total_discounts\nFROM \n    DetailedReturns\nWHERE \n    return_count > 0\nGROUP BY \n    cd_gender, cd_marital_status\nORDER BY \n    total_returns DESC, avg_sales DESC\nLIMIT 10;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_net_profit) AS total_profit,\n        MAX(dd.d_date) AS last_sale_date\n    FROM web_sales ws\n    JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE dd.d_year = 2023\n    GROUP BY ws.ws_item_sk\n), ItemDetails AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_id,\n        i.i_product_name,\n        i.i_brand,\n        id.ib_lower_bound,\n        id.ib_upper_bound\n    FROM item i\n    JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk\n    JOIN income_band id ON i.i_item_sk = id.ib_income_band_sk\n), CombinedData AS (\n    SELECT \n        sd.ws_item_sk,\n        id.i_item_id,\n        id.i_product_name,\n        id.i_brand,\n        sd.total_quantity,\n        sd.total_sales,\n        sd.total_profit,\n        sd.last_sale_date,\n        id.ib_lower_bound,\n        id.ib_upper_bound\n    FROM SalesData sd\n    JOIN ItemDetails id ON sd.ws_item_sk = id.i_item_sk\n)\nSELECT \n    cb.i_item_id,\n    cb.i_product_name,\n    cb.i_brand,\n    cb.total_quantity,\n    cb.total_sales,\n    cb.total_profit,\n    CASE \n        WHEN cb.total_sales > 100000 THEN 'High Performer'\n        WHEN cb.total_sales BETWEEN 50000 AND 100000 THEN 'Moderate Performer'\n        ELSE 'Low Performer'\n    END AS performance_category,\n    cb.last_sale_date,\n    cb.ib_lower_bound,\n    cb.ib_upper_bound\nFROM CombinedData cb\nWHERE cb.total_quantity > 0\nORDER BY cb.total_profit DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ss.ss_sales_price) AS total_sales,\n        AVG(ss.ss_sales_price) AS avg_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS sales_count\n    FROM \n        customer c\n    JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        c.c_customer_id\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nSalesAnalysis AS (\n    SELECT \n        ds.c_customer_id,\n        d.cd_gender,\n        d.cd_marital_status,\n        COUNT(ds.total_sales) AS customer_count,\n        SUM(ds.total_sales) AS total_revenue,\n        AVG(ds.avg_sales) AS average_sales_per_customer\n    FROM \n        CustomerSales ds\n    JOIN \n        Demographics d ON ds.c_customer_id = d.c_customer_id\n    GROUP BY \n        ds.c_customer_id, d.cd_gender, d.cd_marital_status\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    COUNT(sa.customer_count) AS total_customers,\n    SUM(sa.total_revenue) AS revenue_generated,\n    AVG(sa.average_sales_per_customer) AS avg_sales\nFROM \n    SalesAnalysis sa\nJOIN \n    Demographics cd ON sa.c_customer_id = cd.c_customer_id\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status\nORDER BY \n    revenue_generated DESC, total_customers DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT\n        c.c_customer_sk,\n        SUM(ss.ss_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n        AVG(ss.ss_sales_price) AS avg_item_price\n    FROM\n        customer c\n    JOIN\n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY\n        c.c_customer_sk\n),\nSalesByGender AS (\n    SELECT\n        cd.cd_gender,\n        COUNT(DISTINCT cs.c_customer_sk) AS customer_count,\n        SUM(cs.total_sales) AS total_sales,\n        AVG(cs.total_transactions) AS avg_transactions\n    FROM\n        CustomerSales cs\n    JOIN\n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    GROUP BY\n        cd.cd_gender\n),\nSalesTrend AS (\n    SELECT\n        d.d_year,\n        SUM(ss.ss_ext_sales_price) AS yearly_sales,\n        AVG(ss.ss_sales_price) AS avg_sales_price\n    FROM\n        store_sales ss\n    JOIN\n        date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\n    GROUP BY\n        d.d_year\n)\nSELECT\n    sbg.cd_gender,\n    sbg.customer_count,\n    sbg.total_sales,\n    sbg.avg_transactions,\n    st.d_year,\n    st.yearly_sales,\n    st.avg_sales_price\nFROM\n    SalesByGender sbg\nJOIN\n    SalesTrend st ON sbg.total_sales BETWEEN st.avg_sales_price * 0.5 AND st.avg_sales_price * 1.5\nORDER BY\n    sbg.total_sales DESC, st.d_year ASC;\n",
  "\nWITH CustomerData AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_city,\n        ca.ca_state\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n),\nItemSales AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales,\n        ws.ws_bill_cdemo_sk\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_item_sk, ws.ws_bill_cdemo_sk\n),\nSalesWithDemographics AS (\n    SELECT \n        cs.ws_item_sk,\n        cs.total_quantity,\n        cs.total_sales,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_city,\n        ca.ca_state\n    FROM \n        ItemSales cs\n    JOIN \n        customer_demographics cd ON cs.ws_bill_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON cd.cd_demo_sk = ca.ca_address_sk\n)\nSELECT \n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    ca_city,\n    ca_state,\n    SUM(total_quantity) AS total_quantity_sold,\n    SUM(total_sales) AS total_revenue\nFROM \n    SalesWithDemographics\nGROUP BY \n    cd_gender, cd_marital_status, cd_education_status, ca_city, ca_state\nORDER BY \n    total_revenue DESC;\n",
  "\nWITH AddressData AS (\n  SELECT\n    DISTINCT ca.ca_city,\n    ca.ca_state,\n    COUNT(DISTINCT c.c_customer_id) AS customer_count,\n    SUM(CASE WHEN cd.cd_gender = 'F' THEN 1 ELSE 0 END) AS female_count,\n    SUM(CASE WHEN cd.cd_gender = 'M' THEN 1 ELSE 0 END) AS male_count,\n    AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n  FROM customer_address ca\n  JOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\n  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n  GROUP BY ca.ca_city, ca.ca_state\n),\nPromotionsStats AS (\n  SELECT\n    wd.p_promo_name,\n    COUNT(DISTINCT ws.ws_order_number) AS sales_count,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    SUM(ws.ws_ext_discount_amt) AS total_discount\n  FROM web_sales ws\n  JOIN promotion wd ON ws.ws_promo_sk = wd.p_promo_sk\n  GROUP BY wd.p_promo_name\n)\nSELECT\n  ad.ca_city,\n  ad.ca_state,\n  ad.customer_count,\n  ad.female_count,\n  ad.male_count,\n  ad.avg_purchase_estimate,\n  ps.sales_count,\n  ps.total_sales,\n  ps.total_discount\nFROM AddressData ad\nLEFT JOIN PromotionsStats ps ON ad.customer_count > 100\nORDER BY ad.ca_state, ad.ca_city;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        c.c_customer_id,\n        SUM(sr_return_quantity) AS total_returns,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM \n        customer c\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    WHERE \n        sr_return_quantity IS NOT NULL\n    GROUP BY \n        c.c_customer_id\n),\nSalesData AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_net_profit) AS total_profits,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        ws.ws_bill_customer_sk\n),\nProfitableCustomers AS (\n    SELECT \n        c.c_customer_id,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(sd.total_profits, 0) AS total_profits,\n        COALESCE(sd.total_orders, 0) AS total_orders\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_id = cr.c_customer_id\n    LEFT JOIN \n        SalesData sd ON c.c_customer_sk = sd.ws_bill_customer_sk\n)\nSELECT \n    pc.c_customer_id,\n    pc.total_returns,\n    pc.total_profits,\n    pc.total_orders,\n    CASE \n        WHEN pc.total_returns > 0 AND pc.total_profits = 0 THEN 'High Return, No Profit'\n        WHEN pc.total_returns = 0 AND pc.total_profits > 0 THEN 'No Return, Profitable'\n        WHEN pc.total_returns > 0 AND pc.total_profits > 0 THEN 'Returns and Profit'\n        ELSE 'No Transactions'\n    END AS customer_category\nFROM \n    ProfitableCustomers pc\nWHERE \n    pc.total_orders > 0\nORDER BY \n    pc.total_profits DESC, pc.total_returns ASC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(COALESCE(ws.ws_quantity, 0) + COALESCE(cs.cs_quantity, 0) + COALESCE(ss.ss_quantity, 0)) AS total_quantity,\n        COUNT(DISTINCT ws.ws_order_number) AS web_orders,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_orders,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_orders\n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nSalesMetrics AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cs.total_quantity,\n        cs.web_orders,\n        cs.catalog_orders,\n        cs.store_orders,\n        (cs.total_quantity / NULLIF((cs.web_orders + cs.catalog_orders + cs.store_orders), 0)) AS avg_quantity_per_order\n    FROM CustomerSales cs\n    JOIN customer c ON cs.c_customer_sk = c.c_customer_sk\n)\nSELECT \n    sm.c_customer_sk,\n    sm.c_first_name,\n    sm.c_last_name,\n    sm.total_quantity,\n    sm.web_orders,\n    sm.catalog_orders,\n    sm.store_orders,\n    sm.avg_quantity_per_order,\n    CASE \n        WHEN sm.avg_quantity_per_order > 10 THEN 'High Value'\n        WHEN sm.avg_quantity_per_order BETWEEN 5 AND 10 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value\nFROM SalesMetrics sm\nWHERE sm.total_quantity > (\n    SELECT AVG(total_quantity)\n    FROM CustomerSales\n) \nORDER BY sm.total_quantity DESC\nLIMIT 100;\n",
  "\nWITH CustomerSummary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        ca.ca_city,\n        ca.ca_state\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n),\nSalesSummary AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_paid_inc_tax) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM web_sales\n    GROUP BY ws_bill_customer_sk\n),\nReturnsSummary AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_net_loss) AS total_returns\n    FROM store_returns\n    GROUP BY sr_customer_sk\n),\nFinalSummary AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.cd_gender,\n        cs.cd_marital_status,\n        cs.cd_purchase_estimate,\n        cs.cd_credit_rating,\n        cs.ca_city,\n        cs.ca_state,\n        COALESCE(ss.total_sales, 0) AS total_sales,\n        COALESCE(ss.total_orders, 0) AS total_orders,\n        COALESCE(rs.total_returns, 0) AS total_returns\n    FROM CustomerSummary cs\n    LEFT JOIN SalesSummary ss ON cs.c_customer_sk = ss.ws_bill_customer_sk\n    LEFT JOIN ReturnsSummary rs ON cs.c_customer_sk = rs.sr_customer_sk\n)\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    c.ca_city,\n    c.ca_state,\n    c.total_sales,\n    c.total_orders,\n    c.total_returns,\n    CASE \n        WHEN c.total_sales > 1000 THEN 'High Value'\n        WHEN c.total_sales BETWEEN 500 AND 1000 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_category\nFROM FinalSummary c\nWHERE c.total_sales IS NOT NULL OR c.total_orders > 0\nORDER BY c.total_sales DESC, c.total_orders DESC\nLIMIT 100;\n",
  "WITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ss.ss_net_paid) AS total_spent,\n        COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count,\n        COUNT(DISTINCT ws.ws_order_number) AS online_purchase_count\n    FROM \n        customer AS c\n    LEFT JOIN \n        store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        c.c_current_addr_sk IS NOT NULL\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating,\n        c.c_customer_sk\n    FROM \n        customer_demographics AS cd\n    JOIN \n        customer AS c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_spent,\n    cs.purchase_count,\n    cs.online_purchase_count,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_credit_rating,\n    CASE \n        WHEN cs.total_spent BETWEEN 0 AND 100 THEN 'Low'\n        WHEN cs.total_spent BETWEEN 101 AND 500 THEN 'Medium'\n        WHEN cs.total_spent > 500 THEN 'High'\n        ELSE 'Unknown'\n    END AS spending_category\nFROM \n    CustomerSales AS cs\nJOIN \n    CustomerDemographics AS cd ON cs.c_customer_sk = cd.c_customer_sk\nORDER BY \n    cs.total_spent DESC\nLIMIT 10;",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        SUM(ws.ws_net_paid) AS total_spent,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_income_band_sk\n    FROM \n        customer AS c\n    JOIN \n        web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        household_demographics AS hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    JOIN \n        income_band AS ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    GROUP BY \n        c.c_customer_sk, cd.cd_gender, cd.cd_marital_status, ib.ib_income_band_sk\n),\nAggregateSales AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        ib_income_band_sk,\n        AVG(order_count) AS avg_orders,\n        AVG(total_spent) AS avg_spent\n    FROM \n        CustomerSales\n    GROUP BY \n        cd_gender, cd_marital_status, ib_income_band_sk\n)\nSELECT \n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.ib_income_band_sk,\n    cs.avg_orders,\n    cs.avg_spent,\n    CASE \n        WHEN cs.avg_spent > 1000 THEN 'High Value'\n        WHEN cs.avg_spent > 500 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_segment\nFROM \n    AggregateSales AS cs\nORDER BY \n    avg_spent DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        MAX(d.d_date) AS last_purchase_date,\n        cd.cd_gender,\n        cd.cd_marital_status\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT cs.c_customer_id) AS num_customers,\n        AVG(cs.total_sales) AS avg_sales,\n        AVG(cs.total_orders) AS avg_orders,\n        MAX(cs.last_purchase_date) AS last_purchase_date\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_demographics cd ON cs.cd_gender = cd.cd_gender AND cs.cd_marital_status = cd.cd_marital_status\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.num_customers,\n    cd.avg_sales,\n    cd.avg_orders,\n    cd.last_purchase_date\nFROM \n    CustomerDemographics cd\nORDER BY \n    cd.cd_gender, cd.cd_marital_status;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        cs_item_sk,\n        SUM(cs_quantity) AS total_quantity,\n        SUM(cs_sales_price) AS total_sales,\n        SUM(cs_ext_discount_amt) AS total_discount,\n        SUM(cs_net_profit) AS total_net_profit\n    FROM \n        catalog_sales\n    WHERE \n        cs_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        cs_item_sk\n),\ncustomer_summary AS (\n    SELECT \n        c_customer_sk,\n        COUNT(DISTINCT cs_order_number) AS order_count,\n        SUM(cs_ext_sales_price) AS customer_spending\n    FROM \n        customer c\n    JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    GROUP BY \n        c_customer_sk\n),\ndemographic_summary AS (\n    SELECT \n        cd_demo_sk,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    WHERE \n        cd_credit_rating = 'Excellent'\n    GROUP BY \n        cd_demo_sk\n)\nSELECT \n    ss.cs_item_sk,\n    ss.total_quantity,\n    ss.total_sales,\n    ss.total_discount,\n    cs.order_count,\n    cs.customer_spending,\n    ds.customer_count,\n    ds.avg_purchase_estimate\nFROM \n    sales_summary ss\nLEFT JOIN \n    customer_summary cs ON ss.cs_item_sk = cs.c_customer_sk\nLEFT JOIN \n    demographic_summary ds ON cs.c_customer_sk = ds.cd_demo_sk\nWHERE \n    ss.total_sales > 1000\nORDER BY \n    ss.total_net_profit DESC\nLIMIT 100;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_current_cdemo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ss.ss_net_paid) AS total_spent,\n        COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_current_cdemo_sk, cd.cd_gender, cd.cd_marital_status\n),\nDateRange AS (\n    SELECT \n        d.d_date_sk,\n        d.d_year,\n        d.d_month_seq\n    FROM \n        date_dim d\n    WHERE \n        d.d_date BETWEEN '2023-01-01' AND '2023-12-31'\n),\nPromotions AS (\n    SELECT \n        p.p_promo_sk,\n        p.p_promo_name,\n        SUM(ws.ws_net_paid) AS promo_sales\n    FROM \n        promotion p\n    JOIN \n        web_sales ws ON p.p_promo_sk = ws.ws_promo_sk\n    WHERE \n        p.p_start_date_sk >= (SELECT MAX(d.d_date_sk) FROM DateRange d)\n    GROUP BY \n        p.p_promo_sk, p.p_promo_name\n)\nSELECT \n    cs.c_customer_sk,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.total_spent,\n    cs.purchase_count,\n    COALESCE(p.promo_sales, 0) AS total_promo_sales\nFROM \n    CustomerStats cs\nLEFT JOIN \n    Promotions p ON cs.c_current_cdemo_sk = p.p_promo_sk\nWHERE \n    cs.total_spent > (SELECT AVG(total_spent) FROM CustomerStats)\nORDER BY \n    total_spent DESC\nLIMIT 10;\n",
  "\nWITH AddressAggregation AS (\n    SELECT \n        ca.ca_city,\n        ca.ca_state,\n        COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n        COUNT(DISTINCT ca.ca_address_id) AS unique_addresses,\n        SUM(CASE WHEN cd.cd_gender = 'M' THEN 1 ELSE 0 END) AS male_count,\n        SUM(CASE WHEN cd.cd_gender = 'F' THEN 1 ELSE 0 END) AS female_count\n    FROM customer_address ca\n    JOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY ca.ca_city, ca.ca_state\n),\nSalesStatistics AS (\n    SELECT \n        d.d_year,\n        SUM(ss.ss_ext_sales_price) AS total_sales,\n        SUM(ss.ss_net_profit) AS total_profit,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\n    FROM store_sales ss\n    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\n    GROUP BY d.d_year\n),\nFinalBenchmark AS (\n    SELECT \n        aa.ca_city,\n        aa.ca_state,\n        aa.unique_customers,\n        aa.unique_addresses,\n        aa.male_count,\n        aa.female_count,\n        ss.total_sales,\n        ss.total_profit,\n        ss.total_transactions\n    FROM AddressAggregation aa\n    JOIN SalesStatistics ss ON aa.ca_state = 'CA' \n)\nSELECT \n    ca_city AS \"City\",\n    ca_state AS \"State\",\n    unique_customers AS \"Unique Customers\",\n    unique_addresses AS \"Unique Addresses\",\n    male_count AS \"Male Customers\",\n    female_count AS \"Female Customers\",\n    total_sales AS \"Total Sales (USD)\",\n    total_profit AS \"Total Profit (USD)\",\n    total_transactions AS \"Total Transactions\"\nFROM FinalBenchmark\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "\nWITH AddressCount AS (\n    SELECT \n        ca_city,\n        COUNT(ca_address_sk) AS total_address_count\n    FROM \n        customer_address \n    GROUP BY \n        ca_city\n), \nCustomerStats AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        COUNT(DISTINCT c_customer_sk) AS total_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer AS c\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_gender, cd_marital_status\n), \nSalesSummary AS (\n    SELECT \n        d_year,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_quantity) AS total_quantity\n    FROM \n        web_sales AS ws\n    JOIN \n        date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    GROUP BY \n        d_year\n)\nSELECT \n    ac.ca_city,\n    ac.total_address_count,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.total_customers,\n    cs.avg_purchase_estimate,\n    ss.d_year,\n    ss.total_sales,\n    ss.total_quantity\nFROM \n    AddressCount AS ac\nJOIN \n    CustomerStats AS cs ON cs.total_customers > 0\nJOIN \n    SalesSummary AS ss ON ss.total_sales > 0\nORDER BY \n    ac.total_address_count DESC, \n    cs.total_customers DESC, \n    ss.total_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_paid_inc_tax) AS total_revenue,\n        AVG(ws.ws_quantity) AS avg_quantity_per_order\n    FROM \n        customer AS c\n        LEFT JOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nstore_sales_summary AS (\n    SELECT \n        ss.ss_store_sk,\n        SUM(ss.ss_net_paid) AS total_store_revenue,\n        COUNT(ss.ss_ticket_number) AS total_store_sales,\n        AVG(ss.ss_sales_price) AS avg_sales_price\n    FROM \n        store_sales AS ss\n    GROUP BY \n        ss.ss_store_sk\n),\npromotion_effectiveness AS (\n    SELECT \n        p.p_promo_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS promo_order_count,\n        SUM(ws.ws_net_paid) AS promo_revenue\n    FROM\n        promotion AS p\n        JOIN web_sales AS ws ON p.p_promo_sk = ws.ws_promo_sk\n    GROUP BY \n        p.p_promo_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.total_orders,\n    cs.total_revenue,\n    cs.avg_quantity_per_order,\n    ss.total_store_revenue,\n    ss.total_store_sales,\n    ss.avg_sales_price,\n    pe.promo_order_count,\n    pe.promo_revenue\nFROM \n    customer_sales AS cs\n    JOIN store_sales_summary AS ss ON cs.c_customer_sk = ss.ss_store_sk\n    LEFT JOIN promotion_effectiveness AS pe ON cs.c_customer_sk = pe.promo_order_count\nORDER BY \n    cs.total_revenue DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        d.d_date AS sales_date,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_paid) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_date BETWEEN '2023-01-01' AND '2023-12-31'\n    GROUP BY \n        d.d_date\n),\nCustomerStats AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(sd.total_quantity) AS total_qty,\n        SUM(sd.total_sales) AS total_sales,\n        COUNT(DISTINCT c.c_customer_sk) AS num_customers\n    FROM \n        SalesData sd\n    JOIN \n        customer c ON c.c_first_shipto_date_sk IN (SELECT DISTINCT d.d_date_sk FROM date_dim d WHERE d.d_date BETWEEN '2023-01-01' AND '2023-12-31')\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    SUM(cs.total_qty) AS total_quantity,\n    SUM(cs.total_sales) AS total_sales,\n    cs.num_customers,\n    ROUND(SUM(cs.total_sales) / NULLIF(cs.num_customers, 0), 2) AS avg_sales_per_customer\nFROM \n    CustomerStats cs\nJOIN \n    customer_demographics cd ON cs.cd_gender = cd.cd_gender AND cs.cd_marital_status = cd.cd_marital_status\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status, cs.num_customers\nORDER BY \n    total_sales DESC, total_quantity DESC;\n",
  "\nWITH CustomerAddressCTE AS (\n    SELECT \n        ca.ca_address_sk,\n        ca.ca_city,\n        ca.ca_state,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM \n        customer_address ca\n    JOIN \n        customer c ON ca.ca_address_sk = c.c_current_addr_sk\n    GROUP BY \n        ca.ca_address_sk, ca.ca_city, ca.ca_state\n),\nSalesDataCTE AS (\n    SELECT \n        ws.ws_web_site_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_web_site_sk\n),\nReturnDataCTE AS (\n    SELECT \n        sr.sr_store_sk,\n        SUM(sr.sr_return_amt_inc_tax) AS total_returns,\n        COUNT(DISTINCT sr.sr_ticket_number) AS return_count\n    FROM \n        store_returns sr\n    GROUP BY \n        sr.sr_store_sk\n)\nSELECT \n    c.city AS customer_city,\n    c.state AS customer_state,\n    COALESCE(sd.total_sales, 0) AS total_sales,\n    COALESCE(sd.order_count, 0) AS order_count,\n    COALESCE(rd.total_returns, 0) AS total_returns,\n    COALESCE(rd.return_count, 0) AS return_count,\n    c.customer_count\nFROM \n    (SELECT \n        ca.ca_city AS city, \n        ca.ca_state AS state, \n        SUM(c.customer_count) AS customer_count \n     FROM \n        CustomerAddressCTE ca \n     JOIN \n        CustomerAddressCTE c ON ca.ca_address_sk = c.ca_address_sk\n     GROUP BY \n        ca.ca_city, ca.ca_state) c\nLEFT JOIN \n    SalesDataCTE sd ON c.city = CAST(sd.ws_web_site_sk AS VARCHAR)  \nLEFT JOIN \n    ReturnDataCTE rd ON c.city = CAST(rd.sr_store_sk AS VARCHAR)\nORDER BY \n    total_sales DESC, \n    customer_city, \n    customer_state;\n",
  "\nWITH CustomerSaleSummary AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n                               AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status\n),\nWarehouseSummary AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_net_profit) AS total_profit,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    WHERE \n        ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n                               AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        w.w_warehouse_id\n),\nFinalSummary AS (\n    SELECT \n        css.c_customer_id,\n        css.cd_gender,\n        css.cd_marital_status,\n        ws.w_warehouse_id,\n        ws.total_profit,\n        ws.total_orders,\n        css.total_sales,\n        css.total_orders AS customer_orders\n    FROM \n        CustomerSaleSummary css\n    JOIN \n        WarehouseSummary ws ON css.total_orders > 5\n)\nSELECT \n    f.c_customer_id,\n    f.cd_gender,\n    f.cd_marital_status,\n    f.w_warehouse_id,\n    f.total_profit,\n    f.total_orders,\n    f.total_sales,\n    f.customer_orders\nFROM \n    FinalSummary f\nORDER BY \n    f.total_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_paid_inc_tax) AS total_web_sales,\n        SUM(cs.cs_net_paid_inc_tax) AS total_catalog_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_order_count,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_order_count\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nIncomeDemographics AS (\n    SELECT \n        hd.hd_demo_sk,\n        hd.hd_income_band_sk,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n    FROM \n        household_demographics hd\n    JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n),\nSalesAnalysis AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        COALESCE(cs.total_web_sales, 0) AS total_web_sales,\n        COALESCE(cs.total_catalog_sales, 0) AS total_catalog_sales,\n        id.ib_lower_bound,\n        id.ib_upper_bound,\n        CASE \n            WHEN COALESCE(cs.total_web_sales, 0) > COALESCE(cs.total_catalog_sales, 0) THEN 'Web'\n            WHEN COALESCE(cs.total_web_sales, 0) < COALESCE(cs.total_catalog_sales, 0) THEN 'Catalog'\n            ELSE 'Equal'\n        END AS preferred_channel\n    FROM \n        CustomerSales cs\n    INNER JOIN \n        IncomeDemographics id ON cs.c_customer_sk = id.hd_demo_sk\n)\nSELECT \n    s.c_first_name,\n    s.c_last_name,\n    s.total_web_sales,\n    s.total_catalog_sales,\n    s.ib_lower_bound,\n    s.ib_upper_bound,\n    s.preferred_channel\nFROM \n    SalesAnalysis s\nWHERE \n    s.total_web_sales + s.total_catalog_sales > 1000\n    AND s.ib_upper_bound IS NOT NULL\nORDER BY \n    s.total_web_sales DESC, \n    s.total_catalog_sales DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name AS first_name,\n        c.c_last_name AS last_name,\n        SUM(COALESCE(ss.ss_net_paid, 0) + COALESCE(ws.ws_net_paid, 0)) AS total_spend,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_transaction_count,\n        COUNT(DISTINCT ws.ws_order_number) AS web_transaction_count\n    FROM \n        customer c\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nDemographics AS (\n    SELECT \n        d.cd_demo_sk, \n        d.cd_gender, \n        d.cd_marital_status, \n        d.cd_education_status,\n        d.cd_credit_rating,\n        CASE \n            WHEN d.cd_dep_count IS NULL OR d.cd_dep_count = 0 THEN 'No Dependents'\n            ELSE 'Has Dependents'\n        END AS dependent_status\n    FROM \n        customer_demographics d\n),\nSalesSummary AS (\n    SELECT \n        cs.c_customer_sk,\n        SUM(cs.total_spend) AS total_spend,\n        MAX(cs.store_transaction_count) AS max_store_transactions,\n        MAX(cs.web_transaction_count) AS max_web_transactions\n    FROM \n        CustomerSales cs\n    GROUP BY \n        cs.c_customer_sk\n)\nSELECT \n    cs.first_name,\n    cs.last_name,\n    ds.cd_gender,\n    ds.cd_marital_status,\n    ds.cd_education_status,\n    ds.dependent_status,\n    ss.total_spend,\n    ss.max_store_transactions,\n    ss.max_web_transactions\nFROM \n    CustomerSales cs\nJOIN \n    Demographics ds ON cs.c_customer_sk = ds.cd_demo_sk\nJOIN \n    SalesSummary ss ON cs.c_customer_sk = ss.c_customer_sk\nWHERE \n    (ss.total_spend IS NOT NULL AND ss.total_spend > 500) \n    OR (ds.cd_gender = 'F' AND ss.max_web_transactions > 5)\nORDER BY \n    ss.total_spend DESC NULLS LAST\nLIMIT 50;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt_inc_tax) AS total_return_value\n    FROM store_returns\n    GROUP BY sr_customer_sk\n),\nHighValueCustomers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        SUM(ws.ws_ext_sales_price) AS total_spent,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender\n    HAVING SUM(ws.ws_ext_sales_price) > 1000\n),\nReturnRates AS (\n    SELECT \n        hvc.c_customer_sk,\n        hvc.total_spent,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(cr.total_return_value, 0) AS total_return_value,\n        (COALESCE(cr.total_returns, 0) * 1.0 / NULLIF(COUNT(ws.ws_order_number), 0)) AS return_rate\n    FROM HighValueCustomers hvc\n    LEFT JOIN CustomerReturns cr ON hvc.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN web_sales ws ON hvc.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY hvc.c_customer_sk, hvc.total_spent, cr.total_returns, cr.total_return_value\n)\nSELECT \n    r.c_customer_sk,\n    r.total_spent,\n    r.total_returns,\n    r.total_return_value,\n    r.return_rate,\n    CASE \n        WHEN r.return_rate IS NULL THEN 'No Data'\n        WHEN r.return_rate > 0.5 THEN 'High'\n        ELSE 'Low'\n    END AS return_status\nFROM ReturnRates r\nORDER BY r.return_rate DESC NULLS LAST\nLIMIT 10;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt_inc_tax) AS total_returned_amount,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        ca.ca_city,\n        ca.ca_state\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n),\nSalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_quantity) AS total_sales_quantity,\n        SUM(ws_net_paid_inc_tax) AS total_sales_amount\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nReturnStatistics AS (\n    SELECT \n        cd.c_customer_sk,\n        cd.c_first_name,\n        cd.c_last_name,\n        COALESCE(cr.total_returned_quantity, 0) AS total_returned_quantity,\n        COALESCE(cr.total_returned_amount, 0) AS total_returned_amount,\n        COALESCE(sd.total_sales_quantity, 0) AS total_sales_quantity,\n        COALESCE(sd.total_sales_amount, 0) AS total_sales_amount,\n        (COALESCE(cr.total_returned_amount, 0) / NULLIF(sd.total_sales_amount, 0)) * 100 AS return_percentage\n    FROM \n        CustomerDemographics cd\n    LEFT JOIN \n        CustomerReturns cr ON cd.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN \n        SalesData sd ON cd.c_customer_sk = sd.ws_bill_customer_sk\n)\nSELECT \n    r.c_first_name,\n    r.c_last_name,\n    r.total_sales_quantity,\n    r.total_sales_amount,\n    r.total_returned_quantity,\n    r.total_returned_amount,\n    CASE \n        WHEN return_percentage > 0 THEN 'High Risk'\n        ELSE 'Low Risk'\n    END AS return_risk_category\nFROM \n    ReturnStatistics r\nWHERE \n    r.total_sales_quantity > 10\n    AND r.return_percentage IS NOT NULL\nORDER BY \n    r.return_percentage DESC\nLIMIT 50;\n",
  "\nWITH customer_return_data AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(SUM(sr_return_quantity), 0) AS total_returns,\n        COALESCE(SUM(sr_return_amt_inc_tax), 0) AS total_return_amount,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM customer c\n    LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nsales_summary AS (\n    SELECT \n        ws_bill_customer_sk,\n        COUNT(ws_order_number) AS total_orders,\n        SUM(ws_sales_price) AS total_sales_amount,\n        SUM(ws_ext_discount_amt) AS total_discount,\n        AVG(ws_net_profit) AS average_profit\n    FROM web_sales\n    GROUP BY ws_bill_customer_sk\n),\ncombined_data AS (\n    SELECT \n        cr.c_customer_sk,\n        cr.c_first_name,\n        cr.c_last_name,\n        cr.total_returns,\n        cr.total_return_amount,\n        cr.return_count,\n        ss.total_orders,\n        ss.total_sales_amount,\n        ss.total_discount,\n        ss.average_profit\n    FROM customer_return_data cr\n    LEFT JOIN sales_summary ss ON cr.c_customer_sk = ss.ws_bill_customer_sk\n)\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    COALESCE(cr.total_returns, 0) AS total_returns,\n    COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n    COALESCE(ss.total_orders, 0) AS total_orders,\n    COALESCE(ss.total_sales_amount, 0) AS total_sales_amount,\n    COALESCE(ss.total_discount, 0) AS total_discount,\n    COALESCE(ss.average_profit, 0) AS average_profit\nFROM combined_data c\nLEFT JOIN customer_return_data cr ON c.c_customer_sk = cr.c_customer_sk\nLEFT JOIN sales_summary ss ON c.c_customer_sk = ss.ws_bill_customer_sk\nORDER BY cr.total_return_amount DESC, ss.total_sales_amount DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        SUM(cs.cs_net_paid) AS total_catalog_sales,\n        SUM(ss.ss_net_paid) AS total_store_sales,\n        cd.cd_gender,\n        cd.cd_marital_status\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status\n), \nSalesAnalysis AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        COUNT(DISTINCT c_customer_id) AS customer_count,\n        AVG(total_web_sales) AS avg_web_sales,\n        AVG(total_catalog_sales) AS avg_catalog_sales,\n        AVG(total_store_sales) AS avg_store_sales,\n        (AVG(total_web_sales) + AVG(total_catalog_sales) + AVG(total_store_sales)) AS avg_total_sales\n    FROM \n        CustomerSales\n    GROUP BY \n        cd_gender, cd_marital_status\n)\nSELECT \n    cd_gender,\n    cd_marital_status,\n    customer_count,\n    avg_web_sales,\n    avg_catalog_sales,\n    avg_store_sales,\n    avg_total_sales\nFROM \n    SalesAnalysis\nORDER BY \n    avg_total_sales DESC, customer_count DESC\nLIMIT 10;\n",
  "\nWITH customer_data AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        hd.hd_income_band_sk,\n        hd.hd_buy_potential,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        household_demographics hd ON c.c_customer_sk = hd.hd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, hd.hd_income_band_sk, hd.hd_buy_potential\n),\nsales_summary AS (\n    SELECT \n        hd_income_band_sk, \n        COUNT(*) AS customer_count, \n        AVG(total_sales) AS avg_sales, \n        AVG(order_count) AS avg_order_count\n    FROM \n        customer_data\n    GROUP BY \n        hd_income_band_sk\n)\nSELECT \n    ib.ib_income_band_sk,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    COALESCE(ss.customer_count, 0) AS customer_count,\n    COALESCE(ss.avg_sales, 0) AS avg_sales,\n    COALESCE(ss.avg_order_count, 0) AS avg_order_count\nFROM \n    income_band ib\nLEFT JOIN \n    sales_summary ss ON ib.ib_income_band_sk = ss.hd_income_band_sk\nORDER BY \n    ib.ib_income_band_sk;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ss.ss_sales_price) AS total_sales,\n        COUNT(ss.ss_ticket_number) AS total_transactions,\n        COUNT(DISTINCT ss.ss_store_sk) AS store_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    WHERE \n        cd.cd_marital_status = 'M' \n        AND cd.cd_gender = 'F'\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status\n),\ndate_summary AS (\n    SELECT \n        d.d_year,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        SUM(ws.ws_net_paid) AS total_revenue\n    FROM \n        date_dim d\n    JOIN \n        web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\n    GROUP BY \n        d.d_year\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    ds.d_year,\n    ds.order_count,\n    ds.total_revenue,\n    cs.total_sales,\n    cs.total_transactions,\n    cs.store_count\nFROM \n    customer_summary cs\nJOIN \n    date_summary ds ON cs.total_transactions > 0\nORDER BY \n    ds.d_year ASC, cs.total_sales DESC\nLIMIT 100;\n",
  "WITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nSalesByDemographics AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(cs.total_sales) AS demographic_sales,\n        COUNT(cs.c_customer_sk) AS demographic_count\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n),\nSalesByDate AS (\n    SELECT \n        dd.d_year,\n        dd.d_month_seq,\n        SUM(ws.ws_ext_sales_price) AS monthly_sales\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    GROUP BY \n        dd.d_year, dd.d_month_seq\n),\nCombinedResults AS (\n    SELECT \n        sbd.cd_gender,\n        sbd.cd_marital_status,\n        sbd.demographic_sales,\n        sbd.demographic_count,\n        sbd.demographic_sales / NULLIF(sbd.demographic_count, 0) AS avg_sales_per_customer,\n        sbd.demographic_sales / NULLIF(sd.monthly_sales, 0) AS sales_ratio\n    FROM \n        SalesByDemographics sbd\n    JOIN \n        SalesByDate sd ON sd.d_year = EXTRACT(YEAR FROM cast('2002-10-01' as date)) AND sd.d_month_seq = EXTRACT(MONTH FROM cast('2002-10-01' as date))\n)\nSELECT \n    cd_gender,\n    cd_marital_status,\n    SUM(demographic_sales) AS total_demographic_sales,\n    AVG(avg_sales_per_customer) AS avg_sales_per_demographic,\n    SUM(demographic_sales * sales_ratio) AS adjusted_sales\nFROM \n    CombinedResults\nGROUP BY \n    cd_gender, cd_marital_status\nORDER BY \n    total_demographic_sales DESC;",
  "\nWITH sales_summary AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        dd.d_year,\n        dd.d_month_seq\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, dd.d_year, dd.d_month_seq\n),\ndemographic_summary AS (\n    SELECT \n        cd.cd_marital_status,\n        cd.cd_gender,\n        COUNT(DISTINCT ss.c_customer_sk) AS customer_count,\n        SUM(ss.total_sales) AS total_sales_sum,\n        AVG(ss.total_orders) AS avg_orders_per_customer\n    FROM \n        sales_summary ss\n    JOIN \n        customer_demographics cd ON ss.c_customer_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_marital_status, cd.cd_gender \n)\nSELECT \n    ds.cd_marital_status, \n    ds.cd_gender,\n    ds.customer_count,\n    ds.total_sales_sum,\n    ds.avg_orders_per_customer\nFROM \n    demographic_summary ds\nORDER BY \n    ds.total_sales_sum DESC, \n    ds.customer_count DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT\n        sr_item_sk,\n        COUNT(sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amount,\n        SUM(sr_return_tax) AS total_return_tax\n    FROM\n        store_returns\n    GROUP BY\n        sr_item_sk\n),\nInventoryStatus AS (\n    SELECT\n        inv_item_sk,\n        SUM(inv_quantity_on_hand) AS total_quantity_on_hand\n    FROM\n        inventory\n    GROUP BY\n        inv_item_sk\n),\nLatestPromotions AS (\n    SELECT\n        p_item_sk,\n        MAX(p_start_date_sk) AS latest_start_date\n    FROM\n        promotion\n    WHERE\n        p_discount_active = 'Y'\n    GROUP BY\n        p_item_sk\n),\nSalesData AS (\n    SELECT\n        ws_item_sk,\n        SUM(ws_net_paid) AS total_sales_amount,\n        COUNT(ws_order_number) AS total_sales_count\n    FROM\n        web_sales\n    WHERE\n        ws_sold_date_sk >= (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY\n        ws_item_sk\n)\n\nSELECT\n    i.i_item_id,\n    i.i_item_desc,\n    COALESCE(s.total_sales_amount, 0) AS total_sales_amount,\n    COALESCE(r.total_returns, 0) AS total_returns,\n    COALESCE(r.total_return_amount, 0) AS total_return_amount,\n    COALESCE(inv.total_quantity_on_hand, 0) AS total_quantity_on_hand,\n    CASE\n        WHEN COALESCE(s.total_sales_amount, 0) = 0 THEN 'No Sales'\n        ELSE CAST(ROUND((COALESCE(r.total_return_amount, 0) / COALESCE(s.total_sales_amount, 1)) * 100, 2) AS VARCHAR) || '%' \n    END AS return_percentage,\n    CASE\n        WHEN p.p_item_sk IS NOT NULL THEN 'Active Promotion'\n        ELSE 'No Active Promotion'\n    END AS promotion_status\nFROM\n    item i\nLEFT JOIN SalesData s ON i.i_item_sk = s.ws_item_sk\nLEFT JOIN CustomerReturns r ON i.i_item_sk = r.sr_item_sk\nLEFT JOIN InventoryStatus inv ON i.i_item_sk = inv.inv_item_sk\nLEFT JOIN LatestPromotions p ON i.i_item_sk = p.p_item_sk\nORDER BY\n    i.i_item_id;\n",
  "WITH SalesSummary AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        SUM(ws.ws_ext_sales_price) AS total_sales, \n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2001 AND \n        d.d_moy IN (11, 12)  \n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nDemographicSummary AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(cs.cs_order_number) AS total_catalog_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_revenue\n    FROM \n        customer_demographics cd\n    JOIN \n        catalog_sales cs ON cd.cd_demo_sk = cs.cs_bill_cdemo_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status\n),\nFinalSummary AS (\n    SELECT \n        ss.c_customer_sk,\n        ss.c_first_name,\n        ss.c_last_name,\n        ss.total_sales,\n        ss.total_orders,\n        ds.total_catalog_sales,\n        ds.total_catalog_revenue\n    FROM \n        SalesSummary ss\n    LEFT JOIN \n        DemographicSummary ds ON ss.c_customer_sk = ds.cd_demo_sk\n)\nSELECT \n    fs.c_customer_sk, \n    fs.c_first_name, \n    fs.c_last_name, \n    fs.total_sales, \n    fs.total_orders, \n    COALESCE(fs.total_catalog_sales, 0) AS total_catalog_sales,\n    COALESCE(fs.total_catalog_revenue, 0) AS total_catalog_revenue,\n    CASE \n        WHEN fs.total_sales >= 5000 THEN 'High Value'\n        WHEN fs.total_sales BETWEEN 1000 AND 5000 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_segment\nFROM \n    FinalSummary fs\nORDER BY \n    fs.total_sales DESC\nLIMIT 100;",
  "\nWITH CustomerReturnSummary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(SUM(sr_return_quantity), 0) AS total_return_quantity,\n        COALESCE(SUM(sr_return_amt), 0) AS total_return_amount,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM\n        customer AS c\n    LEFT JOIN\n        store_returns AS sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(c.c_customer_sk) AS customer_count\n    FROM \n        customer_demographics AS cd\n    JOIN customer AS c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status\n),\nRefundedCustomers AS (\n    SELECT \n        DISTINCT sr.sr_customer_sk\n    FROM \n        store_returns AS sr\n    WHERE \n        sr.sr_return_amt > 0\n),\nWebSaleSummary AS (\n    SELECT \n        ws_bill_customer_sk,\n        COUNT(ws_order_number) AS web_order_count,\n        SUM(ws_net_paid_inc_ship) AS total_web_sales\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n)\nSELECT \n    cs.c_first_name,\n    cs.c_last_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cs.total_return_quantity,\n    cs.total_return_amount,\n    cd.customer_count,\n    COALESCE(ws.web_order_count, 0) AS web_order_count,\n    COALESCE(ws.total_web_sales, 0) AS total_web_sales\nFROM \n    CustomerReturnSummary AS cs\nLEFT JOIN \n    CustomerDemographics AS cd ON cs.c_customer_sk = cd.cd_demo_sk\nLEFT JOIN \n    WebSaleSummary AS ws ON cs.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    (cs.total_return_quantity > 0 OR cs.total_return_amount > 0)\nAND \n    (cd.cd_gender = 'F' OR cd.cd_marital_status = 'M')\nORDER BY \n    total_return_amount DESC\nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT\n        COALESCE(SR.sr_customer_sk, WR.wr_returning_customer_sk) AS customer_sk,\n        SUM(SR.sr_return_quantity) AS total_returned_quantity,\n        SUM(SR.sr_return_amt) AS total_returned_amount,\n        COUNT(DISTINCT WR.wr_order_number) AS web_return_count\n    FROM\n        store_returns SR\n    FULL OUTER JOIN\n        web_returns WR ON SR.sr_item_sk = WR.wr_item_sk\n    GROUP BY\n        COALESCE(SR.sr_customer_sk, WR.wr_returning_customer_sk)\n),\nSalesSummary AS (\n    SELECT\n        WS.ws_bill_customer_sk AS customer_sk,\n        SUM(WS.ws_quantity) AS total_sales_quantity,\n        SUM(WS.ws_net_profit) AS total_sales_profit\n    FROM\n        web_sales WS\n    GROUP BY\n        WS.ws_bill_customer_sk\n),\nCustomerPerformance AS (\n    SELECT\n        C.c_customer_sk,\n        C.c_first_name,\n        C.c_last_name,\n        COALESCE(CR.total_returned_quantity, 0) AS total_returned_quantity,\n        COALESCE(CR.total_returned_amount, 0) AS total_returned_amount,\n        COALESCE(SS.total_sales_quantity, 0) AS total_sales_quantity,\n        COALESCE(SS.total_sales_profit, 0) AS total_sales_profit,\n        CASE\n            WHEN COALESCE(SS.total_sales_profit, 0) = 0 THEN 0\n            ELSE ROUND(COALESCE(CR.total_returned_amount / SS.total_sales_profit, 0) * 100, 2)\n        END AS return_rate_percentage\n    FROM\n        customer C\n    LEFT JOIN\n        CustomerReturns CR ON C.c_customer_sk = CR.customer_sk\n    LEFT JOIN\n        SalesSummary SS ON C.c_customer_sk = SS.customer_sk\n)\nSELECT\n    c.c_first_name,\n    c.c_last_name,\n    c.c_email_address,\n    cp.total_returned_quantity,\n    cp.total_returned_amount,\n    cp.total_sales_quantity,\n    cp.total_sales_profit,\n    cp.return_rate_percentage\nFROM\n    CustomerPerformance cp\nJOIN\n    customer c ON cp.c_customer_sk = c.c_customer_sk\nWHERE\n    cp.return_rate_percentage > 10\nORDER BY\n    cp.return_rate_percentage DESC\nLIMIT 100;\n",
  "\nWITH AddressCity AS (\n    SELECT \n        ca_city,\n        COUNT(*) AS city_count\n    FROM \n        customer_address\n    GROUP BY \n        ca_city\n),\nDemographicStats AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS total_customers,\n        SUM(cd_dep_count) AS total_dependencies,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nCustomerWithAddress AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        aa.ca_city,\n        aa.ca_state,\n        da.d_date,\n        da.d_month_seq,\n        da.d_year\n    FROM \n        customer c\n    JOIN \n        customer_address aa ON c.c_current_addr_sk = aa.ca_address_sk\n    JOIN \n        date_dim da ON c.c_first_sales_date_sk = da.d_date_sk\n)\nSELECT \n    cwa.ca_city,\n    cwa.ca_state,\n    COUNT(cwa.c_customer_sk) AS customer_count,\n    COALESCE(ac.city_count, 0) AS city_count,\n    ds.total_customers,\n    ds.total_dependencies,\n    ds.avg_purchase_estimate\nFROM \n    CustomerWithAddress cwa\nLEFT JOIN \n    AddressCity ac ON cwa.ca_city = ac.ca_city\nLEFT JOIN \n    DemographicStats ds ON cwa.ca_state = ds.cd_gender\nGROUP BY \n    cwa.ca_city, cwa.ca_state, ac.city_count, ds.total_customers, ds.total_dependencies, ds.avg_purchase_estimate\nORDER BY \n    customer_count DESC, cwa.ca_city;\n",
  "WITH address_stats AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        SUM(CASE WHEN ca_city LIKE 'San%' THEN 1 ELSE 0 END) AS san_city_count\n    FROM customer_address\n    GROUP BY ca_state\n),\ncustomer_stats AS (\n    SELECT \n        cd_gender,\n        COUNT(c_customer_sk) AS customer_count,\n        AVG(cd_dep_count) AS avg_dependents,\n        SUM(cd_purchase_estimate) AS total_purchase_estimate\n    FROM customer_demographics\n    INNER JOIN customer ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\n    GROUP BY cd_gender\n),\nsales_summary AS (\n    SELECT \n        d_year,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit\n    FROM web_sales\n    INNER JOIN date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk\n    GROUP BY d_year\n)\nSELECT \n    a.ca_state,\n    a.unique_addresses,\n    a.avg_street_name_length,\n    a.san_city_count,\n    c.cd_gender,\n    c.customer_count,\n    c.avg_dependents,\n    c.total_purchase_estimate,\n    s.d_year,\n    s.total_sales,\n    s.total_profit\nFROM address_stats a\nJOIN customer_stats c ON a.ca_state = 'CA' \nJOIN sales_summary s ON s.d_year = EXTRACT(YEAR FROM cast('2002-10-01' as date))\nORDER BY a.unique_addresses DESC, c.customer_count DESC, s.total_sales DESC;",
  "\nWITH AddressStats AS (\n    SELECT \n        ca_state, \n        COUNT(*) AS total_addresses, \n        SUM(CASE WHEN ca_city LIKE '%town%' THEN 1 ELSE 0 END) AS town_count,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomerDetails AS (\n    SELECT \n        cd_gender, \n        COUNT(DISTINCT c_customer_id) AS total_customers\n    FROM \n        customer\n    JOIN \n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY \n        cd_gender\n),\nSalesData AS (\n    SELECT \n        ws_ship_date_sk, \n        SUM(ws_sales_price) AS total_sales, \n        SUM(ws_net_profit) AS total_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_ship_date_sk\n),\nReturnStats AS (\n    SELECT \n        sr_reason_sk, \n        COUNT(*) AS total_returns, \n        AVG(sr_return_quantity) AS avg_return_quantity\n    FROM \n        store_returns\n    GROUP BY \n        sr_reason_sk\n),\nFinalBenchmark AS (\n    SELECT \n        a.ca_state,\n        a.total_addresses,\n        a.town_count,\n        a.avg_street_name_length,\n        c.cd_gender,\n        c.total_customers,\n        s.total_sales,\n        s.total_profit,\n        r.total_returns,\n        r.avg_return_quantity\n    FROM \n        AddressStats a\n    JOIN \n        CustomerDetails c ON 1=1\n    JOIN \n        SalesData s ON 1=1\n    JOIN \n        ReturnStats r ON 1=1\n)\nSELECT \n    ca_state,\n    total_addresses,\n    town_count,\n    avg_street_name_length,\n    cd_gender,\n    total_customers,\n    total_sales,\n    total_profit,\n    total_returns,\n    avg_return_quantity\nFROM \n    FinalBenchmark;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        cr_returning_customer_sk,\n        SUM(cr_return_quantity) AS total_returns,\n        AVG(cr_return_amt_inc_tax) AS avg_return_value,\n        COUNT(DISTINCT cr_order_number) AS return_count\n    FROM catalog_returns\n    GROUP BY cr_returning_customer_sk\n), \nTopCustomers AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        cr.total_returns,\n        cr.avg_return_value,\n        cr.return_count\n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN CustomerReturns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\n    GROUP BY c.c_customer_id, cr.total_returns, cr.avg_return_value, cr.return_count\n    ORDER BY total_sales DESC\n    LIMIT 10\n), \nSalesByWarehouse AS (\n    SELECT \n        w.w_warehouse_id,\n        COUNT(ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_ext_sales_price) AS total_revenue\n    FROM warehouse w\n    JOIN web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY w.w_warehouse_id\n)\n\nSELECT \n    tc.c_customer_id,\n    sbw.w_warehouse_id,\n    sbw.total_orders,\n    sbw.total_revenue,\n    tc.total_sales,\n    tc.total_returns,\n    tc.avg_return_value,\n    tc.return_count\nFROM TopCustomers tc\nJOIN SalesByWarehouse sbw ON tc.total_sales > 5000\nORDER BY sbw.total_revenue DESC, tc.total_sales DESC;\n",
  "\nWITH sales_data AS (\n    SELECT\n        ss.ss_sold_date_sk,\n        ss.ss_store_sk,\n        SUM(ss.ss_ext_sales_price) AS total_sales,\n        SUM(ss.ss_net_profit) AS total_profit,\n        COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers,\n        AVG(CASE WHEN cd_gender = 'M' THEN ss.ss_ext_sales_price ELSE 0 END) AS avg_sales_men,\n        AVG(CASE WHEN cd_gender = 'F' THEN ss.ss_ext_sales_price ELSE 0 END) AS avg_sales_women\n    FROM\n        store_sales ss\n    JOIN\n        customer c ON ss.ss_customer_sk = c.c_customer_sk\n    LEFT JOIN\n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN\n        date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\n    WHERE\n        d.d_year = 2022\n    GROUP BY\n        ss.ss_sold_date_sk, ss.ss_store_sk\n),\nstore_sales_summary AS (\n    SELECT\n        sd.ss_store_sk,\n        SUM(sd.total_sales) AS yearly_sales,\n        SUM(sd.total_profit) AS yearly_profit,\n        COUNT(sd.unique_customers) AS total_unique_customers,\n        AVG(sd.avg_sales_men) AS avg_sales_per_men,\n        AVG(sd.avg_sales_women) AS avg_sales_per_women\n    FROM\n        sales_data sd\n    GROUP BY\n        sd.ss_store_sk\n)\nSELECT\n    s.s_store_id,\n    s.s_store_name,\n    s.s_city,\n    s.s_state,\n    s.s_country,\n    ss.yearly_sales,\n    ss.yearly_profit,\n    ss.total_unique_customers,\n    ss.avg_sales_per_men,\n    ss.avg_sales_per_women\nFROM\n    store s\nJOIN\n    store_sales_summary ss ON s.s_store_sk = ss.ss_store_sk\nORDER BY\n    ss.yearly_sales DESC\nLIMIT 10;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ss.ss_sales_price) AS total_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n        AVG(ss.ss_sales_price) AS average_transaction_value\n    FROM \n        customer AS c\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nwarehouse_summary AS (\n    SELECT \n        w.w_warehouse_sk,\n        SUM(ss.ss_ext_sales_price) AS total_sales,\n        AVG(ss.ss_ext_sales_price) AS average_sales_per_item\n    FROM \n        warehouse AS w\n    JOIN \n        store_sales AS ss ON w.w_warehouse_sk = ss.ss_store_sk\n    GROUP BY \n        w.w_warehouse_sk\n),\nfinal_summary AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.total_sales AS customer_total_sales,\n        cs.total_transactions,\n        cs.average_transaction_value,\n        ws.total_sales AS warehouse_total_sales,\n        ws.average_sales_per_item\n    FROM \n        customer_summary AS cs\n    JOIN \n        warehouse_summary AS ws ON cs.total_sales >= ws.total_sales\n)\nSELECT \n    f.c_customer_sk,\n    f.c_first_name,\n    f.c_last_name,\n    f.customer_total_sales,\n    f.total_transactions,\n    f.average_transaction_value,\n    f.warehouse_total_sales,\n    f.average_sales_per_item\nFROM \n    final_summary AS f\nWHERE \n    f.customer_total_sales > 1000\nORDER BY \n    f.customer_total_sales DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        SUM(ws.ws_net_paid) AS total_web_sales,\n        SUM(cs.cs_net_paid) AS total_catalog_sales,\n        SUM(ss.ss_net_paid) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nsales_summary AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name,\n        COALESCE(total_web_sales, 0) AS total_web_sales, \n        COALESCE(total_catalog_sales, 0) AS total_catalog_sales, \n        COALESCE(total_store_sales, 0) AS total_store_sales,\n        (COALESCE(total_web_sales, 0) + COALESCE(total_catalog_sales, 0) + COALESCE(total_store_sales, 0)) AS overall_total_sales\n    FROM \n        customer_sales c\n)\nSELECT \n    s.c_customer_sk, \n    s.c_first_name, \n    s.c_last_name,\n    s.total_web_sales, \n    s.total_catalog_sales, \n    s.total_store_sales, \n    s.overall_total_sales,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status\nFROM \n    sales_summary s\nJOIN customer_demographics cd ON s.c_customer_sk = cd.cd_demo_sk\nWHERE \n    s.overall_total_sales > 1000\nORDER BY \n    overall_total_sales DESC\nLIMIT 50;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nDemographicSales AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(cs.total_sales) AS total_demographic_sales,\n        SUM(cs.order_count) AS total_orders\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n),\nMonthlySales AS (\n    SELECT \n        d.d_year,\n        d.d_month_seq,\n        SUM(ws.ws_ext_sales_price) AS month_sales,\n        COUNT(ws.ws_order_number) AS month_orders\n    FROM \n        date_dim d\n    JOIN \n        web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\n    GROUP BY \n        d.d_year, d.d_month_seq\n)\nSELECT \n    ds.cd_gender,\n    ds.cd_marital_status,\n    ms.d_year,\n    ms.d_month_seq,\n    ds.total_demographic_sales,\n    ds.total_orders,\n    ms.month_sales,\n    ms.month_orders\nFROM \n    DemographicSales ds\nJOIN \n    MonthlySales ms ON ds.total_orders > 10\nORDER BY \n    ds.cd_gender, ds.cd_marital_status, ms.d_year DESC, ms.d_month_seq DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        MAX(ws.ws_sold_date_sk) AS last_order_date\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nHighValueCustomers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_orders,\n        cs.total_net_profit,\n        cs.last_order_date,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    WHERE \n        cs.total_net_profit > (SELECT AVG(total_net_profit) FROM CustomerSales)\n),\nRecentUtils AS (\n    SELECT \n        cs.c_customer_sk,\n        ws.ws_ship_mode_sk,\n        COUNT(ws.ws_order_number) AS total_recent_orders,\n        SUM(ws.ws_net_profit) AS recent_sales_profit\n    FROM \n        CustomerSales cs\n    JOIN \n        web_sales ws ON cs.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        ws.ws_sold_date_sk > (SELECT MAX(last_order_date) - 30 FROM HighValueCustomers)\n    GROUP BY \n        cs.c_customer_sk, ws.ws_ship_mode_sk\n)\nSELECT \n    hvc.c_customer_sk,\n    hvc.total_orders,\n    hvc.total_net_profit,\n    hvc.last_order_date,\n    ru.ws_ship_mode_sk,\n    ru.total_recent_orders,\n    ru.recent_sales_profit\nFROM \n    HighValueCustomers hvc\nLEFT JOIN \n    RecentUtils ru ON hvc.c_customer_sk = ru.c_customer_sk\nORDER BY \n    hvc.total_net_profit DESC, ru.recent_sales_profit DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n), CustomerDemographics AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COUNT(*) AS demographic_count\n    FROM \n        customer_demographics cd\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n), SalesByDemographics AS (\n    SELECT \n        cs.c_customer_id,\n        cs.total_sales,\n        cs.total_orders,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.demographic_count\n    FROM \n        CustomerSales cs\n    JOIN \n        CustomerDemographics cd ON cs.cd_gender = cd.cd_gender \n        AND cs.cd_marital_status = cd.cd_marital_status \n        AND cs.cd_education_status = cd.cd_education_status\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    COUNT(DISTINCT cs.c_customer_id) AS num_customers,\n    AVG(cs.total_sales) AS avg_sales,\n    AVG(cs.total_orders) AS avg_orders,\n    SUM(cs.total_orders) AS total_orders_by_demographic\nFROM \n    SalesByDemographics cs\nJOIN \n    CustomerDemographics cd ON cs.cd_gender = cd.cd_gender \n    AND cs.cd_marital_status = cd.cd_marital_status \n    AND cs.cd_education_status = cd.cd_education_status\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\nORDER BY \n    avg_sales DESC, num_customers DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ss.ss_ext_sales_price) AS TotalStoreSales,\n        SUM(ws.ws_ext_sales_price) AS TotalWebSales\n    FROM \n        customer c\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        c.c_preferred_cust_flag = 'Y'\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nSalesComparison AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        TotalStoreSales,\n        TotalWebSales,\n        CASE \n            WHEN TotalStoreSales > TotalWebSales THEN 'Store Sales Dominant'\n            WHEN TotalStoreSales < TotalWebSales THEN 'Web Sales Dominant'\n            ELSE 'Equal Sales'\n        END AS SalesType\n    FROM \n        CustomerSales c\n)\nSELECT \n    sc.c_customer_sk,\n    sc.c_first_name,\n    sc.c_last_name,\n    sc.TotalStoreSales,\n    sc.TotalWebSales,\n    sc.SalesType,\n    COUNT(sr.sr_return_quantity) AS TotalStoreReturns,\n    COUNT(wr.wr_return_quantity) AS TotalWebReturns\nFROM \n    SalesComparison sc\nLEFT JOIN \n    store_returns sr ON sc.c_customer_sk = sr.sr_customer_sk\nLEFT JOIN \n    web_returns wr ON sc.c_customer_sk = wr.wr_returning_customer_sk\nGROUP BY \n    sc.c_customer_sk, sc.c_first_name, sc.c_last_name, \n    sc.TotalStoreSales, sc.TotalWebSales, sc.SalesType\nORDER BY \n    TotalStoreSales DESC, TotalWebSales DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt_inc_tax) AS total_returned_amount,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        hd.hd_income_band_sk,\n        hd.hd_buy_potential,\n        COALESCE(cd.cd_dep_count, 0) AS dep_count,\n        COALESCE(cd.cd_dep_college_count, 0) AS dep_college_count,\n        COALESCE(cd.cd_dep_employed_count, 0) AS dep_employed_count,\n        CASE \n            WHEN cd.cd_marital_status IS NULL THEN 'Single'\n            ELSE cd.cd_marital_status \n        END AS marital_status \n    FROM \n        customer c \n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n),\nSalesSummary AS (\n    SELECT \n        ss_customer_sk AS customer_sk,\n        SUM(ss_net_paid_inc_tax) AS total_spent,\n        COUNT(DISTINCT ss_ticket_number) AS purchase_count\n    FROM \n        store_sales\n    WHERE \n        ss_sold_date_sk >= (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ss_customer_sk\n),\nReturnAnalysis AS (\n    SELECT \n        d.c_customer_sk,\n        d.cd_gender,\n        d.hd_income_band_sk,\n        d.hd_buy_potential,\n        d.dep_count,\n        d.dep_college_count,\n        d.dep_employed_count,\n        COALESCE(cr.total_returned_quantity, 0) AS total_returns,\n        COALESCE(cr.total_returned_amount, 0) AS total_returned_amount,\n        COALESCE(ss.total_spent, 0) AS total_spent,\n        ss.purchase_count,\n        CASE \n            WHEN COALESCE(cr.total_returned_amount, 0) / NULLIF(ss.total_spent, 0) > 0.5 THEN 'High Returner'\n            ELSE 'Regular Customer' \n        END AS return_category\n    FROM \n        Demographics d\n    LEFT JOIN \n        CustomerReturns cr ON d.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN \n        SalesSummary ss ON d.c_customer_sk = ss.customer_sk\n)\nSELECT \n    return_category,\n    COUNT(*) AS num_customers,\n    AVG(dep_count) AS avg_dependencies,\n    AVG(total_spent) AS avg_spent,\n    AVG(total_returns) AS avg_returns\nFROM \n    ReturnAnalysis\nGROUP BY \n    return_category\nHAVING \n    AVG(total_spent) > 100 \n    AND COUNT(*) > 10\nORDER BY \n    num_customers DESC;\n",
  "\nWITH AddressStats AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT ca_address_sk) AS total_addresses,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        COUNT(DISTINCT ca_city) AS unique_cities\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomerStats AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_sk) AS total_customers,\n        AVG(cd_dep_count) AS avg_dependents,\n        MAX(cd_purchase_estimate) AS max_purchase_estimate\n    FROM \n        customer_demographics \n    JOIN \n        customer ON cd_demo_sk = c_current_cdemo_sk\n    GROUP BY \n        cd_gender\n),\nSalesStats AS (\n    SELECT\n        d_year,\n        SUM(ws_net_paid) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM \n        web_sales \n    JOIN \n        date_dim ON ws_sold_date_sk = d_date_sk\n    GROUP BY \n        d_year\n)\nSELECT \n    a.ca_state,\n    a.total_addresses,\n    a.max_street_name_length,\n    a.avg_street_name_length,\n    a.unique_cities,\n    c.cd_gender,\n    c.total_customers,\n    c.avg_dependents,\n    c.max_purchase_estimate,\n    s.d_year,\n    s.total_sales,\n    s.total_orders\nFROM \n    AddressStats a\nJOIN \n    CustomerStats c ON c.total_customers > 100\nJOIN \n    SalesStats s ON s.total_sales > 50000\nORDER BY \n    a.ca_state, c.cd_gender, s.d_year;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(SUM(sr_return_quantity), 0) AS total_returns,\n        COALESCE(SUM(sr_return_amt), 0) AS total_return_amount,\n        COALESCE(SUM(sr_return_tax), 0) AS total_return_tax,\n        COUNT(DISTINCT sr_ticket_number) AS unique_return_tickets\n    FROM \n        customer c\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate\n),\nReturnSummary AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(cr.total_returns) AS total_returns,\n        SUM(cr.total_return_amount) AS total_return_amount,\n        SUM(cr.total_return_tax) AS total_return_tax,\n        COUNT(DISTINCT cr.c_customer_id) AS customer_return_count\n    FROM \n        CustomerReturns cr\n    JOIN \n        CustomerDemographics cd ON cr.c_customer_id IS NOT NULL\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    COALESCE(r.total_returns, 0) AS total_returns,\n    COALESCE(r.total_return_amount, 0) AS total_return_amount,\n    COALESCE(r.total_return_tax, 0) AS total_return_tax,\n    cd.customer_count,\n    (COALESCE(r.total_returns, 0) * 100.0 / NULLIF(cd.customer_count, 0)) AS return_rate_percentage\nFROM \n    CustomerDemographics cd\nLEFT JOIN \n    ReturnSummary r ON cd.cd_gender = r.cd_gender AND cd.cd_marital_status = r.cd_marital_status\nORDER BY \n    cd.cd_gender, cd.cd_marital_status;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        COUNT(ws.ws_order_number) AS web_order_count\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nStoreSales AS (\n    SELECT \n        s.s_store_sk,\n        SUM(ss.ss_net_paid) AS total_store_sales,\n        COUNT(ss.ss_ticket_number) AS store_order_count\n    FROM \n        store s\n    LEFT JOIN \n        store_sales ss ON s.s_store_sk = ss.ss_store_sk\n    GROUP BY \n        s.s_store_sk\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cb.total_web_sales,\n        cb.web_order_count,\n        sb.total_store_sales,\n        sb.store_order_count\n    FROM \n        customer_demographics cd\n    JOIN \n        CustomerSales cb ON cd.cd_demo_sk = cb.c_customer_sk\n    LEFT JOIN \n        StoreSales sb ON cb.c_customer_sk = sb.s_store_sk \n    WHERE \n        cd.cd_gender = 'F' OR cd.cd_marital_status = 'M'\n),\nSalesSummary AS (\n    SELECT \n        d.cd_gender,\n        d.cd_marital_status,\n        COALESCE(SUM(d.total_web_sales), 0) AS total_web_sales,\n        COALESCE(SUM(d.total_store_sales), 0) AS total_store_sales,\n        COUNT(DISTINCT d.cd_demo_sk) AS demographic_count\n    FROM \n        Demographics d\n    GROUP BY \n        d.cd_gender, d.cd_marital_status\n)\nSELECT \n    ds.cd_gender,\n    ds.cd_marital_status,\n    ds.total_web_sales,\n    ds.total_store_sales,\n    ds.demographic_count,\n    CASE \n        WHEN ds.total_web_sales > ds.total_store_sales THEN 'Web Dominant'\n        WHEN ds.total_web_sales < ds.total_store_sales THEN 'Store Dominant'\n        ELSE 'Equal Sales'\n    END AS sales_dominance\nFROM \n    SalesSummary ds\nORDER BY \n    ds.total_web_sales DESC, ds.total_store_sales DESC;\n",
  "\nWITH CustomerMetrics AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        COUNT(DISTINCT wr.wr_order_number) AS total_web_returns,\n        COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns\n    FROM \n        customer c\n        JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n        LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n        LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate, cd.cd_credit_rating\n),\nSalesMetrics AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_profit) AS total_net_profit,\n        COUNT(ws_order_number) AS total_orders\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nCombinedMetrics AS (\n    SELECT\n        cm.c_customer_sk,\n        cm.c_first_name,\n        cm.c_last_name,\n        cm.cd_gender,\n        cm.cd_marital_status,\n        cm.total_web_returns,\n        cm.total_store_returns,\n        COALESCE(sm.total_net_profit, 0) AS total_net_profit,\n        COALESCE(sm.total_orders, 0) AS total_orders,\n        CASE \n            WHEN cm.total_web_returns > 0 THEN 'High Return Rate'\n            WHEN cm.total_store_returns > 0 THEN 'Some Store Returns'\n            ELSE 'Low Return Rate'\n        END AS return_category\n    FROM \n        CustomerMetrics cm\n        LEFT JOIN SalesMetrics sm ON cm.c_customer_sk = sm.ws_bill_customer_sk\n)\nSELECT \n    return_category,\n    COUNT(*) AS customer_count,\n    AVG(total_net_profit) AS avg_net_profit,\n    SUM(total_orders) AS overall_orders,\n    SUM(total_web_returns) AS total_web_returns,\n    SUM(total_store_returns) AS total_store_returns\nFROM \n    CombinedMetrics\nGROUP BY \n    return_category\nORDER BY \n    customer_count DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        AVG(ws.ws_sales_price) AS avg_sales_price,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_income_band_sk\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, ib.ib_income_band_sk\n),\nSalesSummary AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        ib_income_band_sk,\n        COUNT(c_customer_id) AS customer_count,\n        AVG(total_sales) AS avg_sales,\n        SUM(total_sales) AS total_sales,\n        AVG(order_count) AS avg_orders\n    FROM \n        CustomerSales\n    GROUP BY \n        cd_gender, cd_marital_status, ib_income_band_sk\n)\nSELECT \n    s.cd_gender,\n    s.cd_marital_status,\n    s.ib_income_band_sk,\n    s.customer_count,\n    s.avg_sales,\n    s.total_sales,\n    s.avg_orders,\n    CASE \n        WHEN s.avg_sales > 500 THEN 'High Value'\n        WHEN s.avg_sales BETWEEN 250 AND 500 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_segment\nFROM \n    SalesSummary s\nORDER BY \n    total_sales DESC, customer_count DESC;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        SUM(cs.cs_net_paid) AS total_catalog_sales,\n        SUM(ss.ss_net_paid) AS total_store_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_purchase_count,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_purchase_count,\n        COUNT(DISTINCT ws.ws_order_number) AS web_purchase_count\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nsales_summary AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(cs.total_web_sales) AS total_web_sales,\n        SUM(cs.total_catalog_sales) AS total_catalog_sales,\n        SUM(cs.total_store_sales) AS total_store_sales,\n        AVG(cs.store_purchase_count) AS avg_store_purchases,\n        AVG(cs.catalog_purchase_count) AS avg_catalog_purchases,\n        AVG(cs.web_purchase_count) AS avg_web_purchases\n    FROM \n        customer_sales cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n)\nSELECT \n    s.cd_gender, \n    s.cd_marital_status, \n    s.cd_education_status,\n    s.total_web_sales,\n    s.total_catalog_sales,\n    s.total_store_sales,\n    s.avg_store_purchases,\n    s.avg_catalog_purchases,\n    s.avg_web_purchases\nFROM \n    sales_summary s\nWHERE \n    s.total_web_sales > 5000\nORDER BY \n    s.total_web_sales DESC;\n",
  "WITH sales_data AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        SUM(ws.ws_ext_tax) AS total_tax\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2001\n    GROUP BY \n        ws.ws_item_sk\n),\nitem_data AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_desc,\n        i.i_current_price,\n        i.i_brand,\n        i.i_category\n    FROM \n        item i\n),\ncustomer_data AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_credit_rating\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n)\nSELECT \n    id.i_item_desc,\n    id.i_brand,\n    id.i_category,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    SUM(sd.total_quantity) AS total_quantity,\n    SUM(sd.total_sales) AS total_sales,\n    SUM(sd.total_discount) AS total_discount,\n    SUM(sd.total_tax) AS total_tax\nFROM \n    sales_data sd\nJOIN \n    item_data id ON sd.ws_item_sk = id.i_item_sk\nJOIN \n    customer_data cd ON sd.ws_item_sk = cd.c_customer_sk  \nGROUP BY \n    id.i_item_desc, id.i_brand, id.i_category, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\nORDER BY \n    total_sales DESC\nLIMIT 100;",
  "\nWITH customer_stats AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_state,\n        COUNT(DISTINCT c.c_customer_id) AS customer_count,\n        SUM(CASE WHEN cd.cd_gender = 'F' THEN 1 ELSE 0 END) AS female_count,\n        SUM(CASE WHEN cd.cd_gender = 'M' THEN 1 ELSE 0 END) AS male_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    GROUP BY \n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_state\n),\nsales_stats AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk\n)\nSELECT \n    cs.ca_state,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.cd_education_status,\n    ss.total_quantity,\n    ss.total_net_profit,\n    cs.customer_count,\n    cs.female_count,\n    cs.male_count,\n    cs.avg_purchase_estimate\nFROM \n    customer_stats cs\nLEFT JOIN \n    sales_stats ss ON cs.customer_count > 0\nORDER BY \n    cs.ca_state, \n    cs.cd_gender;\n",
  "\nWITH AddressCounts AS (\n    SELECT \n        ca_city,\n        COUNT(DISTINCT ca_address_id) AS unique_address_count,\n        COUNT(ca_street_number) AS street_number_count,\n        COUNT(ca_suite_number) AS suite_number_count\n    FROM \n        customer_address\n    WHERE \n        ca_street_name IS NOT NULL\n    GROUP BY \n        ca_city\n),\nCustomerStats AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_id) AS customer_count,\n        SUM(cd_dep_count) AS total_dependents,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_gender\n),\nSalesPerformance AS (\n    SELECT \n        d_year,\n        SUM(ws_net_profit) AS total_net_profit,\n        SUM(ws_quantity) AS total_quantity_sold,\n        AVG(ws_sales_price) AS avg_sales_price\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    GROUP BY \n        d_year\n)\nSELECT \n    ac.ca_city,\n    ac.unique_address_count,\n    ac.street_number_count,\n    ac.suite_number_count,\n    cs.cd_gender,\n    cs.customer_count,\n    cs.total_dependents,\n    cs.avg_purchase_estimate,\n    sp.d_year,\n    sp.total_net_profit,\n    sp.total_quantity_sold,\n    sp.avg_sales_price\nFROM \n    AddressCounts ac\nJOIN \n    CustomerStats cs ON cs.customer_count > 100\nJOIN \n    SalesPerformance sp ON sp.total_net_profit > 1000\nORDER BY \n    ac.ca_city, cs.cd_gender, sp.d_year DESC;\n",
  "WITH CustomerReturns AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_store_returns,\n        SUM(sr_return_amt) AS total_return_amount,\n        SUM(sr_return_tax) AS total_return_tax,\n        AVG(sr_return_quantity) AS avg_return_quantity\n    FROM \n        customer c\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_sk\n), \nWebSalesAggregates AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_profit) AS total_web_sales_profit,\n        AVG(ws_net_paid_inc_tax) AS avg_web_sales_per_order\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk >= (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2001)\n    GROUP BY \n        ws_bill_customer_sk\n), \nCombined AS (\n    SELECT \n        c.c_customer_sk,\n        COALESCE(cr.total_store_returns, 0) AS total_store_returns,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        COALESCE(cr.total_return_tax, 0) AS total_return_tax,\n        COALESCE(cr.avg_return_quantity, 0) AS avg_return_quantity,\n        COALESCE(ws.total_web_sales_profit, 0) AS total_web_sales_profit,\n        COALESCE(ws.avg_web_sales_per_order, 0) AS avg_web_sales_per_order\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.c_customer_sk\n    LEFT JOIN \n        WebSalesAggregates ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n)\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    combined.total_store_returns,\n    combined.total_return_amount,\n    combined.total_return_tax,\n    combined.avg_return_quantity,\n    combined.total_web_sales_profit,\n    combined.avg_web_sales_per_order\nFROM \n    customer c\nJOIN \n    Combined combined ON c.c_customer_sk = combined.c_customer_sk\nWHERE \n    (combined.total_store_returns > 0 OR combined.total_web_sales_profit > 0)\nORDER BY \n    combined.total_return_amount DESC, combined.total_web_sales_profit DESC;",
  "\nWITH sales_summary AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        CAST(d.d_date AS DATE) AS sales_date\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2022\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, d.d_date\n), average_sales AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        AVG(total_sales) AS avg_sales,\n        AVG(total_quantity_sold) AS avg_quantity\n    FROM \n        sales_summary\n    GROUP BY \n        cd_gender, cd_marital_status, cd_education_status\n)\n\nSELECT \n    avg_sales.cd_gender,\n    avg_sales.cd_marital_status,\n    avg_sales.cd_education_status,\n    avg_sales.avg_sales,\n    avg_sales.avg_quantity,\n    COUNT(ss.c_customer_id) AS customer_count\nFROM \n    average_sales avg_sales\nJOIN \n    sales_summary ss ON avg_sales.cd_gender = ss.cd_gender \n                      AND avg_sales.cd_marital_status = ss.cd_marital_status \n                      AND avg_sales.cd_education_status = ss.cd_education_status\nGROUP BY \n    avg_sales.cd_gender, avg_sales.cd_marital_status, avg_sales.cd_education_status, avg_sales.avg_sales, avg_sales.avg_quantity\nORDER BY \n    avg_sales.avg_sales DESC;\n",
  "\nWITH CustomerDetails AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(COALESCE(ws.ws_net_profit, 0)) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nMonthlySales AS (\n    SELECT \n        d.d_year,\n        d.d_month_seq,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_coupon_amt) AS total_coupons_redeemed\n    FROM \n        date_dim d\n    JOIN \n        web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\n    GROUP BY \n        d.d_year, d.d_month_seq\n)\nSELECT \n    cd.c_customer_id,\n    cd.c_first_name,\n    cd.c_last_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    cd.total_net_profit,\n    cd.order_count,\n    ms.total_sales,\n    ms.total_coupons_redeemed\nFROM \n    CustomerDetails cd\nJOIN \n    MonthlySales ms ON cd.total_net_profit > 0 AND ms.d_year = EXTRACT(YEAR FROM DATE '2002-10-01') - 1\nWHERE \n    cd.total_net_profit > 5000\nORDER BY \n    cd.total_net_profit DESC, ms.total_sales DESC\nLIMIT 100;\n",
  "\nWITH sold_items AS (\n    SELECT\n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_coupon_amt) AS total_coupons,\n        SUM(ws_net_profit) AS total_profit\n    FROM\n        web_sales\n    GROUP BY\n        ws_item_sk\n),\nitem_details AS (\n    SELECT\n        i.i_item_sk,\n        i.i_item_desc,\n        i.i_brand,\n        i.i_category,\n        i.i_current_price\n    FROM\n        item i\n),\npopular_items AS (\n    SELECT\n        id.i_item_sk,\n        id.i_item_desc,\n        id.i_brand,\n        id.i_category,\n        id.i_current_price,\n        si.total_quantity,\n        si.total_sales,\n        si.total_coupons,\n        si.total_profit\n    FROM\n        item_details id\n    JOIN\n        sold_items si ON id.i_item_sk = si.ws_item_sk\n    ORDER BY\n        si.total_quantity DESC\n    LIMIT 10\n),\ncustomer_profiles AS (\n    SELECT\n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(si.total_sales) AS total_spending\n    FROM\n        customer_demographics cd\n    JOIN\n        web_sales ws ON cd.cd_demo_sk = ws.ws_bill_cdemo_sk\n    JOIN\n        sold_items si ON ws.ws_item_sk = si.ws_item_sk\n    GROUP BY\n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status\n),\ntop_customers AS (\n    SELECT\n        cp.cd_demo_sk,\n        cp.cd_gender,\n        cp.cd_marital_status,\n        cp.total_spending\n    FROM\n        customer_profiles cp\n    ORDER BY\n        cp.total_spending DESC\n    LIMIT 5\n)\nSELECT\n    ti.i_item_desc,\n    ti.i_brand,\n    ti.i_category,\n    ti.i_current_price,\n    tc.cd_gender,\n    tc.cd_marital_status,\n    tc.total_spending\nFROM\n    popular_items ti\nJOIN\n    top_customers tc ON ti.total_profit > (SELECT AVG(total_profit) FROM sold_items);\n",
  "\nWITH customer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        hd.hd_income_band_sk,\n        hd.hd_buy_potential,\n        d.d_year,\n        d.d_month_seq,\n        d.d_dow\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    JOIN date_dim d ON c.c_first_sales_date_sk = d.d_date_sk\n),\nsales_data AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM web_sales ws\n    GROUP BY ws.ws_item_sk\n)\nSELECT \n    ci.c_first_name,\n    ci.c_last_name,\n    ci.cd_gender,\n    ci.cd_marital_status,\n    ci.cd_purchase_estimate,\n    COUNT(sd.ws_item_sk) AS items_bought,\n    SUM(sd.total_quantity_sold) AS total_quantity_sold,\n    SUM(sd.total_sales) AS total_sales,\n    SUM(sd.total_profit) AS total_profit,\n    MAX(ci.d_year) AS last_purchase_year,\n    MAX(ci.d_month_seq) AS last_purchase_month,\n    MAX(ci.d_dow) AS last_purchase_day_of_week\nFROM customer_info ci\nLEFT JOIN sales_data sd ON ci.c_customer_sk = sd.ws_item_sk\nWHERE ci.hd_income_band_sk IS NOT NULL\nGROUP BY ci.c_customer_sk, ci.c_first_name, ci.c_last_name, ci.cd_gender, ci.cd_marital_status, ci.cd_purchase_estimate, ci.hd_income_band_sk\nHAVING SUM(sd.total_sales) > 1000\nORDER BY total_sales DESC;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        COUNT(DISTINCT ws.ws_order_number) AS total_web_orders,\n        SUM(ws.ws_net_paid_inc_tax) AS total_web_sales,\n        AVG(ws.ws_net_profit) AS avg_web_profit\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate\n),\nWarehouseStats AS (\n    SELECT \n        w.w_warehouse_sk,\n        w.w_warehouse_name,\n        SUM(CASE WHEN ws.ws_item_sk IS NOT NULL THEN ws.ws_quantity ELSE 0 END) AS total_items_sold,\n        SUM(ws.ws_ext_sales_price) AS total_sales_sales,\n        AVG(ws.ws_net_profit) AS avg_sales_profit\n    FROM \n        warehouse w\n    LEFT JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_sk, w.w_warehouse_name\n)\nSELECT \n    cs.c_first_name,\n    cs.c_last_name,\n    cs.cd_gender,\n    ws.w_warehouse_name,\n    cs.total_web_orders,\n    cs.total_web_sales,\n    cs.avg_web_profit,\n    ws.total_items_sold,\n    ws.total_sales_sales,\n    ws.avg_sales_profit\nFROM \n    CustomerStats cs\nJOIN \n    WarehouseStats ws ON cs.total_web_orders > 0 AND cs.total_web_sales > 0\nORDER BY \n    cs.total_web_sales DESC, ws.total_sales_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS TotalWebSales,\n        COUNT(ws.ws_order_number) AS TotalOrders,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        hd.hd_income_band_sk,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    GROUP BY \n        c.c_customer_sk, cd.cd_gender, cd.cd_marital_status, hd.hd_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound\n),\nSalesAnalytics AS (\n    SELECT \n        TotalWebSales,\n        TotalOrders,\n        cd_gender,\n        cd_marital_status,\n        SUM(CASE WHEN TotalWebSales > 1000 THEN 1 ELSE 0 END) AS HighValueCustomers,\n        AVG(TotalOrders) AS AvgOrders\n    FROM \n        CustomerSales\n    GROUP BY \n        TotalWebSales, TotalOrders, cd_gender, cd_marital_status\n)\nSELECT \n    cd_gender,\n    cd_marital_status,\n    COUNT(*) AS CustomerCount,\n    SUM(TotalWebSales) AS TotalWebSales,\n    AVG(AvgOrders) AS AvgOrders,\n    MAX(TotalWebSales) AS MaxSale,\n    MIN(TotalWebSales) AS MinSale,\n    SUM(HighValueCustomers) AS TotalHighValueCustomers\nFROM \n    SalesAnalytics\nGROUP BY \n    cd_gender, cd_marital_status\nORDER BY \n    TotalWebSales DESC;\n",
  "\nWITH CustomerData AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        hd.hd_income_band_sk,\n        hd.hd_buy_potential,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n        SUM(ss.ss_sales_price) AS total_sales_amount\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, hd.hd_income_band_sk, hd.hd_buy_potential\n),\nSalesSummary AS (\n    SELECT \n        hd_income_band_sk,\n        hd_buy_potential,\n        COUNT(DISTINCT c_customer_sk) AS customer_count,\n        SUM(total_sales) AS total_sales_count,\n        SUM(total_sales_amount) AS total_sales_amount,\n        AVG(total_sales_amount) AS avg_sales_per_customer\n    FROM \n        CustomerData\n    GROUP BY \n        hd_income_band_sk, hd_buy_potential\n)\nSELECT \n    ib.ib_income_band_sk,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    ss.customer_count,\n    ss.total_sales_count,\n    ss.total_sales_amount,\n    ss.avg_sales_per_customer\nFROM \n    SalesSummary ss\nJOIN \n    income_band ib ON ss.hd_income_band_sk = ib.ib_income_band_sk\nORDER BY \n    ib.ib_lower_bound;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2001 \n        AND dd.d_moy IN (1, 2, 3)\n    GROUP BY \n        ws.ws_sold_date_sk, ws.ws_item_sk\n), ReturnData AS (\n    SELECT \n        wr.wr_item_sk,\n        SUM(wr.wr_return_quantity) AS total_returns,\n        SUM(wr.wr_return_amt) AS total_return_amount\n    FROM \n        web_returns wr\n    JOIN \n        SalesData sd ON wr.wr_item_sk = sd.ws_item_sk\n    GROUP BY \n        wr.wr_item_sk\n)\n\nSELECT \n    id.i_item_id,\n    id.i_item_desc,\n    COALESCE(sd.total_quantity_sold, 0) AS total_quantity_sold,\n    COALESCE(rd.total_returns, 0) AS total_returns,\n    COALESCE(sd.total_sales, 0) AS total_sales,\n    COALESCE(rd.total_return_amount, 0) AS total_return_amount,\n    CASE \n        WHEN COALESCE(sd.total_sales, 0) > 0 THEN \n            (COALESCE(rd.total_return_amount, 0) / COALESCE(sd.total_sales, 0)) * 100\n        ELSE 0 \n    END AS return_percentage,\n    CASE \n        WHEN id.i_current_price > 0 THEN \n            ROUND(COALESCE(sd.total_sales, 0) / NULLIF(COUNT(DISTINCT sd.total_orders), 0) / id.i_current_price, 2)\n        ELSE 0 \n    END AS sales_per_unit_price\nFROM \n    item id\nLEFT JOIN \n    SalesData sd ON id.i_item_sk = sd.ws_item_sk\nLEFT JOIN \n    ReturnData rd ON id.i_item_sk = rd.wr_item_sk\nWHERE \n    id.i_rec_start_date <= DATE '2002-10-01'\n    AND (id.i_rec_end_date IS NULL OR id.i_rec_end_date > DATE '2002-10-01')\nGROUP BY \n    id.i_item_id, id.i_item_desc, sd.total_quantity_sold, rd.total_returns, sd.total_sales, rd.total_return_amount, id.i_current_price\nORDER BY \n    return_percentage DESC, total_sales DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH customer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        hd.hd_income_band_sk,\n        hd.hd_buy_potential,\n        COUNT(DISTINCT sr_ticket_number) AS return_count,\n        SUM(sr_return_amt) AS total_return_amt\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        hd.hd_income_band_sk, \n        hd.hd_buy_potential\n), sales_summary AS (\n    SELECT \n        ws_bill_customer_sk,\n        COUNT(ws_order_number) AS total_orders,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_net_profit\n    FROM web_sales\n    GROUP BY ws_bill_customer_sk\n)\nSELECT \n    ci.c_first_name,\n    ci.c_last_name,\n    ci.cd_gender,\n    ci.cd_marital_status,\n    ci.hd_income_band_sk,\n    ci.hd_buy_potential,\n    ss.total_orders,\n    ss.total_sales,\n    ss.total_net_profit,\n    ci.return_count,\n    ci.total_return_amt\nFROM customer_info ci\nLEFT JOIN sales_summary ss ON ci.c_customer_sk = ss.ws_bill_customer_sk\nWHERE ci.return_count > 0\nORDER BY total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ss.ss_sales_price) AS total_store_sales,\n        SUM(ws.ws_sales_price) AS total_web_sales\n    FROM \n        customer c\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating\n    FROM \n        customer_demographics cd\n)\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    cs.total_store_sales,\n    cs.total_web_sales,\n    (cs.total_store_sales + cs.total_web_sales) AS total_sales,\n    COUNT(DISTINCT CASE WHEN cs.total_store_sales > 0 THEN 'Store Sale' END) AS num_store_transactions,\n    COUNT(DISTINCT CASE WHEN cs.total_web_sales > 0 THEN 'Web Sale' END) AS num_web_transactions\nFROM \n    CustomerSales cs\nJOIN \n    customer c ON cs.c_customer_id = c.c_customer_id\nJOIN \n    CustomerDemographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    cs.total_store_sales + cs.total_web_sales > 0\nGROUP BY \n    c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cs.total_store_sales, cs.total_web_sales\nORDER BY \n    total_sales DESC\nLIMIT 50;\n",
  "\nWITH customer_data AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        hd.hd_income_band_sk,\n        hd.hd_buy_potential\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN household_demographics hd ON c.c_customer_sk = hd.hd_demo_sk\n),\nsales_data AS (\n    SELECT \n        ws.ws_bill_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM web_sales ws\n    GROUP BY ws.ws_bill_customer_sk\n),\nreturns_data AS (\n    SELECT \n        wr.wr_returning_customer_sk,\n        SUM(wr.wr_return_amt) AS total_returns,\n        COUNT(DISTINCT wr.wr_order_number) AS total_return_orders\n    FROM web_returns wr\n    GROUP BY wr.wr_returning_customer_sk\n),\nsummary AS (\n    SELECT \n        cd.c_customer_sk,\n        cd.c_first_name,\n        cd.c_last_name,\n        COALESCE(sd.total_sales, 0) AS total_sales,\n        COALESCE(sd.total_orders, 0) AS total_orders,\n        COALESCE(rd.total_returns, 0) AS total_returns,\n        COALESCE(rd.total_return_orders, 0) AS total_return_orders,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM customer_data cd\n    LEFT JOIN sales_data sd ON cd.c_customer_sk = sd.ws_bill_customer_sk\n    LEFT JOIN returns_data rd ON cd.c_customer_sk = rd.wr_returning_customer_sk\n)\nSELECT \n    s.c_customer_sk,\n    s.c_first_name,\n    s.c_last_name,\n    s.total_sales,\n    s.total_orders,\n    s.total_returns,\n    s.total_return_orders,\n    (s.total_sales - s.total_returns) AS net_sales,\n    s.cd_gender,\n    s.cd_marital_status,\n    s.cd_education_status\nFROM summary s\nWHERE s.total_sales > 5000\nORDER BY net_sales DESC\nLIMIT 100;\n",
  "\nWITH AddressStats AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT ca_address_sk) AS unique_addresses,\n        MAX(LENGTH(ca_street_name)) AS max_street_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_length,\n        AVG(LENGTH(ca_street_name)) AS avg_street_length\n    FROM customer_address\n    GROUP BY ca_state\n),\nCustomerStats AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_sk) AS num_customers,\n        AVG(cd_dep_count) AS avg_dependents,\n        MAX(cd_purchase_estimate) AS max_purchase_estimate,\n        MIN(cd_purchase_estimate) AS min_purchase_estimate\n    FROM customer_demographics\n    JOIN customer ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\n    GROUP BY cd_gender\n),\nSalesStats AS (\n    SELECT \n        t.d_year,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        AVG(ws_sales_price) AS avg_sales_price\n    FROM web_sales\n    JOIN date_dim t ON t.d_date_sk = ws_sold_date_sk\n    GROUP BY t.d_year\n)\nSELECT \n    a.ca_state,\n    a.unique_addresses,\n    a.max_street_length,\n    a.min_street_length,\n    a.avg_street_length,\n    c.cd_gender,\n    c.num_customers,\n    c.avg_dependents,\n    c.max_purchase_estimate,\n    c.min_purchase_estimate,\n    s.d_year,\n    s.total_sales,\n    s.total_orders,\n    s.avg_sales_price\nFROM AddressStats a\nCROSS JOIN CustomerStats c\nCROSS JOIN SalesStats s\nWHERE a.unique_addresses > 1000 AND c.num_customers > 50 AND s.total_sales > 1000000\nORDER BY a.ca_state, c.cd_gender, s.d_year;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_paid) AS total_spent,\n        AVG(ws.ws_net_paid) AS avg_order_value\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n), \nIncomeStats AS (\n    SELECT \n        h.hd_income_band_sk,\n        SUM(cs.cs_sales_price) AS total_sales,\n        COUNT(DISTINCT cs.cs_order_number) AS total_orders,\n        AVG(cs.cs_sales_price) AS avg_order_value\n    FROM \n        household_demographics h\n    JOIN \n        catalog_sales cs ON h.hd_demo_sk = cs.cs_bill_customer_sk\n    GROUP BY \n        h.hd_income_band_sk\n), \nOverallStats AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.cd_gender,\n        cs.cd_marital_status,\n        cs.cd_education_status,\n        ci.total_sales,\n        ci.total_orders,\n        ci.avg_order_value,\n        cs.total_orders AS customer_orders,\n        cs.total_spent AS customer_spent,\n        cs.avg_order_value AS customer_avg_order\n    FROM \n        CustomerStats cs\n    LEFT JOIN \n        IncomeStats ci ON cs.c_customer_sk = ci.hd_income_band_sk\n)\nSELECT \n    o.c_customer_sk,\n    o.c_first_name,\n    o.c_last_name,\n    o.cd_gender,\n    o.cd_marital_status,\n    o.cd_education_status,\n    COALESCE(o.total_sales, 0) AS total_sales,\n    COALESCE(o.total_orders, 0) AS total_orders,\n    COALESCE(o.avg_order_value, 0) AS avg_order_value,\n    o.customer_orders,\n    o.customer_spent,\n    o.customer_avg_order\nFROM \n    OverallStats o\nORDER BY \n    o.customer_spent DESC\nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt) AS total_returned_amount,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM \n        store_returns sr\n    JOIN \n        customer c ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nSalesData AS (\n    SELECT \n        ws_bill_customer_sk AS customer_id,\n        SUM(ws_quantity) AS total_quantity_sold,\n        SUM(ws_net_paid) AS total_sales_amount\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nDemographicStats AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status\n),\nSummary AS (\n    SELECT \n        d.cd_demo_sk,\n        d.cd_gender,\n        d.cd_marital_status,\n        COALESCE(cr.total_returned_quantity, 0) AS total_returned_quantity,\n        COALESCE(cr.total_returned_amount, 0) AS total_returned_amount,\n        COALESCE(sd.total_quantity_sold, 0) AS total_quantity_sold,\n        COALESCE(sd.total_sales_amount, 0) AS total_sales_amount,\n        d.avg_purchase_estimate,\n        d.customer_count\n    FROM \n        DemographicStats d\n    LEFT JOIN \n        CustomerReturns cr ON d.cd_demo_sk = cr.c_customer_sk\n    LEFT JOIN \n        SalesData sd ON d.cd_demo_sk = sd.customer_id\n)\n\nSELECT \n    cd_gender,\n    cd_marital_status,\n    SUM(total_returned_quantity) AS total_returned_quantity,\n    SUM(total_returned_amount) AS total_returned_amount,\n    SUM(total_quantity_sold) AS total_quantity_sold,\n    SUM(total_sales_amount) AS total_sales_amount,\n    AVG(avg_purchase_estimate) AS avg_purchase_estimate,\n    SUM(customer_count) AS total_customers\nFROM \n    Summary\nGROUP BY \n    cd_gender, cd_marital_status\nORDER BY \n    cd_gender, cd_marital_status;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        cr_returning_customer_sk, \n        SUM(cr_return_quantity) AS total_returned_items,\n        SUM(cr_return_amount) AS total_returned_amount,\n        COUNT(DISTINCT cr_order_number) AS return_count\n    FROM \n        catalog_returns\n    GROUP BY \n        cr_returning_customer_sk\n),\nWebSalesData AS (\n    SELECT \n        ws_ship_customer_sk, \n        SUM(ws_quantity) AS total_quantity_sold, \n        SUM(ws_sales_price) AS total_sales_amount\n    FROM \n        web_sales\n    GROUP BY \n        ws_ship_customer_sk\n),\nStoreSalesData AS (\n    SELECT \n        ss_customer_sk, \n        SUM(ss_quantity) AS total_quantity_sold,\n        SUM(ss_sales_price) AS total_sales_amount\n    FROM \n        store_sales\n    GROUP BY \n        ss_customer_sk\n),\nCombinedSalesReturns AS (\n    SELECT \n        COALESCE(ws.ws_ship_customer_sk, ss.ss_customer_sk) AS customer_sk,\n        COALESCE(ws.total_quantity_sold, 0) + COALESCE(ss.total_quantity_sold, 0) AS total_sales_quantity,\n        COALESCE(ws.total_sales_amount, 0) + COALESCE(ss.total_sales_amount, 0) AS total_sales_amount,\n        COALESCE(cr.total_returned_items, 0) AS total_returned_items,\n        COALESCE(cr.total_returned_amount, 0) AS total_returned_amount,\n        COALESCE(cr.return_count, 0) AS total_return_count\n    FROM \n        WebSalesData ws\n    FULL OUTER JOIN \n        StoreSalesData ss ON ws.ws_ship_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        CustomerReturns cr ON COALESCE(ws.ws_ship_customer_sk, ss.ss_customer_sk) = cr.cr_returning_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender AS gender,\n        cd.cd_marital_status AS marital_status,\n        cd.cd_education_status AS education_status,\n        cs.customer_sk,\n        cs.total_sales_quantity,\n        cs.total_sales_amount,\n        cs.total_returned_items,\n        cs.total_returned_amount,\n        cs.total_return_count\n    FROM \n        CombinedSalesReturns cs\n    JOIN \n        customer c ON cs.customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n)\nSELECT \n    cd.gender,\n    cd.marital_status,\n    cd.education_status,\n    COUNT(DISTINCT cd.customer_sk) AS total_customers,\n    SUM(cd.total_sales_quantity) AS overall_quantity_sold,\n    SUM(cd.total_sales_amount) AS overall_sales_amount,\n    SUM(cd.total_returned_items) AS total_returned_items,\n    SUM(cd.total_returned_amount) AS total_returned_amount\nFROM \n    CustomerDemographics cd\nGROUP BY \n    cd.gender, cd.marital_status, cd.education_status\nORDER BY \n    overall_sales_amount DESC\nLIMIT 10;\n",
  "\nWITH customer_data AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        SUM(COALESCE(ws.ws_quantity, 0)) AS total_quantity,\n        SUM(COALESCE(ws.ws_net_profit, 0)) AS total_profit\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate\n),\ninventory_data AS (\n    SELECT \n        inv.inv_item_sk,\n        SUM(inv.inv_quantity_on_hand) AS total_on_hand\n    FROM \n        inventory inv\n    GROUP BY \n        inv.inv_item_sk\n),\npromotion_data AS (\n    SELECT \n        p.p_promo_id, \n        COUNT(DISTINCT p.p_item_sk) AS items_promoted\n    FROM \n        promotion p\n    WHERE \n        p.p_discount_active = 'Y'\n    GROUP BY \n        p.p_promo_id\n)\nSELECT \n    cd.c_customer_id,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    cd.cd_purchase_estimate,\n    cd.total_quantity,\n    cd.total_profit,\n    SUM(inv.total_on_hand) AS total_inventory,\n    COUNT(DISTINCT pd.p_promo_id) AS active_promotions\nFROM \n    customer_data cd\nLEFT JOIN \n    inventory_data inv ON cd.total_quantity > 0\nLEFT JOIN \n    promotion_data pd ON cd.total_quantity > 100\nGROUP BY \n    cd.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.total_quantity, cd.total_profit\nORDER BY \n    cd.total_profit DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH customer_data AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        COALESCE(hd.hd_income_band_sk, -1) AS income_band_sk\n    FROM customer AS c\n    LEFT JOIN customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN household_demographics AS hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n),\nsales_data AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        ws.ws_bill_customer_sk\n    FROM web_sales AS ws\n    GROUP BY ws.ws_sold_date_sk, ws.ws_item_sk, ws.ws_bill_customer_sk\n),\ninventory_summary AS (\n    SELECT \n        inv.inv_item_sk,\n        SUM(inv.inv_quantity_on_hand) AS total_quantity_on_hand\n    FROM inventory AS inv\n    GROUP BY inv.inv_item_sk\n),\njoined_data AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        c.cd_gender,\n        c.cd_marital_status,\n        c.cd_education_status,\n        c.cd_purchase_estimate,\n        c.income_band_sk,\n        s.ws_item_sk,\n        s.total_quantity,\n        s.total_net_profit,\n        inv.total_quantity_on_hand\n    FROM customer_data AS c\n    JOIN sales_data AS s ON c.c_customer_sk = s.ws_bill_customer_sk\n    JOIN inventory_summary AS inv ON s.ws_item_sk = inv.inv_item_sk\n)\nSELECT \n    j.c_customer_sk,\n    j.c_first_name,\n    j.c_last_name,\n    j.cd_gender,\n    j.cd_marital_status,\n    j.cd_education_status,\n    j.cd_purchase_estimate,\n    j.income_band_sk,\n    SUM(j.total_quantity) AS total_units_sold,\n    SUM(j.total_net_profit) AS total_profit,\n    AVG(j.total_quantity_on_hand) AS avg_inventory\nFROM joined_data AS j\nGROUP BY \n    j.c_customer_sk,\n    j.c_first_name,\n    j.c_last_name,\n    j.cd_gender,\n    j.cd_marital_status,\n    j.cd_education_status,\n    j.cd_purchase_estimate,\n    j.income_band_sk\nORDER BY total_profit DESC\nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_returned_date_sk,\n        sr_item_sk,\n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned,\n        SUM(sr_return_amt_inc_tax) AS total_return_amt\n    FROM \n        store_returns\n    GROUP BY \n        sr_returned_date_sk, sr_item_sk, sr_customer_sk\n),\nWebReturns AS (\n    SELECT \n        wr_returned_date_sk,\n        wr_item_sk,\n        wr_web_page_sk,\n        SUM(wr_return_quantity) AS total_web_returned,\n        SUM(wr_return_amt_inc_tax) AS total_web_return_amt\n    FROM \n        web_returns\n    GROUP BY \n        wr_returned_date_sk, wr_item_sk, wr_web_page_sk\n),\nSalesData AS (\n    SELECT \n        ws_sold_date_sk,\n        ws_item_sk,\n        SUM(ws_quantity) AS total_sold,\n        SUM(ws_net_profit) AS total_net_profit\n    FROM \n        web_sales\n    GROUP BY \n        ws_sold_date_sk, ws_item_sk\n),\nItemReturns AS (\n    SELECT \n        i_item_sk,\n        i_product_name,\n        COALESCE(SUM(cr_return_quantity), 0) AS total_catalog_returned,\n        COALESCE(SUM(cr_return_amount), 0) AS total_catalog_return_amt\n    FROM \n        item\n    LEFT JOIN \n        catalog_returns ON item.i_item_sk = catalog_returns.cr_item_sk\n    GROUP BY \n        i_item_sk, i_product_name\n)\nSELECT \n    cs.ws_sold_date_sk,\n    cs.ws_item_sk,\n    cs.total_sold,\n    cs.total_net_profit,\n    COALESCE(cr.total_returned, 0) AS total_store_returned,\n    COALESCE(cr.total_return_amt, 0) AS total_store_return_amt,\n    COALESCE(wr.total_web_returned, 0) AS total_web_returned,\n    COALESCE(wr.total_web_return_amt, 0) AS total_web_return_amt,\n    ir.total_catalog_returned,\n    ir.total_catalog_return_amt\nFROM \n    SalesData cs\nLEFT JOIN \n    CustomerReturns cr ON cs.ws_sold_date_sk = cr.sr_returned_date_sk AND cs.ws_item_sk = cr.sr_item_sk\nLEFT JOIN \n    WebReturns wr ON cs.ws_sold_date_sk = wr.wr_returned_date_sk AND cs.ws_item_sk = wr.wr_item_sk\nLEFT JOIN \n    ItemReturns ir ON cs.ws_item_sk = ir.i_item_sk\nWHERE \n    cs.total_sold > 50\n    AND (cr.total_returned > 10 OR wr.total_web_returned > 5)\nORDER BY \n    cs.ws_sold_date_sk DESC, \n    cs.total_net_profit DESC\nLIMIT 100;\n",
  "WITH AddressStats AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        SUM(LENGTH(ca_street_name)) AS total_street_name_length,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomerStats AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_id) AS total_customers,\n        AVG(cd_dep_count) AS avg_dependents,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        MAX(cd_purchase_estimate) AS max_purchase_estimate,\n        MIN(cd_purchase_estimate) AS min_purchase_estimate\n    FROM \n        customer_demographics \n    JOIN \n        customer ON cd_demo_sk = c_current_cdemo_sk\n    GROUP BY \n        cd_gender\n),\nDemographicIncome AS (\n    SELECT \n        hd_income_band_sk,\n        COUNT(DISTINCT hd_demo_sk) AS total_households,\n        AVG(hd_vehicle_count) AS avg_vehicle_count,\n        MIN(hd_vehicle_count) AS min_vehicle_count,\n        MAX(hd_vehicle_count) AS max_vehicle_count\n    FROM \n        household_demographics\n    GROUP BY \n        hd_income_band_sk\n),\nDateRange AS (\n    SELECT \n        MIN(d_date) AS start_date,\n        MAX(d_date) AS end_date,\n        COUNT(*) AS total_days\n    FROM \n        date_dim\n)\nSELECT \n    a.ca_state,\n    a.unique_addresses,\n    a.total_street_name_length,\n    a.max_street_name_length,\n    a.min_street_name_length,\n    c.cd_gender,\n    c.total_customers,\n    c.avg_dependents,\n    c.avg_purchase_estimate,\n    c.max_purchase_estimate,\n    c.min_purchase_estimate,\n    d.hd_income_band_sk,\n    d.total_households,\n    d.avg_vehicle_count,\n    d.min_vehicle_count,\n    d.max_vehicle_count,\n    date_range.start_date,\n    date_range.end_date,\n    date_range.total_days\nFROM \n    AddressStats a\nJOIN \n    CustomerStats c ON a.ca_state = 'CA' \nJOIN \n    DemographicIncome d ON d.hd_income_band_sk IS NOT NULL\nCROSS JOIN \n    DateRange date_range\nORDER BY \n    a.unique_addresses DESC, \n    c.total_customers DESC;",
  "\nWITH AddressStats AS (\n    SELECT\n        ca_state,\n        COUNT(DISTINCT ca_address_id) AS unique_addresses,\n        COUNT(*) AS total_addresses,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length\n    FROM customer_address\n    GROUP BY ca_state\n),\nCustomerStats AS (\n    SELECT\n        cd_gender,\n        COUNT(DISTINCT c_customer_id) AS total_customers,\n        AVG(cd_dep_count) AS avg_dependents,\n        MAX(cd_dep_count) AS max_dependents,\n        MIN(cd_dep_count) AS min_dependents,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        MAX(cd_purchase_estimate) AS max_purchase_estimate,\n        MIN(cd_purchase_estimate) AS min_purchase_estimate\n    FROM customer_demographics\n    JOIN customer ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\n    GROUP BY cd_gender\n),\nSalesStats AS (\n    SELECT\n        ds.d_year,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_coupon_amt) AS total_coupons,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        AVG(ws_net_profit) AS avg_net_profit,\n        MAX(ws_net_profit) AS max_net_profit,\n        MIN(ws_net_profit) AS min_net_profit\n    FROM web_sales\n    JOIN date_dim ds ON ws_sold_date_sk = ds.d_date_sk\n    GROUP BY ds.d_year\n)\nSELECT\n    a.ca_state,\n    a.unique_addresses,\n    a.total_addresses,\n    a.avg_street_name_length,\n    a.max_street_name_length,\n    a.min_street_name_length,\n    c.cd_gender,\n    c.total_customers,\n    c.avg_dependents,\n    c.max_dependents,\n    c.min_dependents,\n    c.avg_purchase_estimate,\n    c.max_purchase_estimate,\n    c.min_purchase_estimate,\n    s.d_year,\n    s.total_sales,\n    s.total_coupons,\n    s.total_orders,\n    s.avg_net_profit,\n    s.max_net_profit,\n    s.min_net_profit\nFROM AddressStats a\nJOIN CustomerStats c ON 1=1\nJOIN SalesStats s ON 1=1\nORDER BY a.ca_state, c.cd_gender, s.d_year;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    i.i_product_name,\n    ws.ws_sales_price,\n    ws.ws_quantity,\n    d.d_date,\n    sm.sm_type\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    item i ON ws.ws_item_sk = i.i_item_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN \n    ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk\nWHERE \n    d.d_year = 2023\nORDER BY \n    d.d_date, c.c_last_name, c.c_first_name;\n",
  "\nSELECT \n    CA.ca_address_id AS address_id,\n    CA.ca_street_number || ' ' || CA.ca_street_name || ' ' || CA.ca_street_type AS full_address,\n    C.c_first_name || ' ' || C.c_last_name AS customer_name,\n    CD.cd_gender AS gender,\n    CD.cd_marital_status AS marital_status,\n    D.d_date AS purchase_date,\n    I.i_item_desc AS item_description,\n    WS.ws_sales_price AS sales_price,\n    WS.ws_quantity AS quantity_sold,\n    WS.ws_ext_sales_price AS total_sales_value,\n    CASE\n        WHEN C.c_birth_month = 12 THEN 'Holiday Season'\n        WHEN C.c_birth_month IN (6, 7) THEN 'Summer Sales'\n        ELSE 'Regular Season'\n    END AS sales_season\nFROM \n    customer C\nJOIN \n    customer_address CA ON C.c_current_addr_sk = CA.ca_address_sk\nJOIN \n    customer_demographics CD ON C.c_current_cdemo_sk = CD.cd_demo_sk\nJOIN \n    web_sales WS ON C.c_customer_sk = WS.ws_bill_customer_sk\nJOIN \n    item I ON WS.ws_item_sk = I.i_item_sk\nJOIN \n    date_dim D ON WS.ws_sold_date_sk = D.d_date_sk\nWHERE \n    D.d_year = 2023\nAND \n    (CD.cd_gender = 'F' OR CD.cd_marital_status = 'M')\nAND \n    I.i_category LIKE '%Electronics%'\nORDER BY \n    total_sales_value DESC;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_sk) AS unique_customers,\n    SUM(ss_quantity) AS total_sales_quantity,\n    SUM(ss_net_paid) AS total_net_paid,\n    AVG(ss_net_paid) AS avg_net_paid,\n    MAX(ss_net_paid) AS max_net_paid,\n    MIN(ss_net_paid) AS min_net_paid,\n    COUNT(DISTINCT ss_ticket_number) AS total_transactions,\n    AVG(i_current_price) AS avg_item_price,\n    SUM(CASE WHEN cd_gender = 'M' THEN ss_quantity ELSE 0 END) AS male_sales_quantity,\n    SUM(CASE WHEN cd_gender = 'F' THEN ss_quantity ELSE 0 END) AS female_sales_quantity\nFROM \n    store_sales ss\nJOIN \n    customer c ON ss.ss_customer_sk = c.c_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    item i ON ss.ss_item_sk = i.i_item_sk\nJOIN \n    date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\nWHERE \n    dd.d_year = 2023\nGROUP BY \n    ca_state\nORDER BY \n    total_net_paid DESC\nLIMIT 10;\n",
  "\nSELECT \n    ca_state,\n    COUNT(DISTINCT c_customer_id) AS unique_customers,\n    SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_customers,\n    SUM(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_customers,\n    AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n    SUM(sr_return_quantity) AS total_returns,\n    AVG(ss_sales_price) AS avg_sales_price,\n    SUM(ws_net_profit) AS total_web_profit\nFROM \n    customer_address AS ca\nJOIN \n    customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nLEFT JOIN \n    store_returns AS sr ON c.c_customer_sk = sr.sr_customer_sk\nLEFT JOIN \n    store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nWHERE \n    ca_state IN ('CA', 'TX', 'NY')\nGROUP BY \n    ca_state\nORDER BY \n    unique_customers DESC;\n",
  "\nSELECT \n    ca.ca_city,\n    COUNT(DISTINCT c.c_customer_sk) AS unique_customers,\n    SUM(ws.ws_net_profit) AS total_profit,\n    ROUND(AVG(ws.ws_sales_price), 2) AS average_sales_price,\n    MAX(ws.ws_ext_sales_price) AS max_sales_price,\n    MIN(ws.ws_ext_sales_price) AS min_sales_price\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nJOIN \n    date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\nJOIN \n    time_dim td ON ws.ws_sold_time_sk = td.t_time_sk\nJOIN \n    ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk\nWHERE \n    dd.d_year = 2023 AND \n    sm.sm_type LIKE 'Ground%'\nGROUP BY \n    ca.ca_city\nORDER BY \n    total_profit DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        AVG(ws.ws_sales_price) AS average_sales_price,\n        MIN(ws.ws_sold_date_sk) AS first_sale_date,\n        MAX(ws.ws_sold_date_sk) AS last_sale_date,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        item i ON ws.ws_item_sk = i.i_item_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        cd.cd_gender = 'F'\n        AND i.i_current_price > 50.00\n    GROUP BY \n        ws.ws_item_sk\n    HAVING \n        SUM(ws.ws_quantity) > 100\n),\naverage_profit AS (\n    SELECT \n        AVG(total_net_profit) AS avg_profit\n    FROM \n        sales_summary\n),\nhigh_sales_items AS (\n    SELECT \n        s.ws_item_sk,\n        s.total_quantity_sold,\n        s.total_net_profit,\n        p.p_promo_name\n    FROM \n        sales_summary s\n    JOIN \n        promotion p ON s.ws_item_sk = p.p_item_sk\n    WHERE \n        s.total_net_profit > (SELECT avg_profit FROM average_profit)\n)\nSELECT \n    hi.ws_item_sk,\n    hi.total_quantity_sold,\n    hi.total_net_profit,\n    hi.p_promo_name\nFROM \n    high_sales_items hi\nJOIN \n    item i ON hi.ws_item_sk = i.i_item_sk\nORDER BY \n    hi.total_net_profit DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nSELECT \n    ca.ca_city, \n    ca.ca_state, \n    COUNT(DISTINCT c.c_customer_sk) AS unique_customers,\n    SUM(cd.cd_purchase_estimate) AS total_purchase_estimate,\n    COUNT(DISTINCT ws.ws_order_number) AS total_web_orders,\n    SUM(ws.ws_net_paid) AS total_web_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales,\n    SUM(ss.ss_net_paid) AS total_store_net_paid,\n    MAX(i.i_current_price) AS highest_item_price,\n    AVG(i.i_current_price) AS average_item_price\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    item i ON i.i_item_sk = COALESCE(ws.ws_item_sk, ss.ss_item_sk)\nWHERE \n    ca.ca_state IN ('NY', 'CA', 'TX') \n    AND cd.cd_gender = 'F'\nGROUP BY \n    ca.ca_city, ca.ca_state\nORDER BY \n    total_web_sales DESC, unique_customers DESC;\n",
  "\nSELECT \n    ca_state, \n    cd_gender, \n    COUNT(DISTINCT c_customer_id) AS total_customers,\n    SUM(ws_net_profit) AS total_net_profit,\n    AVG(ws_sales_price) AS average_sales_price,\n    COUNT(DISTINCT ws_order_number) AS total_orders,\n    SUM(ws_quantity) AS total_quantity_sold\nFROM \n    customer_address \nJOIN \n    customer ON ca_address_sk = c_current_addr_sk\nJOIN \n    customer_demographics ON c_current_cdemo_sk = cd_demo_sk\nJOIN \n    web_sales ON ws_bill_customer_sk = c_customer_sk\nJOIN \n    date_dim ON d_date_sk = ws_sold_date_sk\nJOIN \n    item ON i_item_sk = ws_item_sk\nWHERE \n    d_year = 2023 \n    AND cd_gender = 'F'\nGROUP BY \n    ca_state, cd_gender\nORDER BY \n    total_net_profit DESC\nLIMIT 10;\n",
  "\nWITH customer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        c.c_email_address,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_city,\n        ca.ca_state,\n        hd.hd_income_band_sk,\n        CASE \n            WHEN hd.hd_income_band_sk BETWEEN 1 AND 3 THEN 'Low Income'\n            WHEN hd.hd_income_band_sk BETWEEN 4 AND 6 THEN 'Middle Income'\n            ELSE 'High Income'\n        END AS income_category\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        household_demographics hd ON c.c_customer_sk = hd.hd_demo_sk\n),\npurchase_summary AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_paid) AS total_spent\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\ndetailed_report AS (\n    SELECT \n        ci.c_first_name,\n        ci.c_last_name,\n        ci.c_email_address,\n        ci.cd_gender,\n        ci.cd_marital_status,\n        ci.cd_education_status,\n        ci.ca_city,\n        ci.ca_state,\n        ci.income_category,\n        ps.total_orders,\n        ps.total_spent\n    FROM \n        customer_info ci\n    LEFT JOIN \n        purchase_summary ps ON ci.c_customer_sk = ps.c_customer_sk\n)\nSELECT \n    *,\n    CASE \n        WHEN total_spent IS NULL THEN 'No Purchases'\n        WHEN total_spent < 100 THEN 'Budget Shopper'\n        WHEN total_spent BETWEEN 100 AND 500 THEN 'Savvy Shopper'\n        ELSE 'Premium Buyer'\n    END AS shopper_type\nFROM \n    detailed_report\nORDER BY \n    total_spent DESC NULLS LAST;\n",
  "\nWITH SalesSummary AS (\n    SELECT \n        c.c_customer_id, \n        ca.ca_city,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM web_sales ws\n    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE d.d_year = 2022\n    GROUP BY c.c_customer_id, ca.ca_city\n),\nTopCities AS (\n    SELECT \n        ca.ca_city, \n        SUM(total_sales) AS city_sales\n    FROM SalesSummary\n    JOIN customer_address ca ON SalesSummary.ca_city = ca.ca_city\n    GROUP BY ca.ca_city\n    ORDER BY city_sales DESC\n    LIMIT 5\n)\nSELECT \n    ss.c_customer_id,\n    ss.total_quantity,\n    ss.total_sales,\n    ss.order_count,\n    tc.city_sales\nFROM SalesSummary ss\nJOIN TopCities tc ON ss.ca_city = tc.ca_city\nORDER BY ss.total_sales DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ss.ss_sales_price) AS total_sales,\n        COUNT(ss.ss_ticket_number) AS total_transactions,\n        AVG(ss.ss_sales_price) AS average_transaction_value,\n        MIN(ss.ss_sales_price) AS min_transaction_value,\n        MAX(ss.ss_sales_price) AS max_transaction_value\n    FROM \n        customer c\n    JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound,\n        cd.cd_purchase_estimate\n    FROM \n        customer_demographics cd\n    LEFT JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n),\nSalesWithDemographics AS (\n    SELECT \n        cs.c_customer_id,\n        cs.total_sales,\n        cs.total_transactions,\n        cs.average_transaction_value,\n        cs.min_transaction_value,\n        cs.max_transaction_value,\n        d.cd_gender,\n        d.cd_marital_status,\n        d.ib_lower_bound,\n        d.ib_upper_bound,\n        d.cd_purchase_estimate\n    FROM \n        CustomerSales cs\n    JOIN \n        customer c ON cs.c_customer_id = c.c_customer_id\n    JOIN \n        Demographics d ON c.c_current_cdemo_sk = d.cd_demo_sk\n)\nSELECT \n    *,\n    CASE \n        WHEN total_sales > 10000 THEN 'High Value'\n        WHEN total_sales BETWEEN 5000 AND 10000 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_segment\nFROM \n    SalesWithDemographics\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_orders_count,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_orders_count,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_orders_count\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nTopCustomers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(total_web_sales, 0) + COALESCE(total_catalog_sales, 0) + COALESCE(total_store_sales, 0) AS total_sales\n    FROM \n        CustomerSales c\n    WHERE \n        (total_web_sales IS NOT NULL OR total_catalog_sales IS NOT NULL OR total_store_sales IS NOT NULL)\n)\nSELECT \n    tc.c_customer_sk,\n    tc.c_first_name,\n    tc.c_last_name,\n    tc.total_sales,\n    CD.cd_gender,\n    HD.hd_income_band_sk,\n    HD.hd_buy_potential\nFROM \n    TopCustomers tc\nJOIN \n    customer_demographics CD ON tc.c_customer_sk = CD.cd_demo_sk\nJOIN \n    household_demographics HD ON CD.cd_demo_sk = HD.hd_demo_sk\nWHERE \n    total_sales > (\n        SELECT AVG(total_sales) FROM TopCustomers\n    )\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ss.ss_net_paid_inc_tax) AS total_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_orders,\n        AVG(ss.ss_net_profit) AS avg_profit,\n        MAX(ss.ss_sales_price) AS max_price,\n        MIN(ss.ss_sales_price) AS min_price\n    FROM \n        customer c\n    JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    JOIN \n        store s ON ss.ss_store_sk = s.s_store_sk\n    JOIN \n        date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        d.d_year = 2023\n        AND cd.cd_gender = 'F'\n        AND c.c_preferred_cust_flag = 'Y'\n    GROUP BY \n        c.c_customer_id\n),\ntop_customers AS (\n    SELECT \n        c.c_customer_id AS customer_id,\n        ss.total_sales,\n        ss.total_orders \n    FROM \n        sales_summary ss\n    JOIN \n        customer c ON ss.c_customer_id = c.c_customer_id\n    ORDER BY \n        ss.total_sales DESC\n    LIMIT 10\n)\nSELECT \n    tc.customer_id,\n    tc.total_sales,\n    tc.total_orders,\n    CASE WHEN tc.total_orders > 5 THEN 'High' ELSE 'Low' END AS order_category\nFROM \n    top_customers tc\nORDER BY \n    tc.total_sales DESC;\n",
  "\nSELECT \n    ca.ca_city, \n    COUNT(DISTINCT c.c_customer_sk) AS total_customers, \n    SUM(ws.ws_net_profit) AS total_net_profit, \n    AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    SUM(sr.sr_return_quantity) AS total_returned_items,\n    CAST(d.d_date AS DATE) AS sales_date\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nLEFT JOIN \n    store_returns sr ON ws.ws_item_sk = sr.sr_item_sk AND ws.ws_order_number = sr.sr_ticket_number\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    d.d_year = 2022 \n    AND ca.ca_country = 'USA'\nGROUP BY \n    ca.ca_city, d.d_date, cd.cd_purchase_estimate, ws.ws_net_profit\nORDER BY \n    total_net_profit DESC, total_customers DESC\nLIMIT 50;\n",
  "\nWITH SalesData AS (\n    SELECT \n        d.d_year,\n        SUM(ss_net_paid) AS total_net_paid,\n        COUNT(DISTINCT ss_customer_sk) AS unique_customers,\n        AVG(ss_quantity) AS avg_quantity_per_sale,\n        SUM(ss_ext_sales_price) AS total_sales,\n        SUM(ss_ext_discount_amt) AS total_discount\n    FROM \n        store_sales \n    INNER JOIN \n        date_dim d ON ss_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n),\nBestCustomer AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws_net_paid) AS total_spent,\n        COUNT(ws_order_number) AS total_orders\n    FROM \n        web_sales \n    INNER JOIN \n        customer c ON ws_bill_customer_sk = c.c_customer_sk\n    GROUP BY \n        c.c_customer_id\n    ORDER BY \n        total_spent DESC\n    LIMIT 10\n),\nTopStores AS (\n    SELECT \n        s.s_store_id,\n        SUM(ss_sales_price) AS total_sales\n    FROM \n        store_sales \n    INNER JOIN \n        store s ON ss_store_sk = s.s_store_sk\n    GROUP BY \n        s.s_store_id\n    ORDER BY \n        total_sales DESC\n    LIMIT 5\n)\nSELECT \n    sd.d_year,\n    sd.total_net_paid,\n    sd.unique_customers,\n    sd.avg_quantity_per_sale,\n    sd.total_sales,\n    sd.total_discount,\n    bc.c_customer_id,\n    bc.total_spent,\n    bc.total_orders,\n    ts.s_store_id,\n    ts.total_sales\nFROM \n    SalesData sd\nCROSS JOIN \n    BestCustomer bc\nCROSS JOIN \n    TopStores ts\nORDER BY \n    sd.d_year DESC, \n    bc.total_spent DESC, \n    ts.total_sales DESC;\n",
  "\nWITH customer_purchase_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_paid) AS total_spent,\n        AVG(ws.ws_net_paid) AS avg_order_value\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n), high_value_customers AS (\n    SELECT \n        * \n    FROM \n        customer_purchase_summary\n    WHERE \n        total_spent > 1000\n), customer_addresses AS (\n    SELECT \n        ca.ca_address_sk,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_country\n    FROM \n        customer_address ca\n    JOIN \n        customer c ON c.c_current_addr_sk = ca.ca_address_sk\n), customer_demo AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status\n    FROM \n        customer_demographics cd\n    JOIN \n        high_value_customers hvc ON hvc.c_customer_sk = cd.cd_demo_sk\n), customer_info AS (\n    SELECT \n        hvc.c_customer_sk,\n        hvc.total_orders,\n        hvc.total_spent,\n        hvc.avg_order_value,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_country,\n        cd.cd_gender,\n        cd.cd_marital_status\n    FROM \n        high_value_customers hvc\n    JOIN \n        customer_addresses ca ON ca.ca_address_sk = hvc.c_customer_sk\n    JOIN \n        customer_demo cd ON cd.cd_demo_sk = hvc.c_customer_sk\n)\nSELECT \n    ci.c_customer_sk,\n    ci.total_orders,\n    ci.total_spent,\n    ci.avg_order_value,\n    ci.ca_city,\n    ci.ca_state,\n    ci.ca_country,\n    ci.cd_gender,\n    ci.cd_marital_status\nFROM \n    customer_info ci\nORDER BY \n    ci.total_spent DESC\nLIMIT 50;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    SUM(ss.ss_sales_price) AS total_sales,\n    AVG(ws.ws_net_profit) AS avg_web_profit,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count,\n    COUNT(DISTINCT sr.sr_ticket_number) AS total_returns,\n    MAX(d.d_date) AS last_purchase_date\nFROM \n    customer c\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nJOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023 \n    AND ca.ca_state IN ('CA', 'TX', 'NY')\nGROUP BY \n    c.c_first_name, \n    c.c_last_name, \n    ca.ca_city, \n    ca.ca_state\nHAVING \n    SUM(ss.ss_sales_price) > 1000\nORDER BY \n    total_sales DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH customer_totals AS (\n    SELECT \n        c.c_customer_sk, \n        SUM(ws.ws_net_paid) AS total_spent,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        COUNT(DISTINCT ws.ws_ship_date_sk) AS distinct_ship_dates\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\ndate_summary AS (\n    SELECT \n        d.d_year,\n        AVG(ct.total_spent) AS avg_spent,\n        MAX(ct.total_spent) AS max_spent\n    FROM \n        date_dim d\n    JOIN \n        web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\n    JOIN \n        customer_totals ct ON ct.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        d.d_year\n),\nfiltered_customer_totals AS (\n    SELECT \n        c.c_customer_id, \n        ct.total_spent\n    FROM \n        customer c\n    JOIN \n        customer_totals ct ON c.c_customer_sk = ct.c_customer_sk\n    WHERE \n        ct.total_spent IS NOT NULL\n)\nSELECT \n    fct.c_customer_id,\n    fct.total_spent,\n    ds.avg_spent,\n    ds.max_spent,\n    CASE \n        WHEN fct.total_spent IS NULL THEN 'No Spend'\n        WHEN fct.total_spent < ds.avg_spent THEN 'Below Average'\n        ELSE 'Above Average'\n    END AS spending_category\nFROM \n    filtered_customer_totals fct\nCROSS JOIN \n    date_summary ds\nWHERE \n    fct.total_spent > (SELECT AVG(total_spent) FROM customer_totals)\nORDER BY \n    fct.total_spent DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count,\n        AVG(ws.ws_sales_price) AS avg_order_value\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id\n), DailySales AS (\n    SELECT \n        d.d_date,\n        SUM(ws.ws_sales_price) AS total_daily_sales,\n        COUNT(ws.ws_order_number) AS total_orders,\n        COUNT(DISTINCT ws.ws_bill_customer_sk) AS unique_customers\n    FROM \n        date_dim d\n    JOIN \n        web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\n    GROUP BY \n        d.d_date\n), TopProducts AS (\n    SELECT \n        i.i_item_id,\n        SUM(ws.ws_quantity) AS total_quantity_sold\n    FROM \n        item i\n    JOIN \n        web_sales ws ON i.i_item_sk = ws.ws_item_sk\n    GROUP BY \n        i.i_item_id\n    ORDER BY \n        total_quantity_sold DESC\n    LIMIT 10\n)\nSELECT \n    cs.c_customer_id,\n    cs.total_sales,\n    cs.order_count,\n    cs.avg_order_value,\n    ds.d_date,\n    ds.total_daily_sales,\n    ds.total_orders,\n    ds.unique_customers,\n    tp.i_item_id,\n    tp.total_quantity_sold\nFROM \n    CustomerSales cs\nJOIN \n    DailySales ds ON ds.total_daily_sales > 1000\nJOIN \n    TopProducts tp ON tp.total_quantity_sold > 50\nWHERE \n    cs.total_sales > 5000\nORDER BY \n    cs.total_sales DESC, ds.d_date DESC;\n",
  "\nWITH SalesData AS (\n    SELECT\n        w.w_warehouse_name,\n        i.i_category,\n        SUM(ss.ss_quantity) AS total_quantity_sold,\n        SUM(ss.ss_sales_price) AS total_sales_value,\n        AVG(ss.ss_net_profit) AS average_net_profit\n    FROM\n        store_sales ss\n    JOIN\n        warehouse w ON ss.ss_store_sk = w.w_warehouse_sk\n    JOIN\n        item i ON ss.ss_item_sk = i.i_item_sk\n    WHERE\n        ss.ss_sold_date_sk IN (\n            SELECT d_date_sk\n            FROM date_dim\n            WHERE d_year = 2023 AND d_month_seq IN (1, 2, 3) \n        )\n    GROUP BY\n        w.w_warehouse_name,\n        i.i_category\n),\nTopSales AS (\n    SELECT\n        w.w_warehouse_name,\n        i.i_category,\n        SUM(ss.ss_quantity) AS total_quantity,\n        SUM(ss.ss_sales_price) AS total_sales\n    FROM\n        store_sales ss\n    JOIN\n        warehouse w ON ss.ss_store_sk = w.w_warehouse_sk\n    JOIN\n        item i ON ss.ss_item_sk = i.i_item_sk\n    GROUP BY\n        w.w_warehouse_name,\n        i.i_category\n    HAVING\n        SUM(ss.ss_quantity) > 1000\n)\nSELECT\n    sd.w_warehouse_name,\n    sd.i_category,\n    sd.total_quantity_sold,\n    sd.total_sales_value,\n    sd.average_net_profit,\n    ts.total_quantity AS top_category_sales\nFROM\n    SalesData sd\nLEFT JOIN\n    TopSales ts ON sd.w_warehouse_name = ts.w_warehouse_name AND sd.i_category = ts.i_category\nORDER BY\n    sd.total_sales_value DESC,\n    sd.total_quantity_sold DESC;\n",
  "\nWITH customer_data AS (\n    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag, cd.cd_gender, cd.cd_marital_status, \n           cd.cd_purchase_estimate, cd.cd_credit_rating, ca.ca_city, ca.ca_state\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n), \nsales_data AS (\n    SELECT ws.ws_bill_customer_sk, SUM(ws.ws_net_profit) AS total_net_profit\n    FROM web_sales ws\n    GROUP BY ws.ws_bill_customer_sk\n), \nactivity_summary AS (\n    SELECT cd.c_customer_sk, \n           COUNT(DISTINCT ws.ws_order_number) AS total_orders, \n           SUM(ws.ws_quantity) AS total_quantity, \n           SUM(ws.ws_net_paid_inc_tax) AS total_spent\n    FROM web_sales ws\n    JOIN customer_data cd ON ws.ws_bill_customer_sk = cd.c_customer_sk\n    GROUP BY cd.c_customer_sk\n), \nfinal_summary AS (\n    SELECT cs.c_customer_sk, cs.c_first_name, cs.c_last_name, cs.c_preferred_cust_flag, \n           cs.cd_gender, cs.cd_marital_status, cs.cd_purchase_estimate, cs.cd_credit_rating, \n           cs.ca_city, cs.ca_state, \n           asu.total_orders, asu.total_quantity, asu.total_spent, \n           COALESCE(sd.total_net_profit, 0) AS total_web_profit\n    FROM customer_data cs\n    LEFT JOIN activity_summary asu ON cs.c_customer_sk = asu.total_orders\n    LEFT JOIN sales_data sd ON cs.c_customer_sk = sd.ws_bill_customer_sk\n)\nSELECT * \nFROM final_summary \nWHERE total_spent > 1000 AND total_web_profit > 500 \nORDER BY total_spent DESC, total_web_profit DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    SUM(ws.ws_net_profit) AS total_profit,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_paid_inc_tax) AS avg_order_value,\n    COUNT(DISTINCT wr.wr_order_number) AS total_web_returns,\n    COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    d.d_year,\n    d.d_month_seq\nFROM \n    customer c\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nLEFT JOIN \n    web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\nLEFT JOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nLEFT JOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nLEFT JOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, cd.cd_gender, cd.cd_marital_status, d.d_year, d.d_month_seq\nHAVING \n    SUM(ws.ws_net_profit) > 1000 \nORDER BY \n    total_profit DESC\nLIMIT 100;\n",
  "\nWITH customer_data AS (\n    SELECT \n        c.c_customer_id,\n        d.d_date,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count,\n        AVG(ws.ws_net_profit) AS avg_net_profit\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_id, d.d_date\n),\ntop_customers AS (\n    SELECT \n        c.c_customer_id,\n        SUM(cd.total_sales) AS total_sales_per_customer,\n        COUNT(cd.order_count) AS total_orders_per_customer,\n        AVG(cd.avg_net_profit) AS avg_profit_per_customer\n    FROM \n        customer_data cd\n    JOIN \n        customer c ON cd.c_customer_id = c.c_customer_id\n    GROUP BY \n        c.c_customer_id\n    ORDER BY \n        total_sales_per_customer DESC\n    LIMIT 10\n)\nSELECT \n    tc.c_customer_id,\n    tc.total_sales_per_customer,\n    tc.total_orders_per_customer,\n    tc.avg_profit_per_customer,\n    ca.ca_city,\n    ca.ca_state\nFROM \n    top_customers tc\nJOIN \n    customer c ON tc.c_customer_id = c.c_customer_id\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE \n    ca.ca_country = 'USA';\n",
  "\nWITH sales_summary AS (\n    SELECT\n        d.d_year AS sales_year,\n        d.d_month_seq AS sales_month,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        AVG(ws.ws_sales_price) AS avg_sales_price,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_quantity) AS total_quantity\n    FROM\n        web_sales ws\n    JOIN\n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE\n        d.d_year BETWEEN 2021 AND 2023\n    GROUP BY\n        d.d_year, d.d_month_seq\n),\ncustomer_summary AS (\n    SELECT\n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS total_customers,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM\n        customer c\n    JOIN\n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY\n        cd.cd_gender\n),\ntop_items AS (\n    SELECT\n        i.i_item_id,\n        SUM(ws.ws_quantity) AS total_quantity_sold\n    FROM\n        web_sales ws\n    JOIN\n        item i ON ws.ws_item_sk = i.i_item_sk\n    GROUP BY\n        i.i_item_id\n    ORDER BY\n        total_quantity_sold DESC\n    LIMIT 10\n)\nSELECT\n    ss.sales_year,\n    ss.sales_month,\n    ss.total_sales,\n    ss.avg_sales_price,\n    ss.total_orders,\n    ss.total_quantity,\n    cs.total_customers,\n    cs.avg_purchase_estimate,\n    ti.i_item_id,\n    ti.total_quantity_sold\nFROM\n    sales_summary ss\nJOIN\n    customer_summary cs ON ss.sales_year = 2023\nCROSS JOIN\n    top_items ti\nORDER BY\n    ss.sales_year, ss.sales_month;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023 \n        AND cd.cd_gender = 'F'\n        AND cd.cd_marital_status = 'M'\n    GROUP BY \n        ws.ws_sold_date_sk\n),\navg_sales AS (\n    SELECT \n        AVG(total_sales) AS avg_daily_sales,\n        AVG(total_discount) AS avg_daily_discount,\n        AVG(total_orders) AS avg_daily_orders\n    FROM \n        sales_data\n),\ntop_sales_dates AS (\n    SELECT \n        d.d_date AS sales_date,\n        sd.total_sales\n    FROM \n        sales_data sd\n    JOIN \n        date_dim d ON sd.ws_sold_date_sk = d.d_date_sk\n    ORDER BY \n        sd.total_sales DESC\n    LIMIT 5\n)\nSELECT \n    a.avg_daily_sales,\n    a.avg_daily_discount,\n    a.avg_daily_orders,\n    t.sales_date,\n    t.total_sales\nFROM \n    avg_sales a\nJOIN \n    top_sales_dates t ON true;\n",
  "WITH CustomerStats AS (\n    SELECT \n        cd_gender, \n        cd_marital_status, \n        COUNT(DISTINCT c_customer_sk) AS customer_count,\n        SUM(cd_purchase_estimate) AS total_purchase_estimate,\n        AVG(cd_dep_count) AS avg_dependents,\n        AVG(cd_dep_employed_count) AS avg_employed_dependents\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_gender, \n        cd_marital_status\n),\nSalesData AS (\n    SELECT \n        d.d_year, \n        d.d_month_seq, \n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year, \n        d.d_month_seq\n),\nTopSellingItems AS (\n    SELECT \n        i.i_item_id, \n        SUM(ws_ext_sales_price) AS item_sales\n    FROM \n        web_sales\n    JOIN \n        item i ON ws_item_sk = i.i_item_sk\n    GROUP BY \n        i.i_item_id\n    ORDER BY \n        item_sales DESC\n    LIMIT 10\n)\nSELECT \n    cs.cd_gender, \n    cs.cd_marital_status, \n    cs.customer_count, \n    cs.total_purchase_estimate, \n    cs.avg_dependents, \n    sd.d_year, \n    sd.d_month_seq, \n    sd.total_sales, \n    sd.total_orders, \n    tsi.i_item_id, \n    tsi.item_sales\nFROM \n    CustomerStats cs\nJOIN \n    SalesData sd ON EXTRACT(YEAR FROM cast('2002-10-01' as date)) = sd.d_year \n                   AND EXTRACT(MONTH FROM cast('2002-10-01' as date)) = sd.d_month_seq\nCROSS JOIN \n    TopSellingItems tsi\nWHERE \n    cs.customer_count > 50 \nORDER BY \n    cs.total_purchase_estimate DESC, \n    sd.total_sales DESC;",
  "\nWITH CustomerDetails AS (\n    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nSalesData AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        ws.ws_quantity,\n        ws.ws_sales_price,\n        ws.ws_net_profit,\n        dd.d_date\n    FROM web_sales ws\n    JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE dd.d_year = 2023\n),\nProfitAggregates AS (\n    SELECT \n        cd.c_customer_sk,\n        SUM(sd.ws_net_profit) AS total_profit,\n        COUNT(sd.ws_item_sk) AS total_sales\n    FROM CustomerDetails cd\n    JOIN SalesData sd ON cd.c_customer_sk = sd.ws_item_sk\n    GROUP BY cd.c_customer_sk\n)\nSELECT \n    cd.c_first_name,\n    cd.c_last_name,\n    ca.ca_city,\n    ca.ca_state,\n    pa.total_profit,\n    pa.total_sales\nFROM CustomerDetails cd\nJOIN customer_address ca ON cd.c_customer_sk = ca.ca_address_sk\nJOIN ProfitAggregates pa ON cd.c_customer_sk = pa.c_customer_sk\nWHERE pa.total_profit > 1000\nORDER BY pa.total_profit DESC\nLIMIT 10;\n",
  "WITH sales_summary AS (\n    SELECT \n        d.d_year,\n        SUM(ws.ws_net_paid) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_quantity) AS total_quantity,\n        COUNT(DISTINCT ws.ws_ship_customer_sk) AS unique_customers\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n),\ncustomer_summary AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS total_customers,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd.cd_dep_count) AS total_dependents\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n),\ntop_products AS (\n    SELECT \n        i.i_item_id,\n        i.i_item_desc,\n        SUM(ws.ws_quantity) AS total_quantity_sold\n    FROM \n        item i\n    JOIN \n        web_sales ws ON i.i_item_sk = ws.ws_item_sk\n    GROUP BY \n        i.i_item_id, i.i_item_desc\n    ORDER BY \n        total_quantity_sold DESC\n    LIMIT 10\n)\nSELECT \n    ss.d_year,\n    ss.total_sales,\n    ss.total_orders,\n    ss.total_quantity,\n    ss.unique_customers,\n    cs.cd_gender,\n    cs.total_customers,\n    cs.avg_purchase_estimate,\n    cs.total_dependents,\n    tp.i_item_id,\n    tp.i_item_desc,\n    tp.total_quantity_sold\nFROM \n    sales_summary ss\nJOIN \n    customer_summary cs ON TRUE \nJOIN \n    top_products tp ON TRUE \nORDER BY \n    ss.d_year, cs.cd_gender, tp.total_quantity_sold DESC;",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        web_sales ws\n    INNER JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    INNER JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    INNER JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    INNER JOIN \n        item i ON ws.ws_item_sk = i.i_item_sk\n    WHERE \n        dd.d_year = 2023 \n        AND cd.cd_gender = 'F' \n        AND cd.cd_marital_status = 'M' \n        AND i.i_brand = 'BrandX'\n    GROUP BY \n        ws.ws_sold_date_sk\n),\nDailyStats AS (\n    SELECT \n        d.d_date AS sale_date,\n        COALESCE(sd.total_quantity, 0) AS total_quantity,\n        COALESCE(sd.total_sales, 0) AS total_sales,\n        COALESCE(sd.total_discount, 0) AS total_discount,\n        COALESCE(sd.total_profit, 0) AS total_profit,\n        (COALESCE(sd.total_sales, 0) - COALESCE(sd.total_discount, 0)) AS net_sales\n    FROM \n        date_dim d\n    LEFT JOIN \n        SalesData sd ON d.d_date_sk = sd.ws_sold_date_sk\n    WHERE \n        d.d_year = 2023\n)\nSELECT \n    sale_date,\n    total_quantity,\n    total_sales,\n    total_discount,\n    total_profit,\n    net_sales\nFROM \n    DailyStats\nORDER BY \n    sale_date;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ci.c_customer_id,\n        SUM(ws.ws_net_paid_inc_tax) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_sales_price) AS avg_sales_price,\n        COUNT(DISTINCT ws.ws_item_sk) AS unique_items_purchased\n    FROM \n        web_sales ws\n    JOIN \n        customer ci ON ws.ws_bill_customer_sk = ci.c_customer_sk\n    JOIN \n        customer_demographics cd ON ci.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023 AND \n        cd.cd_marital_status = 'M'\n    GROUP BY \n        ci.c_customer_id\n),\nhigh_value_customers AS (\n    SELECT \n        css.c_customer_id,\n        css.total_sales,\n        css.total_orders,\n        css.avg_sales_price,\n        css.unique_items_purchased\n    FROM \n        sales_summary css\n    WHERE \n        css.total_sales > (\n            SELECT \n                AVG(total_sales) \n            FROM \n                sales_summary\n        )\n)\nSELECT \n    hvc.c_customer_id,\n    hvc.total_sales,\n    hvc.total_orders,\n    hvc.avg_sales_price,\n    hvc.unique_items_purchased,\n    cd.cd_gender,\n    cd.cd_credit_rating,\n    cd.cd_education_status\nFROM \n    high_value_customers hvc\nJOIN \n    customer ci ON hvc.c_customer_id = ci.c_customer_id\nJOIN \n    customer_demographics cd ON ci.c_current_cdemo_sk = cd.cd_demo_sk\nORDER BY \n    hvc.total_sales DESC\nLIMIT 100;\n",
  "\nWITH enriched_data AS (\n    SELECT \n        c.c_customer_sk,\n        CONCAT(c.c_first_name, ' ', c.c_last_name) AS full_name,\n        ca.ca_city,\n        ca.ca_state,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        d.d_date AS order_date,\n        t.t_hour AS order_hour,\n        ws.ws_sales_price,\n        ws.ws_quantity\n    FROM \n        customer c\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    JOIN \n        time_dim t ON ws.ws_sold_time_sk = t.t_time_sk\n    WHERE \n        ws.ws_sales_price > 100.00\n        AND d.d_year = 2023\n),\ncity_analysis AS (\n    SELECT \n        ca_city,\n        ca_state,\n        COUNT(DISTINCT c_customer_sk) AS customer_count,\n        SUM(ws_sales_price) AS total_sales,\n        AVG(ws_sales_price) AS avg_sales\n    FROM \n        enriched_data\n    GROUP BY \n        ca_city, ca_state\n)\nSELECT \n    ca_city,\n    ca_state,\n    customer_count,\n    total_sales,\n    avg_sales,\n    CASE \n        WHEN total_sales >= 10000 THEN 'High Revenue'\n        WHEN total_sales BETWEEN 5000 AND 9999 THEN 'Medium Revenue'\n        ELSE 'Low Revenue'\n    END AS revenue_category\nFROM \n    city_analysis\nORDER BY \n    total_sales DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_quantity) AS total_quantity_sold,\n    SUM(ss.ss_ext_sales_price) AS total_sales_amount,\n    AVG(ws.ws_net_profit) AS average_web_profit,\n    d.d_year,\n    d.d_month_seq,\n    w.w_warehouse_name,\n    sm.sm_type\nFROM \n    customer c \nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk \nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \nJOIN \n    warehouse w ON ss.ss_store_sk = w.w_warehouse_sk \nJOIN \n    ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk \nWHERE \n    d.d_year = 2023 \nAND \n    c.c_preferred_cust_flag = 'Y' \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year, d.d_month_seq, w.w_warehouse_name, sm.sm_type \nORDER BY \n    total_sales_amount DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_net_paid) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    AVG(ws.ws_net_paid) AS average_order_value,\n    d.d_year,\n    ca.ca_city,\n    CASE \n        WHEN cd.cd_gender = 'M' THEN 'Male'\n        WHEN cd.cd_gender = 'F' THEN 'Female'\n        ELSE 'Other' \n    END AS gender,\n    cd.cd_marital_status,\n    COUNT(DISTINCT wr.wr_order_number) AS total_web_returns,\n    SUM(wr.wr_return_amt) AS total_web_return_amount\nFROM \n    customer AS c \nJOIN \n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nLEFT JOIN \n    web_returns AS wr ON c.c_customer_sk = wr.wr_returning_customer_sk \nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year, ca.ca_city, cd.cd_gender, cd.cd_marital_status\nORDER BY \n    total_sales DESC, average_order_value DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_order_count,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_order_count,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_order_count\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\ndemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_credit_rating,\n        ca.ca_country\n    FROM \n        customer_demographics cd\n    JOIN \n        customer_address ca ON cd.cd_demo_sk = ca.ca_address_sk\n),\nsummary AS (\n    SELECT \n        cs.c_customer_sk,\n        d.cd_gender,\n        d.cd_marital_status,\n        d.cd_education_status,\n        d.cd_credit_rating,\n        cs.total_web_sales,\n        cs.total_catalog_sales,\n        cs.total_store_sales,\n        cs.web_order_count,\n        cs.catalog_order_count,\n        cs.store_order_count,\n        CASE \n            WHEN cs.total_web_sales + cs.total_catalog_sales + cs.total_store_sales > 1000 THEN 'High Value'\n            WHEN cs.total_web_sales + cs.total_catalog_sales + cs.total_store_sales BETWEEN 500 AND 1000 THEN 'Medium Value'\n            ELSE 'Low Value'\n        END AS customer_value\n    FROM \n        customer_sales cs\n    JOIN \n        demographics d ON cs.c_customer_sk = d.cd_demo_sk\n)\nSELECT \n    customer_value,\n    COUNT(*) AS customer_count,\n    AVG(total_web_sales) AS avg_web_sales,\n    AVG(total_catalog_sales) AS avg_catalog_sales,\n    AVG(total_store_sales) AS avg_store_sales\nFROM \n    summary\nGROUP BY \n    customer_value\nORDER BY \n    customer_value;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_sales_price) AS avg_sales_price,\n        MAX(ws.ws_net_profit) AS max_net_profit,\n        MIN(ws.ws_net_profit) AS min_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023 AND\n        cd.cd_gender = 'F' AND\n        cd.cd_marital_status = 'M'\n    GROUP BY \n        c.c_customer_id\n), gender_summary AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS num_customers,\n        SUM(ss.total_sales) AS total_sales_by_gender,\n        AVG(ss.avg_sales_price) AS avg_sales_price_by_gender\n    FROM \n        sales_summary ss\n    JOIN \n        customer c ON ss.c_customer_id = c.c_customer_id\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n)\nSELECT \n    gs.cd_gender,\n    gs.num_customers,\n    gs.total_sales_by_gender,\n    gs.avg_sales_price_by_gender\nFROM \n    gender_summary gs\nORDER BY \n    gs.total_sales_by_gender DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS order_count,\n        AVG(ws_sales_price) AS avg_sales_price,\n        CAST(d.d_date AS DATE) AS sales_date\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        d.d_year = 2023 AND cd.cd_gender = 'M'\n    GROUP BY \n        CAST(d.d_date AS DATE)\n),\nInventoryData AS (\n    SELECT \n        SUM(inv_quantity_on_hand) AS total_inventory,\n        i.i_item_id\n    FROM \n        inventory inv\n    JOIN \n        item i ON inv.inv_item_sk = i.i_item_sk\n    GROUP BY \n        i.i_item_id\n)\nSELECT \n    sd.sales_date,\n    sd.total_sales,\n    sd.order_count,\n    sd.avg_sales_price,\n    id.total_inventory\nFROM \n    SalesData sd\nLEFT JOIN \n    InventoryData id ON id.i_item_id IN (SELECT DISTINCT i.i_item_id FROM item i)\nORDER BY \n    sd.sales_date DESC\nLIMIT 100;\n",
  "WITH CustomerDemographics AS (\n    SELECT cd_demo_sk, \n           cd_gender, \n           cd_marital_status, \n           cd_education_status, \n           cd_purchase_estimate, \n           cd_credit_rating, \n           cd_dep_count, \n           cd_dep_employed_count, \n           cd_dep_college_count\n    FROM customer_demographics\n    WHERE cd_marital_status = 'M'\n), CustomerDetails AS (\n    SELECT c.c_customer_sk, \n           c.c_first_name, \n           c.c_last_name, \n           ca.ca_city, \n           ca.ca_state, \n           ca.ca_country, \n           cd.cd_gender, \n           cd.cd_purchase_estimate\n    FROM customer c\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN CustomerDemographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n), DateFiltered AS (\n    SELECT d.d_date, \n           d.d_year, \n           COUNT(ws.ws_order_number) AS total_orders,\n           SUM(ws.ws_sales_price) AS total_sales\n    FROM web_sales ws\n    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE d.d_year = 2001\n    GROUP BY d.d_date, d.d_year\n), SalesByCustomer AS (\n    SELECT cd.c_customer_sk, \n           cd.c_first_name, \n           cd.c_last_name, \n           cd.ca_city, \n           cd.ca_state, \n           SUM(ws.ws_sales_price) AS customer_sales\n    FROM CustomerDetails cd\n    JOIN web_sales ws ON cd.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY cd.c_customer_sk, cd.c_first_name, cd.c_last_name, cd.ca_city, cd.ca_state\n), FinalReport AS (\n    SELECT dbc.d_date AS Sales_Date, \n           dbc.total_orders, \n           dbc.total_sales, \n           sbc.c_customer_sk, \n           sbc.c_first_name, \n           sbc.c_last_name, \n           sbc.ca_city, \n           sbc.ca_state, \n           sbc.customer_sales\n    FROM DateFiltered dbc\n    JOIN SalesByCustomer sbc ON dbc.d_date = cast('2002-10-01' as date) \n)\nSELECT * \nFROM FinalReport\nORDER BY total_sales DESC, customer_sales DESC;",
  "\nWITH CustomerLocation AS (\n    SELECT \n        ca_city, \n        ca_state, \n        COUNT(DISTINCT c_customer_sk) AS customer_count \n    FROM \n        customer_address \n    JOIN \n        customer ON ca_address_sk = c_current_addr_sk \n    GROUP BY \n        ca_city, ca_state\n), CustomerDemographics AS (\n    SELECT \n        cd_gender, \n        cd_marital_status, \n        COUNT(DISTINCT c_customer_sk) AS demographic_count \n    FROM \n        customer_demographics \n    JOIN \n        customer ON cd_demo_sk = c_current_cdemo_sk \n    GROUP BY \n        cd_gender, cd_marital_status\n), SalesData AS (\n    SELECT \n        d_year, \n        SUM(ws_net_profit) AS total_profit \n    FROM \n        web_sales \n    JOIN \n        date_dim ON ws_sold_date_sk = d_date_sk \n    GROUP BY \n        d_year\n), TopCities AS (\n    SELECT \n        ca_city, ca_state, customer_count \n    FROM \n        CustomerLocation \n    ORDER BY \n        customer_count DESC \n    LIMIT 10\n)\n\nSELECT \n    t.d_year, \n    t.total_profit, \n    c.ca_city, \n    c.ca_state, \n    d.cd_gender, \n    d.cd_marital_status, \n    d.demographic_count \nFROM \n    SalesData t \nJOIN \n    TopCities c ON c.customer_count > 0 \nJOIN \n    CustomerDemographics d ON d.demographic_count > 0 \nORDER BY \n    t.d_year, c.ca_city;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_paid) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        ws.ws_sold_date_sk IS NOT NULL\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nHighSpenders AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cs.total_sales,\n        cs.total_orders\n    FROM \n        CustomerSales cs\n    JOIN \n        customer c ON cs.c_customer_sk = c.c_customer_sk\n    WHERE \n        cs.total_sales > (\n            SELECT AVG(total_sales) FROM CustomerSales\n        )\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating,\n        cd.cd_dep_count,\n        cd.cd_dep_employed_count,\n        ib.ib_income_band_sk\n    FROM \n        customer_demographics cd\n    LEFT JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n),\nFinalReport AS (\n    SELECT \n        hs.c_customer_sk,\n        hs.c_first_name,\n        hs.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating,\n        cd.cd_dep_count,\n        cd.cd_dep_employed_count,\n        COALESCE(cd.ib_income_band_sk, -1) AS income_band,\n        hs.total_sales,\n        hs.total_orders\n    FROM \n        HighSpenders hs\n    LEFT JOIN \n        CustomerDemographics cd ON hs.c_customer_sk = cd.cd_demo_sk\n)\nSELECT \n    *,\n    CASE \n        WHEN total_sales > 10000 THEN 'High Value Customer'\n        WHEN total_sales > 5000 THEN 'Medium Value Customer'\n        ELSE 'Low Value Customer'\n    END AS customer_segment\nFROM \n    FinalReport\nORDER BY \n    total_sales DESC;\n",
  "\nWITH recent_sales AS (\n    SELECT \n        ss_store_sk,\n        SUM(ss_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ss_ticket_number) AS total_sales_count\n    FROM store_sales\n    WHERE ss_sold_date_sk BETWEEN (\n        SELECT MAX(d_date_sk) - 30 \n        FROM date_dim \n        WHERE d_current_month = 'Y'\n    ) AND (\n        SELECT MAX(d_date_sk) \n        FROM date_dim \n        WHERE d_current_month = 'Y'\n    )\n    GROUP BY ss_store_sk\n),\naverage_profit AS (\n    SELECT \n        AVG(total_net_profit) AS avg_net_profit \n    FROM recent_sales\n),\npromotional_sales AS (\n    SELECT \n        cs_promo_sk,\n        SUM(cs_net_profit) AS promo_net_profit\n    FROM catalog_sales\n    GROUP BY cs_promo_sk\n),\ninventory_status AS (\n    SELECT \n        inv_warehouse_sk,\n        SUM(inv_quantity_on_hand) AS total_quantity\n    FROM inventory\n    GROUP BY inv_warehouse_sk\n)\nSELECT \n    w.w_warehouse_name,\n    inv.total_quantity,\n    COALESCE(s.total_net_profit, 0) AS store_net_profit,\n    CASE \n        WHEN s.total_net_profit > a.avg_net_profit THEN 'Above Average'\n        WHEN s.total_net_profit = a.avg_net_profit THEN 'Average'\n        ELSE 'Below Average'\n    END AS profit_comparison,\n    p.promo_net_profit\nFROM warehouse w\nLEFT JOIN (\n    SELECT \n        r.ss_store_sk,\n        SUM(r.ss_net_profit) AS total_net_profit\n    FROM store_sales r\n    JOIN recent_sales s ON r.ss_store_sk = s.ss_store_sk\n    GROUP BY r.ss_store_sk\n) s ON w.w_warehouse_sk = s.ss_store_sk\nJOIN inventory_status inv ON w.w_warehouse_sk = inv.inv_warehouse_sk\nCROSS JOIN average_profit a\nLEFT JOIN promotional_sales p ON p.cs_promo_sk = (\n    SELECT cs_promo_sk \n    FROM catalog_sales \n    GROUP BY cs_promo_sk\n    ORDER BY SUM(cs_net_profit) DESC\n    LIMIT 1\n)\nWHERE inv.total_quantity > 0 \nAND (s.total_net_profit IS NULL OR s.total_net_profit <> 0)\nORDER BY w.w_warehouse_name;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_purchase_estimate,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_net_paid) AS total_spent,\n    AVG(ws.ws_net_profit) AS average_profit,\n    d.d_year,\n    w.w_warehouse_name,\n    sm.sm_carrier\nFROM \n    customer c\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN \n    warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\nJOIN \n    ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk\nWHERE \n    d.d_year = 2023 \n    AND cd.cd_gender = 'F' \n    AND cd.cd_marital_status = 'M'\nGROUP BY \n    c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate, d.d_year, w.w_warehouse_name, sm.sm_carrier\nHAVING \n    SUM(ws.ws_quantity) > 100\nORDER BY \n    total_spent DESC;\n",
  "\nWITH CustomerGroups AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_sk) AS customer_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer AS c\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_gender\n),\nSalesSummary AS (\n    SELECT \n        d.d_year,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_net_profit\n    FROM \n        web_sales AS ws\n    JOIN \n        date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n),\nWarehouseStats AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(inv_quantity_on_hand) AS total_inventory\n    FROM \n        warehouse AS w\n    JOIN \n        inventory AS inv ON w.w_warehouse_sk = inv.inv_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n),\nFinalReport AS (\n    SELECT \n        cg.cd_gender,\n        cs.total_sales,\n        cs.total_net_profit,\n        ws.total_inventory\n    FROM \n        CustomerGroups AS cg\n    JOIN \n        SalesSummary AS cs ON 1=1\n    JOIN \n        WarehouseStats AS ws ON 1=1\n)\nSELECT \n    cd_gender,\n    total_sales,\n    total_net_profit,\n    total_inventory\nFROM \n    FinalReport\nORDER BY \n    cd_gender;\n",
  "\nWITH CustomerDetails AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_education_status \n    FROM \n        customer c \n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n), \n\nSalesData AS (\n    SELECT \n        ws.ws_sold_date_sk, \n        ws.ws_item_sk, \n        SUM(ws.ws_quantity) AS total_quantity, \n        SUM(ws.ws_sales_price) AS total_sales \n    FROM \n        web_sales ws \n    GROUP BY \n        ws.ws_sold_date_sk, \n        ws.ws_item_sk\n), \n\nDailySales AS (\n    SELECT \n        dd.d_date_sk,\n        dd.d_date,\n        SUM(sd.total_quantity) AS daily_total_quantity,\n        SUM(sd.total_sales) AS daily_total_sales \n    FROM \n        date_dim dd\n    JOIN \n        SalesData sd ON dd.d_date_sk = sd.ws_sold_date_sk \n    GROUP BY \n        dd.d_date_sk, \n        dd.d_date\n), \n\nTopCustomers AS (\n    SELECT \n        cd.c_customer_sk, \n        cd.c_first_name, \n        cd.c_last_name, \n        SUM(ds.daily_total_sales) AS total_spent \n    FROM \n        CustomerDetails cd \n    JOIN \n        web_sales ws ON cd.c_customer_sk = ws.ws_bill_customer_sk \n    JOIN \n        DailySales ds ON ws.ws_sold_date_sk = ds.d_date_sk \n    GROUP BY \n        cd.c_customer_sk, \n        cd.c_first_name, \n        cd.c_last_name \n    ORDER BY \n        total_spent DESC \n    LIMIT 10\n)\n\nSELECT \n    tc.c_customer_sk, \n    tc.c_first_name, \n    tc.c_last_name, \n    tc.total_spent, \n    ds.daily_total_quantity, \n    ds.daily_total_sales \nFROM \n    TopCustomers tc \nJOIN \n    DailySales ds ON tc.c_customer_sk = ds.d_date_sk \nORDER BY \n    tc.total_spent DESC, \n    ds.daily_total_sales DESC;\n",
  "\nWITH customer_return_stats AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(CASE WHEN sr_return_quantity > 0 THEN sr_return_quantity ELSE 0 END) AS total_returns,\n        SUM(CASE WHEN sr_return_quantity > 0 THEN sr_return_amt ELSE 0 END) AS total_return_amount,\n        COUNT(DISTINCT sr_ticket_number) AS return_count,\n        COALESCE(AVG(CASE WHEN sr_return_quantity > 0 THEN sr_return_amt_inc_tax END), 0) AS avg_return_value\n    FROM \n        customer c\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name\n),\nwarehouse_inventory AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(i.inv_quantity_on_hand) AS total_inventory\n    FROM \n        warehouse w\n    JOIN \n        inventory i ON w.w_warehouse_sk = i.inv_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n),\ntop_customers AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        cs.cs_item_sk,\n        SUM(cs.cs_quantity) AS total_purchases\n    FROM \n        customer c\n    JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name, cs.cs_item_sk\n    ORDER BY \n        total_purchases DESC\n    LIMIT 10\n)\nSELECT\n    cr.c_customer_id,\n    cr.c_first_name,\n    cr.c_last_name,\n    cr.total_returns,\n    cr.total_return_amount,\n    cr.return_count,\n    cr.avg_return_value,\n    wi.w_warehouse_id AS warehouse_id,\n    wi.total_inventory,\n    tc.total_purchases\nFROM \n    customer_return_stats cr\nJOIN \n    warehouse_inventory wi ON cr.total_returns > 0\nJOIN \n    top_customers tc ON cr.c_customer_id = tc.c_customer_id\nWHERE \n    cr.total_return_amount > 1000\nORDER BY \n    cr.total_return_amount DESC, tc.total_purchases DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        d.d_year AS sales_year,\n        d.d_month_seq AS sales_month,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        d.d_year = 2023 AND \n        (cd.cd_gender = 'F' OR cd.cd_gender = 'M')\n    GROUP BY \n        d.d_year, d.d_month_seq\n), warehouse_summary AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory\n    FROM \n        warehouse w\n    JOIN \n        inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    ss.sales_year,\n    ss.sales_month,\n    ss.total_sales,\n    ss.total_discount,\n    ss.total_orders,\n    ws.total_inventory\nFROM \n    sales_summary ss\nJOIN \n    warehouse_summary ws ON ss.sales_year = 2023\nORDER BY \n    ss.sales_month;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        cr_returning_customer_sk,\n        COUNT(cr_order_number) AS return_count,\n        SUM(cr_return_amount) AS total_return_amount,\n        SUM(cr_return_tax) AS total_return_tax\n    FROM catalog_returns\n    GROUP BY cr_returning_customer_sk\n),\nWebSalesAggregated AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_paid) AS total_net_paid,\n        COUNT(ws_order_number) AS order_count,\n        AVG(ws_net_profit) AS avg_net_profit\n    FROM web_sales\n    GROUP BY ws_bill_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        ca.ca_state\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    WHERE cd.cd_purchase_estimate > (\n        SELECT AVG(cd_purchase_estimate) \n        FROM customer_demographics \n        WHERE cd_gender = 'F'\n    )\n),\nReturningCustomers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(cr.return_count, 0) AS return_count,\n        COALESCE(wsa.total_net_paid, 0) AS total_net_paid,\n        COALESCE(wsa.order_count, 0) AS order_count\n    FROM customer c\n    LEFT JOIN CustomerReturns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\n    LEFT JOIN WebSalesAggregated wsa ON c.c_customer_sk = wsa.ws_bill_customer_sk\n),\nFinalResults AS (\n    SELECT \n        rc.c_customer_sk,\n        rc.c_first_name,\n        rc.c_last_name,\n        rc.return_count,\n        rc.total_net_paid,\n        rc.order_count,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.ca_state,\n        CASE \n            WHEN rc.order_count = 0 THEN NULL \n            ELSE rc.total_net_paid / NULLIF(rc.order_count, 0)\n        END AS avg_spent_per_order\n    FROM ReturningCustomers rc\n    JOIN CustomerDemographics cd ON rc.c_customer_sk = cd.c_customer_sk\n)\nSELECT \n    fr.c_customer_sk,\n    fr.c_first_name,\n    fr.c_last_name,\n    fr.return_count,\n    fr.total_net_paid,\n    fr.order_count,\n    fr.cd_gender,\n    fr.cd_marital_status,\n    fr.ca_state,\n    fr.avg_spent_per_order,\n    CASE \n        WHEN fr.return_count > 5 THEN 'Frequent Returner' \n        WHEN fr.return_count IS NULL THEN 'No Returns'\n        ELSE 'Occasional Returner' \n    END AS return_category\nFROM FinalResults fr\nWHERE (fr.return_count >= (SELECT AVG(return_count) FROM FinalResults) OR fr.total_net_paid > 1000)\nAND fr.cd_gender IS NOT NULL\nORDER BY fr.total_net_paid DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_id,\n        c.c_current_addr_sk,\n        SUM(COALESCE(ss.ss_ext_sales_price, 0)) AS total_store_sales,\n        SUM(COALESCE(ws.ws_ext_sales_price, 0)) AS total_web_sales\n    FROM \n        customer c\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY \n        c.c_customer_id, c.c_current_addr_sk\n),\nhigh_value_customers AS (\n    SELECT \n        cs.c_customer_id,\n        cs.c_current_addr_sk,\n        (cs.total_store_sales + cs.total_web_sales) AS total_sales\n    FROM \n        customer_sales cs\n    WHERE \n        (cs.total_store_sales + cs.total_web_sales) > (\n            SELECT \n                AVG(total_sales)\n            FROM \n                (\n                    SELECT \n                        (SUM(COALESCE(ss.ss_ext_sales_price, 0)) + \n                         SUM(COALESCE(ws.ws_ext_sales_price, 0))) AS total_sales\n                    FROM \n                        customer c\n                    LEFT JOIN \n                        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n                    LEFT JOIN \n                        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n                    GROUP BY \n                        c.c_customer_id\n                ) AS avg_sales\n        )\n),\naddress_details AS (\n    SELECT \n        ca.ca_address_id,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_address_sk\n    FROM \n        customer_address ca\n)\nSELECT \n    hvc.c_customer_id,\n    ad.ca_address_id,\n    ad.ca_city,\n    ad.ca_state,\n    hvc.total_sales\nFROM \n    high_value_customers hvc\nJOIN \n    address_details ad ON hvc.c_current_addr_sk = ad.ca_address_sk\nORDER BY \n    hvc.total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        cd.cd_dep_count\n    FROM \n        customer_demographics cd\n),\nSalesStatistics AS (\n    SELECT \n        cs.c_customer_sk,\n        SUM(cs.total_web_sales + cs.total_catalog_sales + cs.total_store_sales) AS total_sales,\n        COUNT(DISTINCT cd.cd_demo_sk) AS demo_count\n    FROM \n        CustomerSales cs\n    JOIN \n        CustomerDemographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    GROUP BY \n        cs.c_customer_sk\n)\nSELECT \n    s.c_customer_sk,\n    s.total_sales,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    CASE \n        WHEN s.total_sales > 1000 THEN 'High Value'\n        WHEN s.total_sales > 500 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_category\nFROM \n    SalesStatistics s\nJOIN \n    CustomerDemographics cd ON s.c_customer_sk = cd.cd_demo_sk\nORDER BY \n    s.total_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH CustomerSpending AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_net_paid_inc_tax) AS total_spent,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        AVG(ws.ws_net_paid_inc_tax) AS average_order_value\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nHighSpenders AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_spent,\n        cs.order_count,\n        cs.average_order_value,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        CustomerSpending cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    WHERE \n        cs.total_spent > 5000\n),\nTopProducts AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_sold\n    FROM \n        web_sales ws\n    JOIN \n        HighSpenders hs ON ws.ws_bill_customer_sk = hs.c_customer_sk\n    GROUP BY \n        ws.ws_item_sk\n    ORDER BY \n        total_sold DESC\n    LIMIT 10\n)\nSELECT \n    p.i_item_id,\n    p.i_item_desc,\n    tp.total_sold,\n    hs.average_order_value,\n    hs.cd_gender,\n    hs.cd_marital_status,\n    hs.cd_education_status\nFROM \n    item p\nJOIN \n    TopProducts tp ON p.i_item_sk = tp.ws_item_sk\nJOIN \n    HighSpenders hs ON tp.total_sold > 0\nORDER BY \n    tp.total_sold DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        cd.cd_gender,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023 \n        AND cd.cd_marital_status = 'M'\n    GROUP BY \n        cd.cd_gender\n),\ninventory_summary AS (\n    SELECT \n        inv.inv_item_sk,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory\n    FROM \n        inventory inv\n    GROUP BY \n        inv.inv_item_sk\n),\nprofit_analysis AS (\n    SELECT \n        iss.i_item_sk,\n        iss.i_item_id,\n        COALESCE(ss.total_quantity, 0) AS total_sales_quantity,\n        COALESCE(ss.total_profit, 0) AS total_sales_profit,\n        COALESCE(isu.total_inventory, 0) AS total_inventory\n    FROM \n        item iss\n    LEFT JOIN \n        sales_summary ss ON iss.i_item_sk = ss.total_quantity\n    LEFT JOIN \n        inventory_summary isu ON iss.i_item_sk = isu.inv_item_sk\n)\nSELECT \n    pa.i_item_id,\n    pa.total_sales_quantity,\n    pa.total_sales_profit,\n    pa.total_inventory,\n    (CASE \n        WHEN pa.total_inventory = 0 THEN 0 \n        ELSE pa.total_sales_profit / pa.total_inventory \n    END) AS profit_per_inventory_unit\nFROM \n    profit_analysis pa\nORDER BY \n    profit_per_inventory_unit DESC\nLIMIT 10;\n",
  "\nWITH sale_data AS (\n    SELECT \n        ss.ss_store_sk,\n        SUM(ss.ss_quantity) AS total_sales_quantity,\n        SUM(ss.ss_sales_price) AS total_sales_price,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n        SUM(ss.ss_net_profit) AS total_net_profit\n    FROM \n        store_sales ss\n    JOIN \n        date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\n    JOIN \n        customer c ON ss.ss_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound\n    WHERE \n        dd.d_year = 2001\n        AND dd.d_moy IN (11, 12)\n        AND cd.cd_gender = 'M'\n    GROUP BY \n        ss.ss_store_sk\n),\nwarehouse_data AS (\n    SELECT \n        w.w_warehouse_sk,\n        w.w_warehouse_name,\n        SUM(s.total_sales_quantity) AS warehouse_total_sales_quantity,\n        SUM(s.total_sales_price) AS warehouse_total_sales_price,\n        SUM(s.total_net_profit) AS warehouse_total_net_profit\n    FROM \n        warehouse w\n    LEFT JOIN \n        sale_data s ON w.w_warehouse_sk = s.ss_store_sk\n    GROUP BY \n        w.w_warehouse_sk, w.w_warehouse_name\n)\nSELECT \n    w.w_warehouse_name AS warehouse_name,\n    w.warehouse_total_sales_quantity,\n    w.warehouse_total_sales_price,\n    w.warehouse_total_net_profit,\n    (w.warehouse_total_net_profit / NULLIF(w.warehouse_total_sales_price, 0)) * 100 AS profit_margin_percentage\nFROM \n    warehouse_data w\nORDER BY \n    w.warehouse_total_net_profit DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        d.d_year = 2023 AND \n        cd.cd_gender = 'F' AND \n        cd.cd_marital_status = 'M'\n    GROUP BY \n        ws.ws_sold_date_sk\n),\ninventory_data AS (\n    SELECT \n        inv.inv_item_sk,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory\n    FROM \n        inventory inv\n    GROUP BY \n        inv.inv_item_sk\n),\nsales_inventory AS (\n    SELECT \n        sd.ws_sold_date_sk,\n        sd.total_quantity,\n        sd.total_sales,\n        sd.order_count,\n        id.total_inventory\n    FROM \n        sales_data sd\n    LEFT JOIN \n        inventory_data id ON sd.ws_sold_date_sk = id.inv_item_sk\n)\n\nSELECT \n    d.d_date AS sale_date,\n    si.total_quantity,\n    si.total_sales,\n    si.order_count,\n    si.total_inventory,\n    CASE \n        WHEN si.total_quantity > 0 THEN \n            ROUND((si.total_sales / si.total_quantity), 2) \n        ELSE 0 END AS average_sale_price\nFROM \n    sales_inventory si\nJOIN \n    date_dim d ON si.ws_sold_date_sk = d.d_date_sk\nORDER BY \n    d.d_date;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales\n    FROM \n        customer c \n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\ncustomer_details AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        c.c_customer_sk\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nsales_comparison AS (\n    SELECT \n        cs.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cs.total_store_sales,\n        cs.total_web_sales,\n        COALESCE(cs.total_store_sales, 0) - COALESCE(cs.total_web_sales, 0) AS sales_difference\n    FROM \n        customer_sales cs\n    JOIN \n        customer_details cd ON cs.c_customer_sk = cd.c_customer_sk\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    COUNT(*) AS customer_count,\n    AVG(sc.sales_difference) AS avg_sales_difference,\n    MAX(sc.total_store_sales) AS max_store_sales,\n    MAX(sc.total_web_sales) AS max_web_sales\nFROM \n    sales_comparison sc\nJOIN \n    customer_details cd ON sc.c_customer_sk = cd.c_customer_sk\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status\nORDER BY \n    avg_sales_difference DESC, customer_count DESC\nLIMIT 10;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        hd.hd_income_band_sk,\n        SUM(COALESCE(ss.ss_quantity, 0)) AS total_store_sales,\n        SUM(COALESCE(ws.ws_quantity, 0)) AS total_web_sales\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, \n        cd.cd_marital_status, cd.cd_purchase_estimate, cd.cd_credit_rating, \n        hd.hd_income_band_sk\n),\ntop_customers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        (total_store_sales + total_web_sales) AS total_sales\n    FROM \n        customer_summary c\n    ORDER BY \n        total_sales DESC\n    LIMIT 10\n)\nSELECT \n    tc.c_customer_sk,\n    tc.c_first_name,\n    tc.c_last_name,\n    tc.total_sales\nFROM \n    top_customers tc\nJOIN \n    customer_summary cs ON tc.c_customer_sk = cs.c_customer_sk;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_spent,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        CASE\n            WHEN COUNT(DISTINCT ws.ws_order_number) IS NULL THEN 'No Orders'\n            ELSE 'Orders Present'\n        END AS order_status\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nincome_distribution AS (\n    SELECT \n        h.hd_income_band_sk,\n        COUNT(c.c_customer_sk) AS income_count,\n        COALESCE(AVG(cs.total_spent), 0) AS avg_income_spent\n    FROM \n        household_demographics h\n    LEFT JOIN \n        customer c ON h.hd_demo_sk = c.c_current_cdemo_sk\n    LEFT JOIN \n        customer_sales cs ON c.c_customer_sk = cs.c_customer_sk\n    GROUP BY \n        h.hd_income_band_sk\n),\nhigh_value_customers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.total_spent\n    FROM \n        customer_sales cs\n    WHERE \n        cs.total_spent > (\n            SELECT \n                AVG(total_spent) \n            FROM \n                customer_sales\n        )\n)\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    COALESCE(i.income_count, 0) AS customer_income_count,\n    COALESCE(i.avg_income_spent, 0) AS avg_income_internet_spent,\n    CASE \n        WHEN hv.total_spent IS NOT NULL THEN 'High Value'\n        ELSE 'Regular'\n    END AS customer_status\nFROM \n    customer c\nLEFT JOIN \n    income_distribution i ON c.c_current_cdemo_sk = i.hd_income_band_sk\nLEFT JOIN \n    high_value_customers hv ON c.c_customer_sk = hv.c_customer_sk\nWHERE \n    (i.income_count IS NOT NULL OR hv.total_spent IS NOT NULL)\nORDER BY \n    c.c_last_name ASC, \n    c.c_first_name ASC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        COUNT(c.c_customer_sk) AS number_of_customers,\n        AVG(CASE WHEN cd.cd_gender = 'F' THEN 1 ELSE 0 END) AS female_ratio,\n        AVG(CASE WHEN cd.cd_marital_status = 'M' THEN 1 ELSE 0 END) AS married_ratio\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    GROUP BY \n        cd.cd_demo_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.total_web_sales,\n    cs.total_catalog_sales,\n    cs.total_store_sales,\n    d.number_of_customers,\n    d.female_ratio,\n    d.married_ratio\nFROM \n    CustomerSales cs\nJOIN \n    Demographics d ON cs.c_customer_sk = d.cd_demo_sk\nWHERE \n    cs.total_web_sales > 1000 OR cs.total_catalog_sales > 1000 OR cs.total_store_sales > 1000\nORDER BY \n    cs.total_web_sales DESC, cs.total_catalog_sales DESC, cs.total_store_sales DESC\nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    d.d_year,\n    d.d_month_seq,\n    ca.ca_city,\n    ca.ca_state,\n    cd.cd_marital_status,\n    cd.cd_gender,\n    hd.hd_buy_potential\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\nWHERE d.d_year = 2023\nAND ca.ca_state = 'CA'\nAND cd.cd_marital_status = 'M'\nGROUP BY \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    d.d_year,\n    d.d_month_seq,\n    ca.ca_city,\n    ca.ca_state,\n    cd.cd_marital_status,\n    cd.cd_gender,\n    hd.hd_buy_potential\nORDER BY total_sales DESC\nLIMIT 10;\n",
  "WITH daily_sales AS (\n    SELECT \n        dd.d_date AS sale_date,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_profit) AS avg_profit\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    GROUP BY \n        dd.d_date\n),\ncustomer_summary AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS total_customers,\n        SUM(cd.cd_purchase_estimate) AS total_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n),\nwarehouse_sales AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_ext_sales_price) AS warehouse_sales\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    ds.sale_date,\n    ds.total_sales,\n    ds.total_orders,\n    ds.avg_profit,\n    cs.total_customers,\n    cs.total_purchase_estimate,\n    ws.warehouse_sales\nFROM \n    daily_sales ds\nJOIN \n    customer_summary cs ON ds.sale_date BETWEEN '2001-01-01' AND '2001-12-31'\nJOIN \n    warehouse_sales ws ON ds.sale_date = '2001-01-01'  \nORDER BY \n    ds.sale_date DESC;",
  "WITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk\n), StoreSales AS (\n    SELECT \n        s.s_store_sk,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_store_orders\n    FROM \n        store s\n    JOIN \n        store_sales ss ON s.s_store_sk = ss.ss_store_sk\n    GROUP BY \n        s.s_store_sk\n), CombinedSales AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_web_sales,\n        cs.total_orders,\n        ss.s_store_sk,\n        ss.total_store_sales,\n        ss.total_store_orders\n    FROM \n        CustomerSales cs\n    JOIN \n        store s ON cs.c_customer_sk = s.s_store_sk \n    JOIN \n        StoreSales ss ON s.s_store_sk = ss.s_store_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.total_web_sales,\n    cs.total_orders,\n    ss.total_store_sales,\n    ss.total_store_orders,\n    (COALESCE(cs.total_web_sales, 0) + COALESCE(ss.total_store_sales, 0)) AS total_sales,\n    (COALESCE(cs.total_orders, 0) + COALESCE(ss.total_store_orders, 0)) AS total_orders_count\nFROM \n    CombinedSales cs\nLEFT JOIN \n    StoreSales ss ON cs.s_store_sk = ss.s_store_sk\nORDER BY \n    total_sales DESC\nLIMIT 10;",
  "\nWITH sales_summary AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_sales_price) AS avg_sales_price,\n        MAX(ws.ws_sold_date_sk) AS last_sale_date\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        w.w_warehouse_id\n),\ncustomer_summary AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender\n),\njoin_summary AS (\n    SELECT \n        ss.w_warehouse_id,\n        cs.cd_gender,\n        ss.total_net_profit,\n        cs.total_net_profit AS customer_net_profit,\n        ss.total_orders,\n        ss.avg_sales_price,\n        ss.last_sale_date\n    FROM \n        sales_summary ss\n    JOIN \n        customer_summary cs ON ss.total_net_profit = cs.total_net_profit\n)\nSELECT \n    j.w_warehouse_id,\n    j.cd_gender,\n    j.total_net_profit,\n    j.customer_net_profit,\n    j.total_orders,\n    j.avg_sales_price,\n    j.last_sale_date\nFROM \n    join_summary j\nWHERE \n    j.total_net_profit > 1000\nORDER BY \n    j.total_net_profit DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        w.w_warehouse_name,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_quantity) AS total_quantity\n    FROM \n        web_sales ws\n    INNER JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    INNER JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        ws.ws_sold_date_sk, w.w_warehouse_name\n),\ncustomer_summary AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        SUM(cs.cs_net_profit) AS total_profit\n    FROM \n        customer_demographics cd\n    INNER JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    INNER JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    GROUP BY \n        cd.cd_gender\n)\nSELECT \n    ss.ws_sold_date_sk,\n    ss.w_warehouse_name,\n    ss.total_sales,\n    ss.total_discount,\n    cs.cd_gender,\n    cs.customer_count,\n    cs.total_profit\nFROM \n    sales_summary ss\nLEFT JOIN \n    customer_summary cs ON ss.ws_sold_date_sk = cs.customer_count\nORDER BY \n    ss.ws_sold_date_sk, ss.total_sales DESC;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ws.ws_net_profit) AS total_profit,\n        COUNT(DISTINCT c.c_customer_id) AS customer_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2022\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n),\nWarehouseStats AS (\n    SELECT \n        w.w_warehouse_id,\n        COUNT(DISTINCT ws.ws_order_number) AS orders_count,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.total_profit AS customer_total_profit,\n    cs.customer_count,\n    ws.w_warehouse_id,\n    ws.orders_count,\n    ws.total_profit AS warehouse_total_profit\nFROM \n    CustomerStats cs\nJOIN \n    WarehouseStats ws ON cs.total_profit > ws.total_profit\nWHERE \n    cs.total_profit > 10000 \nORDER BY \n    cs.total_profit DESC, ws.total_profit ASC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_ext_sales_price) AS total_sales,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    d.d_year,\n    d.d_month_seq,\n    d.d_quarter_seq,\n    p.p_promo_id,\n    sm.sm_type AS shipping_mode,\n    ca.ca_city,\n    ca.ca_state\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN \n    promotion p ON ws.ws_promo_sk = p.p_promo_sk\nJOIN \n    ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE \n    d.d_year = 2023 \n    AND p.p_discount_active = 'Y'\n    AND ca.ca_state IN ('CA', 'NY')\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year, d.d_month_seq, d.d_quarter_seq, p.p_promo_id, sm.sm_type, ca.ca_city, ca.ca_state\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM\n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023 AND dd.d_month_seq IN (1, 2, 3)\n    GROUP BY\n        ws.ws_item_sk\n),\nreturns_summary AS (\n    SELECT\n        wr.wr_item_sk,\n        SUM(wr.wr_return_quantity) AS total_return_quantity,\n        SUM(wr.wr_net_loss) AS total_return_loss\n    FROM\n        web_returns wr\n    JOIN \n        date_dim dd ON wr.wr_returned_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY\n        wr.wr_item_sk\n),\ninventory_status AS (\n    SELECT\n        inv.inv_item_sk,\n        MAX(inv.inv_quantity_on_hand) AS max_quantity_on_hand\n    FROM\n        inventory inv\n    GROUP BY\n        inv.inv_item_sk\n)\nSELECT\n    it.i_item_id,\n    it.i_item_desc,\n    COALESCE(ss.total_quantity, 0) AS web_sales_quantity,\n    COALESCE(ss.total_net_profit, 0) AS web_sales_net_profit,\n    COALESCE(rs.total_return_quantity, 0) AS web_return_quantity,\n    COALESCE(rs.total_return_loss, 0) AS web_return_loss,\n    iv.max_quantity_on_hand\nFROM\n    item it\nLEFT JOIN\n    sales_summary ss ON it.i_item_sk = ss.ws_item_sk\nLEFT JOIN\n    returns_summary rs ON it.i_item_sk = rs.wr_item_sk\nLEFT JOIN\n    inventory_status iv ON it.i_item_sk = iv.inv_item_sk\nWHERE\n    (COALESCE(ss.total_quantity, 0) - COALESCE(rs.total_return_quantity, 0)) > iv.max_quantity_on_hand\nORDER BY\n    web_sales_net_profit DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH SalesSummary AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        AVG(ws.ws_net_paid_inc_tax) AS avg_net_paid,\n        MAX(ws.ws_net_profit) AS max_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_ship_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_site w ON ws.ws_web_site_sk = w.web_site_sk\n    WHERE \n        cd.cd_gender = 'F' AND \n        cd.cd_marital_status = 'M' AND \n        ws.ws_sold_date_sk BETWEEN 2459918 AND 2459890\n    GROUP BY \n        ws.ws_sold_date_sk\n),\nDailyReturns AS (\n    SELECT \n        wr.wr_returned_date_sk,\n        SUM(wr.wr_return_amt) AS total_return_amt,\n        COUNT(DISTINCT wr.wr_order_number) AS return_count\n    FROM \n        web_returns wr\n    WHERE \n        wr.wr_returned_date_sk IS NOT NULL\n    GROUP BY \n        wr.wr_returned_date_sk\n),\nCombinedResults AS (\n    SELECT \n        ds.d_date AS sale_date,\n        ss.total_sales,\n        ss.order_count,\n        ss.avg_net_paid,\n        r.total_return_amt,\n        r.return_count\n    FROM \n        SalesSummary ss\n    JOIN \n        date_dim ds ON ss.ws_sold_date_sk = ds.d_date_sk\n    LEFT JOIN \n        DailyReturns r ON ss.ws_sold_date_sk = r.wr_returned_date_sk\n)\nSELECT \n    sale_date,\n    COALESCE(total_sales, 0) AS total_sales,\n    COALESCE(order_count, 0) AS order_count,\n    COALESCE(avg_net_paid, 0) AS avg_net_paid,\n    COALESCE(total_return_amt, 0) AS total_return_amt,\n    COALESCE(return_count, 0) AS return_count,\n    (COALESCE(total_sales, 0) - COALESCE(total_return_amt, 0)) AS net_sales\nFROM \n    CombinedResults\nWHERE \n    (COALESCE(total_sales, 0) - COALESCE(total_return_amt, 0)) > 1000\nORDER BY \n    net_sales DESC;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_profit) AS total_profit,\n        SUM(ws.ws_quantity) AS total_quantity\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nWarehouseStats AS (\n    SELECT \n        w.w_warehouse_sk,\n        SUM(COALESCE(ws.ws_net_profit, 0)) AS warehouse_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS warehouse_orders\n    FROM \n        warehouse w\n    LEFT JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_sk\n),\nPromotionStats AS (\n    SELECT \n        p.p_promo_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS promo_orders,\n        SUM(ws.ws_net_profit) AS promo_profit\n    FROM \n        promotion p\n    LEFT JOIN \n        web_sales ws ON p.p_promo_sk = ws.ws_promo_sk\n    GROUP BY \n        p.p_promo_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.total_orders,\n    cs.total_profit,\n    ws.warehouse_profit,\n    ws.warehouse_orders,\n    ps.promo_orders,\n    ps.promo_profit\nFROM \n    CustomerStats cs\nJOIN \n    WarehouseStats ws ON cs.total_orders > 0\nJOIN \n    PromotionStats ps ON cs.total_orders > 0\nORDER BY \n    cs.total_profit DESC, cs.total_orders DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    GROUP BY \n        c.c_customer_id\n), \nHighValueCustomers AS (\n    SELECT \n        cs.c_customer_id, \n        cs.total_sales, \n        cs.total_orders\n    FROM \n        CustomerSales cs\n    WHERE \n        cs.total_sales > 10000\n), \nCustomerDemographics AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        AVG(hd.hd_income_band_sk) AS avg_income_band\n    FROM \n        HighValueCustomers hvc\n    JOIN \n        customer c ON hvc.c_customer_id = c.c_customer_id\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    GROUP BY \n        cd.cd_gender, \n        cd.cd_marital_status\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.avg_income_band,\n    COUNT(hvc.c_customer_id) AS total_high_value_customers\nFROM \n    CustomerDemographics cd\nJOIN \n    HighValueCustomers hvc ON cd.cd_gender = hvc.c_customer_id\nGROUP BY \n    cd.cd_gender, \n    cd.cd_marital_status, \n    cd.avg_income_band\nORDER BY \n    total_high_value_customers DESC;\n",
  "WITH MonthlySales AS (\n    SELECT \n        d.d_year AS SalesYear,\n        d.d_month_seq AS SalesMonth,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS TotalSales\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year, d.d_month_seq\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT c.c_customer_sk) AS CustomerCount\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n),\nWarehouseInventory AS (\n    SELECT \n        i.i_item_sk,\n        SUM(inv.inv_quantity_on_hand) AS TotalInventory\n    FROM \n        inventory inv\n    JOIN \n        item i ON inv.inv_item_sk = i.i_item_sk\n    GROUP BY \n        i.i_item_sk\n)\nSELECT \n    ms.SalesYear,\n    ms.SalesMonth,\n    ms.TotalSales,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.CustomerCount,\n    wi.TotalInventory\nFROM \n    MonthlySales ms\nJOIN \n    CustomerDemographics cd ON 1=1  \nJOIN \n    WarehouseInventory wi ON 1=1     \nWHERE \n    ms.TotalSales > 0\nORDER BY \n    ms.SalesYear, ms.SalesMonth, cd.cd_gender, cd.cd_marital_status;",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\naddress_summary AS (\n    SELECT \n        cga.ca_city,\n        cga.ca_state,\n        COUNT(DISTINCT cs.c_customer_id) AS customer_count,\n        SUM(cs.total_sales) AS total_sales_by_city\n    FROM \n        customer_address cga\n    JOIN \n        customer c ON c.c_current_addr_sk = cga.ca_address_sk\n    JOIN \n        customer_summary cs ON c.c_customer_id = cs.c_customer_id\n    GROUP BY \n        cga.ca_city, cga.ca_state\n),\nzipcode_summary AS (\n    SELECT \n        cga.ca_zip,\n        COUNT(DISTINCT cga.ca_address_sk) AS address_count,\n        SUM(asbs.total_sales_by_city) AS total_sales_by_zip\n    FROM \n        customer_address cga\n    JOIN \n        address_summary asbs ON cga.ca_city = asbs.ca_city AND cga.ca_state = asbs.ca_state\n    GROUP BY \n        cga.ca_zip\n)\nSELECT \n    zs.ca_zip,\n    zs.address_count,\n    zs.total_sales_by_zip\nFROM \n    zipcode_summary zs\nWHERE \n    zs.total_sales_by_zip > 10000\nORDER BY \n    zs.total_sales_by_zip DESC\nLIMIT 10;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales, \n    COUNT(DISTINCT ws.ws_order_number) AS total_orders, \n    AVG(ws.ws_net_profit) AS avg_net_profit,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    cd.cd_credit_rating,\n    ca.ca_city,\n    ca.ca_state,\n    d.d_year,\n    w.w_warehouse_name\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN \n    warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\nWHERE \n    d.d_year = 2023 AND \n    w.w_state = 'CA'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, \n    cd.cd_credit_rating, ca.ca_city, ca.ca_state, d.d_year, w.w_warehouse_name\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerWithReturns AS (\n    SELECT \n        c.c_customer_id,\n        COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns,\n        COUNT(DISTINCT wr.wr_order_number) AS total_web_returns,\n        SUM(COALESCE(sr.sr_return_amt, 0) + COALESCE(wr.wr_return_amt, 0)) AS total_return_amount\n    FROM customer c\n    LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    GROUP BY c.c_customer_id\n),\nSalesSummary AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales\n    FROM customer c\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY c.c_customer_id\n),\nFinalReport AS (\n    SELECT \n        csr.c_customer_id,\n        csr.total_store_returns,\n        csr.total_web_returns,\n        csr.total_return_amount,\n        ss.total_store_sales,\n        ss.total_web_sales,\n        (COALESCE(ss.total_store_sales, 0) + COALESCE(ss.total_web_sales, 0)) AS total_sales,\n        (COALESCE(ss.total_store_sales, 0) + COALESCE(ss.total_web_sales, 0) - COALESCE(csr.total_return_amount, 0)) AS net_sales\n    FROM CustomerWithReturns csr\n    JOIN SalesSummary ss ON csr.c_customer_id = ss.c_customer_id\n)\nSELECT \n    c_customer_id AS customer_id,\n    total_store_returns,\n    total_web_returns,\n    total_return_amount,\n    total_sales,\n    net_sales,\n    (CASE \n        WHEN total_sales > 0 THEN (net_sales * 100.0 / total_sales) \n        ELSE 0 \n    END) AS return_percentage\nFROM FinalReport\nORDER BY net_sales DESC\nLIMIT 10;\n",
  "\nWITH customer_stats AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_sk) AS total_customers,\n        SUM(cd_dep_count) AS avg_deps,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer\n    JOIN \n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY \n        cd_gender\n),\nsales_summary AS (\n    SELECT \n        d_year,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit\n    FROM \n        web_sales\n    JOIN \n        date_dim ON ws_sold_date_sk = d_date_sk\n    GROUP BY \n        d_year\n),\nwarehouse_stats AS (\n    SELECT \n        w_warehouse_id,\n        SUM(inv_quantity_on_hand) AS total_inventory\n    FROM \n        inventory\n    JOIN \n        warehouse ON inv_warehouse_sk = w_warehouse_sk\n    GROUP BY \n        w_warehouse_id\n)\nSELECT \n    cs.cd_gender,\n    cs.total_customers,\n    cs.avg_deps,\n    ss.d_year,\n    ss.total_sales,\n    ss.total_profit,\n    ws.w_warehouse_id,\n    ws.total_inventory\nFROM \n    customer_stats cs\nJOIN \n    sales_summary ss ON 1=1\nJOIN \n    warehouse_stats ws ON 1=1\nORDER BY \n    cs.cd_gender, ss.d_year;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT s.ss_ticket_number) AS total_sales,\n        SUM(s.ss_net_profit) AS total_profit,\n        SUM(s.ss_quantity) AS total_quantity,\n        AVG(s.ss_sales_price) AS avg_sales_price\n    FROM \n        customer c\n    LEFT JOIN \n        store_sales s ON c.c_customer_sk = s.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nActiveCustomers AS (\n    SELECT \n        ca.ca_address_sk,\n        COUNT(DISTINCT cs.c_customer_sk) AS active_customer_count\n    FROM \n        customer_address ca\n    JOIN \n        customer c ON ca.ca_address_sk = c.c_current_addr_sk\n    JOIN \n        CustomerStats cs ON c.c_customer_sk = cs.c_customer_sk\n    WHERE \n        cs.total_sales > 0\n    GROUP BY \n        ca.ca_address_sk\n),\nSalesData AS (\n    SELECT \n        dd.d_year,\n        dd.d_month_seq,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        AVG(ws.ws_net_profit) AS average_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    GROUP BY \n        dd.d_year, dd.d_month_seq\n)\nSELECT \n    ac.ca_address_sk,\n    ac.active_customer_count,\n    sd.d_year,\n    sd.d_month_seq,\n    sd.total_web_sales,\n    sd.average_net_profit\nFROM \n    ActiveCustomers ac\nJOIN \n    SalesData sd ON sd.d_year >= (SELECT MAX(d_year) - 1 FROM SalesData)\nORDER BY \n    ac.active_customer_count DESC, sd.total_web_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        AVG(ws.ws_net_profit) AS avg_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        w.w_warehouse_id\n),\nCustomerData AS (\n    SELECT \n        cd.cd_gender,\n        SUM(CASE WHEN cs.cs_quantity IS NOT NULL THEN cs.cs_quantity ELSE 0 END) AS total_quantity,\n        SUM(CASE WHEN cs.cs_sales_price IS NOT NULL THEN cs.cs_sales_price ELSE 0 END) AS total_sales\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    WHERE \n        cd.cd_marital_status = 'M'\n    GROUP BY \n        cd.cd_gender\n)\nSELECT \n    sd.w_warehouse_id,\n    sd.total_quantity,\n    sd.total_sales,\n    sd.order_count,\n    sd.avg_net_profit,\n    cd.cd_gender,\n    cd.total_quantity AS customer_total_quantity,\n    cd.total_sales AS customer_total_sales\nFROM \n    SalesData sd\nJOIN \n    CustomerData cd ON sd.total_quantity > 1000\nORDER BY \n    sd.total_sales DESC, \n    cd.cd_gender;\n",
  "\nWITH sales_summary AS (\n    SELECT\n        w.w_warehouse_id,\n        SUM(COALESCE(ss.ss_net_profit, 0)) AS total_net_profit,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n        SUM(ss.ss_quantity) AS total_quantity_sold\n    FROM\n        store_sales ss\n    JOIN\n        store s ON ss.ss_store_sk = s.s_store_sk\n    JOIN\n        warehouse w ON s.s_company_id = w.w_warehouse_sk\n    WHERE\n        ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n                             AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY\n        w.w_warehouse_id\n),\ncustomer_info AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(COALESCE(ws.ws_net_profit, 0)) AS customer_net_profit\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status\n),\nanalytics AS (\n    SELECT \n        cs.c_customer_id,\n        cs.cd_gender,\n        cs.cd_marital_status,\n        cs.customer_net_profit,\n        ss.total_net_profit,\n        ss.total_sales,\n        ss.total_quantity_sold,\n        (cs.customer_net_profit / NULLIF(ss.total_sales, 0)) AS avg_profit_per_sale\n    FROM \n        customer_info cs\n    JOIN \n        sales_summary ss ON cs.customer_net_profit > (ss.total_net_profit * 0.1)\n)\nSELECT \n    a.c_customer_id,\n    a.cd_gender,\n    a.cd_marital_status,\n    a.customer_net_profit,\n    a.total_net_profit,\n    a.total_sales,\n    a.total_quantity_sold,\n    CASE \n        WHEN a.avg_profit_per_sale IS NULL THEN 'No Sales'\n        ELSE CAST(a.avg_profit_per_sale AS VARCHAR)\n    END AS avg_profit_per_sale_formatted\nFROM \n    analytics a\nWHERE \n    a.customer_net_profit < (SELECT AVG(customer_net_profit) FROM customer_info)\nORDER BY \n    a.total_net_profit DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nincome_summary AS (\n    SELECT \n        hd.hd_income_band_sk,\n        COUNT(DISTINCT cs.c_customer_sk) AS customer_count,\n        SUM(cs.total_web_sales) AS total_web_sales,\n        SUM(cs.total_catalog_sales) AS total_catalog_sales,\n        SUM(cs.total_store_sales) AS total_store_sales\n    FROM \n        household_demographics hd\n    JOIN \n        customer_sales cs ON hd.hd_demo_sk = cs.c_customer_sk\n    GROUP BY \n        hd.hd_income_band_sk\n)\nSELECT \n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    COALESCE(income_summary.customer_count, 0) AS customer_count,\n    COALESCE(income_summary.total_web_sales, 0) AS total_web_sales,\n    COALESCE(income_summary.total_catalog_sales, 0) AS total_catalog_sales,\n    COALESCE(income_summary.total_store_sales, 0) AS total_store_sales\nFROM \n    income_band ib\nLEFT JOIN \n    income_summary ON ib.ib_income_band_sk = income_summary.hd_income_band_sk\nWHERE \n    ib.ib_lower_bound IS NOT NULL\nORDER BY \n    ib.ib_lower_bound;\n",
  "\nWITH TotalSales AS (\n    SELECT \n        d.d_year,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_ext_discount_amt) AS total_discount,\n        SUM(ws_ext_tax) AS total_tax,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM \n        web_sales \n    JOIN \n        date_dim d ON ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n),\nCustomerDemoStats AS (\n    SELECT \n        cd_marital_status,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c \n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_marital_status\n),\nWarehouseSales AS (\n    SELECT \n        w.w_warehouse_name,\n        SUM(ws_ext_sales_price) AS warehouse_sales\n    FROM \n        web_sales ws \n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        w.w_warehouse_name\n)\nSELECT \n    ts.d_year,\n    ts.total_sales,\n    ts.total_discount,\n    ts.total_tax,\n    ts.total_orders,\n    cds.cd_marital_status,\n    cds.customer_count,\n    cds.avg_purchase_estimate,\n    wws.warehouse_sales\nFROM \n    TotalSales ts\nJOIN \n    CustomerDemoStats cds ON ts.d_year = (SELECT MAX(d_year) FROM TotalSales)\nJOIN \n    WarehouseSales wws ON wws.warehouse_sales = (SELECT MAX(warehouse_sales) FROM WarehouseSales)\nORDER BY \n    ts.d_year DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        AVG(ws_net_profit) AS average_profit\n    FROM\n        web_sales\n    WHERE\n        ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\n    GROUP BY \n        ws_bill_customer_sk\n),\nCustomerInfo AS (\n    SELECT\n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        d.d_year,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound,\n        hd.hd_buy_potential\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    JOIN \n        date_dim d ON c.c_birth_year = d.d_year\n),\nFinalResults AS (\n    SELECT \n        ci.c_customer_sk,\n        ci.c_first_name,\n        ci.c_last_name,\n        ci.cd_gender,\n        ci.cd_marital_status,\n        ci.cd_education_status,\n        sa.total_sales,\n        sa.total_orders,\n        sa.average_profit,\n        ci.ib_lower_bound,\n        ci.ib_upper_bound,\n        ci.hd_buy_potential\n    FROM \n        CustomerInfo ci\n    LEFT JOIN \n        SalesData sa ON ci.c_customer_sk = sa.ws_bill_customer_sk\n)\nSELECT \n    cd_gender AS gender,\n    cd_marital_status AS marital_status,\n    cd_education_status AS education_status,\n    COUNT(*) AS customer_count,\n    SUM(total_sales) AS grand_total_sales,\n    AVG(total_orders) AS avg_orders_per_customer,\n    AVG(average_profit) AS avg_profit_per_customer \nFROM \n    FinalResults\nWHERE \n    total_sales > 0\nGROUP BY \n    cd_gender, cd_marital_status, cd_education_status\nORDER BY \n    grand_total_sales DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        AVG(ws.ws_quantity) AS avg_quantity_per_order\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nDemographicAnalysis AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        AVG(cs.total_net_profit) AS avg_net_profit_per_demo,\n        SUM(cs.total_orders) AS total_orders_per_demo\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status\n),\nStatewiseProfit AS (\n    SELECT \n        ca.ca_state,\n        SUM(cs.total_net_profit) AS state_net_profit,\n        COUNT(DISTINCT cs.c_customer_sk) AS unique_customers\n    FROM \n        customer_address ca\n    JOIN \n        customer c ON ca.ca_address_sk = c.c_current_addr_sk\n    JOIN \n        CustomerSales cs ON c.c_customer_sk = cs.c_customer_sk\n    GROUP BY \n        ca.ca_state\n)\nSELECT \n    d.cd_gender,\n    d.cd_marital_status,\n    s.ca_state,\n    d.avg_net_profit_per_demo,\n    s.state_net_profit,\n    s.unique_customers\nFROM \n    DemographicAnalysis d\nJOIN \n    StatewiseProfit s ON s.unique_customers > 0\nORDER BY \n    s.state_net_profit DESC, d.avg_net_profit_per_demo DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_order_number,\n        ws.ws_quantity,\n        ws.ws_sales_price,\n        ws.ws_ext_sales_price,\n        ws.ws_ship_date_sk,\n        d.d_date as ship_date,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        st.s_store_name,\n        sm.sm_carrier\n    FROM web_sales ws\n    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN date_dim d ON ws.ws_ship_date_sk = d.d_date_sk\n    JOIN store st ON ws.ws_ship_addr_sk = st.s_store_sk\n    JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk\n    WHERE d.d_year = 2023 AND d.d_moy IN (11, 12)\n),\nAggregatedSales AS (\n    SELECT \n        ship_date,\n        c_first_name,\n        c_last_name,\n        cd_gender,\n        cd_marital_status,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(ws_order_number) AS order_count\n    FROM SalesData\n    GROUP BY \n        ship_date,\n        c_first_name,\n        c_last_name,\n        cd_gender,\n        cd_marital_status\n)\nSELECT \n    ship_date,\n    cd_gender,\n    cd_marital_status,\n    COUNT(DISTINCT c_first_name || ' ' || c_last_name) AS unique_customers,\n    SUM(total_quantity) AS total_items_sold,\n    SUM(total_sales) AS total_revenue\nFROM AggregatedSales\nGROUP BY \n    ship_date, cd_gender, cd_marital_status\nORDER BY \n    ship_date,\n    cd_gender,\n    cd_marital_status;\n",
  "\nWITH customer_info AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        h.hd_income_band_sk,\n        h.hd_buy_potential,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_ext_sales_price) AS total_sales\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN household_demographics h ON c.c_current_hdemo_sk = h.hd_demo_sk\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE cd.cd_gender = 'M' \n    AND h.hd_income_band_sk IS NOT NULL\n    GROUP BY c.c_customer_id, cd.cd_gender, cd.cd_marital_status, h.hd_income_band_sk, h.hd_buy_potential\n),\nsales_data AS (\n    SELECT \n        d.d_year,\n        d.d_month_seq,\n        SUM(ws.ws_ext_sales_price) AS monthly_sales\n    FROM web_sales ws\n    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY d.d_year, d.d_month_seq\n)\nSELECT \n    ci.c_customer_id,\n    ci.cd_gender,\n    ci.cd_marital_status,\n    ci.hd_buy_potential,\n    COALESCE(sd.monthly_sales, 0) AS average_monthly_sales,\n    ci.total_orders\nFROM customer_info ci\nLEFT JOIN sales_data sd ON ci.total_sales > 0\nORDER BY ci.total_orders DESC, average_monthly_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH CustomerSpend AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_net_paid) AS total_spent,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM customer c\n    JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE c.c_current_cdemo_sk IS NOT NULL\n    GROUP BY c.c_customer_sk\n),\nHighSpenders AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_spent,\n        cs.total_orders,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM CustomerSpend cs\n    JOIN customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    WHERE cs.total_spent > 1000\n),\nMonthlySales AS (\n    SELECT \n        d.d_month_seq,\n        SUM(ws.ws_ext_sales_price) AS total_monthly_sales\n    FROM web_sales ws\n    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY d.d_month_seq\n),\nGenderSales AS (\n    SELECT \n        hs.cd_gender,\n        SUM(ms.total_monthly_sales) AS total_sales_by_gender\n    FROM HighSpenders hs\n    JOIN MonthlySales ms ON hs.c_customer_sk = hs.c_customer_sk\n    GROUP BY hs.cd_gender\n)\nSELECT \n    gs.cd_gender,\n    gs.total_sales_by_gender,\n    COUNT(hs.c_customer_sk) AS number_of_high_spenders\nFROM GenderSales gs\nJOIN HighSpenders hs ON gs.cd_gender = hs.cd_gender\nGROUP BY gs.cd_gender, gs.total_sales_by_gender\nORDER BY gs.total_sales_by_gender DESC;\n",
  "\nWITH CustomerData AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        hd.hd_income_band_sk,\n        SUM(ss.ss_quantity) AS total_quantity,\n        SUM(ss.ss_net_paid) AS total_spent\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, \n        cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, \n        cd.cd_credit_rating, hd.hd_income_band_sk\n), DateSales AS (\n    SELECT \n        d.d_year,\n        SUM(ws.ws_ext_sales_price) AS yearly_sales\n    FROM \n        web_sales ws \n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n), FinalReport AS (\n    SELECT \n        cd.c_customer_sk,\n        cd.c_first_name,\n        cd.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.total_quantity,\n        cd.total_spent,\n        ds.yearly_sales\n    FROM \n        CustomerData cd\n    LEFT JOIN \n        DateSales ds ON cd.hd_income_band_sk = ds.d_year\n)\nSELECT \n    *,\n    CASE \n        WHEN total_spent > 10000 THEN 'High Value'\n        WHEN total_spent BETWEEN 5000 AND 10000 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_category\nFROM \n    FinalReport\nWHERE \n    total_quantity > 10 AND \n    cd_gender = 'F'\nORDER BY \n    total_spent DESC\nLIMIT 100;\n",
  "\nWITH MonthlySales AS (\n    SELECT \n        d_year,\n        d_month_seq,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit\n    FROM \n        web_sales \n    JOIN \n        date_dim ON ws_sold_date_sk = d_date_sk\n    GROUP BY \n        d_year, d_month_seq\n),\nCustomerDemographics AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_sk) AS customer_count,\n        SUM(cd_dep_count) AS total_dependents\n    FROM \n        customer \n    JOIN \n        customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY \n        cd_gender\n),\nWarehouseSales AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws_ext_sales_price) AS warehouse_sales\n    FROM \n        web_sales AS ws\n    JOIN \n        warehouse AS w ON ws_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    m.d_year,\n    m.d_month_seq,\n    m.total_sales,\n    m.total_profit,\n    cd.cd_gender,\n    cd.customer_count,\n    cd.total_dependents,\n    ws.warehouse_sales\nFROM \n    MonthlySales m\nJOIN \n    CustomerDemographics cd ON cd.customer_count > 0\nJOIN \n    WarehouseSales ws ON ws.warehouse_sales > 0\nORDER BY \n    m.d_year, m.d_month_seq, ws.warehouse_sales DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_profit) AS total_profit,\n        SUM(ws.ws_net_paid_inc_tax) AS total_revenue\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk\n), \nHighValueCustomers AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_orders,\n        cs.total_profit,\n        cs.total_revenue,\n        cd.cd_gender,\n        hd.hd_income_band_sk\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    LEFT JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    WHERE \n        cs.total_profit > 1000 AND cs.total_orders > 5\n), \nDateRange AS (\n    SELECT \n        d.d_date_sk, \n        d.d_year \n    FROM \n        date_dim d\n    WHERE \n        d.d_date BETWEEN '2022-01-01' AND '2022-12-31'\n), \nSalesSummary AS (\n    SELECT \n        dr.d_year,\n        SUM(c.total_revenue) AS year_revenue,\n        COUNT(c.c_customer_sk) AS number_of_customers\n    FROM \n        DateRange dr\n    JOIN \n        web_sales ws ON dr.d_date_sk = ws.ws_sold_date_sk\n    JOIN \n        HighValueCustomers c ON ws.ws_ship_customer_sk = c.c_customer_sk \n    GROUP BY \n        dr.d_year\n)\nSELECT \n    ss.d_year, \n    ss.year_revenue, \n    ss.number_of_customers,\n    ROUND(ss.year_revenue / NULLIF(ss.number_of_customers, 0), 2) AS avg_revenue_per_customer\nFROM \n    SalesSummary ss\nORDER BY \n    ss.year_revenue DESC;\n",
  "WITH sales_summary AS (\n    SELECT\n        w.w_warehouse_id,\n        d.d_year,\n        SUM(ws.ws_sales_price) AS total_sales,\n        AVG(ws.ws_net_profit) AS avg_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM\n        web_sales ws\n    JOIN\n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN\n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE\n        d.d_year BETWEEN 1998 AND 2001\n    GROUP BY\n        w.w_warehouse_id, d.d_year\n),\ndemographic_summary AS (\n    SELECT\n        cd.cd_gender,\n        hd.hd_income_band_sk,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(ws.ws_quantity) AS total_items_sold\n    FROM\n        customer_demographics cd\n    JOIN\n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    JOIN\n        web_sales ws ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk\n    GROUP BY\n        cd.cd_gender, hd.hd_income_band_sk\n)\nSELECT\n    s.w_warehouse_id,\n    s.d_year,\n    s.total_sales,\n    s.avg_net_profit,\n    d.cd_gender,\n    d.hd_income_band_sk,\n    d.avg_purchase_estimate,\n    d.total_items_sold\nFROM\n    sales_summary s\nJOIN\n    demographic_summary d ON s.d_year = 2000 \nORDER BY\n    s.total_sales DESC, d.avg_purchase_estimate DESC;",
  "\nWITH SalesData AS (\n    SELECT \n        cd_demo_sk,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_sales_price) AS total_sales,\n        AVG(ws_sales_price) AS avg_order_value,\n        MAX(ws_sales_price) AS max_order_value,\n        MIN(ws_sales_price) AS min_order_value\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_demo_sk\n),\nDemographics AS (\n    SELECT\n        cd_demo_sk,\n        cd_gender,\n        cd_marital_status,\n        ib_income_band_sk,\n        hd_buy_potential\n    FROM \n        customer_demographics cd\n    LEFT JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n)\nSELECT \n    d.cd_gender,\n    d.cd_marital_status,\n    d.ib_income_band_sk,\n    COUNT(s.total_orders) AS customer_count,\n    SUM(s.total_sales) AS total_revenue,\n    AVG(s.avg_order_value) AS average_order_value,\n    MAX(s.max_order_value) AS highest_order_value,\n    MIN(s.min_order_value) AS lowest_order_value\nFROM \n    SalesData s\nJOIN \n    Demographics d ON s.cd_demo_sk = d.cd_demo_sk\nWHERE \n    s.total_sales > 1000\nGROUP BY \n    d.cd_gender, d.cd_marital_status, d.ib_income_band_sk\nORDER BY \n    total_revenue DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        SUM(ss_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ss_customer_sk) AS unique_customers,\n        s_city,\n        s_state\n    FROM \n        store_sales ss\n    JOIN \n        store s ON ss.ss_store_sk = s.s_store_sk\n    WHERE \n        ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        s_city, s_state\n),\nCustomerDemographics AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        AVG(cd_dep_count) AS average_dependents\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_gender, cd_marital_status\n),\nPromotionData AS (\n    SELECT \n        p.p_promo_name,\n        SUM(cs_ext_sales_price) AS promo_sales\n    FROM \n        promotion p\n    JOIN \n        catalog_sales cs ON p.p_promo_sk = cs.cs_promo_sk\n    GROUP BY \n        p.p_promo_name\n)\nSELECT \n    SD.s_city,\n    SD.s_state,\n    SD.total_sales,\n    SD.unique_customers,\n    CD.cd_gender,\n    CD.cd_marital_status,\n    CD.average_dependents,\n    PD.promo_sales\nFROM \n    SalesData SD\nJOIN \n    CustomerDemographics CD ON SD.unique_customers > 100\nJOIN \n    PromotionData PD ON PD.promo_sales > 1000\nORDER BY \n    SD.total_sales DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_current_cdemo_sk,\n        SUM(ws.ws_sales_price) AS total_web_sales,\n        SUM(cs.cs_sales_price) AS total_catalog_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_web_orders,\n        COUNT(DISTINCT cs.cs_order_number) AS total_catalog_orders,\n        CASE \n            WHEN SUM(ws.ws_sales_price) > SUM(cs.cs_sales_price) THEN 'Web'\n            WHEN SUM(ws.ws_sales_price) < SUM(cs.cs_sales_price) THEN 'Catalog'\n            ELSE 'Equal'\n        END AS preferred_sales_channel\n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    GROUP BY c.c_customer_sk, c.c_current_cdemo_sk\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_income_band_sk,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n    FROM customer_demographics cd\n    LEFT JOIN household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    LEFT JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.total_web_sales,\n    cs.total_catalog_sales,\n    cs.total_web_orders,\n    cs.total_catalog_orders,\n    cs.preferred_sales_channel,\n    d.cd_gender,\n    d.cd_marital_status,\n    d.ib_lower_bound,\n    d.ib_upper_bound,\n    COALESCE(cs.total_web_sales, 0) - COALESCE(cs.total_catalog_sales, 0) AS sales_difference\nFROM CustomerSales cs\nFULL OUTER JOIN Demographics d ON cs.c_current_cdemo_sk = d.cd_demo_sk\nWHERE (cs.total_web_sales > 1000 OR cs.total_catalog_sales > 1000)\n  AND (d.cd_gender = 'F' AND d.cd_marital_status IS NOT NULL)\nORDER BY sales_difference DESC\nOFFSET 0 ROWS FETCH NEXT 100 ROWS ONLY;\n",
  "\nWITH MonthlySales AS (\n    SELECT \n        d.d_month_seq,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS order_count,\n        COUNT(DISTINCT ws_bill_customer_sk) AS unique_customers\n    FROM web_sales \n    JOIN date_dim d ON d.d_date_sk = ws_sold_date_sk\n    GROUP BY d.d_month_seq\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE cd.cd_gender IS NOT NULL\n    AND (cd.cd_marital_status = 'S' OR cd.cd_marital_status = 'M')\n    GROUP BY cd.cd_gender, cd.cd_marital_status\n),\nInventoryData AS (\n    SELECT \n        i.i_item_sk,\n        i.i_category,\n        SUM(inv_quantity_on_hand) AS total_inventory\n    FROM inventory inv\n    JOIN item i ON inv.inv_item_sk = i.i_item_sk\n    GROUP BY i.i_item_sk, i.i_category\n)\nSELECT \n    md.d_month_seq,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    md.total_sales,\n    cs.customer_count,\n    COALESCE(id.total_inventory, 0) AS total_inventory,\n    md.total_sales / NULLIF(cs.customer_count, 0) AS average_sales_per_customer,\n    md.total_sales / NULLIF(md.order_count, 0) AS average_sales_per_order\nFROM MonthlySales md\nLEFT JOIN CustomerDemographics cs ON md.d_month_seq % 12 = cs.customer_count % 12\nLEFT JOIN InventoryData id ON md.d_month_seq % 10 = id.total_inventory % 10\nWHERE \n    (md.total_sales > 10000 OR md.total_sales IS NULL)\n    AND (cs.customer_count IS NOT NULL AND cs.customer_count > 1)\nORDER BY md.d_month_seq, cs.cd_gender DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH TopCustomers AS (\n    SELECT\n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE\n        ws.ws_sold_date_sk BETWEEN (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023) - 30 \n        AND (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023)\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n    ORDER BY \n        total_net_profit DESC\n    LIMIT 10\n), CustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        hd.hd_buy_potential,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n    FROM \n        customer_demographics cd\n    LEFT JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n), SalesStats AS (\n    SELECT\n        cs.cs_order_number,\n        SUM(cs.cs_net_profit) AS total_profit,\n        COUNT(cs.cs_item_sk) AS number_of_items\n    FROM \n        catalog_sales cs\n    WHERE \n        cs.cs_sold_date_sk >= (SELECT MIN(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023)\n    GROUP BY \n        cs.cs_order_number\n), AverageSales AS (\n    SELECT \n        AVG(total_profit) AS avg_sales_profit,\n        AVG(number_of_items) AS avg_items_per_order\n    FROM \n        SalesStats\n)\nSELECT \n    tc.c_customer_sk,\n    tc.c_first_name,\n    tc.c_last_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_purchase_estimate,\n    cd.hd_buy_potential,\n    COALESCE(\n        CASE \n            WHEN tc.total_net_profit > aps.avg_sales_profit THEN 'Above Average' \n            ELSE 'Below Average' \n        END, \n        'Not Available'\n    ) AS performance\nFROM \n    TopCustomers tc\nLEFT JOIN \n    CustomerDemographics cd ON tc.c_customer_sk = cd.cd_demo_sk\nLEFT JOIN \n    AverageSales aps ON TRUE\nORDER BY \n    tc.total_net_profit DESC;\n",
  "\nWITH customer_stats AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_profit) AS total_profit,\n        SUM(ws.ws_quantity) AS total_quantity\n    FROM \n        customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\ndemographic_stats AS (\n    SELECT \n        cd.cd_demo_sk,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM \n        customer_demographics cd\n    JOIN customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    GROUP BY \n        cd.cd_demo_sk\n),\nwarehouse_sales AS (\n    SELECT \n        w.w_warehouse_sk,\n        SUM(ws.ws_net_paid_inc_tax) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        warehouse w\n    JOIN web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_sk\n)\nSELECT \n    cs.c_customer_sk,\n    ds.cd_demo_sk,\n    ws.w_warehouse_sk,\n    cs.total_orders,\n    cs.total_profit,\n    cs.total_quantity,\n    ds.avg_purchase_estimate,\n    ds.customer_count,\n    ws.total_sales\nFROM \n    customer_stats cs\nJOIN \n    demographic_stats ds ON ds.customer_count > 50\nJOIN \n    warehouse_sales ws ON ws.total_sales > 10000\nORDER BY \n    cs.total_profit DESC\nLIMIT 100;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT ws.ws_order_number) AS total_web_orders,\n        SUM(ws.ws_net_paid_inc_tax) AS total_spent,\n        AVG(ws.ws_net_profit) AS avg_profit_per_order\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status\n),\nhigh_spending_customers AS (\n    SELECT \n        c.c_customer_sk AS customer_id,\n        cs.total_web_orders,\n        cs.total_spent,\n        cs.avg_profit_per_order\n    FROM \n        customer_summary cs\n    JOIN \n        customer c ON cs.c_customer_sk = c.c_customer_sk\n    WHERE \n        cs.total_spent > 5000\n),\nproduct_sales AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_units_sold,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_item_sk\n),\ntop_products AS (\n    SELECT \n        p.i_item_id,\n        ps.total_units_sold,\n        ps.total_profit\n    FROM \n        item p\n    JOIN \n        product_sales ps ON p.i_item_sk = ps.ws_item_sk\n    ORDER BY \n        ps.total_profit DESC\n    LIMIT 10\n)\nSELECT \n    h.customer_id,\n    tp.i_item_id,\n    tp.total_units_sold,\n    h.total_spent,\n    h.avg_profit_per_order\nFROM \n    high_spending_customers h\nJOIN \n    top_products tp ON h.total_spent > 10000 AND tp.total_units_sold > 100\nORDER BY \n    h.total_spent DESC, tp.total_profit DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_profit) AS total_profit,\n        COUNT(ws.ws_order_number) AS order_count,\n        AVG(ws.ws_sales_price) AS avg_sales_price\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023 \n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\ndemographics_summary AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT css.c_customer_sk) AS customer_count,\n        SUM(css.total_profit) AS total_profit,\n        AVG(css.order_count) AS avg_orders\n    FROM \n        customer_demographics cd\n    JOIN \n        sales_summary css ON cd.cd_demo_sk = css.c_customer_sk\n    GROUP BY \n        cd_gender\n),\nincome_distribution AS (\n    SELECT \n        ib.ib_income_band_sk,\n        COUNT(DISTINCT hdd.hd_demo_sk) AS household_count,\n        AVG(hdd.hd_vehicle_count) AS avg_vehicle_count\n    FROM \n        household_demographics hdd\n    JOIN \n        income_band ib ON hdd.hd_income_band_sk = ib.ib_income_band_sk\n    GROUP BY \n        ib.ib_income_band_sk\n)\nSELECT \n    ds.cd_gender,\n    ds.customer_count,\n    ds.total_profit,\n    ds.avg_orders,\n    id.household_count,\n    id.avg_vehicle_count\nFROM \n    demographics_summary ds\nJOIN \n    income_distribution id ON ds.customer_count > 100\nORDER BY \n    total_profit DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        w.w_warehouse_name,\n        d.d_year,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_net_paid) AS total_net_paid\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        w.w_warehouse_name, d.d_year\n), customer_summary AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ws.ws_quantity) AS total_quantity_purchased,\n        SUM(ws.ws_net_paid) AS total_spent\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        cd.cd_gender = 'F' AND cd.cd_marital_status = 'M'\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    ss.w_warehouse_name,\n    ss.d_year,\n    ss.total_quantity_sold,\n    ss.total_net_paid,\n    cs.c_customer_id,\n    cs.total_quantity_purchased,\n    cs.total_spent\nFROM \n    sales_summary ss\nJOIN \n    customer_summary cs ON ss.total_quantity_sold > 100 AND cs.total_quantity_purchased > 50\nORDER BY \n    ss.d_year DESC, ss.total_net_paid DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity_sold,\n        SUM(ws_sales_price) AS total_sales,\n        AVG(ws_net_profit) AS average_net_profit\n    FROM web_sales\n    WHERE ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) - 30 FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\n    GROUP BY ws_item_sk\n),\nitem_details AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_desc,\n        COALESCE(i.i_current_price, 0) AS current_price,\n        COALESCE(i.i_wholesale_cost, 0) AS wholesale_cost\n    FROM item i\n    LEFT JOIN sales_summary ss ON i.i_item_sk = ss.ws_item_sk\n),\ncustomer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        d.cd_gender,\n        d.cd_marital_status,\n        COALESCE(hd.hd_income_band_sk, 0) AS income_band\n    FROM customer c\n    LEFT JOIN customer_demographics d ON c.c_current_cdemo_sk = d.cd_demo_sk\n    LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n)\nSELECT \n    ci.c_customer_sk,\n    ci.c_first_name,\n    ci.c_last_name,\n    id.i_item_desc,\n    id.current_price,\n    id.wholesale_cost,\n    COALESCE(ss.total_quantity_sold, 0) AS total_quantity_sold,\n    COALESCE(ss.total_sales, 0) AS total_sales,\n    ss.average_net_profit,\n    CASE \n        WHEN ci.income_band IS NOT NULL THEN 'Has Income Band'\n        ELSE 'No Income Band'\n    END AS income_band_status\nFROM customer_info ci\nJOIN item_details id ON ci.c_customer_sk = id.i_item_sk\nLEFT JOIN sales_summary ss ON id.i_item_sk = ss.ws_item_sk\nWHERE (ss.total_sales > 1000 OR ci.cd_gender = 'M')\nORDER BY total_sales DESC\nLIMIT 50;\n",
  "\nWITH SalesData AS (\n    SELECT \n        d.d_year,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_profit) AS avg_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n), CustomerData AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS total_customers,\n        SUM(cd.cd_purchase_estimate) AS total_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n), WarehouseData AS (\n    SELECT \n        w.w_warehouse_id,\n        COUNT(DISTINCT ws.ws_item_sk) AS unique_items,\n        SUM(ws.ws_net_paid) AS total_net_paid\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\n\nSELECT \n    sd.d_year,\n    sd.total_quantity_sold,\n    sd.total_sales,\n    cd.cd_gender,\n    cd.total_customers,\n    cd.total_purchase_estimate,\n    wd.w_warehouse_id,\n    wd.unique_items,\n    wd.total_net_paid\nFROM \n    SalesData sd\nJOIN \n    CustomerData cd ON cd.total_customers > 100\nJOIN \n    WarehouseData wd ON wd.total_net_paid > 10000\nORDER BY \n    sd.d_year, cd.cd_gender, wd.w_warehouse_id;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        customer_demographics cd\n),\nSalesByDemographics AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(cs.total_web_sales) AS web_sales,\n        SUM(cs.total_catalog_sales) AS catalog_sales,\n        SUM(cs.total_store_sales) AS store_sales\n    FROM \n        CustomerSales cs\n    JOIN customer c ON cs.c_customer_id = c.c_customer_id\n    JOIN CustomerDemographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n)\nSELECT \n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    web_sales,\n    catalog_sales,\n    store_sales,\n    (web_sales + catalog_sales + store_sales) AS total_sales\nFROM \n    SalesByDemographics\nORDER BY \n    total_sales DESC\nLIMIT \n    10;\n",
  "\nWITH SalesSummary AS (\n    SELECT \n        ws.ws_web_site_sk,\n        COUNT(ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        web_sales AS ws\n    JOIN \n        date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN \n        customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        dd.d_year = 2023 AND\n        cd.cd_gender = 'F' AND\n        cd.cd_marital_status = 'M'\n    GROUP BY \n        ws.ws_web_site_sk\n),\nWarehouseSummary AS (\n    SELECT \n        w.w_warehouse_sk,\n        COUNT(ws.ws_order_number) AS total_orders_warehouse,\n        SUM(ws.ws_ext_sales_price) AS total_sales_warehouse,\n        SUM(ws.ws_net_profit) AS total_profit_warehouse\n    FROM \n        warehouse AS w\n    JOIN \n        web_sales AS ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_sk\n),\nCombinedSummary AS (\n    SELECT \n        ss.ws_web_site_sk,\n        ss.total_orders,\n        ss.total_sales,\n        ss.total_profit,\n        COALESCE(ws.total_orders_warehouse, 0) AS total_orders_warehouse,\n        COALESCE(ws.total_sales_warehouse, 0) AS total_sales_warehouse,\n        COALESCE(ws.total_profit_warehouse, 0) AS total_profit_warehouse\n    FROM \n        SalesSummary AS ss\n    LEFT JOIN \n        WarehouseSummary AS ws ON ss.ws_web_site_sk = ws.w_warehouse_sk\n)\nSELECT \n    cs.ws_web_site_sk,\n    cs.total_orders,\n    cs.total_sales,\n    cs.total_profit,\n    cs.total_orders_warehouse,\n    cs.total_sales_warehouse,\n    cs.total_profit_warehouse\nFROM \n    CombinedSummary AS cs\nORDER BY \n    cs.total_profit DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        w.w_warehouse_id,\n        d.d_year,\n        SUM(ws.ws_net_paid) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        COUNT(DISTINCT ws.ws_bill_customer_sk) AS total_customers\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        w.w_warehouse_id, d.d_year\n),\ndemographics_summary AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT c.c_customer_sk) AS total_customers,\n        SUM(ws.ws_net_paid) AS total_sales\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    ss.w_warehouse_id,\n    ss.d_year,\n    ss.total_sales,\n    ss.total_orders,\n    ss.total_customers,\n    ds.cd_gender,\n    ds.cd_marital_status,\n    ds.total_customers AS demographic_customers,\n    ds.total_sales AS demographic_sales\nFROM \n    sales_summary ss\nLEFT JOIN \n    demographics_summary ds ON ss.total_customers = ds.total_customers\nORDER BY \n    ss.d_year DESC, ss.total_sales DESC;\n",
  "\nWITH CustomerStores AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        s.s_store_sk,\n        s.s_store_name,\n        SUM(ss.ss_quantity) AS total_sales_quantity,\n        SUM(ss.ss_net_paid) AS total_net_paid\n    FROM \n        customer c\n    JOIN \n        store s ON c.c_current_addr_sk = s.s_store_sk\n    JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk AND s.s_store_sk = ss.ss_store_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, s.s_store_sk, s.s_store_name\n),\nTopStores AS (\n    SELECT \n        s.s_store_sk,\n        s.s_store_name,\n        SUM(cs.cs_quantity) AS total_catalog_sales_quantity \n    FROM \n        store s\n    JOIN \n        catalog_sales cs ON s.s_store_sk = cs.cs_ship_mode_sk\n    GROUP BY \n        s.s_store_sk, s.s_store_name\n),\nSalesComparison AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.s_store_sk,\n        cs.s_store_name,\n        cs.total_sales_quantity,\n        ts.total_catalog_sales_quantity\n    FROM \n        CustomerStores cs\n    LEFT JOIN \n        TopStores ts ON cs.s_store_sk = ts.s_store_sk\n)\nSELECT \n    c.c_first_name, \n    c.c_last_name, \n    s.s_store_name, \n    total_sales_quantity, \n    total_catalog_sales_quantity,\n    CASE \n        WHEN total_sales_quantity > total_catalog_sales_quantity THEN 'Store Sales Higher'\n        WHEN total_sales_quantity < total_catalog_sales_quantity THEN 'Catalog Sales Higher'\n        ELSE 'Equal Sales'\n    END AS sales_comparison\nFROM \n    SalesComparison c\nJOIN \n    store s ON c.s_store_sk = s.s_store_sk\nWHERE \n    s.s_city = 'Seattle'\nORDER BY \n    total_sales_quantity DESC, total_catalog_sales_quantity DESC\nLIMIT 10;\n",
  "WITH CustomerReturns AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(SUM(sr_return_quantity), 0) AS total_store_returns,\n        COALESCE(SUM(wr_return_quantity), 0) AS total_web_returns\n    FROM \n        customer c\n    LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nPromotionalSales AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_net_profit) AS total_web_profit,\n        SUM(cs_net_profit) AS total_catalog_profit\n    FROM \n        web_sales ws\n    JOIN catalog_sales cs ON ws.ws_order_number = cs.cs_order_number AND ws.ws_item_sk = cs.cs_item_sk\n    WHERE \n        ws_sold_date_sk > (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2001)\n    GROUP BY \n        ws_bill_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        CASE \n            WHEN cd.cd_credit_rating = 'Good' THEN 'High'\n            WHEN cd.cd_credit_rating = 'Bad' THEN 'Low'\n            ELSE 'Medium'\n        END AS credit_tier\n    FROM \n        customer_demographics cd\n)\n\nSELECT \n    cr.c_first_name,\n    cr.c_last_name,\n    cr.total_store_returns,\n    cr.total_web_returns,\n    COALESCE(ps.total_web_profit, 0) AS total_web_profit,\n    COALESCE(ps.total_catalog_profit, 0) AS total_catalog_profit,\n    cd.cd_gender,\n    cd.credit_tier\nFROM \n    CustomerReturns cr\nJOIN \n    PromotionalSales ps ON cr.c_customer_sk = ps.ws_bill_customer_sk\nJOIN \n    CustomerDemographics cd ON cr.c_customer_sk = cd.cd_demo_sk\nWHERE \n    (cr.total_store_returns + cr.total_web_returns) > (\n        SELECT AVG(total_store_returns + total_web_returns) \n        FROM CustomerReturns \n        WHERE total_store_returns IS NOT NULL OR total_web_returns IS NOT NULL\n    )\nAND \n    (cd.cd_gender = 'F' OR cd.cd_marital_status = 'M')\nORDER BY \n    total_web_profit DESC\nLIMIT 100;",
  "WITH SellerInfo AS (\n    SELECT \n        s.s_store_sk,\n        s.s_store_name,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_sales,\n        SUM(ss.ss_net_paid) AS total_revenue\n    FROM \n        store s\n    JOIN \n        store_sales ss ON s.s_store_sk = ss.ss_store_sk\n    GROUP BY \n        s.s_store_sk, s.s_store_name\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender\n),\nSalesSummary AS (\n    SELECT \n        di.d_year,\n        SUM(ws.ws_net_profit) AS yearly_net_profit,\n        SUM(ws.ws_quantity) AS total_quantity_sold\n    FROM \n        web_sales ws\n    JOIN \n        date_dim di ON ws.ws_sold_date_sk = di.d_date_sk\n    GROUP BY \n        di.d_year\n)\nSELECT \n    si.s_store_name,\n    si.total_sales,\n    si.total_revenue,\n    cd.cd_gender,\n    cd.customer_count,\n    cd.avg_purchase_estimate,\n    ss.yearly_net_profit,\n    ss.total_quantity_sold\nFROM \n    SellerInfo si\nJOIN \n    CustomerDemographics cd ON si.total_sales > 100  \nJOIN \n    SalesSummary ss ON ss.total_quantity_sold > 5000 \nORDER BY \n    si.total_revenue DESC, \n    cd.customer_count DESC;",
  "\nWITH CustomerCounts AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c.c_customer_id) AS total_customers,\n        SUM(cd_dep_count) AS total_dependents,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_gender\n),\nSalesData AS (\n    SELECT \n        d.d_year,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_quantity) AS total_quantity,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n),\nPromoData AS (\n    SELECT \n        p.p_promo_name,\n        SUM(CASE WHEN ws.ws_sales_price > 100 THEN ws.ws_net_profit ELSE 0 END) AS high_value_sales_profit\n    FROM \n        promotion p\n    JOIN \n        web_sales ws ON ws.ws_promo_sk = p.p_promo_sk\n    GROUP BY \n        p.p_promo_name\n)\nSELECT \n    cc.cd_gender,\n    cc.total_customers,\n    cc.total_dependents,\n    cc.avg_purchase_estimate,\n    sd.d_year,\n    sd.total_sales,\n    sd.total_quantity,\n    sd.total_orders,\n    pd.p_promo_name,\n    pd.high_value_sales_profit\nFROM \n    CustomerCounts cc\nJOIN \n    SalesData sd ON TRUE\nJOIN \n    PromoData pd ON TRUE\nORDER BY \n    cc.cd_gender, sd.d_year, pd.p_promo_name;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_sk) AS num_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependents\n    FROM customer\n    JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY cd_gender\n),\nWarehouseStats AS (\n    SELECT \n        w_warehouse_id,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(ws_order_number) AS order_count\n    FROM warehouse \n    JOIN web_sales ON ws_warehouse_sk = w_warehouse_sk \n    GROUP BY w_warehouse_id\n),\nSalesStats AS (\n    SELECT \n        d_year,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit\n    FROM web_sales \n    JOIN date_dim ON ws_sold_date_sk = d_date_sk\n    GROUP BY d_year\n)\nSELECT \n    cs.cd_gender,\n    cs.num_customers,\n    cs.avg_purchase_estimate,\n    cs.total_dependents,\n    ws.w_warehouse_id,\n    ws.total_sales,\n    ws.order_count,\n    ss.d_year,\n    ss.total_sales AS yearly_sales,\n    ss.total_profit\nFROM CustomerStats cs\nJOIN WarehouseStats ws ON cs.num_customers > 1000\nJOIN SalesStats ss ON ss.total_sales > 1000000\nORDER BY cs.num_customers DESC, ss.d_year;\n",
  "\nWITH TopCustomers AS (\n    SELECT c.c_customer_sk, \n           c.c_first_name, \n           c.c_last_name, \n           SUM(ws.ws_net_profit) AS total_profit\n    FROM customer c\n    JOIN web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name\n    ORDER BY total_profit DESC\n    LIMIT 10\n), \nSalesSummary AS (\n    SELECT d.d_year, \n           SUM(ws.ws_quantity) AS total_quantity_sold, \n           SUM(ws.ws_net_paid) AS total_sales, \n           SUM(ws.ws_net_profit) AS total_profit\n    FROM web_sales ws\n    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY d.d_year\n), \nWarehousePerformance AS (\n    SELECT w.w_warehouse_id, \n           COUNT(DISTINCT ws.ws_order_number) AS total_orders, \n           SUM(ws.ws_net_profit) AS overall_profit\n    FROM warehouse w\n    JOIN web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY w.w_warehouse_id\n)\nSELECT tc.c_first_name, \n       tc.c_last_name, \n       ts.d_year, \n       ts.total_quantity_sold, \n       ts.total_sales, \n       ts.total_profit, \n       wp.w_warehouse_id, \n       wp.total_orders, \n       wp.overall_profit\nFROM TopCustomers tc\nJOIN SalesSummary ts ON ts.d_year = EXTRACT(YEAR FROM DATE '2002-10-01')\nJOIN WarehousePerformance wp ON wp.total_orders > 100\nORDER BY ts.total_profit DESC, wp.overall_profit DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        AVG(ws.ws_net_profit) AS avg_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN \n        item it ON ws.ws_item_sk = it.i_item_sk\n    WHERE \n        dd.d_year = 2023 \n        AND it.i_category = 'Beverages'\n    GROUP BY \n        ws.ws_sold_date_sk, ws.ws_item_sk\n),\nReturnData AS (\n    SELECT \n        wr.wr_item_sk,\n        SUM(wr.wr_return_quantity) AS total_returns,\n        SUM(wr.wr_net_loss) AS total_net_loss\n    FROM \n        web_returns wr\n    JOIN \n        date_dim dd ON wr.wr_returned_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        wr.wr_item_sk\n),\nCombinedData AS (\n    SELECT \n        sd.ws_item_sk,\n        sd.total_quantity,\n        sd.total_sales,\n        sd.avg_net_profit,\n        COALESCE(rd.total_returns, 0) AS total_returns,\n        COALESCE(rd.total_net_loss, 0) AS total_net_loss\n    FROM \n        SalesData sd\n    LEFT JOIN \n        ReturnData rd ON sd.ws_item_sk = rd.wr_item_sk\n)\nSELECT \n    it.i_item_id,\n    it.i_item_desc,\n    cd.total_quantity,\n    cd.total_sales,\n    cd.avg_net_profit,\n    cd.total_returns,\n    cd.total_net_loss,\n    (cd.total_sales - cd.total_net_loss) AS net_revenue\nFROM \n    CombinedData cd\nJOIN \n    item it ON cd.ws_item_sk = it.i_item_sk\nORDER BY \n    net_revenue DESC \nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_bill_customer_sk,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_net_paid) AS total_revenue,\n        CAST(d.d_date AS DATE) AS sales_date\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        ws_bill_customer_sk, CAST(d.d_date AS DATE)\n),\ncustomer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        hd.hd_income_band_sk\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n),\njoin_summary AS (\n    SELECT \n        ss.sales_date,\n        ci.c_customer_sk,\n        ci.c_first_name,\n        ci.c_last_name,\n        ci.cd_gender,\n        ci.cd_marital_status,\n        ci.hd_income_band_sk,\n        ss.total_orders,\n        ss.total_quantity,\n        ss.total_revenue\n    FROM \n        sales_summary ss\n    JOIN \n        customer_info ci ON ss.ws_bill_customer_sk = ci.c_customer_sk\n)\nSELECT \n    js.sales_date,\n    js.c_customer_sk,\n    js.c_first_name,\n    js.c_last_name,\n    js.cd_gender,\n    js.cd_marital_status,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    js.total_orders,\n    js.total_quantity,\n    js.total_revenue\nFROM \n    join_summary js\nLEFT JOIN \n    income_band ib ON js.hd_income_band_sk = ib.ib_income_band_sk\nWHERE \n    js.total_revenue > 1000\nORDER BY \n    js.sales_date, js.total_revenue DESC\nLIMIT 100;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        ib_income_band_sk,\n        COUNT(DISTINCT c_customer_sk) AS customer_count,\n        SUM(cd_purchase_estimate) AS total_purchase_estimate,\n        AVG(cd_dep_count) AS avg_dependent_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        household_demographics hd ON hd.hd_demo_sk = c.c_current_hdemo_sk\n    JOIN \n        income_band ib ON ib.ib_income_band_sk = hd.hd_income_band_sk\n    GROUP BY \n        cd_gender, cd_marital_status, ib_income_band_sk\n),\nsales_summary AS (\n    SELECT \n        ws_bill_cdemo_sk,\n        SUM(ws_ext_sales_price) AS total_sales_amount,\n        COUNT(*) AS total_sales_count\n    FROM \n        web_sales\n    WHERE \n        ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        ws_bill_cdemo_sk\n)\nSELECT \n    cs.cd_gender,\n    cs.cd_marital_status,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    cs.customer_count,\n    cs.total_purchase_estimate,\n    cs.avg_dependent_count,\n    COALESCE(ss.total_sales_amount, 0) AS total_sales_amount,\n    COALESCE(ss.total_sales_count, 0) AS total_sales_count\nFROM \n    customer_summary cs\nLEFT JOIN \n    sales_summary ss ON cs.ib_income_band_sk = ss.ws_bill_cdemo_sk\nJOIN \n    income_band ib ON cs.ib_income_band_sk = ib.ib_income_band_sk\nORDER BY \n    cs.cd_gender, cs.cd_marital_status, ib.ib_lower_bound;\n",
  "\nWITH SalesSummary AS (\n    SELECT \n        d.d_year,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS order_count,\n        AVG(ws_net_profit) AS avg_net_profit\n    FROM \n        web_sales \n    JOIN \n        date_dim d ON ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n),\nDemographicsSummary AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_sk) AS customer_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer\n    JOIN \n        customer_demographics cd ON c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_gender\n),\nWarehouseStatistics AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(inv_quantity_on_hand) AS total_inventory,\n        COUNT(DISTINCT inv_item_sk) AS distinct_items\n    FROM \n        inventory\n    JOIN \n        warehouse w ON inv_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    ss.d_year,\n    ss.total_sales,\n    ss.order_count,\n    ss.avg_net_profit,\n    ds.cd_gender,\n    ds.customer_count,\n    ds.avg_purchase_estimate,\n    ws.w_warehouse_id,\n    ws.total_inventory,\n    ws.distinct_items\nFROM \n    SalesSummary ss\nCROSS JOIN \n    DemographicsSummary ds\nCROSS JOIN \n    WarehouseStatistics ws\nORDER BY \n    ss.d_year DESC, \n    ds.cd_gender;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count,\n        COUNT(DISTINCT ws.ws_ship_date_sk) AS unique_shipment_dates,\n        AVG(ws.ws_net_profit) AS avg_net_profit\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status\n),\npromotions AS (\n    SELECT \n        p.p_promo_id,\n        p.p_promo_name,\n        COUNT(ws.ws_order_number) AS promo_order_count,\n        SUM(ws.ws_ext_sales_price) AS promo_sales\n    FROM \n        promotion p\n    JOIN \n        web_sales ws ON p.p_promo_sk = ws.ws_promo_sk\n    GROUP BY \n        p.p_promo_id, p.p_promo_name\n)\nSELECT \n    ss.c_customer_id,\n    ss.cd_gender,\n    ss.cd_marital_status,\n    ss.total_sales,\n    ss.order_count,\n    ss.unique_shipment_dates,\n    ss.avg_net_profit,\n    p.promo_order_count,\n    p.promo_sales\nFROM \n    sales_summary ss\nLEFT JOIN \n    promotions p ON ss.total_sales > p.promo_sales\nORDER BY \n    ss.total_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH CustomerReturnStats AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT sr_returned_date_sk) AS return_days,\n        SUM(sr_return_quantity) AS total_return_quantity,\n        SUM(sr_return_amt) AS total_return_amt,\n        SUM(sr_return_tax) AS total_return_tax\n    FROM \n        customer AS c\n    LEFT JOIN \n        store_returns AS sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_sk\n), \nWarehouseSales AS (\n    SELECT \n        ws.ws_warehouse_sk,\n        SUM(ws.ws_quantity) AS total_sales_quantity,\n        SUM(ws.ws_sales_price) AS total_sales_price\n    FROM \n        web_sales AS ws\n    GROUP BY \n        ws.ws_warehouse_sk\n), \nPromotionalStats AS (\n    SELECT \n        p.p_promo_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_ext_sales_price) AS total_sales_with_discount\n    FROM \n        promotion AS p\n    JOIN \n        web_sales AS ws ON p.p_promo_sk = ws.ws_promo_sk\n    GROUP BY \n        p.p_promo_sk\n)\nSELECT \n    c.c_customer_sk,\n    c.c_first_name,\n    c.c_last_name,\n    coalesce(crs.return_days, 0) AS return_days,\n    coalesce(crs.total_return_quantity, 0) AS total_return_quantity,\n    coalesce(crs.total_return_amt, 0) AS total_return_amt,\n    ws.total_sales_quantity,\n    ws.total_sales_price,\n    ps.total_orders,\n    ps.total_sales_with_discount\nFROM \n    customer AS c\nLEFT JOIN \n    CustomerReturnStats AS crs ON c.c_customer_sk = crs.c_customer_sk\nLEFT JOIN \n    WarehouseSales AS ws ON ws.ws_warehouse_sk = c.c_current_addr_sk\nLEFT JOIN \n    PromotionalStats AS ps ON ps.p_promo_sk = c.c_current_cdemo_sk\nWHERE \n    c.c_preferred_cust_flag = 'Y'\nORDER BY \n    c.c_last_name, \n    c.c_first_name;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COUNT(DISTINCT sr.sr_ticket_number) AS total_returns,\n        SUM(sr.sr_return_amt) AS total_return_amount,\n        SUM(sr.sr_return_tax) AS total_return_tax,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        cd.cd_gender = 'F' AND\n        cd.cd_marital_status = 'M'\n    GROUP BY \n        c.c_customer_sk, c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n), WarehouseSales AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_ext_sales_price) AS warehouse_sales\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n), CombinedStats AS (\n    SELECT \n        cs.c_customer_id,\n        cs.total_returns,\n        cs.total_return_amount,\n        cs.total_return_tax,\n        cs.total_orders,\n        cs.total_net_profit,\n        ws.warehouse_sales\n    FROM \n        CustomerStats cs\n    JOIN \n        WarehouseSales ws ON cs.total_orders > 0\n)\nSELECT \n    c_customer_id,\n    total_returns,\n    total_return_amount,\n    total_return_tax,\n    total_orders,\n    total_net_profit,\n    warehouse_sales,\n    (total_net_profit - total_return_amount) AS net_profit_after_returns\nFROM \n    CombinedStats\nORDER BY \n    net_profit_after_returns DESC\nLIMIT 10;\n",
  "\nWITH yearly_sales AS (\n    SELECT \n        d_year,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM \n        web_sales\n    JOIN \n        date_dim ON ws_sold_date_sk = d_date_sk\n    GROUP BY \n        d_year\n),\ntop_customers AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws_ext_sales_price) AS total_spent\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws_bill_customer_sk = c.c_customer_sk\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name\n    ORDER BY \n        total_spent DESC\n    LIMIT 10\n),\nwarehouse_stats AS (\n    SELECT \n        w.w_warehouse_id,\n        COUNT(DISTINCT ws_order_number) AS orders_fulfilled,\n        SUM(ws_ext_sales_price) AS total_revenue\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    ys.d_year,\n    ys.total_sales,\n    ys.total_orders,\n    tc.c_customer_id,\n    tc.c_first_name,\n    tc.c_last_name,\n    tc.total_spent,\n    ws.w_warehouse_id,\n    ws.orders_fulfilled,\n    ws.total_revenue\nFROM \n    yearly_sales ys\nCROSS JOIN \n    top_customers tc\nJOIN \n    warehouse_stats ws ON ws.total_revenue > 100000\nWHERE \n    ys.total_orders > 100\nORDER BY \n    ys.d_year DESC, tc.total_spent DESC, ws.total_revenue DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        w.w_warehouse_id,\n        d.d_year,\n        SUM(ss.ss_sales_price) AS total_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n        AVG(ss.ss_net_profit) AS avg_net_profit\n    FROM \n        store_sales ss\n    JOIN \n        date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\n    JOIN \n        warehouse w ON ss.ss_store_sk = w.w_warehouse_sk\n    WHERE \n        d.d_year BETWEEN 2021 AND 2023\n    GROUP BY \n        w.w_warehouse_id, d.d_year\n),\ncustomer_summary AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        SUM(ws.ws_net_paid) AS total_spent\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        ws.ws_sold_date_sk IN (SELECT d.d_date_sk FROM date_dim d WHERE d.d_year = 2023)\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    ss.w_warehouse_id,\n    ss.d_year,\n    ss.total_sales,\n    ss.total_transactions,\n    ss.avg_net_profit,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.customer_count,\n    cs.total_spent\nFROM \n    sales_summary ss\nJOIN \n    customer_summary cs ON ss.d_year = 2023\nORDER BY \n    ss.total_sales DESC, cs.total_spent DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_returned_date_sk,\n        sr_item_sk,\n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt) AS total_returned_amount,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM store_returns\n    WHERE sr_returned_date_sk IS NOT NULL\n    GROUP BY sr_returned_date_sk, sr_item_sk, sr_customer_sk\n),\nHighValueCustomers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating,\n        CTE.total_returned_quantity,\n        CASE \n            WHEN CTE.total_returned_quantity > 10 THEN 'High Return'\n            WHEN CTE.total_returned_quantity BETWEEN 5 AND 10 THEN 'Medium Return'\n            ELSE 'Low Return'\n        END AS return_category\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN CustomerReturns CTE ON c.c_customer_sk = CTE.sr_customer_sk\n),\nSalesData AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_sold_quantity,\n        SUM(ws_sales_price) AS total_sales_value\n    FROM web_sales\n    GROUP BY ws_item_sk\n),\nReturnSummary AS (\n    SELECT \n        C.c_customer_sk,\n        COALESCE(H.total_returned_quantity, 0) AS returned_qty,\n        COALESCE(S.total_sold_quantity, 0) AS sold_qty,\n        CASE \n            WHEN COALESCE(S.total_sold_quantity, 0) > 0 THEN \n                (COALESCE(H.total_returned_quantity, 0) / COALESCE(S.total_sold_quantity, 0)) * 100\n            ELSE 0 \n        END AS return_rate_percentage\n    FROM HighValueCustomers C\n    LEFT JOIN CustomerReturns H ON C.c_customer_sk = H.sr_customer_sk\n    LEFT JOIN SalesData S ON H.sr_item_sk = S.ws_item_sk\n)\nSELECT \n    HS.c_first_name,\n    HS.c_last_name,\n    HS.cd_gender,\n    HS.return_category,\n    RS.returned_qty,\n    RS.sold_qty,\n    RS.return_rate_percentage\nFROM ReturnSummary RS\nJOIN HighValueCustomers HS ON RS.c_customer_sk = HS.c_customer_sk\nORDER BY RS.return_rate_percentage DESC, HS.c_last_name, HS.c_first_name\nLIMIT 10;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amt,\n        SUM(sr_return_tax) AS total_return_tax,\n        SUM(sr_return_ship_cost) AS total_return_ship_cost\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nWebReturns AS (\n    SELECT \n        wr_returning_customer_sk,\n        COUNT(DISTINCT wr_order_number) AS total_web_returns,\n        SUM(wr_return_amt) AS total_web_return_amt,\n        SUM(wr_return_tax) AS total_web_return_tax\n    FROM \n        web_returns\n    GROUP BY \n        wr_returning_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        hd.hd_income_band_sk\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n),\nSalesSummary AS (\n    SELECT \n        ss.ss_customer_sk,\n        SUM(ss.ss_net_profit) AS total_net_profit,\n        SUM(ss.ss_quantity) AS total_units_sold\n    FROM \n        store_sales ss\n    GROUP BY \n        ss.ss_customer_sk\n)\nSELECT \n    cd.c_customer_sk,\n    COALESCE(cr.total_returns, 0) AS total_store_returns,\n    COALESCE(cr.total_return_amt, 0) AS total_store_return_amt,\n    COALESCE(wr.total_web_returns, 0) AS total_web_returns,\n    COALESCE(wr.total_web_return_amt, 0) AS total_web_return_amt,\n    ss.total_net_profit,\n    ss.total_units_sold,\n    CASE \n        WHEN cd.cd_gender = 'M' THEN 'Male'\n        WHEN cd.cd_gender = 'F' THEN 'Female'\n        ELSE 'Unknown' \n    END AS gender_desc,\n    CASE \n        WHEN cd.cd_marital_status = 'M' THEN 'Married'\n        WHEN cd.cd_marital_status = 'S' THEN 'Single'\n        ELSE 'Unknown'\n    END AS marital_status_desc\nFROM \n    CustomerDemographics cd\nLEFT JOIN \n    CustomerReturns cr ON cd.c_customer_sk = cr.sr_customer_sk\nLEFT JOIN \n    WebReturns wr ON cd.c_customer_sk = wr.wr_returning_customer_sk\nLEFT JOIN \n    SalesSummary ss ON cd.c_customer_sk = ss.ss_customer_sk\nWHERE \n    (cd.cd_gender IS NOT NULL OR cd.cd_marital_status IS NOT NULL)\n    AND (cd.hd_income_band_sk IS NOT NULL OR ss.total_net_profit > 0)\nORDER BY \n    total_net_profit DESC,\n    total_store_return_amt DESC;\n",
  "\nWITH AddressStats AS (\n    SELECT \n        ca_state,\n        COUNT(*) AS address_count,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nDemoStats AS (\n    SELECT \n        cd_gender,\n        COUNT(*) AS demographic_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        AVG(cd_dep_count) AS avg_dependency_count\n    FROM \n        customer_demographics\n    GROUP BY \n        cd_gender\n),\nDateSales AS (\n    SELECT \n        d_year,\n        SUM(COALESCE(ws_ext_sales_price, 0) + COALESCE(cs_ext_sales_price, 0) + COALESCE(ss_ext_sales_price, 0)) AS total_sales,\n        SUM(COALESCE(ws_net_profit, 0) + COALESCE(cs_net_profit, 0) + COALESCE(ss_net_profit, 0)) AS total_profit\n    FROM \n        date_dim\n    LEFT JOIN \n        web_sales ON d_date_sk = ws_sold_date_sk\n    LEFT JOIN \n        catalog_sales ON d_date_sk = cs_sold_date_sk\n    LEFT JOIN \n        store_sales ON d_date_sk = ss_sold_date_sk\n    GROUP BY \n        d_year\n)\nSELECT \n    ds.d_year,\n    ds.total_sales,\n    ds.total_profit,\n    as1.address_count,\n    as1.max_street_name_length,\n    as1.min_street_name_length,\n    as1.avg_street_name_length,\n    ds1.demographic_count,\n    ds1.avg_purchase_estimate,\n    ds1.avg_dependency_count\nFROM \n    DateSales ds\nJOIN \n    AddressStats as1 ON ds.d_year = (SELECT MAX(d_year) FROM date_dim)\nJOIN \n    DemoStats ds1 ON ds1.cd_gender = 'F'\nORDER BY \n    ds.d_year DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT c.c_customer_sk, \n           c.c_first_name, \n           c.c_last_name, \n           SUM(ws.ws_net_paid_inc_tax) AS total_spent,\n           COUNT(ws.ws_order_number) AS order_count\n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE ws.ws_sold_date_sk >= (SELECT MAX(d.d_date_sk) \n                                  FROM date_dim d \n                                  WHERE d.d_year = 2023)\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nHighValueCustomers AS (\n    SELECT cs.c_customer_sk, \n           cs.c_first_name, \n           cs.c_last_name, \n           cs.total_spent\n    FROM CustomerSales cs\n    WHERE cs.total_spent > (SELECT AVG(total_spent) FROM CustomerSales)\n),\nCustomerDemographics AS (\n    SELECT cd.cd_demo_sk, \n           cd.cd_gender, \n           cd.cd_marital_status, \n           cd.cd_education_status,\n           hd.hd_income_band_sk\n    FROM customer_demographics cd\n    JOIN household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n),\nTopDemographics AS (\n    SELECT hv.c_customer_sk,\n           COUNT(DISTINCT cd.cd_demo_sk) AS demographic_count\n    FROM HighValueCustomers hv\n    JOIN CustomerDemographics cd ON hv.c_customer_sk = cd.cd_demo_sk\n    GROUP BY hv.c_customer_sk\n)\nSELECT hv.c_customer_sk, \n       hv.c_first_name, \n       hv.c_last_name, \n       hv.total_spent, \n       d.cd_gender, \n       d.cd_marital_status, \n       d.cd_education_status, \n       td.demographic_count\nFROM HighValueCustomers hv\nLEFT JOIN CustomerDemographics d ON hv.c_customer_sk = d.cd_demo_sk\nLEFT JOIN TopDemographics td ON hv.c_customer_sk = td.c_customer_sk\nWHERE d.cd_gender IS NOT NULL\nORDER BY hv.total_spent DESC \nLIMIT 50;\n",
  "\nWITH sales_summary AS (\n    SELECT\n        ws.ws_sold_date_sk,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM\n        web_sales ws\n    JOIN\n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE\n        dd.d_year = 2023\n    GROUP BY\n        ws.ws_sold_date_sk\n),\ncustomer_summary AS (\n    SELECT\n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS total_customers,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM\n        customer c\n    JOIN\n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE\n        cd.cd_marital_status = 'M'\n    GROUP BY\n        cd.cd_gender\n),\nstore_summary AS (\n    SELECT\n        s.s_store_id,\n        s.s_store_name,\n        SUM(ss.ss_quantity) AS total_store_sales,\n        SUM(ss.ss_net_profit) AS total_store_profit\n    FROM\n        store s\n    JOIN\n        store_sales ss ON s.s_store_sk = ss.ss_store_sk\n    GROUP BY\n        s.s_store_id, s.s_store_name\n)\nSELECT\n    ss.ws_sold_date_sk,\n    ss.total_quantity_sold,\n    ss.total_net_profit,\n    cs.cd_gender,\n    cs.total_customers,\n    cs.avg_purchase_estimate,\n    st.s_store_id,\n    st.total_store_sales,\n    st.total_store_profit\nFROM\n    sales_summary ss\nJOIN\n    customer_summary cs ON cs.total_customers IS NOT NULL\nJOIN\n    store_summary st ON st.total_store_sales IS NOT NULL\nORDER BY\n    ss.ws_sold_date_sk DESC, cs.cd_gender, st.total_store_profit DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_sales_price) AS total_sales,\n        SUM(ws_quantity) AS total_quantity,\n        AVG(ws_sales_price) AS avg_sales_price,\n        MAX(ws_sales_price) AS max_sales_price,\n        MIN(ws_sales_price) AS min_sales_price,\n        CAST(d_date AS DATE) AS sales_date\n    FROM \n        web_sales \n    JOIN \n        date_dim ON ws_sold_date_sk = d_date_sk\n    WHERE \n        d_year = 2022\n    GROUP BY \n        ws_item_sk, d_date\n),\ncustomer_summary AS (\n    SELECT \n        c_customer_sk,\n        COUNT(DISTINCT ws_order_number) AS order_count,\n        SUM(ws_net_profit) AS total_profit\n    FROM \n        web_sales \n    JOIN \n        customer ON ws_bill_customer_sk = c_customer_sk\n    GROUP BY \n        c_customer_sk\n),\nwarehouse_summary AS (\n    SELECT \n        w_warehouse_sk,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_net_profit) AS total_profit\n    FROM \n        web_sales \n    JOIN \n        warehouse ON ws_warehouse_sk = w_warehouse_sk\n    GROUP BY \n        w_warehouse_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.order_count,\n    cs.total_profit,\n    ss.ws_item_sk,\n    ss.total_sales,\n    ss.total_quantity,\n    ss.avg_sales_price,\n    ws.w_warehouse_sk,\n    ws.total_orders,\n    ws.total_profit\nFROM \n    customer_summary cs\nJOIN \n    sales_summary ss ON cs.order_count > 0\nJOIN \n    warehouse_summary ws ON cs.total_profit > 0\nWHERE \n    cs.order_count > 10\nORDER BY \n    cs.total_profit DESC, ss.total_sales DESC;\n",
  "\nWITH Customer_Sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ss.ss_net_paid) AS total_store_sales,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_order_count,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_order_count\n    FROM\n        customer AS c\n    LEFT JOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY c.c_customer_sk\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_income_band_sk,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n    FROM \n        customer_demographics AS cd\n    JOIN household_demographics AS hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    JOIN income_band AS ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n),\nSales_By_Demographics AS (\n    SELECT \n        d.cd_gender,\n        d.cd_marital_status,\n        COUNT(DISTINCT cs.c_customer_sk) AS num_customers,\n        SUM(cs.total_store_sales) AS store_sales,\n        SUM(cs.total_web_sales) AS web_sales,\n        AVG(cs.web_order_count) AS avg_web_orders,\n        AVG(cs.store_order_count) AS avg_store_orders\n    FROM\n        Customer_Sales AS cs\n    JOIN Demographics AS d ON cs.c_customer_sk = d.cd_demo_sk\n    WHERE \n        cs.total_store_sales > 0 OR cs.total_web_sales > 0\n    GROUP BY d.cd_gender, d.cd_marital_status\n)\nSELECT \n    cd_gender,\n    cd_marital_status,\n    num_customers,\n    store_sales,\n    web_sales,\n    avg_web_orders,\n    avg_store_orders\nFROM \n    Sales_By_Demographics\nORDER BY store_sales DESC, web_sales DESC;\n",
  "WITH customer_summary AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS total_customers,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(CASE WHEN cd.cd_marital_status = 'M' THEN 1 ELSE 0 END) AS married_customers,\n        SUM(CASE WHEN cd.cd_marital_status = 'S' THEN 1 ELSE 0 END) AS single_customers,\n        SUM(cd.cd_dep_count) AS total_dependents\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n),\nsales_summary AS (\n    SELECT \n        time_dim.d_year,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        SUM(ws.ws_ext_discount_amt) AS total_discount\n    FROM \n        web_sales ws\n    JOIN \n        date_dim time_dim ON ws.ws_sold_date_sk = time_dim.d_date_sk\n    GROUP BY \n        time_dim.d_year\n),\ninventory_summary AS (\n    SELECT \n        i.i_item_id,\n        SUM(inv.inv_quantity_on_hand) AS total_quantity_on_hand\n    FROM \n        inventory inv\n    JOIN \n        item i ON inv.inv_item_sk = i.i_item_sk\n    GROUP BY \n        i.i_item_id\n)\nSELECT \n    cs.cd_gender,\n    cs.total_customers,\n    cs.avg_purchase_estimate,\n    cs.married_customers,\n    cs.single_customers,\n    cs.total_dependents,\n    ss.d_year,\n    ss.total_quantity_sold,\n    ss.total_net_profit,\n    ss.total_discount,\n    ii.total_quantity_on_hand\nFROM \n    customer_summary cs\nJOIN \n    sales_summary ss ON cs.total_customers > 0\nJOIN \n    inventory_summary ii ON 1 = 1 \nORDER BY \n    cs.cd_gender, ss.d_year DESC;",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n), customer_demographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n), sales_summary AS (\n    SELECT \n        cs.c_customer_sk,\n        COALESCE(cs.total_web_sales, 0) AS total_web_sales,\n        COALESCE(cs.total_catalog_sales, 0) AS total_catalog_sales,\n        COALESCE(cs.total_store_sales, 0) AS total_store_sales,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status\n    FROM \n        customer_sales cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n), average_sales AS (\n    SELECT \n        sd.cd_gender,\n        sd.cd_marital_status,\n        sd.cd_education_status,\n        AVG(sd.total_web_sales) AS avg_web_sales,\n        AVG(sd.total_catalog_sales) AS avg_catalog_sales,\n        AVG(sd.total_store_sales) AS avg_store_sales\n    FROM \n        sales_summary sd\n    GROUP BY \n        sd.cd_gender, \n        sd.cd_marital_status, \n        sd.cd_education_status\n)\nSELECT \n    avg_web_sales,\n    avg_catalog_sales,\n    avg_store_sales\nFROM \n    average_sales\nWHERE \n    avg_web_sales > 1000 AND avg_catalog_sales > 500\nORDER BY \n    avg_store_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH MonthlySales AS (\n    SELECT \n        EXTRACT(MONTH FROM d.d_date) AS SalesMonth,\n        EXTRACT(YEAR FROM d.d_date) AS SalesYear,\n        SUM(ws.ws_ext_sales_price) AS TotalSales,\n        COUNT(DISTINCT ws.ws_order_number) AS TotalOrders,\n        AVG(ws.ws_net_paid) AS AvgOrderValue\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        EXTRACT(MONTH FROM d.d_date), EXTRACT(YEAR FROM d.d_date)\n),\nTopCustomers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS TotalSpent\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n    ORDER BY \n        TotalSpent DESC\n    LIMIT 10\n),\nWarehouseSales AS (\n    SELECT \n        w.w_warehouse_id,\n        w.w_warehouse_name,\n        SUM(ws.ws_ext_sales_price) AS WarehouseTotalSales\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id, w.w_warehouse_name\n)\nSELECT \n    ms.SalesYear,\n    ms.SalesMonth,\n    ms.TotalSales,\n    ms.TotalOrders,\n    ms.AvgOrderValue,\n    tc.c_first_name,\n    tc.c_last_name,\n    tc.TotalSpent,\n    ws.WarehouseTotalSales\nFROM \n    MonthlySales ms\nCROSS JOIN \n    TopCustomers tc\nJOIN \n    WarehouseSales ws ON 1=1\nWHERE \n    ms.TotalSales > 10000\nORDER BY \n    ms.SalesYear DESC,\n    ms.SalesMonth DESC,\n    tc.TotalSpent DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_paid) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders,\n        MAX(d.d_date) AS last_purchase_date\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023 \n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nDemographicInfo AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_country\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_sales,\n    cs.total_orders,\n    cs.last_purchase_date,\n    di.cd_gender,\n    di.cd_marital_status,\n    di.cd_education_status,\n    di.ca_city,\n    di.ca_state,\n    di.ca_country\nFROM \n    CustomerSales cs\nJOIN \n    DemographicInfo di ON cs.c_customer_sk = di.cd_demo_sk\nWHERE \n    cs.total_sales > 1000\nORDER BY \n    cs.total_sales DESC\nLIMIT 10;\n",
  "WITH sales_summary AS (\n    SELECT \n        d.d_year AS sales_year,\n        d.d_month_seq AS sales_month,\n        COUNT(ss.ss_ticket_number) AS total_sales,\n        SUM(ss.ss_sales_price) AS total_revenue,\n        SUM(ss.ss_quantity) AS total_quantity\n    FROM \n        store_sales ss\n    JOIN \n        date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year BETWEEN 1998 AND 2001\n    GROUP BY \n        d.d_year, d.d_month_seq\n),\ncustomer_summary AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n        COUNT(c.c_customer_sk) AS customer_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n),\ninventory_summary AS (\n    SELECT \n        inv.inv_warehouse_sk,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory\n    FROM \n        inventory inv\n    JOIN \n        warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        inv.inv_warehouse_sk\n)\nSELECT \n    s.sales_year,\n    s.sales_month,\n    s.total_sales,\n    s.total_revenue,\n    s.total_quantity,\n    c.cd_gender,\n    c.cd_marital_status,\n    c.avg_purchase_estimate,\n    c.customer_count,\n    i.total_inventory\nFROM \n    sales_summary s\nJOIN \n    customer_summary c ON s.sales_year >= 1999 \nJOIN \n    inventory_summary i ON s.sales_year IN (1998, 1999, 2000, 2001) \nORDER BY \n    s.sales_year, s.sales_month, c.cd_gender;",
  "\nWITH CustomerData AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        ca.ca_city,\n        ca.ca_state,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ws.ws_net_paid) AS total_spent\n    FROM \n        customer c\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        ca.ca_state = 'CA'\n        AND cd.cd_gender = 'F'\n        AND cd.cd_marital_status = 'S'\n    GROUP BY \n        c.c_customer_id, \n        c.c_first_name, \n        c.c_last_name, \n        ca.ca_city, \n        ca.ca_state, \n        cd.cd_gender, \n        cd.cd_marital_status\n),\nPromoData AS (\n    SELECT \n        p.p_promo_name,\n        p.p_discount_active,\n        SUM(ws.ws_ext_discount_amt) AS total_discount\n    FROM \n        promotion p\n    JOIN \n        web_sales ws ON p.p_promo_sk = ws.ws_promo_sk\n    WHERE \n        p.p_discount_active = 'Y'\n    GROUP BY \n        p.p_promo_name, \n        p.p_discount_active\n)\nSELECT \n    cd.c_first_name,\n    cd.c_last_name,\n    cd.ca_city,\n    cd.total_spent,\n    pd.p_promo_name AS promo_name,\n    pd.total_discount\nFROM \n    CustomerData cd\nLEFT JOIN \n    PromoData pd ON cd.total_spent > pd.total_discount\nORDER BY \n    cd.total_spent DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_order_number,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        SUM(ws.ws_net_profit) AS total_profit,\n        d.d_year,\n        c.c_birth_year,\n        cd.cd_gender\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        ws.ws_order_number, d.d_year, c.c_birth_year, cd.cd_gender\n),\ncustomer_summary AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT ws_order_number) AS order_count,\n        AVG(total_quantity) AS avg_quantity,\n        AVG(total_sales) AS avg_sales,\n        AVG(total_discount) AS avg_discount,\n        AVG(total_profit) AS avg_profit\n    FROM \n        sales_data\n    JOIN \n        customer c ON sales_data.ws_order_number = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n)\nSELECT \n    cs.cd_gender,\n    cs.order_count,\n    cs.avg_quantity,\n    cs.avg_sales,\n    cs.avg_discount,\n    cs.avg_profit,\n    CASE \n        WHEN cs.avg_profit > 1000 THEN 'High Performer'\n        WHEN cs.avg_profit BETWEEN 500 AND 1000 THEN 'Medium Performer'\n        ELSE 'Low Performer' \n    END AS performance_category\nFROM \n    customer_summary cs\nORDER BY \n    cs.avg_profit DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        w.w_warehouse_name,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_paid) AS total_net_paid,\n        d.d_year,\n        d.d_month_seq,\n        d.d_quarter_seq\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        w.w_warehouse_name, d.d_year, d.d_month_seq, d.d_quarter_seq\n),\nCustomerData AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ws.ws_net_paid) AS customer_total_net_paid\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, cd.cd_gender, cd.cd_marital_status\n),\nAggregatedData AS (\n    SELECT \n        sd.w_warehouse_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(cd.customer_total_net_paid) AS total_customer_spending,\n        SUM(sd.total_net_paid) AS warehouse_total_spending\n    FROM \n        SalesData sd\n    JOIN \n        CustomerData cd ON sd.total_quantity > 0\n    GROUP BY \n        sd.w_warehouse_name, cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    w_warehouse_name,\n    cd_gender,\n    cd_marital_status,\n    total_customer_spending,\n    warehouse_total_spending\nFROM \n    AggregatedData\nWHERE \n    total_customer_spending > (SELECT AVG(total_customer_spending) FROM AggregatedData)\nORDER BY \n    warehouse_total_spending DESC, total_customer_spending DESC;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        SUM(ws.ws_ext_sales_price) AS total_spent,\n        MAX(ws.ws_sold_date_sk) AS last_purchase_date\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate\n),\nIncomeBandStats AS (\n    SELECT \n        h.hd_demo_sk,\n        IB.ib_income_band_sk,\n        CASE \n            WHEN IB.ib_lower_bound <= 20000 THEN 'Low'\n            WHEN IB.ib_lower_bound BETWEEN 20001 AND 60000 THEN 'Medium'\n            ELSE 'High'\n        END AS income_band\n    FROM household_demographics h\n    JOIN income_band IB ON h.hd_income_band_sk = IB.ib_income_band_sk\n),\nSalesData AS (\n    SELECT \n        ss.ss_item_sk,\n        SUM(ss.ss_quantity) AS total_quantity_sold,\n        SUM(ss.ss_net_profit) AS total_net_profit\n    FROM store_sales ss\n    GROUP BY ss.ss_item_sk\n)\nSELECT \n    cs.c_first_name, \n    cs.c_last_name,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.total_spent,\n    COALESCE(ibs.income_band, 'Unknown') AS income_band,\n    COALESCE(sd.total_quantity_sold, 0) AS total_quantity_sold,\n    COALESCE(sd.total_net_profit, 0) AS total_net_profit\nFROM CustomerStats cs\nLEFT JOIN IncomeBandStats ibs ON cs.c_customer_sk = ibs.hd_demo_sk\nLEFT JOIN SalesData sd ON cs.c_customer_sk = sd.ss_item_sk\nWHERE cs.order_count > 0\nAND (cs.total_spent > 100 OR sd.total_net_profit > 500)\nORDER BY cs.last_purchase_date DESC, cs.total_spent DESC\nLIMIT 100;\n",
  "WITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_current_cdemo_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_order_count,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_order_count\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk \n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \n    GROUP BY \n        c.c_customer_sk, c.c_current_cdemo_sk\n),\nAverageSale AS (\n    SELECT\n        AVG(total_web_sales) AS avg_web_sales,\n        AVG(total_store_sales) AS avg_store_sales\n    FROM \n        CustomerSales\n),\nSalesByDemographics AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(cs.total_web_sales) AS gender_web_sales,\n        SUM(cs.total_store_sales) AS gender_store_sales\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_demographics cd ON cs.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    d.d_day_name,\n    COUNT(DISTINCT ws.ws_order_number) AS orders_today,\n    SUM(ws.ws_net_profit) AS total_profit_today,\n    COALESCE(sbd.gender_web_sales, 0) AS web_sales_by_gender,\n    COALESCE(sbd.gender_store_sales, 0) AS store_sales_by_gender,\n    (SELECT avg_web_sales FROM AverageSale) AS avg_web_sales,\n    (SELECT avg_store_sales FROM AverageSale) AS avg_store_sales\nFROM \n    date_dim d\nLEFT JOIN \n    web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\nLEFT JOIN \n    SalesByDemographics sbd ON 1=1 \nWHERE \n    d.d_date = cast('2002-10-01' as date)\nAND \n    (sbd.gender_web_sales > (SELECT avg_web_sales FROM AverageSale) OR sbd.gender_store_sales > (SELECT avg_store_sales FROM AverageSale))\nGROUP BY \n    d.d_day_name, sbd.gender_web_sales, sbd.gender_store_sales\nORDER BY \n    d.d_day_name;",
  "\nWITH SalesData AS (\n    SELECT \n        cs.cs_item_sk AS item_sk, \n        cs.cs_order_number AS order_number,\n        SUM(cs.cs_quantity) AS total_quantity,\n        SUM(cs.cs_net_paid) AS total_sales\n    FROM \n        catalog_sales cs\n    JOIN \n        date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023 \n        AND dd.d_month_seq IN (4, 5) \n    GROUP BY \n        cs.cs_item_sk, cs.cs_order_number\n),\nCustomerData AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(sd.total_quantity) AS total_items_purchased,\n        SUM(sd.total_sales) AS total_spent\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        SalesData sd ON c.c_customer_sk = sd.order_number\n    GROUP BY \n        c.c_customer_sk, cd.cd_gender, cd.cd_marital_status\n),\nPromoData AS (\n    SELECT \n        p.p_promo_sk, \n        p.p_promo_name, \n        SUM(ws.ws_quantity) AS total_sales_by_promo\n    FROM \n        promotion p\n    JOIN \n        web_sales ws ON p.p_promo_sk = ws.ws_promo_sk\n    GROUP BY \n        p.p_promo_sk, p.p_promo_name\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    AVG(cd.total_items_purchased) AS avg_items_purchased,\n    AVG(cd.total_spent) AS avg_spent,\n    pd.total_sales_by_promo,\n    pd.p_promo_name\nFROM \n    CustomerData cd\nJOIN \n    PromoData pd ON cd.total_spent > 1000\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status, pd.p_promo_name, pd.total_sales_by_promo\nORDER BY \n    total_sales_by_promo DESC;\n",
  "\nWITH SalesSummary AS (\n    SELECT\n        d.d_year,\n        d.d_moy,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_quantity) AS total_quantity,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM web_sales ws\n    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE d.d_year = 2022\n    GROUP BY d.d_year, d.d_moy\n),\nCustomerDemographics AS (\n    SELECT\n        cd.cd_gender,\n        cd.cd_marital_status,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM customer_demographics cd\n    JOIN customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    GROUP BY cd.cd_gender, cd.cd_marital_status\n),\nWarehouseSummary AS (\n    SELECT\n        w.w_warehouse_id,\n        COUNT(DISTINCT ws.ws_order_number) AS orders_handled,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM warehouse w\n    JOIN web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY w.w_warehouse_id\n)\nSELECT\n    ss.d_year,\n    ss.d_moy,\n    ss.total_sales,\n    ss.total_quantity,\n    ss.order_count,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.avg_purchase_estimate,\n    ws.w_warehouse_id,\n    ws.orders_handled,\n    ws.total_profit\nFROM SalesSummary ss\nJOIN CustomerDemographics cd ON ss.total_sales >= 1000\nJOIN WarehouseSummary ws ON ws.orders_handled > 10\nORDER BY ss.d_year, ss.d_moy, cd.cd_gender, ws.total_profit DESC;\n",
  "\nWITH CTE_Customer_Sales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        MAX(d.d_date) AS last_purchase_date\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nCTE_Customer_Demographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM \n        customer_demographics cd\n    LEFT JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_credit_rating\n),\nCTE_Combined AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.total_sales,\n        cs.order_count,\n        cs.last_purchase_date,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating\n    FROM \n        CTE_Customer_Sales cs\n    JOIN \n        customer c ON cs.c_customer_sk = c.c_customer_sk\n    JOIN \n        CTE_Customer_Demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n)\nSELECT \n    cb.c_customer_sk,\n    cb.c_first_name,\n    cb.c_last_name,\n    cb.total_sales,\n    cb.order_count,\n    cb.last_purchase_date,\n    cb.cd_gender,\n    cb.cd_marital_status,\n    cb.cd_credit_rating\nFROM \n    CTE_Combined cb\nWHERE \n    cb.total_sales > (SELECT AVG(total_sales) FROM CTE_Customer_Sales) \n    AND cb.cd_credit_rating = 'Low'\nORDER BY \n    cb.total_sales DESC\nLIMIT 100;\n",
  "\nWITH Customer_Sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_order_count,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_order_count,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_order_count\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nSales_With_Gender AS (\n    SELECT \n        cd.cd_gender,\n        SUM(total_web_sales) AS total_web_sales_by_gender,\n        SUM(total_catalog_sales) AS total_catalog_sales_by_gender,\n        SUM(total_store_sales) AS total_store_sales_by_gender,\n        SUM(web_order_count) AS total_web_orders_by_gender,\n        SUM(catalog_order_count) AS total_catalog_orders_by_gender,\n        SUM(store_order_count) AS total_store_orders_by_gender\n    FROM \n        Customer_Sales cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n),\nSales_By_Education AS (\n    SELECT \n        cd.cd_education_status,\n        SUM(Total_Web_Sales_By_Gender) AS Total_Web_Sales,\n        SUM(Total_Catalog_Sales_By_Gender) AS Total_Catalog_Sales,\n        SUM(Total_Store_Sales_By_Gender) AS Total_Store_Sales\n    FROM \n        Sales_With_Gender sg\n    JOIN \n        customer_demographics cd ON sg.cd_gender = cd.cd_gender\n    GROUP BY \n        cd.cd_education_status\n)\n\nSELECT \n    ed.cd_education_status,\n    SUM(total_web_sales) AS total_sales_web,\n    SUM(total_catalog_sales) AS total_sales_catalog,\n    SUM(total_store_sales) AS total_sales_store,\n    AVG(total_web_sales) AS avg_web_sales,\n    AVG(total_catalog_sales) AS avg_catalog_sales,\n    AVG(total_store_sales) AS avg_store_sales\nFROM \n    Sales_By_Education ed\nGROUP BY \n    ed.cd_education_status\nORDER BY \n    total_sales_web DESC, total_sales_catalog DESC, total_sales_store DESC;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        hd.hd_income_band_sk,\n        SUM(ss.ss_quantity) AS total_quantity,\n        SUM(ss.ss_net_paid) AS total_spent\n    FROM\n        customer c\n    JOIN\n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN\n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    LEFT JOIN\n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate, hd.hd_income_band_sk\n),\nDateRange AS (\n    SELECT \n        d.d_date_sk\n    FROM \n        date_dim d\n    WHERE \n        d.d_date BETWEEN '2023-01-01' AND '2023-12-31'\n),\nInventoryDetails AS (\n    SELECT \n        inv.inv_item_sk,\n        SUM(inv.inv_quantity_on_hand) AS total_on_hand\n    FROM \n        inventory inv\n    JOIN \n        DateRange dr ON inv.inv_date_sk = dr.d_date_sk\n    GROUP BY \n        inv.inv_item_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.total_quantity,\n    cs.total_spent,\n    id.total_on_hand\nFROM \n    CustomerStats cs\nLEFT JOIN \n    InventoryDetails id ON cs.c_customer_sk = id.inv_item_sk\nORDER BY \n    cs.total_spent DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_income_band_sk\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    WHERE \n        ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) \n                                  AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        c.c_customer_sk, cd.cd_gender, cd.cd_marital_status, ib.ib_income_band_sk\n),\nSalesSummary AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        ib_income_band_sk,\n        COUNT(DISTINCT c_customer_sk) AS num_customers,\n        SUM(total_quantity_sold) AS total_quantity_sold,\n        SUM(total_net_profit) AS total_net_profit\n    FROM \n        CustomerSales\n    GROUP BY \n        cd_gender, cd_marital_status, ib_income_band_sk\n)\nSELECT \n    ss.cd_gender,\n    ss.cd_marital_status,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    ss.num_customers,\n    ss.total_quantity_sold,\n    ss.total_net_profit,\n    CAST(ss.total_net_profit / NULLIF(ss.total_quantity_sold, 0) AS DECIMAL(10,2)) AS avg_net_profit_per_item\nFROM \n    SalesSummary ss\nLEFT JOIN \n    income_band ib ON ss.ib_income_band_sk = ib.ib_income_band_sk\nORDER BY \n    ss.cd_gender, ss.cd_marital_status, ib.ib_income_band_sk;\n",
  "\nWITH customer_info AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_country\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n),\nsales_summary AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_net_paid) AS total_sales,\n        COUNT(ws_order_number) AS order_count\n    FROM web_sales\n    GROUP BY ws_bill_customer_sk\n),\ncombined_data AS (\n    SELECT \n        ci.c_customer_id,\n        ci.c_first_name,\n        ci.c_last_name,\n        ci.cd_gender,\n        ci.cd_marital_status,\n        ci.cd_education_status,\n        ci.cd_purchase_estimate,\n        ci.ca_city,\n        ci.ca_state,\n        ci.ca_country,\n        ss.total_quantity,\n        ss.total_sales,\n        ss.order_count\n    FROM customer_info ci\n    LEFT JOIN sales_summary ss ON ci.c_customer_id = CAST(ss.ws_bill_customer_sk AS CHAR)\n),\nincome_data AS (\n    SELECT \n        ci.*,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n    FROM combined_data ci\n    JOIN household_demographics hd ON ci.cd_purchase_estimate BETWEEN hd.hd_income_band_sk AND hd.hd_income_band_sk\n    JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n)\nSELECT \n    c_customer_id AS customer_id,\n    c_first_name,\n    c_last_name,\n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    total_quantity,\n    total_sales,\n    order_count,\n    ca_city,\n    ca_state,\n    ca_country,\n    ib_lower_bound,\n    ib_upper_bound\nFROM income_data\nWHERE total_sales > 1000\nORDER BY total_sales DESC\nLIMIT 50;\n",
  "WITH CustomerReturns AS (\n    SELECT\n        wr_returning_customer_sk,\n        SUM(wr_return_quantity) AS total_returned_quantity,\n        SUM(wr_return_amt_inc_tax) AS total_returned_amount,\n        COUNT(DISTINCT wr_order_number) AS total_returned_orders \n    FROM\n        web_returns\n    GROUP BY\n        wr_returning_customer_sk\n),\nAggregateCustomerInfo AS (\n    SELECT\n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_city,\n        ca.ca_state,\n        cr.total_returned_quantity,\n        cr.total_returned_amount,\n        cr.total_returned_orders\n    FROM\n        customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    LEFT JOIN CustomerReturns cr ON c.c_customer_sk = cr.wr_returning_customer_sk\n),\nMonthlySales AS (\n    SELECT\n        d.d_year,\n        d.d_month_seq,\n        SUM(ws_ext_sales_price) AS total_sales_amount\n    FROM\n        web_sales\n    JOIN date_dim d ON d.d_date_sk = ws_sold_date_sk\n    GROUP BY\n        d.d_year, d.d_month_seq\n),\nFinalReport AS (\n    SELECT\n        aci.c_customer_id,\n        aci.cd_gender,\n        aci.cd_marital_status,\n        aci.cd_education_status,\n        aci.ca_city,\n        aci.ca_state,\n        aci.total_returned_quantity,\n        aci.total_returned_amount,\n        aci.total_returned_orders,\n        ms.d_year,\n        ms.d_month_seq,\n        ms.total_sales_amount\n    FROM\n        AggregateCustomerInfo aci\n    JOIN MonthlySales ms ON ms.d_year = EXTRACT(YEAR FROM cast('2002-10-01' as date)) \n        AND ms.d_month_seq = EXTRACT(MONTH FROM cast('2002-10-01' as date))\n)\nSELECT\n    c_customer_id,\n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    ca_city,\n    ca_state,\n    total_returned_quantity,\n    total_returned_amount,\n    total_returned_orders,\n    d_year,\n    d_month_seq,\n    total_sales_amount\nFROM\n    FinalReport\nORDER BY\n    total_returned_amount DESC, total_returned_orders DESC;",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt) AS total_returned_amount,\n        COUNT(DISTINCT sr_ticket_number) AS return_count\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nWebSales AS (\n    SELECT \n        ws_bill_customer_sk,\n        SUM(ws_quantity) AS total_web_sales_quantity,\n        SUM(ws_net_paid_inc_tax) AS total_web_sales_amt\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        cd_demo_sk,\n        cd_gender,\n        cd_marital_status,\n        CASE \n            WHEN cd_purchase_estimate < 1000 THEN 'Low'\n            WHEN cd_purchase_estimate BETWEEN 1000 AND 5000 THEN 'Medium'\n            ELSE 'High'\n        END AS purchase_band\n    FROM \n        customer_demographics\n),\nDateRange AS (\n    SELECT \n        d_year,\n        d_month_seq,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM \n        date_dim\n    JOIN \n        web_sales ON d_date_sk = ws_sold_date_sk\n    WHERE \n        d_date BETWEEN '2022-01-01' AND '2022-12-31'\n    GROUP BY \n        d_year, d_month_seq\n)\n\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    COALESCE(cr.total_returned_quantity, 0) AS total_returned_quantity,\n    COALESCE(cr.total_returned_amount, 0) AS total_returned_amount,\n    COALESCE(ws.total_web_sales_quantity, 0) AS total_web_sales_quantity,\n    COALESCE(ws.total_web_sales_amt, 0) AS total_web_sales_amt,\n    cd.purchase_band,\n    dr.d_year,\n    dr.d_month_seq,\n    dr.total_orders\nFROM \n    customer c\nLEFT JOIN \n    CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\nLEFT JOIN \n    WebSales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nLEFT JOIN \n    CustomerDemographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nCROSS JOIN \n    DateRange dr\nWHERE \n    (cd.cd_gender = 'F' OR cd.cd_gender IS NULL) AND\n    (cd.cd_marital_status = 'M' OR cd.cd_marital_status IS NULL)\nORDER BY \n    total_web_sales_amt DESC,\n    total_returned_amount DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        SUM(ws.ws_ext_tax) AS total_tax,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        w.w_warehouse_name,\n        d.d_month_seq,\n        d.d_year\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        ws.ws_sold_date_sk, \n        ws.ws_item_sk, \n        w.w_warehouse_name, \n        d.d_month_seq, \n        d.d_year\n),\nMaxSales AS (\n    SELECT \n        warehouse_name,\n        d_year,\n        d_month_seq,\n        MAX(total_sales) AS max_sales\n    FROM \n        (SELECT \n            w.w_warehouse_name AS warehouse_name,\n            d.d_year,\n            d.d_month_seq,\n            SUM(ws.ws_sales_price) AS total_sales\n        FROM \n            web_sales ws\n        JOIN \n            warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n        JOIN \n            date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n        GROUP BY \n            w.w_warehouse_name, \n            d.d_year, \n            d.d_month_seq) AS InnerSales\n    GROUP BY \n        warehouse_name, d_year, d_month_seq\n)\nSELECT \n    sd.w_warehouse_name AS warehouse_name,\n    sd.d_year,\n    sd.d_month_seq,\n    sd.total_quantity,\n    sd.total_sales,\n    sd.total_discount,\n    sd.total_tax,\n    sd.total_orders\nFROM \n    SalesData sd\nJOIN \n    MaxSales ms ON sd.w_warehouse_name = ms.warehouse_name \n                AND sd.d_year = ms.d_year \n                AND sd.d_month_seq = ms.d_month_seq \n                AND sd.total_sales = ms.max_sales\nORDER BY \n    sd.d_year DESC, sd.d_month_seq DESC, sd.w_warehouse_name;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_profit) AS avg_net_profit\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON d.d_date_sk = ws.ws_sold_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COUNT(DISTINCT cs.c_customer_sk) AS num_customers\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        CustomerSales cs ON cs.c_customer_sk = c.c_customer_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nSalesSummary AS (\n    SELECT\n        c.cd_gender AS gender,\n        c.cd_marital_status AS marital_status,\n        c.cd_education_status AS education_status,\n        SUM(cs.total_web_sales) AS total_sales,\n        SUM(cs.total_orders) AS total_orders,\n        AVG(cs.avg_net_profit) AS avg_net_profit\n    FROM \n        CustomerDemographics c\n    JOIN \n        CustomerSales cs ON cs.c_customer_sk = c.cd_demo_sk\n    GROUP BY \n        c.cd_gender, c.cd_marital_status, c.cd_education_status\n)\nSELECT \n    gender,\n    marital_status,\n    education_status,\n    total_sales,\n    total_orders,\n    avg_net_profit\nFROM \n    SalesSummary\nORDER BY \n    total_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH CustomerSummary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_paid) AS total_spent\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_credit_rating\n),\n\nDateRange AS (\n    SELECT \n        d.d_date_sk\n    FROM \n        date_dim d\n    WHERE \n        d.d_date BETWEEN '2022-01-01' AND '2022-12-31'\n),\n\nPromotionSummary AS (\n    SELECT \n        p.p_promo_sk,\n        p.p_promo_name,\n        COUNT(ws.ws_order_number) AS promo_order_count,\n        SUM(ws.ws_net_paid) AS promo_revenue\n    FROM \n        promotion p\n    JOIN \n        web_sales ws ON p.p_promo_sk = ws.ws_promo_sk\n    JOIN \n        DateRange dr ON ws.ws_sold_date_sk = dr.d_date_sk\n    GROUP BY \n        p.p_promo_sk, p.p_promo_name\n)\n\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.total_orders,\n    cs.total_spent,\n    ps.promo_order_count,\n    ps.promo_revenue\nFROM \n    CustomerSummary cs\nLEFT JOIN \n    PromotionSummary ps ON cs.total_orders > 0\nORDER BY \n    cs.total_spent DESC, ps.promo_revenue DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        SUM(ws.ws_ext_tax) AS total_tax\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN \n        item it ON ws.ws_item_sk = it.i_item_sk\n    WHERE \n        dd.d_year = 2023\n        AND it.i_current_price > 10.00\n    GROUP BY \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk\n), customer_summary AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ss.total_sales) AS total_spent,\n        SUM(ss.total_discount) AS total_discount,\n        SUM(ss.total_tax) AS total_tax\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    JOIN \n        sales_summary ss ON ws.ws_sold_date_sk = ss.ws_sold_date_sk AND ws.ws_item_sk = ss.ws_item_sk\n    GROUP BY \n        c.c_customer_sk\n), gender_summary AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT cs.c_customer_sk) AS customer_count,\n        SUM(cs.total_orders) AS total_orders,\n        SUM(cs.total_spent) AS total_spent,\n        SUM(cs.total_discount) AS total_discount,\n        SUM(cs.total_tax) AS total_tax\n    FROM \n        customer_summary cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n)\nSELECT \n    gs.cd_gender,\n    gs.customer_count,\n    gs.total_orders,\n    gs.total_spent,\n    gs.total_discount,\n    gs.total_tax,\n    (gs.total_spent / NULLIF(gs.customer_count, 0) ) AS avg_spent_per_customer\nFROM \n    gender_summary gs\nORDER BY \n    total_spent DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_net_profit) AS total_profit,\n        d.d_year,\n        c.c_current_cdemo_sk,\n        cd.cd_gender,\n        ib.ib_income_band_sk\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    GROUP BY \n        ws.ws_item_sk, d.d_year, c.c_current_cdemo_sk, cd.cd_gender, ib.ib_income_band_sk\n)\nSELECT \n    sd.ws_item_sk,\n    sd.d_year,\n    COUNT(DISTINCT sd.c_current_cdemo_sk) AS num_customers,\n    SUM(sd.total_quantity) AS total_sales_quantity,\n    AVG(sd.total_sales) AS avg_sale_price,\n    AVG(sd.total_profit) AS avg_profit,\n    MAX(sd.total_sales) AS max_sale,\n    MIN(sd.total_sales) AS min_sale,\n    sd.cd_gender,\n    sd.ib_income_band_sk\nFROM \n    SalesData sd\nGROUP BY \n    sd.ws_item_sk, sd.d_year, sd.cd_gender, sd.ib_income_band_sk\nORDER BY \n    sd.d_year DESC, total_sales_quantity DESC\nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt) AS total_returned_amt,\n        SUM(sr_return_quantity) AS total_returned_qty\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nWebReturns AS (\n    SELECT \n        wr_returning_customer_sk,\n        COUNT(wr_order_number) AS web_total_returns,\n        SUM(wr_return_amt) AS web_total_returned_amt\n    FROM \n        web_returns\n    GROUP BY \n        wr_returning_customer_sk\n),\nSalesTotals AS (\n    SELECT \n        ws_bill_customer_sk AS customer_sk,\n        SUM(ws_net_paid) AS total_net_paid,\n        SUM(ws_net_paid_inc_tax) AS total_net_paid_inc_tax,\n        COUNT(ws_order_number) AS total_orders\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nIncomeEstimates AS (\n    SELECT \n        cd_demo_sk,\n        CASE\n            WHEN cd_purchase_estimate < 1000 THEN 'Low'\n            WHEN cd_purchase_estimate BETWEEN 1000 AND 5000 THEN 'Medium'\n            ELSE 'High'\n        END AS income_category\n    FROM \n        customer_demographics\n),\nCustomerStatistics AS (\n    SELECT \n        c.c_customer_sk,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(wr.web_total_returns, 0) AS web_total_returns,\n        COALESCE(st.total_net_paid, 0) AS total_net_paid,\n        COALESCE(st.total_orders, 0) AS total_orders,\n        ie.income_category\n    FROM \n        customer c\n    LEFT JOIN \n        CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN \n        WebReturns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    LEFT JOIN \n        SalesTotals st ON c.c_customer_sk = st.customer_sk\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        IncomeEstimates ie ON cd.cd_demo_sk = ie.cd_demo_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.total_returns,\n    cs.web_total_returns,\n    cs.total_net_paid,\n    cs.income_category,\n    CASE \n        WHEN cs.total_returns > 5 THEN 'Frequent Returner'\n        WHEN cs.total_orders > 10 THEN 'Active Customer'\n        ELSE 'Occasional Customer'\n    END AS customer_status\nFROM \n    CustomerStatistics cs\nWHERE \n    cs.total_net_paid > 1000\nORDER BY \n    cs.total_returns DESC, cs.total_net_paid DESC\nLIMIT 50;\n",
  "\nWITH customer_data AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        c.c_first_name,\n        c.c_last_name,\n        ca.ca_city,\n        ca.ca_state,\n        SUM(ss.ss_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ss.ss_ticket_number) AS purchase_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    WHERE \n        cd.cd_gender = 'F' \n        AND cd.cd_marital_status = 'M' \n        AND ca.ca_state = 'CA'\n    GROUP BY \n        c.c_customer_id, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_education_status, \n        c.c_first_name, \n        c.c_last_name, \n        ca.ca_city, \n        ca.ca_state\n),\npromotion_summary AS (\n    SELECT \n        p.p_promo_name,\n        SUM(cs.cs_net_profit) AS total_promo_profit\n    FROM \n        promotion p\n    JOIN \n        catalog_sales cs ON p.p_promo_sk = cs.cs_promo_sk\n    GROUP BY \n        p.p_promo_name\n),\nfinal_summary AS (\n    SELECT \n        cd.c_customer_id,\n        cd.c_first_name,\n        cd.c_last_name,\n        cd.ca_city,\n        cd.ca_state,\n        cd.total_net_profit,\n        ps.p_promo_name AS promo_name,\n        ps.total_promo_profit\n    FROM \n        customer_data cd\n    LEFT JOIN \n        promotion_summary ps ON cd.total_net_profit > 1000\n)\nSELECT \n    f.c_customer_id,\n    f.c_first_name,\n    f.c_last_name,\n    f.ca_city,\n    f.ca_state,\n    f.total_net_profit,\n    f.promo_name,\n    f.total_promo_profit\nFROM \n    final_summary f\nORDER BY \n    f.total_net_profit DESC, \n    f.c_last_name ASC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH DemographicDetails AS (\n    SELECT \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_education_status, \n        COUNT(DISTINCT c.c_customer_id) AS customer_count,\n        SUM(ws.ws_quantity) AS total_sales_quantity,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_education_status\n),\nAddressDetails AS (\n    SELECT \n        ca.ca_state, \n        ca.ca_city, \n        COUNT(DISTINCT c.c_customer_id) AS customer_count_by_location\n    FROM \n        customer_address ca\n    JOIN \n        customer c ON ca.ca_address_sk = c.c_current_addr_sk\n    GROUP BY \n        ca.ca_state, \n        ca.ca_city\n),\nSalesMetrics AS (\n    SELECT\n        ws.ws_sold_date_sk, \n        COUNT(ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_ext_sales_price) AS total_sales_revenue,\n        SUM(ws.ws_ext_tax) AS total_sales_tax\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_sold_date_sk\n)\nSELECT \n    dd.cd_gender,\n    dd.cd_marital_status,\n    dd.cd_education_status,\n    ad.ca_state,\n    ad.ca_city,\n    ad.customer_count_by_location,\n    sm.total_orders,\n    sm.total_sales_revenue,\n    sm.total_sales_tax,\n    dd.total_sales_quantity,\n    dd.total_net_profit\nFROM \n    DemographicDetails dd\nJOIN \n    AddressDetails ad ON dd.customer_count = ad.customer_count_by_location\nJOIN \n    SalesMetrics sm ON sm.total_orders = (SELECT MAX(total_orders) FROM SalesMetrics)\nORDER BY \n    dd.cd_gender, \n    ad.ca_state, \n    ad.ca_city;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_paid) AS total_spent,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nhigh_value_customers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cs.total_spent,\n        cs.total_orders\n    FROM \n        customer_sales cs\n    JOIN \n        customer c ON cs.c_customer_sk = c.c_customer_sk\n    WHERE \n        cs.total_spent > (SELECT AVG(total_spent) FROM customer_sales)\n),\ntop_items AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        web_sales ws\n    GROUP BY \n        ws.ws_item_sk\n    ORDER BY \n        total_quantity_sold DESC\n    LIMIT 10\n),\nitem_promotions AS (\n    SELECT \n        p.p_promo_name,\n        p.p_discount_active,\n        ti.ws_item_sk,\n        SUM(ti.total_quantity_sold) AS total_sales\n    FROM \n        top_items ti\n    LEFT JOIN \n        promotion p ON ti.ws_item_sk = p.p_item_sk\n    GROUP BY \n        p.p_promo_name, p.p_discount_active, ti.ws_item_sk\n)\nSELECT \n    hvc.c_first_name,\n    hvc.c_last_name,\n    ti.ws_item_sk,\n    ti.total_quantity_sold,\n    ip.p_promo_name,\n    ip.total_sales,\n    CASE \n        WHEN ip.p_discount_active = 'Y' THEN 'Active'\n        ELSE 'Inactive'\n    END AS promo_status\nFROM \n    high_value_customers hvc\nJOIN \n    item_promotions ip ON hvc.c_customer_sk = ip.ws_item_sk\nJOIN \n    top_items ti ON ip.ws_item_sk = ti.ws_item_sk\nWHERE \n    hvc.total_orders > (\n        SELECT AVG(total_orders) FROM customer_sales\n    )\nORDER BY \n    hvc.total_spent DESC, ti.total_quantity_sold DESC;\n",
  "\nWITH aggregated_sales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        AVG(ws.ws_quantity) AS avg_quantity_per_order,\n        MAX(ws.ws_net_paid) AS max_transaction,\n        MIN(ws.ws_net_paid) AS min_transaction\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_id\n),\ndemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_state,\n        COUNT(c.c_customer_sk) AS customer_count\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, ca.ca_state\n),\nprofit_summary AS (\n    SELECT \n        d.cd_gender,\n        d.cd_marital_status,\n        d.cd_education_status,\n        d.ca_state,\n        SUM(a.total_profit) AS total_profit,\n        SUM(a.order_count) AS total_orders,\n        AVG(a.avg_quantity_per_order) AS avg_quantity\n    FROM \n        aggregated_sales a\n    JOIN \n        demographics d ON d.customer_count > 0\n    GROUP BY \n        d.cd_gender, d.cd_marital_status, d.cd_education_status, d.ca_state\n)\nSELECT \n    ps.cd_gender,\n    ps.cd_marital_status,\n    ps.cd_education_status,\n    ps.ca_state,\n    ps.total_profit,\n    ps.total_orders,\n    ps.avg_quantity\nFROM \n    profit_summary ps\nWHERE \n    ps.total_profit > 10000\nORDER BY \n    ps.total_profit DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(SUM(ws.ws_net_paid_inc_tax), 0) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        COUNT(DISTINCT ws.ws_item_sk) AS unique_items\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nPromotions AS (\n    SELECT \n        p.p_promo_id,\n        COUNT(DISTINCT ws.ws_order_number) AS promo_order_count,\n        SUM(ws.ws_net_paid_inc_tax) AS promo_sales\n    FROM \n        web_sales ws\n    JOIN \n        promotion p ON ws.ws_promo_sk = p.p_promo_sk\n    GROUP BY \n        p.p_promo_id\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n)\nSELECT \n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_sales,\n    cs.total_orders,\n    cs.unique_items,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    COALESCE(promo.total_orders, 0) AS promo_order_count,\n    COALESCE(promo.promo_sales, 0) AS promo_sales\nFROM \n    CustomerSales cs\nLEFT JOIN \n    CustomerDemographics cd ON cs.c_customer_sk = cd.cd_demo_sk\nLEFT JOIN \n    (\n        SELECT \n            pd.promo_order_count,\n            pd.promo_sales,\n            COUNT(DISTINCT pd.promo_order_count) AS total_orders\n        FROM \n            Promotions pd\n        GROUP BY \n            pd.promo_order_count, pd.promo_sales\n    ) promo ON promo.promo_order_count = cs.total_orders\nWHERE \n    cs.total_sales > 1000 \n    OR cd.cd_marital_status = 'M'\nORDER BY \n    cs.total_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        d.d_year,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        COUNT(DISTINCT ws_bill_customer_sk) AS unique_customers,\n        SUM(ws_net_profit) AS total_net_profit\n    FROM \n        web_sales\n    JOIN \n        date_dim d ON ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n),\ncustomer_demographics AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        COUNT(DISTINCT c_customer_sk) AS customer_count,\n        SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_customers,\n        SUM(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_customers\n    FROM \n        customer \n    JOIN \n        customer_demographics cd ON c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_gender, cd_marital_status\n),\nwarehouse_summary AS (\n    SELECT \n        w.w_warehouse_id,\n        COUNT(DISTINCT ws_order_number) AS orders_in_warehouse,\n        SUM(ws_ext_sales_price) AS warehouse_sales\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    ss.d_year,\n    ss.total_sales,\n    ss.total_orders,\n    ss.unique_customers,\n    ss.total_net_profit,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.customer_count,\n    cd.female_customers,\n    cd.male_customers,\n    ws.w_warehouse_id,\n    ws.orders_in_warehouse,\n    ws.warehouse_sales\nFROM \n    sales_summary ss\nJOIN \n    customer_demographics cd ON cd.customer_count > 0\nJOIN \n    warehouse_summary ws ON ws.orders_in_warehouse > 0\nORDER BY \n    ss.d_year DESC, \n    ws.w_warehouse_id;\n",
  "\nWITH SalesData AS (\n    SELECT \n        w.w_warehouse_name,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_profit) AS avg_profit,\n        CAST(d.d_date AS DATE) AS sales_date\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        w.w_warehouse_name, CAST(d.d_date AS DATE)\n),\nCustomerInfo AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_ext_sales_price) AS customer_sales\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nPerformanceMetrics AS (\n    SELECT \n        sd.sales_date,\n        sd.w_warehouse_name,\n        ci.cd_gender,\n        ci.cd_marital_status,\n        SUM(sd.total_sales) AS warehouse_sales,\n        COUNT(DISTINCT ci.c_customer_id) AS distinct_customers,\n        SUM(ci.customer_sales) AS customer_contribution\n    FROM \n        SalesData sd\n    JOIN \n        CustomerInfo ci ON sd.sales_date = CAST('2002-10-01' AS DATE)\n    GROUP BY \n        sd.sales_date, sd.w_warehouse_name, ci.cd_gender, ci.cd_marital_status\n)\nSELECT \n    w_warehouse_name AS warehouse_name,\n    cd_gender,\n    cd_marital_status,\n    AVG(distinct_customers) AS avg_distinct_customers,\n    SUM(customer_contribution) AS total_customer_contribution,\n    SUM(warehouse_sales) AS total_warehouse_sales\nFROM \n    PerformanceMetrics\nGROUP BY \n    w_warehouse_name, cd_gender, cd_marital_status\nORDER BY \n    total_warehouse_sales DESC, avg_distinct_customers DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_ext_sales_price) AS avg_order_value,\n        MAX(ws.ws_ext_sales_price) AS max_order_value,\n        MIN(ws.ws_ext_sales_price) AS min_order_value\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales\n    FROM \n        customer_demographics cd\n    LEFT JOIN \n        catalog_sales cs ON cd.cd_demo_sk = cs.cs_bill_cdemo_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_credit_rating \n),\nSalesPeriod AS (\n    SELECT \n        d.d_year,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(ws.ws_order_number) AS total_web_orders\n    FROM \n        date_dim d\n    JOIN \n        web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\n    GROUP BY \n        d.d_year\n)\n\nSELECT \n    cs.c_customer_sk,\n    cs.total_sales,\n    cs.total_orders,\n    cs.avg_order_value,\n    cs.max_order_value,\n    cs.min_order_value,\n    d.cd_gender,\n    d.cd_marital_status,\n    d.cd_credit_rating,\n    d.total_catalog_sales,\n    sp.d_year,\n    sp.total_net_profit,\n    sp.total_web_orders\nFROM \n    CustomerSales cs\nJOIN \n    Demographics d ON cs.c_customer_sk = d.cd_demo_sk\nJOIN \n    SalesPeriod sp ON sp.total_net_profit > 10000\nORDER BY \n    cs.total_sales DESC\nFETCH FIRST 1000 ROWS ONLY;\n",
  "\nWITH CustomerSummary AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        SUM(ss.ss_net_profit) AS total_spent,\n        COUNT(ss.ss_ticket_number) AS total_purchases\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status\n),\nDateRange AS (\n    SELECT \n        MIN(d.d_date) AS start_date, \n        MAX(d.d_date) AS end_date\n    FROM date_dim d\n    WHERE d.d_year = 2023\n),\nItemSummary AS (\n    SELECT \n        i.i_item_id, \n        i.i_item_desc, \n        COUNT(ss.ss_ticket_number) AS sold_count,\n        SUM(ss.ss_net_profit) AS total_revenue\n    FROM item i\n    JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk\n    GROUP BY \n        i.i_item_id, \n        i.i_item_desc\n),\nHighSpenders AS (\n    SELECT \n        cs.c_customer_sk, \n        cs.c_first_name, \n        cs.c_last_name, \n        cs.total_spent, \n        cs.total_purchases,\n        CASE\n            WHEN cs.total_spent > 1000 THEN 'High'\n            WHEN cs.total_spent BETWEEN 500 AND 1000 THEN 'Medium'\n            ELSE 'Low'\n        END AS spending_category\n    FROM CustomerSummary cs\n)\n\nSELECT \n    hs.c_customer_sk, \n    hs.c_first_name, \n    hs.c_last_name, \n    hs.total_spent, \n    hs.spending_category,\n    ir.i_item_id AS item_id,\n    ir.i_item_desc AS item_desc,\n    ir.sold_count,\n    ir.total_revenue,\n    dr.start_date,\n    dr.end_date\nFROM HighSpenders hs\nJOIN ItemSummary ir ON ir.sold_count > 10\nCROSS JOIN DateRange dr\nWHERE hs.total_spent IS NOT NULL\nORDER BY hs.total_spent DESC, ir.total_revenue DESC\nLIMIT 50;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_returned_date_sk,\n        sr_item_sk,\n        COUNT(sr_ticket_number) AS total_returns,\n        SUM(sr_return_quantity) AS total_returned_quantity,\n        SUM(sr_return_amt) AS total_returned_amount,\n        SUM(sr_return_tax) AS total_returned_tax\n    FROM \n        store_returns\n    GROUP BY \n        sr_returned_date_sk, sr_item_sk\n),\nPromotionDetails AS (\n    SELECT \n        p.p_promo_sk,\n        p.p_promo_name,\n        SUM(cs_ext_sales_price) AS total_sales\n    FROM \n        promotion p\n    JOIN \n        catalog_sales cs ON p.p_promo_sk = cs.cs_promo_sk\n    GROUP BY \n        p.p_promo_sk, p.p_promo_name\n),\nSalesSummary AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_sold_quantity,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        item i ON ws.ws_item_sk = i.i_item_sk\n    WHERE \n        i.i_current_price > 0\n    GROUP BY \n        ws.ws_sold_date_sk, ws.ws_item_sk\n)\nSELECT \n    d.d_date AS sales_date,\n    COALESCE(sales.total_sold_quantity, 0) AS total_sold_quantity,\n    COALESCE(cr.total_returns, 0) AS total_returns,\n    COALESCE(cr.total_returned_quantity, 0) AS total_returned_quantity,\n    COALESCE(cr.total_returned_amount, 0) AS total_returned_amount,\n    COALESCE(pd.total_sales, 0) AS total_sales_from_promotion,\n    SUM(sales.total_net_profit) AS total_net_profit\nFROM \n    date_dim d\nLEFT JOIN \n    SalesSummary sales ON d.d_date_sk = sales.ws_sold_date_sk\nLEFT JOIN \n    CustomerReturns cr ON d.d_date_sk = cr.sr_returned_date_sk\nLEFT JOIN \n    PromotionDetails pd ON sales.ws_item_sk = pd.p_promo_sk\nWHERE \n    d.d_year = 2023\n    AND (cr.total_returns IS NULL OR cr.total_returns > 0)\nGROUP BY \n    d.d_date, sales.total_sold_quantity, cr.total_returns, cr.total_returned_quantity, cr.total_returned_amount, pd.total_sales\nORDER BY \n    sales_date;\n",
  "\nWITH customer_data AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        SUM(ws.ws_sales_price) AS total_spent\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\n\nsales_analysis AS (\n    SELECT\n        ca.ca_city,\n        ca.ca_state,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        AVG(ws.ws_sales_price) AS average_sales_price,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        c.c_customer_sk\n    FROM \n        customer c\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        ca.ca_city, ca.ca_state, c.c_customer_sk\n)\n\nSELECT \n    cust.c_first_name,\n    cust.c_last_name,\n    cust.cd_gender,\n    cust.cd_marital_status,\n    cust.cd_education_status,\n    sales.total_quantity_sold,\n    sales.average_sales_price,\n    sales.total_orders,\n    cust.total_spent\nFROM \n    customer_data cust\nJOIN \n    sales_analysis sales ON cust.c_customer_sk = sales.c_customer_sk\nWHERE \n    cust.order_count > 0\nORDER BY \n    cust.total_spent DESC, cust.c_last_name, cust.c_first_name\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH CustomerStats AS (\n    SELECT\n        c.c_customer_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        SUM(ws.ws_ext_discount_amt) AS total_discount\n    FROM\n        customer c\n    JOIN\n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE\n        c.c_current_cdemo_sk IS NOT NULL\n    GROUP BY\n        c.c_customer_sk\n),\nFrequentCustomers AS (\n    SELECT\n        cs.c_customer_sk,\n        cs.total_quantity,\n        cs.total_sales,\n        cs.order_count,\n        cs.total_discount,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        hd.hd_buy_potential\n    FROM\n        CustomerStats cs\n    JOIN\n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    LEFT JOIN\n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    WHERE\n        cs.order_count > 5\n),\nSalesTrends AS (\n    SELECT\n        d.d_year,\n        SUM(ws.ws_ext_sales_price) AS annual_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM\n        web_sales ws\n    JOIN\n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY\n        d.d_year\n)\nSELECT\n    f.c_customer_sk,\n    f.total_quantity,\n    f.total_sales,\n    f.order_count,\n    f.total_discount,\n    f.cd_gender,\n    f.cd_marital_status,\n    f.hd_buy_potential,\n    s.d_year,\n    s.annual_sales,\n    s.total_orders\nFROM\n    FrequentCustomers f\nJOIN\n    SalesTrends s ON f.total_sales > (SELECT AVG(total_sales) FROM CustomerStats)\nORDER BY\n    f.total_sales DESC, s.d_year DESC;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_customer_id, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_education_status, \n        hd.hd_income_band_sk, \n        hd.hd_buy_potential, \n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, \n        c.c_customer_id, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_education_status, \n        hd.hd_income_band_sk, \n        hd.hd_buy_potential\n),\nsales_summary AS (\n    SELECT \n        d.d_year, \n        COUNT(DISTINCT ws.ws_order_number) AS num_orders, \n        SUM(ws.ws_ext_sales_price) AS total_sales\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n)\nSELECT \n    cs.c_customer_id,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.cd_education_status,\n    cs.hd_income_band_sk,\n    cs.hd_buy_potential,\n    ss.d_year,\n    ss.num_orders,\n    ss.total_sales,\n    cs.total_orders,\n    cs.total_sales,\n    cs.total_profit\nFROM \n    customer_summary cs\nJOIN \n    sales_summary ss ON cs.total_orders > 0\nORDER BY \n    cs.total_sales DESC, ss.total_sales DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws_ext_sales_price) AS total_web_sales,\n        SUM(cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss_ext_sales_price) AS total_store_sales,\n        COUNT(DISTINCT ws_order_number) AS web_order_count,\n        COUNT(DISTINCT cs_order_number) AS catalog_order_count,\n        COUNT(DISTINCT ss_ticket_number) AS store_order_count\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        AVG(hd.hd_income_band_sk) AS avg_income_band\n    FROM \n        customer_demographics cd\n    LEFT JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate, cd.cd_credit_rating\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_web_sales,\n    cs.total_catalog_sales,\n    cs.total_store_sales,\n    cs.web_order_count,\n    cs.catalog_order_count,\n    cs.store_order_count,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_purchase_estimate,\n    cd.cd_credit_rating,\n    cd.avg_income_band\nFROM \n    CustomerSales cs\nLEFT JOIN \n    CustomerDemographics cd ON cs.c_customer_sk = cd.cd_demo_sk\nWHERE \n    (cs.total_web_sales > 1000 OR cs.total_catalog_sales > 1000 OR cs.total_store_sales > 1000)\n    AND (cd.cd_gender = 'M' OR cd.cd_marital_status = 'S')\nORDER BY \n    cs.total_web_sales DESC NULLS LAST,\n    cd.cd_purchase_estimate DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        cs_item_sk,\n        SUM(cs_quantity) AS total_quantity_sold,\n        SUM(cs_ext_sales_price) AS total_sales,\n        SUM(cs_ext_discount_amt) AS total_discount,\n        COUNT(DISTINCT cs_order_number) AS total_orders\n    FROM \n        catalog_sales\n    WHERE \n        cs_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 30 AND \n                              (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        cs_item_sk\n),\nitem_info AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_id,\n        i.i_item_desc,\n        i.i_current_price,\n        COALESCE(ss.total_quantity_sold, 0) AS total_quantity_sold,\n        COALESCE(ss.total_sales, 0) AS total_sales,\n        COALESCE(ss.total_discount, 0) AS total_discount,\n        COALESCE(ss.total_orders, 0) AS total_orders\n    FROM \n        item i\n    LEFT JOIN \n        sales_summary ss ON i.i_item_sk = ss.cs_item_sk\n),\ndemographics_info AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        cd.cd_dep_count,\n        cd.cd_dep_college_count,\n        SUM(ss.total_sales) AS demographic_total_sales\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        sales_summary ss ON ws.ws_item_sk = ss.cs_item_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate, \n        cd.cd_credit_rating, cd.cd_dep_count, cd.cd_dep_college_count\n)\nSELECT \n    i.i_item_id,\n    i.i_item_desc,\n    i.i_current_price,\n    di.cd_gender,\n    di.cd_marital_status,\n    di.demographic_total_sales,\n    i.total_quantity_sold,\n    i.total_sales,\n    i.total_discount,\n    i.total_orders\nFROM \n    item_info i\nJOIN \n    demographics_info di ON i.total_sales > 1000 AND di.demographic_total_sales > 50000\nORDER BY \n    i.total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_sold_date_sk,\n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity_sold,\n        SUM(ws_sales_price) AS total_sales,\n        SUM(ws_ext_discount_amt) AS total_discount,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM \n        web_sales\n    WHERE\n        ws_sales_price > 0\n    GROUP BY \n        ws_sold_date_sk, ws_item_sk\n),\ndemographics_summary AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT ws_order_number) AS order_count,\n        SUM(sf.total_sales) AS total_spent\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        sales_summary sf ON ws.ws_item_sk = sf.ws_item_sk AND ws.ws_sold_date_sk = sf.ws_sold_date_sk\n    GROUP BY \n        c.c_customer_sk, cd.cd_gender, cd.cd_marital_status\n),\nactive_customers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name, \n        c.c_last_name,\n        ds.d_year,\n        ds.d_month_seq\n    FROM \n        customer c\n    JOIN \n        date_dim ds ON c.c_first_sales_date_sk = ds.d_date_sk\n    WHERE \n        ds.d_year = 2023\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, ds.d_year, ds.d_month_seq\n)\nSELECT \n    d.cd_gender,\n    d.cd_marital_status,\n    COUNT(DISTINCT a.c_customer_sk) AS active_customers_count,\n    SUM(d.total_spent) AS total_spent_by_gender_and_marital_status,\n    AVG(d.order_count) AS avg_orders_per_customer\nFROM \n    demographics_summary d\nJOIN \n    active_customers a ON d.c_customer_sk = a.c_customer_sk\nGROUP BY \n    d.cd_gender, d.cd_marital_status\nORDER BY \n    total_spent_by_gender_and_marital_status DESC;\n",
  "WITH AddressStats AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT ca_address_sk) AS unique_addresses,\n        AVG(LENGTH(ca_street_name)) AS avg_street_name_length,\n        MAX(LENGTH(ca_street_name)) AS max_street_name_length,\n        MIN(LENGTH(ca_street_name)) AS min_street_name_length\n    FROM \n        customer_address\n    GROUP BY \n        ca_state\n),\nCustomerStats AS (\n    SELECT \n        cd_gender,\n        COUNT(c_customer_sk) AS total_customers,\n        AVG(cd_dep_count) AS avg_dependent_count,\n        SUM(cd_purchase_estimate) AS total_purchase_estimate\n    FROM \n        customer_demographics\n    JOIN \n        customer ON cd_demo_sk = c_current_cdemo_sk \n    GROUP BY \n        cd_gender\n),\nSalesStats AS (\n    SELECT \n        d_year,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit\n    FROM \n        web_sales\n    JOIN \n        date_dim ON ws_sold_date_sk = d_date_sk \n    GROUP BY \n        d_year\n),\nPromotions AS (\n    SELECT \n        p_channel_details,\n        COUNT(DISTINCT p_promo_id) AS total_promotions,\n        AVG(p_cost) AS avg_cost\n    FROM \n        promotion\n    GROUP BY \n        p_channel_details\n)\nSELECT \n    a.ca_state,\n    a.unique_addresses,\n    a.avg_street_name_length,\n    a.max_street_name_length,\n    a.min_street_name_length,\n    c.cd_gender,\n    c.total_customers,\n    c.avg_dependent_count,\n    c.total_purchase_estimate,\n    s.d_year,\n    s.total_sales,\n    s.total_profit,\n    p.p_channel_details,\n    p.total_promotions,\n    p.avg_cost\nFROM \n    AddressStats a\nJOIN \n    CustomerStats c ON a.ca_state = 'CA'  \nJOIN \n    SalesStats s ON s.d_year = 2001  \nJOIN \n    Promotions p ON p.total_promotions > 10  \nORDER BY \n    a.unique_addresses DESC, \n    c.total_customers DESC;",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        AVG(ws.ws_net_paid_inc_tax) AS avg_transaction_value\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate, cd.cd_credit_rating\n),\nTopIncomeBands AS (\n    SELECT\n        ib.ib_income_band_sk,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound,\n        COUNT(hd.hd_demo_sk) AS customer_count\n    FROM \n        household_demographics hd\n    JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    GROUP BY \n        ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound\n    ORDER BY \n        customer_count DESC\n    LIMIT 5\n),\nWebSalesDetails AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_net_profit) AS total_web_profit\n    FROM \n        web_sales ws\n    WHERE \n        ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim) AND (SELECT MAX(d_date_sk) FROM date_dim)\n    GROUP BY \n        ws.ws_item_sk\n)\nSELECT \n    cs.c_first_name,\n    cs.c_last_name,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.cd_purchase_estimate,\n    cs.total_orders,\n    cs.total_net_profit,\n    CASE \n        WHEN cs.total_orders = 0 THEN NULL \n        ELSE cs.total_net_profit / cs.total_orders \n    END AS avg_profit_per_order,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    ib.customer_count,\n    wsd.total_quantity_sold,\n    wsd.total_web_profit\nFROM \n    CustomerStats cs\nJOIN \n    TopIncomeBands ib ON ib.ib_lower_bound <= cs.cd_purchase_estimate AND ib.ib_upper_bound > cs.cd_purchase_estimate\nLEFT JOIN \n    WebSalesDetails wsd ON wsd.ws_item_sk = (SELECT ws_item_sk FROM web_sales ORDER BY ws_net_profit DESC LIMIT 1)\nWHERE \n    cs.total_net_profit > 0\nORDER BY \n    cs.total_net_profit DESC\nLIMIT 10;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_sales_price) AS total_sales,\n        AVG(ws_net_profit) AS avg_net_profit,\n        COUNT(DISTINCT ws_order_number) AS total_orders\n    FROM web_sales\n    JOIN date_dim ON ws_sold_date_sk = d_date_sk\n    WHERE d_year = 2023\n    GROUP BY ws_item_sk\n),\nitem_details AS (\n    SELECT \n        i_item_sk,\n        i_product_name,\n        i_brand,\n        i_current_price\n    FROM item\n),\ntop_items AS (\n    SELECT \n        id.i_item_sk,\n        id.i_product_name,\n        id.i_brand,\n        id.i_current_price,\n        ss.total_quantity,\n        ss.total_sales,\n        ss.avg_net_profit,\n        ss.total_orders\n    FROM item_details id\n    JOIN sales_summary ss ON id.i_item_sk = ss.ws_item_sk\n    ORDER BY ss.total_sales DESC\n    LIMIT 10\n),\ncustomer_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        COUNT(DISTINCT ws_order_number) AS orders_count\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate\n),\nfinal_summary AS (\n    SELECT \n        ti.i_item_sk,\n        ti.i_product_name,\n        ti.i_brand,\n        ti.total_quantity,\n        ti.total_sales,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.orders_count\n    FROM top_items ti\n    JOIN customer_summary cs ON ti.total_orders IN (SELECT orders_count FROM customer_summary)\n)\nSELECT \n    f.i_item_sk,\n    f.i_product_name,\n    f.i_brand,\n    f.total_quantity,\n    f.total_sales,\n    f.c_first_name,\n    f.c_last_name\nFROM final_summary f\nWHERE f.orders_count > 5\nORDER BY f.total_sales DESC;\n",
  "\nWITH annual_sales AS (\n    SELECT \n        d.d_year,\n        SUM(ws.ws_ext_sales_price) AS total_sales\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n), sales_by_gender AS (\n    SELECT \n        cd.cd_gender,\n        SUM(ws.ws_ext_sales_price) AS total_sales\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n), top_stores AS (\n    SELECT \n        s.s_store_name,\n        SUM(ss.ss_ext_sales_price) AS total_sales\n    FROM \n        store s\n    JOIN \n        store_sales ss ON s.s_store_sk = ss.ss_store_sk\n    GROUP BY \n        s.s_store_name\n    ORDER BY \n        total_sales DESC\n    LIMIT 5\n)\nSELECT \n    a.d_year,\n    a.total_sales AS annual_web_sales,\n    g.cd_gender,\n    g.total_sales AS gender_sales,\n    t.s_store_name,\n    t.total_sales AS top_store_sales\nFROM \n    annual_sales a\nCROSS JOIN \n    sales_by_gender g\nCROSS JOIN \n    top_stores t\nORDER BY \n    a.d_year, g.cd_gender, t.total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(ws.ws_ext_sales_price) AS total_sales, \n    SUM(ws.ws_ext_tax) AS total_tax,\n    MAX(d.d_date) AS last_purchase_date,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n    ce.cc_call_center_id,\n    COUNT(DISTINCT sr.sr_ticket_number) AS total_returns,\n    AVG(inv.inv_quantity_on_hand) AS avg_inventory,\n    p.p_promo_name\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    call_center AS ce ON ws.ws_ship_customer_sk = ce.cc_call_center_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nLEFT JOIN \n    store_returns AS sr ON c.c_customer_sk = sr.sr_customer_sk \nLEFT JOIN \n    inventory AS inv ON ws.ws_item_sk = inv.inv_item_sk AND inv.inv_warehouse_sk = ws.ws_warehouse_sk\nLEFT JOIN \n    promotion AS p ON ws.ws_promo_sk = p.p_promo_sk\nWHERE \n    d.d_year = 2023 \n    AND c.c_current_cdemo_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, ce.cc_call_center_id, p.p_promo_name\nORDER BY \n    total_sales DESC \nLIMIT 100;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_quantity) AS total_quantity,\n    SUM(ws.ws_net_paid) AS total_net_paid,\n    d.d_year,\n    d.d_month_seq,\n    ca.ca_state,\n    COUNT(DISTINCT ws.ws_order_number) AS order_count\nFROM \n    customer AS c\nJOIN \n    web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN \n    customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    warehouse AS w ON ws.ws_warehouse_sk = w.w_warehouse_sk\nJOIN \n    ship_mode AS sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk\nWHERE \n    d.d_year = 2023 AND \n    ca.ca_state IN ('CA', 'NY', 'TX') AND \n    cd.cd_credit_rating = 'Good'\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year, d.d_month_seq, ca.ca_state\nORDER BY \n    total_net_paid DESC, order_count DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_paid_inc_tax) AS total_web_sales,\n        SUM(cs.cs_net_paid_inc_tax) AS total_catalog_sales,\n        COALESCE(SUM(ws.ws_net_paid_inc_tax), 0) - COALESCE(SUM(cs.cs_net_paid_inc_tax), 0) AS sales_difference\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nhigh_spenders AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_paid_inc_tax) AS total_spent\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n    HAVING \n        SUM(ws.ws_net_paid_inc_tax) > 1000\n),\nrepeat_customers AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk\n    HAVING \n        COUNT(DISTINCT ws.ws_order_number) > 1\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_web_sales,\n    cs.total_catalog_sales,\n    cs.sales_difference,\n    CASE \n        WHEN hs.total_spent IS NOT NULL THEN 'High Spender'\n        ELSE 'Regular Customer'\n    END AS customer_type,\n    CASE \n        WHEN rc.order_count IS NOT NULL THEN 'Repeat Customer'\n        ELSE 'New Customer'\n    END AS customer_status\nFROM \n    customer_sales cs\nLEFT JOIN \n    high_spenders hs ON cs.c_customer_sk = hs.c_customer_sk\nLEFT JOIN \n    repeat_customers rc ON cs.c_customer_sk = rc.c_customer_sk\nWHERE \n    cs.total_web_sales > 0 OR cs.total_catalog_sales > 0\nORDER BY \n    cs.sales_difference DESC\nLIMIT 50;\n",
  "\nWITH SalesStats AS (\n    SELECT \n        cs.cs_item_sk,\n        SUM(cs.cs_quantity) AS total_quantity_sold,\n        SUM(cs.cs_ext_sales_price) AS total_sales,\n        AVG(cs.cs_sales_price) AS avg_sales_price,\n        COUNT(DISTINCT cs.cs_order_number) AS total_orders\n    FROM catalog_sales cs\n    JOIN item i ON cs.cs_item_sk = i.i_item_sk\n    JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk\n    WHERE \n        p.p_start_date_sk <= (\n            SELECT MAX(d.d_date_sk) \n            FROM date_dim d \n            WHERE d.d_year = 2023\n        ) AND \n        p.p_end_date_sk >= (\n            SELECT MIN(d.d_date_sk) \n            FROM date_dim d \n            WHERE d.d_year = 2023\n        )\n    GROUP BY cs.cs_item_sk\n),\nCustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS total_web_orders,\n        SUM(ws.ws_net_paid) AS total_web_revenue\n    FROM customer c\n    JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY c.c_customer_sk\n),\nSalesByDemographics AS (\n    SELECT \n        cd.cd_gender,\n        SUM(ss.total_sales) AS total_sales_by_gender,\n        AVG(cs.total_web_revenue) AS avg_revenue_per_customer\n    FROM SalesStats ss\n    JOIN CustomerStats cs ON ss.cs_item_sk = cs.total_web_orders\n    JOIN customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    GROUP BY cd.cd_gender\n)\nSELECT \n    cd.cd_gender,\n    sb.total_sales_by_gender,\n    sb.avg_revenue_per_customer\nFROM SalesByDemographics sb\nJOIN customer_demographics cd ON sb.cd_gender = cd.cd_gender\nWHERE sb.total_sales_by_gender > 10000\nORDER BY sb.total_sales_by_gender DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_sales_price) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    AVG(ss.ss_sales_price) AS average_transaction_value,\n    d.d_year,\n    d.d_month_seq,\n    r.r_reason_desc,\n    w.w_warehouse_name\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nJOIN \n    warehouse w ON s.s_company_id = w.w_warehouse_sk\nLEFT JOIN \n    store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number\nLEFT JOIN \n    reason r ON sr.sr_reason_sk = r.r_reason_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year, d.d_month_seq, r.r_reason_desc, w.w_warehouse_name\nHAVING \n    SUM(ss.ss_sales_price) > 1000 \nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_sales_price,\n        ws.ws_quantity,\n        ws.ws_net_profit,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        d.d_year,\n        d.d_month_seq,\n        s.s_store_name,\n        w.w_warehouse_name\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    JOIN \n        store s ON ws.ws_ship_addr_sk = s.s_store_sk\n    JOIN \n        warehouse w ON s.s_store_sk = w.w_warehouse_sk\n    WHERE \n        ws.ws_sold_date_sk >= (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2022)\n        AND ws.ws_sold_date_sk <= (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022)\n),\nYearlySales AS (\n    SELECT \n        d_year,\n        SUM(ws_sales_price * ws_quantity) AS total_sales,\n        SUM(ws_net_profit) AS total_profit,\n        COUNT(*) AS total_transactions\n    FROM \n        SalesData\n    GROUP BY \n        d_year\n),\nGenderDemographics AS (\n    SELECT \n        cd_gender,\n        SUM(ws_sales_price * ws_quantity) AS gender_sales,\n        SUM(ws_net_profit) AS gender_profit\n    FROM \n        SalesData\n    GROUP BY \n        cd_gender\n)\nSELECT \n    ys.d_year,\n    ys.total_sales,\n    ys.total_profit,\n    gd.gender_sales,\n    gd.gender_profit\nFROM \n    YearlySales ys\nJOIN \n    GenderDemographics gd ON ys.d_year = 2022\nORDER BY \n    ys.total_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id,\n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_store_sales,\n    SUM(ws.ws_net_paid) AS total_web_sales,\n    SUM(cs.cs_net_paid) AS total_catalog_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS store_transactions,\n    COUNT(DISTINCT ws.ws_order_number) AS web_transactions,\n    COUNT(DISTINCT cs.cs_order_number) AS catalog_transactions,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_credit_rating,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound \nFROM \n    customer c\nLEFT JOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nLEFT JOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\nLEFT JOIN \n    catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\nLEFT JOIN \n    household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\nLEFT JOIN \n    income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\nWHERE \n    c.c_first_shipto_date_sk IS NOT NULL\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    cd.cd_gender, \n    cd.cd_marital_status, \n    cd.cd_credit_rating, \n    ib.ib_lower_bound, \n    ib.ib_upper_bound\nORDER BY \n    total_store_sales DESC, \n    total_web_sales DESC, \n    total_catalog_sales DESC \nLIMIT 100;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        c.c_customer_id,\n        SUM(COALESCE(sr_return_quantity, 0) + COALESCE(cr_return_quantity, 0) + COALESCE(wr_return_quantity, 0)) AS total_returns,\n        COUNT(DISTINCT sr_ticket_number) AS store_return_count,\n        COUNT(DISTINCT cr_order_number) AS catalog_return_count,\n        COUNT(DISTINCT wr_order_number) AS web_return_count\n    FROM \n        customer c\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    LEFT JOIN \n        catalog_returns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\n    LEFT JOIN \n        web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT c.c_customer_id) AS customer_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    SUM(cr.total_returns) AS total_customer_returns,\n    AVG(cd.customer_count) AS avg_customers_per_demo\nFROM \n    CustomerReturns cr\nJOIN \n    customer c ON c.c_customer_id = cr.c_customer_id\nJOIN \n    CustomerDemographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nWHERE \n    cr.total_returns > 0\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status\nORDER BY \n    total_customer_returns DESC\nLIMIT 10;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_ext_tax) AS total_tax,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        web_site w ON ws.ws_web_site_sk = w.web_site_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023 AND \n        cd.cd_gender = 'F' AND \n        cd.cd_marital_status = 'M' AND \n        w.web_country = 'USA'\n    GROUP BY \n        ws.ws_sold_date_sk\n),\nwarehouse_data AS (\n    SELECT \n        inv.inv_warehouse_sk,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory\n    FROM \n        inventory inv\n    JOIN \n        warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk\n    WHERE \n        w.w_country = 'USA'\n    GROUP BY \n        inv.inv_warehouse_sk\n)\nSELECT \n    sd.ws_sold_date_sk,\n    sd.total_quantity,\n    sd.total_sales,\n    sd.total_tax,\n    sd.total_orders,\n    wd.total_inventory,\n    (sd.total_sales - sd.total_tax) AS net_sales\nFROM \n    sales_data sd\nJOIN \n    warehouse_data wd ON sd.ws_sold_date_sk = wd.inv_warehouse_sk\nORDER BY \n    sd.ws_sold_date_sk DESC;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ws.ws_sales_price) AS total_sales,\n    COUNT(ws.ws_order_number) AS total_orders,\n    d.d_year,\n    SUM(ws.ws_net_profit) AS total_net_profit,\n    SUM(ws.ws_ext_discount_amt) AS total_discount,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    ca.ca_city,\n    ca.ca_state,\n    w.w_warehouse_name,\n    sm.sm_carrier\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN \n    warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\nJOIN \n    ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, d.d_year, cd.cd_gender, cd.cd_marital_status, ca.ca_city, ca.ca_state, w.w_warehouse_name, sm.sm_carrier\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        SUM(cs.cs_net_paid) AS total_catalog_sales,\n        SUM(ss.ss_net_paid) AS total_store_sales\n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY c.c_customer_sk\n), demographic_stats AS (\n    SELECT \n        cd.cd_demo_sk,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM customer_demographics cd\n    JOIN customer c ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY cd.cd_demo_sk\n), final_report AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.total_web_sales,\n        cs.total_catalog_sales,\n        cs.total_store_sales,\n        ds.avg_purchase_estimate,\n        ds.customer_count\n    FROM customer_sales cs\n    JOIN demographic_stats ds ON cs.c_customer_sk = ds.cd_demo_sk\n    WHERE cs.total_web_sales > 1000 OR cs.total_catalog_sales > 1000 OR cs.total_store_sales > 1000\n)\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    fr.total_web_sales,\n    fr.total_catalog_sales,\n    fr.total_store_sales,\n    fr.avg_purchase_estimate,\n    fr.customer_count\nFROM final_report fr\nJOIN customer c ON fr.c_customer_sk = c.c_customer_sk\nORDER BY total_web_sales DESC, total_catalog_sales DESC, total_store_sales DESC\nLIMIT 50;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_net_paid) AS total_net_paid,\n        AVG(ws.ws_sales_price) AS average_sales_price\n    FROM \n        web_sales ws\n    JOIN \n        item i ON ws.ws_item_sk = i.i_item_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2022\n        AND cd.cd_gender = 'F'\n        AND i.i_brand LIKE 'Brand%'\n    GROUP BY \n        ws.ws_item_sk\n)\nSELECT \n    i.i_item_id,\n    d.d_year,\n    sd.total_quantity_sold,\n    sd.total_net_paid,\n    sd.average_sales_price\nFROM \n    SalesData sd\nJOIN \n    item i ON sd.ws_item_sk = i.i_item_sk\nJOIN \n    date_dim d ON i.i_rec_start_date IS NOT NULL\nGROUP BY \n    i.i_item_id,\n    d.d_year,\n    sd.total_quantity_sold,\n    sd.total_net_paid,\n    sd.average_sales_price\nORDER BY \n    sd.total_net_paid DESC\nLIMIT 10;\n",
  "\nWITH customer_sales AS (\n    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, \n           SUM(COALESCE(ws.ws_net_paid, 0) + COALESCE(cs.cs_net_paid, 0) + COALESCE(ss.ss_net_paid, 0)) AS total_sales\n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name\n),\ntop_customers AS (\n    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, cs.total_sales\n    FROM customer_sales cs\n    JOIN customer c ON cs.c_customer_sk = c.c_customer_sk\n    ORDER BY cs.total_sales DESC\n    LIMIT 10\n),\nsales_details AS (\n    SELECT tc.c_customer_sk, tc.c_first_name, tc.c_last_name, \n           ws.ws_sales_price, ws.ws_quantity, ws.ws_sold_date_sk, \n           dd.d_date\n    FROM top_customers tc\n    JOIN web_sales ws ON tc.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    ORDER BY tc.c_customer_sk, ws.ws_sold_date_sk\n)\nSELECT td.c_customer_sk, td.c_first_name, td.c_last_name, \n       SUM(td.ws_sales_price * td.ws_quantity) AS total_amount_spent,\n       MIN(td.d_date) AS first_purchase_date,\n       MAX(td.d_date) AS last_purchase_date\nFROM sales_details td\nGROUP BY td.c_customer_sk, td.c_first_name, td.c_last_name\nORDER BY total_amount_spent DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk, \n        SUM(ws.ws_net_paid) AS total_web_sales,\n        SUM(cs.cs_net_paid) AS total_catalog_sales,\n        SUM(ss.ss_net_paid) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nIncomeDemographics AS (\n    SELECT \n        h.hd_demo_sk, \n        i.ib_lower_bound, \n        i.ib_upper_bound, \n        COUNT(DISTINCT cd.cd_demo_sk) AS demographics_count\n    FROM \n        household_demographics h\n    INNER JOIN \n        income_band i ON h.hd_income_band_sk = i.ib_income_band_sk\n    INNER JOIN \n        customer_demographics cd ON h.hd_demo_sk = cd.cd_demo_sk\n    GROUP BY \n        h.hd_demo_sk, i.ib_lower_bound, i.ib_upper_bound\n)\nSELECT \n    cds.c_customer_sk,\n    cds.total_web_sales,\n    cds.total_catalog_sales,\n    cds.total_store_sales,\n    id.ib_lower_bound,\n    id.ib_upper_bound,\n    id.demographics_count\nFROM \n    CustomerSales cds\nJOIN \n    IncomeDemographics id ON cds.c_customer_sk = id.hd_demo_sk\nWHERE \n    cds.total_web_sales > 50000\nORDER BY \n    cds.total_web_sales DESC, id.demographics_count DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT cr.cr_order_number) AS catalog_return_count,\n        COUNT(DISTINCT wr.wr_order_number) AS web_return_count\n    FROM customer c\n    LEFT JOIN catalog_returns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\n    LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    GROUP BY c.c_customer_sk\n),\nSalesData AS (\n    SELECT \n        ws.ws_ship_date_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales\n    FROM web_sales ws\n    FULL OUTER JOIN catalog_sales cs ON ws.ws_sold_date_sk = cs.cs_sold_date_sk\n    WHERE ws.ws_sold_date_sk IS NOT NULL OR cs.cs_sold_date_sk IS NOT NULL\n    GROUP BY ws.ws_ship_date_sk\n),\nIncomeBandCounts AS (\n    SELECT \n        h.hd_income_band_sk,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM household_demographics h\n    JOIN customer c ON h.hd_demo_sk = c.c_current_hdemo_sk\n    WHERE h.hd_buy_potential = 'High'\n    GROUP BY h.hd_income_band_sk\n)\nSELECT \n    cr.c_customer_sk,\n    cr.catalog_return_count,\n    cr.web_return_count,\n    sbc.customer_count AS high_income_customer_count,\n    COALESCE(sd.total_web_sales, 0) AS total_web_sales,\n    COALESCE(sd.total_catalog_sales, 0) AS total_catalog_sales\nFROM CustomerReturns cr\nJOIN IncomeBandCounts sbc ON cr.c_customer_sk = sbc.customer_count \nLEFT JOIN SalesData sd ON sd.ws_ship_date_sk = (\n    SELECT MAX(ws_ship_date_sk) FROM web_sales\n)\nWHERE cr.catalog_return_count > 0 OR cr.web_return_count > 0\nORDER BY cr.catalog_return_count DESC, cr.web_return_count DESC;\n",
  "\nWITH customer_stats AS (\n    SELECT \n        cd_gender, \n        COUNT(DISTINCT c_customer_sk) AS customer_count, \n        AVG(cd_purchase_estimate) AS avg_purchase_estimate, \n        SUM(hd_dep_count) AS total_dependents\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    LEFT JOIN \n        household_demographics hd ON hd.hd_demo_sk = c.c_current_hdemo_sk\n    GROUP BY \n        cd_gender\n),\nsales_summary AS (\n    SELECT \n        d.d_year, \n        SUM(ws_ext_sales_price) AS total_sales, \n        SUM(ws_net_profit) AS total_profit\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n),\nwarehouse_details AS (\n    SELECT \n        w.w_warehouse_id, \n        AVG(inv_quantity_on_hand) AS avg_inventory\n    FROM \n        inventory inv\n    JOIN \n        warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    cs.cd_gender,\n    cs.customer_count,\n    cs.avg_purchase_estimate,\n    cs.total_dependents,\n    ss.total_sales,\n    ss.total_profit,\n    wd.w_warehouse_id,\n    wd.avg_inventory\nFROM \n    customer_stats cs\nJOIN \n    sales_summary ss ON cs.customer_count > 1000\nJOIN \n    warehouse_details wd ON wd.avg_inventory > 500\nORDER BY \n    cs.customer_count DESC, ss.total_sales DESC;\n",
  "\nWITH customer_stats AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT c_customer_id) AS customer_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        AVG(cd_dep_count) AS avg_dep_count\n    FROM customer_address\n    JOIN customer ON customer.c_current_addr_sk = customer_address.ca_address_sk\n    JOIN customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk\n    GROUP BY ca_state\n),\nsales_summary AS (\n    SELECT \n        d_year,\n        SUM(ss_sales_price) AS total_sales,\n        SUM(ss_net_profit) AS total_profit,\n        COUNT(DISTINCT ss_ticket_number) AS total_transactions\n    FROM store_sales\n    JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    GROUP BY d_year\n),\nstate_sales AS (\n    SELECT \n        ca_state,\n        SUM(ss_sales_price) AS state_sales,\n        SUM(ss_net_profit) AS state_profit\n    FROM store_sales\n    JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk\n    JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\n    GROUP BY ca_state\n)\nSELECT \n    cs.ca_state,\n    cs.customer_count,\n    cs.avg_purchase_estimate,\n    cs.avg_dep_count,\n    COALESCE(ss.state_sales, 0) AS total_sales_in_state,\n    COALESCE(ss.state_profit, 0) AS total_profit_in_state\nFROM customer_stats cs\nLEFT JOIN state_sales ss ON cs.ca_state = ss.ca_state\nORDER BY cs.customer_count DESC, total_sales_in_state DESC\nFETCH FIRST 20 ROWS ONLY;\n",
  "\nWITH SalesSummary AS (\n    SELECT \n        d.d_year,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_profit) AS avg_net_profit,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_orders,\n        COALESCE(SUM(sr.sr_return_quantity), 0) AS total_returns\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    LEFT JOIN \n        catalog_sales cs ON ws.ws_item_sk = cs.cs_item_sk AND ws.ws_order_number = cs.cs_order_number\n    LEFT JOIN \n        store_returns sr ON ws.ws_item_sk = sr.sr_item_sk AND ws.ws_order_number = sr.sr_ticket_number\n    GROUP BY \n        d.d_year\n), \nIncomeSummary AS (\n    SELECT \n        hd.hd_income_band_sk,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        hd.hd_income_band_sk\n)\nSELECT \n    s.d_year,\n    s.total_sales,\n    s.total_orders,\n    s.avg_net_profit,\n    s.catalog_orders,\n    s.total_returns,\n    i.hd_income_band_sk,\n    i.customer_count,\n    i.avg_purchase_estimate\nFROM \n    SalesSummary s\nJOIN \n    IncomeSummary i ON s.total_sales > 1000000\nORDER BY \n    s.d_year DESC, s.total_sales DESC;\n",
  "\nWITH customer_stats AS (\n    SELECT\n        ca.ca_country,\n        cd.cd_gender,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        AVG(ws.ws_net_profit) AS avg_profit\n    FROM\n        web_sales ws\n    JOIN\n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN\n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN\n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN\n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE\n        dd.d_year = 2023\n        AND (cd.cd_gender = 'F' OR cd.cd_gender = 'M')\n    GROUP BY\n        ca.ca_country,\n        cd.cd_gender\n),\nwarehouse_sales AS (\n    SELECT\n        w.w_warehouse_id,\n        SUM(ws.ws_quantity) AS quantity_sold,\n        SUM(ws.ws_net_paid) AS total_revenue\n    FROM\n        warehouse w\n    JOIN\n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY\n        w.w_warehouse_id\n)\nSELECT\n    cs.ca_country,\n    cs.cd_gender,\n    cs.total_quantity,\n    cs.total_sales,\n    cs.avg_profit,\n    ws.w_warehouse_id,\n    ws.quantity_sold,\n    ws.total_revenue\nFROM\n    customer_stats cs\nJOIN\n    warehouse_sales ws ON cs.total_quantity > 100\nORDER BY\n    cs.total_sales DESC,\n    ws.total_revenue DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        w.w_warehouse_id,\n        d.d_year,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_sales_price) AS avg_sales_price\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        w.w_warehouse_id, d.d_year\n), customer_summary AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender\n), return_summary AS (\n    SELECT \n        r.r_reason_desc,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt) AS total_return_amount\n    FROM \n        store_returns sr\n    JOIN \n        reason r ON sr.sr_reason_sk = r.r_reason_sk\n    GROUP BY \n        r.r_reason_desc\n)\nSELECT \n    ss.w_warehouse_id,\n    ss.d_year,\n    ss.total_net_profit,\n    cs.customer_count,\n    cs.avg_purchase_estimate,\n    rs.total_returns,\n    rs.total_return_amount\nFROM \n    sales_summary ss\nJOIN \n    customer_summary cs ON ss.total_orders > cs.customer_count / 10\nJOIN \n    return_summary rs ON rs.total_returns > 100\nORDER BY \n    ss.total_net_profit DESC, cs.customer_count DESC;\n",
  "\nWITH customer_sales AS (\n    SELECT\n        c.c_customer_sk,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales\n    FROM\n        customer c\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    GROUP BY\n        c.c_customer_sk\n),\ndemographic_summary AS (\n    SELECT\n        cd.cd_gender,\n        hd.hd_income_band_sk,\n        COUNT(DISTINCT cs.c_customer_sk) AS customer_count,\n        SUM(cs.total_store_sales) AS total_store_sales,\n        SUM(cs.total_web_sales) AS total_web_sales,\n        SUM(cs.total_catalog_sales) AS total_catalog_sales\n    FROM\n        customer_sales cs\n    JOIN customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    JOIN household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    GROUP BY\n        cd.cd_gender,\n        hd.hd_income_band_sk\n)\nSELECT\n    ds.cd_gender,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    ds.customer_count,\n    ds.total_store_sales,\n    ds.total_web_sales,\n    ds.total_catalog_sales\nFROM\n    demographic_summary ds\nJOIN income_band ib ON ds.hd_income_band_sk = ib.ib_income_band_sk\nWHERE\n    ds.total_store_sales > 1000000\nORDER BY\n    ds.total_store_sales DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        c.c_customer_id,\n        SUM(sr_return_quantity) AS total_returned_qty,\n        SUM(sr_return_amt_inc_tax) AS total_returned_amt,\n        COUNT(DISTINCT sr_ticket_number) AS total_returned_transactions\n    FROM \n        customer c\n    JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nSalesAnalysis AS (\n    SELECT \n        ws_bill_customer_sk,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_net_profit) AS total_net_profit,\n        SUM(ws_net_paid) AS total_net_paid\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        COUNT(DISTINCT c.c_customer_id) AS demographic_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd.cd_dep_count) AS total_dependencies\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    GROUP BY \n        cd.cd_demo_sk\n)\n\nSELECT \n    ca.ca_country,\n    COUNT(DISTINCT c.c_customer_id) AS number_of_customers,\n    SUM(sa.total_orders) AS total_orders,\n    SUM(cu.total_returned_qty) AS total_returned_qty,\n    AVG(demo.avg_purchase_estimate) AS avg_purchase_estimate\nFROM \n    customer_address ca\nJOIN \n    customer c ON ca.ca_address_sk = c.c_current_addr_sk\nLEFT JOIN \n    SalesAnalysis sa ON c.c_customer_sk = sa.ws_bill_customer_sk\nLEFT JOIN \n    CustomerReturns cu ON c.c_customer_id = cu.c_customer_id\nLEFT JOIN \n    Demographics demo ON c.c_current_cdemo_sk = demo.cd_demo_sk\nWHERE \n    ca.ca_state = 'NY'\nGROUP BY \n    ca.ca_country\nORDER BY \n    number_of_customers DESC;\n",
  "WITH SalesSummary AS (\n    SELECT \n        w.w_warehouse_name,\n        d.d_year,\n        d.d_month_seq,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_paid) AS avg_order_value,\n        COUNT(DISTINCT ws.ws_bill_customer_sk) AS unique_customers\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2001\n    GROUP BY \n        w.w_warehouse_name, d.d_year, d.d_month_seq\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ss.total_sales) AS total_sales_by_gender_marital_status\n    FROM \n        SalesSummary ss\n    JOIN \n        customer c ON ss.unique_customers = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n),\nYearlyComparison AS (\n    SELECT \n        d.d_year,\n        SUM(ws.ws_sales_price) AS yearly_sales\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n)\nSELECT \n    COALESCE(cd.cd_gender, 'Unknown') AS gender,\n    COALESCE(cd.cd_marital_status, 'Unknown') AS marital_status,\n    SUM(cd.total_sales_by_gender_marital_status) AS total_sales,\n    yc.yearly_sales,\n    (SUM(cd.total_sales_by_gender_marital_status) / NULLIF(yc.yearly_sales, 0)) * 100 AS sales_percentage_of_year\nFROM \n    CustomerDemographics cd\nJOIN \n    YearlyComparison yc ON cd.cd_gender IS NOT NULL \nGROUP BY \n    cd.cd_gender, cd.cd_marital_status, yc.yearly_sales\nORDER BY \n    total_sales DESC;",
  "\nWITH customer_data AS (\n    SELECT \n        c.c_customer_id,\n        c.c_birth_year,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE dd.d_year = 2023 \n    GROUP BY \n        c.c_customer_id, \n        c.c_birth_year, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_purchase_estimate\n),\nincome_band_stats AS (\n    SELECT \n        h.hd_income_band_sk,\n        COUNT(c.c_customer_sk) AS customer_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM household_demographics h\n    JOIN customer c ON h.hd_demo_sk = c.c_current_hdemo_sk\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE h.hd_income_band_sk IS NOT NULL\n    GROUP BY h.hd_income_band_sk\n),\nfinal_report AS (\n    SELECT \n        cd.c_customer_id,\n        cd.c_birth_year,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        ib.customer_count,\n        ib.avg_purchase_estimate,\n        cd.total_net_profit\n    FROM customer_data cd\n    LEFT JOIN income_band_stats ib ON cd.cd_purchase_estimate BETWEEN ib.hd_income_band_sk AND ib.hd_income_band_sk + 10000\n)\nSELECT \n    c.cd_gender,\n    COUNT(*) AS num_customers,\n    AVG(c.total_net_profit) AS avg_net_profit,\n    SUM(c.customer_count) AS total_customers_in_income_band\nFROM final_report c\nGROUP BY c.cd_gender\nORDER BY avg_net_profit DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(COALESCE(ws.ws_net_paid, 0) + COALESCE(cs.cs_net_paid, 0) + COALESCE(ss.ss_net_paid, 0)) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS web_order_count,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_order_count,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_order_count\n    FROM \n        customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    WHERE \n        c.c_current_cdemo_sk IS NOT NULL\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nIncomeDistribution AS (\n    SELECT \n        cd.cd_demo_sk,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n    FROM \n        customer_demographics cd\n    JOIN household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_sales,\n    cs.web_order_count,\n    cs.catalog_order_count,\n    cs.store_order_count,\n    id.ib_lower_bound,\n    id.ib_upper_bound\nFROM \n    CustomerSales cs\nJOIN IncomeDistribution id ON cs.c_customer_sk = id.cd_demo_sk\nORDER BY \n    cs.total_sales DESC\nLIMIT 100;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        w.w_warehouse_id,\n        w.w_city,\n        i.i_item_id,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        AVG(ws.ws_net_profit) AS avg_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        item i ON ws.ws_item_sk = i.i_item_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n        AND w.w_state = 'CA'\n    GROUP BY \n        w.w_warehouse_id, w.w_city, i.i_item_id\n),\ndemographics_summary AS (\n    SELECT \n        cd.cd_marital_status,\n        cd.cd_gender,\n        COUNT(DISTINCT c.c_customer_sk) AS total_customers,\n        SUM(cd.cd_purchase_estimate) AS total_estimated_purchases\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_marital_status, cd.cd_gender\n),\nfinal_report AS (\n    SELECT \n        ss.w_warehouse_id,\n        ss.w_city,\n        ss.i_item_id,\n        ss.total_quantity,\n        ss.total_sales,\n        ss.avg_profit,\n        ds.cd_marital_status,\n        ds.cd_gender,\n        ds.total_customers,\n        ds.total_estimated_purchases\n    FROM \n        sales_summary ss\n    LEFT JOIN \n        demographics_summary ds ON ss.total_orders > 100\n)\nSELECT \n    w.w_warehouse_id,\n    w.w_city,\n    COUNT(DISTINCT f.i_item_id) AS total_items,\n    SUM(f.total_sales) AS aggregate_sales,\n    AVG(f.avg_profit) AS average_profit,\n    SUM(f.total_customers) AS aggregate_customers\nFROM \n    final_report f\nJOIN \n    warehouse w ON f.w_warehouse_id = w.w_warehouse_id\nGROUP BY \n    w.w_warehouse_id, w.w_city\nORDER BY \n    aggregate_sales DESC\nLIMIT 10;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        cd_gender,\n        COUNT(DISTINCT c_customer_sk) AS total_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependents\n    FROM customer\n    JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk\n    GROUP BY cd_gender\n), \nSalesData AS (\n    SELECT \n        d_year,\n        SUM(ws_sales_price) AS total_sales,\n        SUM(ws_quantity) AS total_quantity\n    FROM web_sales\n    JOIN date_dim ON ws_sold_date_sk = d_date_sk\n    GROUP BY d_year\n), \nReturnsData AS (\n    SELECT \n        d_year,\n        SUM(ws_ext_sales_price) AS total_returns,\n        COUNT(DISTINCT wr_order_number) AS return_count\n    FROM web_returns\n    JOIN web_sales ON wr_order_number = ws_order_number\n    JOIN date_dim ON wr_returned_date_sk = d_date_sk\n    GROUP BY d_year\n)\nSELECT \n    cs.cd_gender,\n    cs.total_customers,\n    cs.avg_purchase_estimate,\n    cs.total_dependents,\n    sd.d_year,\n    sd.total_sales,\n    rd.total_returns,\n    rd.return_count,\n    (COALESCE(sd.total_sales, 0) - COALESCE(rd.total_returns, 0)) AS net_sales\nFROM CustomerStats cs\nCROSS JOIN SalesData sd\nLEFT JOIN ReturnsData rd ON sd.d_year = rd.d_year\nORDER BY cs.cd_gender, sd.d_year;\n",
  "\nWITH SalesSummary AS (\n    SELECT \n        ws.ws_item_sk, \n        SUM(ws.ws_quantity) AS total_quantity_sold, \n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        CAST(dd.d_date AS DATE) AS sales_date\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023 \n    GROUP BY \n        ws.ws_item_sk, dd.d_date\n), \nCustomerSegment AS (\n    SELECT \n        cd.cd_demo_sk, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        ib.ib_income_band_sk,\n        SUM(ss.total_quantity_sold) AS total_quantity_sold\n    FROM \n        SalesSummary ss\n    JOIN \n        customer c ON ss.ws_item_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk \n    JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, ib.ib_income_band_sk\n)\nSELECT \n    cs.cd_gender, \n    cs.cd_marital_status, \n    ib.ib_lower_bound, \n    ib.ib_upper_bound, \n    SUM(cs.total_quantity_sold) AS total_quantity_by_segment\nFROM \n    CustomerSegment cs\nJOIN \n    income_band ib ON cs.ib_income_band_sk = ib.ib_income_band_sk\nGROUP BY \n    cs.cd_gender, \n    cs.cd_marital_status, \n    ib.ib_lower_bound, \n    ib.ib_upper_bound\nORDER BY \n    total_quantity_by_segment DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales\n    FROM\n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT cs.c_customer_id) AS customers_count\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON (cd.cd_demo_sk = c.c_current_cdemo_sk)\n    JOIN \n        CustomerSales cs ON cs.c_customer_id = c.c_customer_id\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.customers_count,\n    COALESCE(SUM(cs.total_web_sales), 0) AS total_web_sales,\n    COALESCE(SUM(cs.total_store_sales), 0) AS total_store_sales,\n    COALESCE(SUM(cs.total_catalog_sales), 0) AS total_catalog_sales\nFROM \n    CustomerDemographics cd\nLEFT JOIN \n    CustomerSales cs ON cd.customers_count > 0\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status, cd.customers_count\nORDER BY \n    total_web_sales DESC, total_store_sales DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT c.c_customer_sk, \n           c.c_first_name, \n           c.c_last_name, \n           SUM(s.ws_ext_sales_price) AS total_sales, \n           COUNT(DISTINCT s.ws_order_number) AS order_count\n    FROM customer c\n    JOIN web_sales s ON c.c_customer_sk = s.ws_bill_customer_sk\n    WHERE s.ws_sold_date_sk BETWEEN \n          (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2022) - 90 AND \n          (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2022)\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name\n), Demographics AS (\n    SELECT cd.cd_demo_sk, \n           cd.cd_gender, \n           cd.cd_marital_status, \n           cd.cd_education_status,\n           ib.ib_income_band_sk\n    FROM customer_demographics cd\n    JOIN household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n), CustomerInsights AS (\n    SELECT cs.c_customer_sk, \n           cs.c_first_name, \n           cs.c_last_name, \n           cs.total_sales, \n           cs.order_count,\n           d.cd_gender, \n           d.cd_marital_status, \n           d.cd_education_status, \n           d.ib_income_band_sk\n    FROM CustomerSales cs\n    JOIN customer c ON cs.c_customer_sk = c.c_customer_sk\n    JOIN Demographics d ON c.c_current_cdemo_sk = d.cd_demo_sk\n    WHERE cs.total_sales > 1000\n)\nSELECT ci.c_customer_sk, \n       ci.c_first_name, \n       ci.c_last_name, \n       ci.total_sales, \n       ci.order_count, \n       ci.cd_gender, \n       ci.cd_marital_status, \n       ci.cd_education_status, \n       ib.ib_lower_bound, \n       ib.ib_upper_bound\nFROM CustomerInsights ci\nJOIN income_band ib ON ci.ib_income_band_sk = ib.ib_income_band_sk\nORDER BY ci.total_sales DESC\nLIMIT 10;\n",
  "\nWITH customer_activity AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(COALESCE(ws.ws_quantity, 0) + COALESCE(cs.cs_quantity, 0) + COALESCE(ss.ss_quantity, 0)) AS total_quantity,\n        COUNT(DISTINCT ws.ws_order_number) AS web_order_count,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_order_count,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_order_count\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\ndemographics_summary AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT ca.ca_address_sk) AS customer_count,\n        AVG(cd.cd_purchase_estimate) AS average_purchase_estimate,\n        MAX(cd.cd_dep_count) AS max_dependents\n    FROM \n        customer_demographics cd\n    LEFT JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    LEFT JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    a.c_first_name,\n    a.c_last_name,\n    a.total_quantity,\n    d.cd_gender,\n    d.cd_marital_status,\n    d.customer_count,\n    d.average_purchase_estimate,\n    d.max_dependents\nFROM \n    customer_activity a\nJOIN \n    demographics_summary d ON (d.customer_count > 0 AND (a.total_quantity > 100 OR d.average_purchase_estimate IS NOT NULL))\nWHERE \n    (d.cd_gender = 'M' AND d.cd_marital_status = 'S') \n    OR (d.cd_gender = 'F' AND d.cd_marital_status IS NULL)\nORDER BY \n    a.total_quantity DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt_inc_tax) AS total_return_amount,\n        AVG(sr_return_quantity) AS avg_return_quantity\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nItemSales AS (\n    SELECT \n        ws_bill_customer_sk AS customer_sk,\n        SUM(ws_quantity) AS total_items_sold,\n        SUM(ws_net_profit) AS total_net_profit,\n        AVG(ws_sales_price) AS avg_sales_price\n    FROM \n        web_sales\n    GROUP BY \n        ws_bill_customer_sk\n),\nIncomeDemographics AS (\n    SELECT \n        cd_demo_sk,\n        ib_income_band_sk,\n        COUNT(*) AS customer_count\n    FROM \n        household_demographics \n    JOIN \n        customer_demographics ON hd_demo_sk = cd_demo_sk\n    LEFT JOIN \n        income_band ON hd_income_band_sk = ib_income_band_sk\n    GROUP BY \n        cd_demo_sk, ib_income_band_sk\n)\nSELECT \n    c.c_customer_id,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    COALESCE(cr.total_returns, 0) AS total_returns,\n    COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n    COALESCE(isales.total_items_sold, 0) AS total_items_sold,\n    COALESCE(isales.total_net_profit, 0) AS total_net_profit,\n    id.customer_count AS income_band_customers,\n    CASE \n        WHEN cr.total_return_amount > 0 THEN 'Returns Made'\n        ELSE 'No Returns' \n    END AS returns_status\nFROM \n    customer c\nLEFT JOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nLEFT JOIN \n    CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\nLEFT JOIN \n    ItemSales isales ON c.c_customer_sk = isales.customer_sk\nLEFT JOIN \n    IncomeDemographics id ON cd.cd_demo_sk = id.cd_demo_sk\nWHERE \n    cd.cd_marital_status = 'M' \n    AND cd.cd_gender = 'F'\n    AND (isales.total_net_profit > 1000 OR cr.total_returns > 5)\nORDER BY \n    total_return_amount DESC, \n    total_items_sold DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS order_count\n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nHighValueCustomers AS (\n    SELECT \n        c_customer_sk,\n        c_first_name,\n        c_last_name,\n        total_sales,\n        order_count,\n        CASE \n            WHEN total_sales >= 5000 THEN 'High Value'\n            ELSE 'Regular'\n        END AS customer_type\n    FROM CustomerSales\n),\nSalesTrend AS (\n    SELECT \n        dd.d_year,\n        SUM(ws.ws_ext_sales_price) AS sales_amount,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM date_dim dd\n    JOIN web_sales ws ON dd.d_date_sk = ws.ws_sold_date_sk\n    GROUP BY dd.d_year\n),\nWarehouseStats AS (\n    SELECT \n        w.w_warehouse_sk,\n        w.w_warehouse_name,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory\n    FROM warehouse w\n    JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk\n    GROUP BY w.w_warehouse_sk, w.w_warehouse_name\n)\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    cv.customer_type,\n    st.sales_amount,\n    st.total_orders,\n    ws.w_warehouse_name,\n    ws.total_inventory\nFROM HighValueCustomers cv\nJOIN CustomerSales c ON c.c_customer_sk = cv.c_customer_sk\nJOIN SalesTrend st ON st.sales_amount = (SELECT MAX(sales_amount) FROM SalesTrend)\nRIGHT JOIN WarehouseStats ws ON ws.total_inventory > 10\nORDER BY cv.total_sales DESC, c.c_last_name ASC\nLIMIT 100;\n",
  "\nWITH customer_data AS (\n    SELECT\n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_paid_inc_tax) AS average_transaction_value,\n        COUNT(DISTINCT ws.ws_item_sk) AS unique_items_purchased\n    FROM\n        customer c\n    JOIN\n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN\n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE\n        cd.cd_gender = 'F' AND cd.cd_marital_status = 'M'\n    GROUP BY\n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nwarehouse_data AS (\n    SELECT\n        w.w_warehouse_id,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory\n    FROM\n        warehouse w\n    JOIN\n        inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk\n    GROUP BY\n        w.w_warehouse_id\n), \nsales_data AS (\n    SELECT\n        date_dim.d_year,\n        SUM(ws.ws_net_profit) AS total_sales\n    FROM\n        web_sales ws\n    JOIN\n        date_dim ON ws.ws_sold_date_sk = date_dim.d_date_sk\n    GROUP BY\n        date_dim.d_year\n)\nSELECT\n    cd.c_customer_id,\n    cd.total_net_profit,\n    cd.total_orders,\n    cd.average_transaction_value,\n    cd.unique_items_purchased,\n    wd.w_warehouse_id,\n    wd.total_inventory,\n    sd.d_year,\n    sd.total_sales\nFROM\n    customer_data cd\nJOIN\n    warehouse_data wd ON TRUE  \nJOIN\n    sales_data sd ON TRUE  \nORDER BY\n    cd.total_net_profit DESC,\n    sd.total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerStats AS (\n    SELECT\n        c.c_customer_sk,\n        c.c_birth_month,\n        c.c_birth_year,\n        cd.cd_gender,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_profit) AS total_profit,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM\n        customer c\n    JOIN\n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN\n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN\n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    WHERE\n        (cd.cd_marital_status = 'S' OR cd.cd_gender = 'F')\n    GROUP BY\n        c.c_customer_sk, c.c_birth_month, c.c_birth_year, cd.cd_gender\n),\nMonthlySales AS (\n    SELECT\n        d.d_month_seq,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM\n        date_dim d\n    LEFT JOIN\n        web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\n    LEFT JOIN\n        store_sales ss ON d.d_date_sk = ss.ss_sold_date_sk\n    GROUP BY\n        d.d_month_seq\n),\nSummary AS (\n    SELECT\n        cs.c_birth_month,\n        cs.c_birth_year,\n        cs.cd_gender,\n        cs.total_orders,\n        cs.total_profit,\n        ms.total_sales,\n        ms.total_store_sales,\n        (COALESCE(cs.total_profit, 0) + COALESCE(ms.total_sales, 0) + COALESCE(ms.total_store_sales, 0)) AS grand_total\n    FROM\n        CustomerStats cs\n    JOIN\n        MonthlySales ms ON cs.c_birth_month = EXTRACT(MONTH FROM DATE '2002-10-01') \n)\nSELECT\n    c_birth_month,\n    c_birth_year,\n    cd_gender,\n    total_orders,\n    total_profit,\n    total_sales,\n    total_store_sales,\n    grand_total\nFROM\n    Summary\nORDER BY\n    grand_total DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(COALESCE(ws.ws_net_paid, 0) + COALESCE(ss.ss_net_paid, 0) + COALESCE(cs.cs_net_paid, 0)) AS total_sales,\n        cd.cd_gender,\n        hd.hd_income_band_sk\n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    GROUP BY c.c_customer_sk, cd.cd_gender, hd.hd_income_band_sk\n),\nSalesDistribution AS (\n    SELECT \n        cd_gender,\n        hd_income_band_sk,\n        COUNT(*) AS customer_count,\n        AVG(total_sales) AS average_sales,\n        MAX(total_sales) AS max_sales,\n        MIN(total_sales) AS min_sales\n    FROM CustomerSales\n    GROUP BY cd_gender, hd_income_band_sk\n)\nSELECT \n    cd_gender,\n    ib_lower_bound,\n    ib_upper_bound,\n    customer_count,\n    average_sales,\n    max_sales,\n    min_sales\nFROM SalesDistribution sd\nJOIN income_band ib ON sd.hd_income_band_sk = ib.ib_income_band_sk\nORDER BY cd_gender, ib_lower_bound;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\ncustomer_details AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_country\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n)\nSELECT \n    cd.c_customer_sk,\n    cd.c_first_name,\n    cd.c_last_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    cd.ca_city,\n    cd.ca_state,\n    cd.ca_country,\n    cs.total_web_sales,\n    cs.total_catalog_sales,\n    cs.total_store_sales,\n    (COALESCE(cs.total_web_sales, 0) + COALESCE(cs.total_catalog_sales, 0) + COALESCE(cs.total_store_sales, 0)) AS total_sales\nFROM \n    customer_details cd\nLEFT JOIN \n    customer_sales cs ON cd.c_customer_sk = cs.c_customer_sk\nWHERE \n    cd.ca_state = 'CA' \n    AND (cs.total_web_sales > 1000 OR cs.total_catalog_sales > 1000 OR cs.total_store_sales > 1000)\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS number_of_orders\n    FROM \n        customer AS c\n    JOIN \n        web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        ws.ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        c.c_customer_id\n), \nAddressDemographics AS (\n    SELECT \n        ca.ca_country,\n        COUNT(DISTINCT cd.cd_demo_sk) AS customers_count,\n        SUM(cd.cd_purchase_estimate) AS total_purchase_estimate\n    FROM \n        customer_demographics AS cd\n    JOIN \n        customer AS c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    JOIN \n        customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\n    GROUP BY \n        ca.ca_country\n), \nSalesSummary AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales,\n        AVG(ss.ss_net_profit) AS avg_net_profit,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions\n    FROM \n        store_sales AS ss\n    JOIN \n        warehouse AS w ON ss.ss_store_sk = w.w_warehouse_sk\n    WHERE \n        ss.ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year = 2023) AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023)\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    cs.c_customer_id,\n    cs.total_sales,\n    cs.number_of_orders,\n    ad.customers_count,\n    ad.total_purchase_estimate,\n    ss.total_store_sales,\n    ss.avg_net_profit,\n    ss.total_transactions\nFROM \n    CustomerSales AS cs\nJOIN \n    AddressDemographics AS ad ON ad.customers_count > 100 \nJOIN \n    SalesSummary AS ss ON ss.total_store_sales > 10000\nORDER BY \n    cs.total_sales DESC, ad.customers_count DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        SUM(sr_return_amt_inc_tax) AS total_return_amt,\n        COUNT(DISTINCT sr_ticket_number) AS returns_count\n    FROM \n        store_returns\n    GROUP BY \n        sr_customer_sk\n),\nSalesData AS (\n    SELECT \n        ws_ship_customer_sk,\n        SUM(ws_net_paid_inc_tax) AS total_sales_amt,\n        COUNT(DISTINCT ws_order_number) AS sales_count\n    FROM \n        web_sales\n    GROUP BY \n        ws_ship_customer_sk\n),\nCustomerDemographics AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_lower_bound AS income_lower,\n        ib.ib_upper_bound AS income_upper\n    FROM \n        customer c\n    LEFT JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    LEFT JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n),\nReturnSalesComparison AS (\n    SELECT \n        cd.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.income_lower,\n        cd.income_upper,\n        COALESCE(cr.total_return_amt, 0) AS total_return_amt,\n        COALESCE(sd.total_sales_amt, 0) AS total_sales_amt,\n        CASE \n            WHEN COALESCE(cr.total_return_amt, 0) = 0 THEN NULL \n            ELSE (COALESCE(sd.total_sales_amt, 0) - COALESCE(cr.total_return_amt, 0)) / COALESCE(sd.total_sales_amt, 0) \n        END AS return_to_sales_ratio\n    FROM \n        CustomerDemographics cd\n    LEFT JOIN CustomerReturns cr ON cd.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN SalesData sd ON cd.c_customer_sk = sd.ws_ship_customer_sk\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    COUNT(DISTINCT cd.c_customer_sk) AS customer_count,\n    AVG(rsc.return_to_sales_ratio) AS avg_return_to_sales_ratio,\n    SUM(rsc.total_return_amt) AS total_return_amt,\n    SUM(rsc.total_sales_amt) AS total_sales_amt,\n    MAX(rsc.income_upper) AS max_income_upper,\n    MIN(rsc.income_lower) AS min_income_lower\nFROM \n    ReturnSalesComparison rsc\nJOIN CustomerDemographics cd ON rsc.c_customer_sk = cd.c_customer_sk\nGROUP BY \n    cd.cd_gender,\n    cd.cd_marital_status\nORDER BY \n    customer_count DESC, \n    avg_return_to_sales_ratio DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(COALESCE(ws.ws_ext_sales_price, 0) + COALESCE(cs.cs_ext_sales_price, 0) + COALESCE(ss.ss_ext_sales_price, 0)) AS total_sales,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    GROUP BY \n        c.c_customer_sk, cd.cd_gender, cd.cd_marital_status, ib.ib_lower_bound, ib.ib_upper_bound\n),\nSalesSummary AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        COUNT(DISTINCT c_customer_sk) AS customer_count,\n        AVG(total_sales) AS avg_sales,\n        MIN(total_sales) AS min_sales,\n        MAX(total_sales) AS max_sales\n    FROM \n        CustomerSales\n    GROUP BY \n        cd_gender, cd_marital_status\n)\nSELECT \n    cd_gender,\n    cd_marital_status,\n    customer_count,\n    avg_sales,\n    min_sales,\n    max_sales\nFROM \n    SalesSummary\nORDER BY \n    cd_gender, cd_marital_status;\n",
  "\nWITH customer_analysis AS (\n    SELECT \n        c.c_customer_id,\n        ca.ca_city,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT s.ss_ticket_number) AS total_sales,\n        SUM(s.ss_ext_sales_price) AS total_sales_amount,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate,\n        COUNT(DISTINCT wr.wr_order_number) AS total_web_returns,\n        SUM(wr.wr_return_amt_inc_tax) AS total_returned_amount\n    FROM \n        customer c\n    LEFT JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    LEFT JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN store_sales s ON c.c_customer_sk = s.ss_customer_sk\n    LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    GROUP BY \n        c.c_customer_id, \n        ca.ca_city, \n        cd.cd_gender, \n        cd.cd_marital_status\n),\nwarehouse_sales AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_ext_sales_price) AS total_sales_amount,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        warehouse w\n    JOIN web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    ca.ca_city,\n    ca.cd_gender,\n    ca.cd_marital_status,\n    ca.total_sales,\n    ca.total_sales_amount,\n    ca.avg_purchase_estimate,\n    ca.total_web_returns,\n    ca.total_returned_amount,\n    ws.total_sales_amount AS warehouse_sales_amount,\n    ws.total_orders AS warehouse_total_orders\nFROM \n    customer_analysis ca\nJOIN warehouse_sales ws ON ca.total_sales_amount > ws.total_sales_amount\nORDER BY \n    ca.total_sales_amount DESC, \n    ws.total_sales_amount ASC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS purchase_count,\n        AVG(CASE WHEN cd.cd_gender = 'M' THEN ws.ws_sales_price ELSE NULL END) AS avg_male_sale,\n        AVG(CASE WHEN cd.cd_gender = 'F' THEN ws.ws_sales_price ELSE NULL END) AS avg_female_sale\n    FROM \n        customer AS c\n    LEFT JOIN \n        web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        c.c_customer_id\n),\nWarehousePerformance AS (\n    SELECT \n        w.w_warehouse_id,\n        AVG(ws.ws_net_profit) AS avg_net_profit,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        warehouse AS w\n    JOIN \n        web_sales AS ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n),\nPromotionsImpact AS (\n    SELECT \n        p.p_promo_id,\n        SUM(ws.ws_net_paid) AS total_net_paid,\n        COUNT(DISTINCT ws.ws_order_number) AS promo_order_count\n    FROM \n        promotion AS p\n    LEFT JOIN \n        web_sales AS ws ON p.p_promo_sk = ws.ws_promo_sk\n    GROUP BY \n        p.p_promo_id\n)\nSELECT \n    cs.c_customer_id,\n    cs.total_sales,\n    cs.purchase_count,\n    cs.avg_male_sale,\n    cs.avg_female_sale,\n    wp.w_warehouse_id,\n    wp.avg_net_profit,\n    wp.total_orders,\n    pi.p_promo_id,\n    pi.total_net_paid,\n    pi.promo_order_count\nFROM \n    CustomerSales AS cs\nLEFT JOIN \n    WarehousePerformance AS wp ON cs.purchase_count = wp.total_orders\nLEFT JOIN \n    PromotionsImpact AS pi ON cs.total_sales > 1000 \nORDER BY \n    cs.total_sales DESC, wp.avg_net_profit DESC;\n",
  "\nWITH CustomerSummary AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT c_customer_sk) AS total_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependents\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    GROUP BY \n        ca_state\n),\nSalesSummary AS (\n    SELECT \n        d_year,\n        SUM(ws_net_paid) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        AVG(ws_net_paid) AS avg_order_value\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    GROUP BY \n        d_year\n),\nReturnsSummary AS (\n    SELECT \n        dd.d_year,\n        COUNT(DISTINCT wr_order_number) AS total_returns,\n        SUM(wr_return_amt) AS total_returned_amount\n    FROM \n        web_returns wr\n    JOIN \n        date_dim dd ON wr.wr_returned_date_sk = dd.d_date_sk\n    GROUP BY \n        dd.d_year\n)\nSELECT \n    cs.ca_state,\n    cs.total_customers,\n    cs.avg_purchase_estimate,\n    cs.total_dependents,\n    ss.d_year,\n    ss.total_sales,\n    ss.total_orders,\n    ss.avg_order_value,\n    rs.total_returns,\n    rs.total_returned_amount\nFROM \n    CustomerSummary cs\nJOIN \n    SalesSummary ss ON cs.total_customers > 1000 \nJOIN \n    ReturnsSummary rs ON ss.d_year = rs.d_year\nORDER BY \n    cs.total_customers DESC, ss.total_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH CustomerStats AS (\n    SELECT\n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COUNT(DISTINCT c.c_customer_sk) AS total_customers,\n        SUM(ws.ws_sales_price) AS total_sales,\n        AVG(ws.ws_net_profit) AS average_profit\n    FROM\n        customer_demographics cd\n    JOIN\n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    LEFT JOIN\n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY\n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nSalesByWarehouse AS (\n    SELECT\n        w.w_warehouse_sk,\n        SUM(ws.ws_sales_price) AS total_warehouse_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM\n        warehouse w\n    JOIN\n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY\n        w.w_warehouse_sk\n),\nSalesTrends AS (\n    SELECT\n        dd.d_year,\n        SUM(ws.ws_sales_price) AS total_annual_sales\n    FROM\n        date_dim dd\n    JOIN\n        web_sales ws ON dd.d_date_sk = ws.ws_sold_date_sk\n    GROUP BY\n        dd.d_year\n)\nSELECT\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.cd_education_status,\n    cs.total_customers,\n    cs.total_sales,\n    cs.average_profit,\n    sw.total_warehouse_sales,\n    sw.total_orders,\n    st.total_annual_sales\nFROM\n    CustomerStats cs\nJOIN\n    SalesByWarehouse sw ON cs.cd_demo_sk % 10 = sw.w_warehouse_sk % 10\nJOIN\n    SalesTrends st ON cs.cd_demo_sk % 5 = st.d_year % 5\nORDER BY\n    total_sales DESC, average_profit DESC;\n",
  "\nWITH regional_sales AS (\n    SELECT \n        s.s_store_id,\n        s.s_store_name,\n        SUM(ss.ss_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n        AVG(ss.ss_sales_price) AS avg_sales_price\n    FROM \n        store s\n    JOIN \n        store_sales ss ON s.s_store_sk = ss.ss_store_sk\n    WHERE \n        ss.ss_sold_date_sk BETWEEN (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023) - 30 \n                                AND (SELECT MAX(d.d_date_sk) FROM date_dim d WHERE d.d_year = 2023)\n    GROUP BY \n        s.s_store_id, s.s_store_name\n),\ncustomer_info AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COUNT(ss.ss_ticket_number) AS purchase_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nemployee_sales AS (\n    SELECT \n        w.w_warehouse_id, \n        COUNT(ss.ss_ticket_number) AS employee_handled_sales\n    FROM \n        warehouse w\n    JOIN \n        store_sales ss ON w.w_warehouse_sk = ss.ss_store_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    rs.s_store_id,\n    rs.s_store_name,\n    rs.total_sales,\n    rs.total_transactions,\n    rs.avg_sales_price,\n    ci.cd_gender,\n    ci.cd_marital_status,\n    ci.purchase_count,\n    es.employee_handled_sales\nFROM \n    regional_sales rs\nJOIN \n    customer_info ci ON ci.purchase_count > 0\nJOIN \n    employee_sales es ON es.w_warehouse_id = rs.s_store_id\nORDER BY \n    rs.total_sales DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH daily_sales AS (\n    SELECT \n        d.d_date AS sales_date,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_quantity) AS total_units_sold\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2022\n    GROUP BY \n        d.d_date\n),\ncustomer_summary AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT c.c_customer_sk) AS total_customers,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n),\nsales_by_region AS (\n    SELECT \n        ca.ca_state,\n        SUM(ws.ws_ext_sales_price) AS total_sales\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    GROUP BY \n        ca.ca_state\n),\ncombined_report AS (\n    SELECT \n        ds.sales_date,\n        ds.total_sales,\n        ds.total_orders,\n        ds.total_units_sold,\n        cs.cd_gender,\n        cs.cd_marital_status,\n        cs.total_customers,\n        cs.avg_purchase_estimate,\n        sr.ca_state,\n        sr.total_sales AS region_sales\n    FROM \n        daily_sales ds\n    CROSS JOIN \n        customer_summary cs\n    CROSS JOIN \n        sales_by_region sr\n)\nSELECT \n    sales_date,\n    total_sales,\n    total_orders,\n    total_units_sold,\n    cd_gender,\n    cd_marital_status,\n    total_customers,\n    avg_purchase_estimate,\n    ca_state,\n    region_sales\nFROM \n    combined_report\nORDER BY \n    sales_date, cd_gender, ca_state;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        cd.cd_gender = 'M' \n        AND cd.cd_marital_status = 'M'\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender\n),\nstore_summary AS (\n    SELECT \n        s.s_store_sk,\n        s.s_store_name,\n        SUM(ss.ss_quantity) AS total_quantity,\n        SUM(ss.ss_sales_price) AS total_sales\n    FROM \n        store s\n    JOIN \n        store_sales ss ON s.s_store_sk = ss.ss_store_sk\n    GROUP BY \n        s.s_store_sk, s.s_store_name\n),\nprofit_summary AS (\n    SELECT \n        w.w_warehouse_sk,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_sk\n)\nSELECT \n    cs.c_first_name, \n    cs.c_last_name,\n    cs.total_quantity AS customer_total_quantity,\n    cs.total_sales AS customer_total_sales,\n    ss.s_store_name,\n    ss.total_quantity AS store_total_quantity,\n    ss.total_sales AS store_total_sales,\n    ps.total_profit AS warehouse_total_profit\nFROM \n    customer_summary cs\nJOIN \n    store_summary ss ON cs.total_sales > 1000\nJOIN \n    profit_summary ps ON ps.total_profit > 0\nORDER BY \n    cs.total_sales DESC, \n    ss.total_sales DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH daily_sales AS (\n    SELECT \n        d.d_date AS sales_date,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_quantity) AS total_units,\n        AVG(ws.ws_sales_price) AS avg_price\n    FROM \n        web_sales AS ws\n    JOIN \n        date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_date\n),\ntop_customers AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS customer_total\n    FROM \n        customer AS c\n    JOIN \n        web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n    ORDER BY \n        customer_total DESC\n    LIMIT 10\n),\ncustomer_demographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS demographic_sales\n    FROM \n        customer AS c\n    JOIN \n        web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n)\nSELECT \n    ds.sales_date,\n    ds.total_sales,\n    ds.total_orders,\n    ds.total_units,\n    ds.avg_price,\n    tc.customer_total,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    cd.demographic_sales\nFROM \n    daily_sales AS ds\nLEFT JOIN \n    top_customers AS tc ON ds.sales_date = (SELECT MAX(sales_date) FROM daily_sales)\nLEFT JOIN \n    customer_demographics AS cd ON cd.cd_demo_sk = (SELECT cd.cd_demo_sk FROM customer_demographics cd ORDER BY cd.demographic_sales DESC LIMIT 1)\nORDER BY \n    ds.sales_date DESC;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(SUM(sr_return_quantity), 0) AS total_store_returns,\n        COALESCE(SUM(wr_return_quantity), 0) AS total_web_returns,\n        COUNT(DISTINCT sr_ticket_number) AS store_return_count,\n        COUNT(DISTINCT wr_order_number) AS web_return_count\n    FROM customer c\n    LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nCustomerDemographics AS (\n    SELECT \n        cd_demo_sk,\n        cd_gender,\n        cd_marital_status,\n        cd_purchase_estimate,\n        cd_credit_rating,\n        cd_dep_count\n    FROM customer_demographics\n),\nHighValueCustomers AS (\n    SELECT \n        cr.c_customer_sk, \n        cr.c_first_name, \n        cr.c_last_name, \n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate\n    FROM CustomerReturns cr\n    JOIN CustomerDemographics cd ON cr.c_customer_sk = cd.cd_demo_sk\n    WHERE cr.total_store_returns + cr.total_web_returns > 10 OR cd.cd_purchase_estimate > 1000\n),\nIncomeBandDetails AS (\n    SELECT \n        hd.hd_demo_sk,\n        IB.ib_lower_bound,\n        IB.ib_upper_bound\n    FROM household_demographics hd\n    JOIN income_band IB ON hd.hd_income_band_sk = IB.ib_income_band_sk\n)\nSELECT \n    hvc.c_first_name,\n    hvc.c_last_name,\n    hvc.cd_gender,\n    hvc.cd_marital_status,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    COUNT(ws.ws_order_number) AS total_orders,\n    SUM(ws.ws_net_profit) AS total_net_profit\nFROM HighValueCustomers hvc\nLEFT JOIN web_sales ws ON hvc.c_customer_sk = ws.ws_bill_customer_sk\nLEFT JOIN IncomeBandDetails ib ON hvc.c_customer_sk = ib.hd_demo_sk\nGROUP BY \n    hvc.c_first_name,\n    hvc.c_last_name,\n    hvc.cd_gender,\n    hvc.cd_marital_status,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound\nHAVING \n    COUNT(ws.ws_order_number) > 5\nORDER BY total_net_profit DESC\nLIMIT 10;\n",
  "\nWITH CustomerReturns AS (\n    SELECT \n        sr_customer_sk,\n        COUNT(DISTINCT sr_ticket_number) AS total_returns,\n        SUM(sr_return_amt_inc_tax) AS total_return_amount\n    FROM store_returns\n    GROUP BY sr_customer_sk\n),\nSalesSummary AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_net_profit) AS total_profit\n    FROM web_sales ws\n    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    GROUP BY c.c_customer_sk\n),\nCustomerWithReturns AS (\n    SELECT \n        c.c_customer_sk,\n        COALESCE(cr.total_returns, 0) AS total_returns,\n        COALESCE(cr.total_return_amount, 0) AS total_return_amount,\n        COALESCE(ss.total_sales, 0) AS total_sales,\n        COALESCE(ss.total_profit, 0) AS total_profit\n    FROM customer c\n    LEFT JOIN CustomerReturns cr ON c.c_customer_sk = cr.sr_customer_sk\n    LEFT JOIN SalesSummary ss ON c.c_customer_sk = ss.c_customer_sk\n),\nIncomeDistribution AS (\n    SELECT \n        hd.hd_income_band_sk,\n        COUNT(c.c_customer_sk) AS num_customers,\n        AVG(COALESCE(cwr.total_sales, 0)) AS avg_sales,\n        AVG(COALESCE(cwr.total_profits, 0)) AS avg_profit\n    FROM household_demographics hd\n    JOIN customer c ON hd.hd_demo_sk = c.c_current_hdemo_sk\n    LEFT JOIN (\n        SELECT \n            c_customer_sk,\n            SUM(total_sales) AS total_sales,\n            SUM(total_profit) AS total_profits\n        FROM CustomerWithReturns\n        GROUP BY c_customer_sk\n    ) cwr ON c.c_customer_sk = cwr.c_customer_sk\n    GROUP BY hd.hd_income_band_sk\n)\nSELECT \n    ib.ib_income_band_sk,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    id.num_customers,\n    id.avg_sales,\n    id.avg_profit\nFROM income_band ib\nJOIN IncomeDistribution id ON ib.ib_income_band_sk = id.hd_income_band_sk\nWHERE id.num_customers > 0\nORDER BY ib.ib_income_band_sk;\n",
  "\nWITH CustomerCounts AS (\n    SELECT \n        ca_state, \n        COUNT(DISTINCT c_customer_sk) AS customer_count,\n        SUM(cd_dep_count) AS total_dependencies,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate\n    FROM customer_address AS ca\n    JOIN customer AS c ON ca.ca_address_sk = c.c_current_addr_sk\n    JOIN customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY ca_state\n),\nSalesData AS (\n    SELECT \n        d.d_year,\n        d.d_month_seq,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_quantity) AS total_quantity\n    FROM web_sales AS ws\n    JOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY d.d_year, d.d_month_seq\n),\nStoreSalesData AS (\n    SELECT \n        s.s_store_name,\n        SUM(ss_ext_sales_price) AS total_store_sales,\n        COUNT(DISTINCT ss_ticket_number) AS total_transactions\n    FROM store_sales AS ss\n    JOIN store AS s ON ss.ss_store_sk = s.s_store_sk\n    GROUP BY s.s_store_name\n)\nSELECT \n    cc.ca_state,\n    cc.customer_count,\n    cc.total_dependencies,\n    cc.avg_purchase_estimate,\n    sd.d_year,\n    sd.d_month_seq,\n    sd.total_sales,\n    sd.total_quantity,\n    ssd.s_store_name,\n    ssd.total_store_sales,\n    ssd.total_transactions\nFROM CustomerCounts AS cc\nJOIN SalesData AS sd ON cc.customer_count > 1000\nLEFT JOIN StoreSalesData AS ssd ON sd.total_sales > 10000\nORDER BY cc.ca_state, sd.d_year, sd.d_month_seq, ssd.total_store_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH sales_summary AS (\n    SELECT\n        w.w_warehouse_id,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM\n        web_sales ws\n    JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE\n        d.d_year = 2023\n        AND ws.ws_net_profit > 0\n    GROUP BY\n        w.w_warehouse_id\n),\ncustomer_summary AS (\n    SELECT\n        c.c_customer_id,\n        d.d_year,\n        SUM(ws.ws_net_profit) AS total_customer_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS customer_order_count\n    FROM\n        customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE\n        d.d_year = 2023\n    GROUP BY\n        c.c_customer_id, d.d_year\n),\noverall_summary AS (\n    SELECT\n        ss.w_warehouse_id,\n        ss.total_quantity,\n        ss.total_profit,\n        ss.total_orders,\n        SUM(cs.total_customer_profit) AS total_customer_profit,\n        SUM(cs.customer_order_count) AS total_customer_orders\n    FROM\n        sales_summary ss\n    JOIN customer_summary cs ON ss.total_orders > 0\n    GROUP BY\n        ss.w_warehouse_id, ss.total_quantity, ss.total_profit, ss.total_orders\n)\nSELECT\n    w.w_warehouse_id,\n    w.w_warehouse_name,\n    os.total_quantity,\n    os.total_profit,\n    os.total_orders,\n    os.total_customer_profit,\n    os.total_customer_orders\nFROM\n    overall_summary os\nJOIN warehouse w ON os.w_warehouse_id = w.w_warehouse_id\nORDER BY\n    os.total_profit DESC;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        AVG(ws.ws_net_profit) AS avg_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status\n),\nStoreStats AS (\n    SELECT \n        s.s_store_id,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n        SUM(ss.ss_sales_price) AS total_revenue,\n        AVG(ss.ss_net_profit) AS avg_net_profit\n    FROM \n        store s\n    JOIN \n        store_sales ss ON s.s_store_sk = ss.ss_store_sk\n    JOIN \n        date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        s.s_store_id\n)\nSELECT \n    cs.c_customer_id,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.total_quantity,\n    cs.total_sales,\n    cs.avg_profit,\n    ss.s_store_id,\n    ss.total_transactions,\n    ss.total_revenue,\n    ss.avg_net_profit\nFROM \n    CustomerStats cs\nJOIN \n    StoreStats ss ON cs.total_sales = ss.total_revenue\nORDER BY \n    cs.total_sales DESC, ss.total_revenue DESC\nLIMIT 100;\n",
  "WITH demographic_analysis AS (\n    SELECT \n        cd_gender,\n        cd_marital_status,\n        cd_education_status,\n        COUNT(c.c_customer_sk) AS total_customers,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(CASE WHEN cd_credit_rating = 'High' THEN 1 ELSE 0 END) AS high_credit_count,\n        SUM(CASE WHEN cd_credit_rating = 'Medium' THEN 1 ELSE 0 END) AS medium_credit_count,\n        SUM(CASE WHEN cd_credit_rating = 'Low' THEN 1 ELSE 0 END) AS low_credit_count\n    FROM \n        customer AS c\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        cd_gender, cd_marital_status, cd_education_status\n),\nlocation_analysis AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        SUM(ws_net_profit) AS total_net_profit\n    FROM \n        customer AS c\n    JOIN \n        customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        ca_state\n),\nwarehouse_analysis AS (\n    SELECT \n        w.w_country,\n        COUNT(DISTINCT ws.ws_warehouse_sk) AS total_warehouses,\n        SUM(ws.ws_quantity) AS total_items_sold\n    FROM \n        warehouse AS w\n    JOIN \n        web_sales AS ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_country\n)\nSELECT \n    da.cd_gender,\n    da.cd_marital_status,\n    da.cd_education_status,\n    da.total_customers,\n    da.avg_purchase_estimate,\n    la.ca_state,\n    la.customer_count AS state_customer_count,\n    la.total_net_profit,\n    wa.w_country,\n    wa.total_warehouses,\n    wa.total_items_sold\nFROM \n    demographic_analysis AS da\nJOIN \n    location_analysis AS la ON da.cd_gender = 'F'  \nJOIN \n    warehouse_analysis AS wa ON la.customer_count > 100  \nORDER BY \n    da.total_customers DESC, la.total_net_profit DESC;",
  "\nWITH CustomerStats AS (\n    SELECT \n        ca_state,\n        COUNT(DISTINCT c_customer_id) AS customer_count,\n        AVG(cd_purchase_estimate) AS avg_purchase_estimate,\n        SUM(cd_dep_count) AS total_dependents\n    FROM \n        customer_address ca\n    JOIN \n        customer c ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        customer_demographics cd ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    GROUP BY \n        ca_state\n),\nSalesStats AS (\n    SELECT \n        d.d_year,\n        SUM(ws_ext_sales_price) AS total_sales,\n        SUM(ws_ext_tax) AS total_tax,\n        SUM(ws_net_profit) AS net_profit\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON d.d_date_sk = ws.ws_sold_date_sk\n    GROUP BY \n        d.d_year\n),\nWarehouseStats AS (\n    SELECT \n        w.w_warehouse_id,\n        COUNT(DISTINCT ws.ws_order_number) AS orders_fulfilled,\n        SUM(ws_ext_sales_price) AS sales_generated\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n),\nOverallStats AS (\n    SELECT \n        cs.ca_state,\n        cs.customer_count,\n        cs.avg_purchase_estimate,\n        cs.total_dependents,\n        ss.d_year,\n        ss.total_sales,\n        ss.total_tax,\n        ss.net_profit,\n        ws.w_warehouse_id,\n        ws.orders_fulfilled,\n        ws.sales_generated\n    FROM \n        CustomerStats cs\n    JOIN \n        SalesStats ss ON ss.d_year = EXTRACT(YEAR FROM DATE '2002-10-01')\n    JOIN \n        WarehouseStats ws ON ws.sales_generated > 100000\n)\nSELECT \n    os.ca_state,\n    os.customer_count,\n    os.avg_purchase_estimate,\n    os.total_dependents,\n    os.d_year,\n    os.total_sales,\n    os.total_tax,\n    os.net_profit,\n    os.w_warehouse_id,\n    os.orders_fulfilled,\n    os.sales_generated\nFROM \n    OverallStats os\nORDER BY \n    os.total_sales DESC, os.customer_count ASC;\n",
  "\nWITH SalesSummary AS (\n    SELECT \n        w.w_warehouse_name AS warehouse_name,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2000\n        AND d.d_moy IN (6, 7)  \n    GROUP BY \n        w.w_warehouse_name\n), CTE_Customer AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_ext_sales_price) AS total_spent\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2000\n        AND d.d_moy IN (6, 7)  \n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n), CustomerInsights AS (\n    SELECT \n        ci.cd_gender AS gender,\n        ci.cd_marital_status AS marital_status,\n        ci.cd_education_status AS education_status,\n        COUNT(DISTINCT ci.c_customer_id) AS customer_count,\n        AVG(ci.total_spent) AS avg_spent\n    FROM \n        CTE_Customer ci\n    GROUP BY \n        ci.cd_gender, ci.cd_marital_status, ci.cd_education_status\n)\nSELECT \n    ss.warehouse_name,\n    cs.gender,\n    cs.marital_status,\n    cs.education_status,\n    ss.total_quantity_sold,\n    ss.total_sales,\n    cs.customer_count,\n    cs.avg_spent\nFROM \n    SalesSummary ss\nJOIN \n    CustomerInsights cs ON ss.total_quantity_sold > 100\nORDER BY \n    ss.total_sales DESC, cs.customer_count DESC;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_sales_price) AS total_spent,\n        AVG(ws.ws_sales_price) AS avg_order_value\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate\n),\nwarehouse_summary AS (\n    SELECT \n        w.w_warehouse_sk,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory\n    FROM \n        warehouse w\n    JOIN \n        inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk\n    GROUP BY \n        w.w_warehouse_sk\n),\nstore_sales_summary AS (\n    SELECT \n        s.s_store_sk,\n        SUM(ss.ss_sales_price) AS total_store_sales,\n        AVG(ss.ss_sales_price) AS avg_sales_per_transaction\n    FROM \n        store s\n    JOIN \n        store_sales ss ON s.s_store_sk = ss.ss_store_sk\n    GROUP BY \n        s.s_store_sk\n)\nSELECT \n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_orders,\n    cs.total_spent,\n    cs.avg_order_value,\n    ws.total_inventory,\n    ss.total_store_sales,\n    ss.avg_sales_per_transaction\nFROM \n    customer_summary cs\nJOIN \n    warehouse_summary ws ON ws.total_inventory > 1000\nJOIN \n    store_sales_summary ss ON ss.total_store_sales > 5000\nWHERE \n    cs.cd_gender = 'F' \n    AND cs.total_orders > 5\nORDER BY \n    cs.total_spent DESC\nLIMIT 50;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_paid_inc_tax) AS total_spent,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        MAX(d.d_date) AS last_purchase_date\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nHighValueCustomers AS (\n    SELECT \n        c.c_customer_sk AS customer_id,\n        cs.total_spent,\n        cs.total_orders,\n        cs.last_purchase_date\n    FROM \n        CustomerSales cs\n    JOIN \n        customer c ON cs.c_customer_sk = c.c_customer_sk\n    WHERE \n        cs.total_spent > (SELECT AVG(total_spent) FROM CustomerSales) \n        AND cs.total_orders > 5\n),\nPromotionsApplied AS (\n    SELECT \n        hvc.customer_id,\n        p.p_promo_name,\n        COUNT(ws.ws_order_number) AS promo_orders\n    FROM \n        HighValueCustomers hvc\n    JOIN \n        web_sales ws ON hvc.customer_id = ws.ws_bill_customer_sk\n    JOIN \n        promotion p ON ws.ws_promo_sk = p.p_promo_sk\n    GROUP BY \n        hvc.customer_id, p.p_promo_name\n)\nSELECT \n    hvc.customer_id,\n    hvc.total_spent,\n    hvc.total_orders,\n    hvc.last_purchase_date,\n    COALESCE(SUM(p.promo_orders), 0) AS promotions_used\nFROM \n    HighValueCustomers hvc\nLEFT JOIN \n    PromotionsApplied p ON hvc.customer_id = p.customer_id\nGROUP BY \n    hvc.customer_id, hvc.total_spent, hvc.total_orders, hvc.last_purchase_date\nORDER BY \n    hvc.total_spent DESC\nLIMIT 10;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        SUM(cs.cs_net_paid) AS total_catalog_sales,\n        SUM(ss.ss_net_paid) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY c.c_customer_sk\n),\nDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        hd.hd_income_band_sk,\n        hd.hd_buy_potential\n    FROM \n        customer_demographics cd\n    JOIN household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n)\nSELECT \n    d.cd_gender,\n    d.cd_marital_status,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    COALESCE(cs.total_web_sales, 0) AS total_web_sales,\n    COALESCE(cs.total_catalog_sales, 0) AS total_catalog_sales,\n    COALESCE(cs.total_store_sales, 0) AS total_store_sales,\n    (COALESCE(cs.total_web_sales, 0) + COALESCE(cs.total_catalog_sales, 0) + COALESCE(cs.total_store_sales, 0)) AS total_sales,\n    COUNT(DISTINCT cs.c_customer_sk) AS customer_count\nFROM \n    CustomerSales cs\nJOIN Demographics d ON cs.c_customer_sk = d.cd_demo_sk\nJOIN income_band ib ON d.hd_income_band_sk = ib.ib_income_band_sk\nWHERE \n    ib.ib_lower_bound IS NOT NULL AND \n    (COALESCE(cs.total_web_sales, 0) + COALESCE(cs.total_catalog_sales, 0) + COALESCE(cs.total_store_sales, 0)) > 0\nGROUP BY \n    d.cd_gender,\n    d.cd_marital_status,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    cs.total_web_sales,\n    cs.total_catalog_sales,\n    cs.total_store_sales\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    WHERE \n        ws.ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022) - 30 \n        AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2022)\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_income_band_sk,\n        COUNT(cs.c_customer_sk) AS customer_count\n    FROM \n        customer_demographics cd\n    JOIN \n        household_demographics hd ON hd.hd_demo_sk = cd.cd_demo_sk\n    JOIN \n        income_band ib ON ib.ib_income_band_sk = hd.hd_income_band_sk\n    LEFT JOIN \n        CustomerSales cs ON cs.c_customer_sk = cd.cd_demo_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, ib.ib_income_band_sk\n),\nSalesSummary AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound,\n        SUM(cs.total_sales) AS total_sales,\n        SUM(cs.order_count) AS total_orders\n    FROM \n        CustomerDemographics cd\n    LEFT JOIN \n        CustomerSales cs ON cd.cd_demo_sk = cs.c_customer_sk\n    JOIN \n        income_band ib ON ib.ib_income_band_sk = cd.ib_income_band_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status, ib.ib_lower_bound, ib.ib_upper_bound\n)\nSELECT \n    ss.cd_gender,\n    ss.cd_marital_status,\n    ss.ib_lower_bound,\n    ss.ib_upper_bound,\n    ss.total_sales,\n    ss.total_orders\nFROM \n    SalesSummary ss\nWHERE \n    ss.total_sales IS NOT NULL\nORDER BY \n    ss.total_sales DESC;\n",
  "\nWITH customer_sales AS (\n    SELECT\n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM\n        customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY\n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nsales_summary AS (\n    SELECT\n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        COALESCE(cs.total_web_sales, 0) AS web_sales,\n        COALESCE(cs.total_catalog_sales, 0) AS catalog_sales,\n        COALESCE(cs.total_store_sales, 0) AS store_sales,\n        (COALESCE(cs.total_web_sales, 0) + COALESCE(cs.total_catalog_sales, 0) + COALESCE(cs.total_store_sales, 0)) AS total_sales\n    FROM\n        customer_sales cs\n),\nincome_bracket AS (\n    SELECT\n        cd.cd_demo_sk,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n    FROM\n        household_demographics hd\n    JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    JOIN customer_demographics cd ON hd.hd_demo_sk = cd.cd_demo_sk\n),\nfinal_report AS (\n    SELECT\n        ss.c_customer_sk,\n        ss.c_first_name,\n        ss.c_last_name,\n        ss.web_sales,\n        ss.catalog_sales,\n        ss.store_sales,\n        ss.total_sales,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n    FROM\n        sales_summary ss\n    LEFT JOIN income_bracket ib ON ss.c_customer_sk = ib.cd_demo_sk\n)\nSELECT \n    f.c_customer_sk,\n    f.c_first_name,\n    f.c_last_name,\n    f.web_sales,\n    f.catalog_sales,\n    f.store_sales,\n    f.total_sales,\n    f.ib_lower_bound,\n    f.ib_upper_bound,\n    CASE \n        WHEN f.total_sales > 1000 THEN 'High'\n        WHEN f.total_sales BETWEEN 500 AND 1000 THEN 'Medium'\n        ELSE 'Low'\n    END AS sales_category\nFROM \n    final_report f\nWHERE \n    f.web_sales IS NOT NULL OR f.catalog_sales IS NOT NULL OR f.store_sales IS NOT NULL\nORDER BY \n    f.total_sales DESC\nLIMIT 100;\n",
  "\nWITH SalesSummary AS (\n    SELECT \n        w.w_warehouse_id, \n        SUM(ws.ws_net_paid) AS total_sales, \n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_gender, \n        cd.cd_marital_status, \n        COUNT(DISTINCT c.c_customer_sk) AS total_customers,\n        SUM(ss.ss_net_profit) AS total_profit\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk \n    GROUP BY \n        cd.cd_gender, \n        cd.cd_marital_status\n),\nDateRange AS (\n    SELECT \n        d.d_year, \n        d.d_month_seq, \n        SUM(ws.ws_ext_sales_price) AS total_sales_price,\n        SUM(ws.ws_ext_tax) AS total_sales_tax\n    FROM \n        date_dim d\n    JOIN \n        web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\n    WHERE \n        d.d_year IN (2022, 2023)\n    GROUP BY \n        d.d_year, \n        d.d_month_seq\n)\nSELECT \n    ss.w_warehouse_id,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    dr.d_year,\n    dr.d_month_seq,\n    ss.total_sales,\n    ss.total_orders,\n    cd.total_customers,\n    cd.total_profit,\n    dr.total_sales_price,\n    dr.total_sales_tax\nFROM \n    SalesSummary ss\nJOIN \n    CustomerDemographics cd ON 1 = 1 \nJOIN \n    DateRange dr ON 1 = 1\nORDER BY \n    ss.w_warehouse_id, \n    cd.cd_gender, \n    dr.d_year, \n    dr.d_month_seq;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        d.d_year,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_paid) AS total_spent,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year\n), Promotions AS (\n    SELECT \n        p.p_promo_sk,\n        p.p_promo_name,\n        COUNT(cs.cs_order_number) AS promo_order_count,\n        SUM(cs.cs_net_paid) AS promo_total_revenue\n    FROM \n        promotion p\n    LEFT JOIN \n        catalog_sales cs ON p.p_promo_sk = cs.cs_promo_sk\n    GROUP BY \n        p.p_promo_sk, p.p_promo_name\n), Demographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status\n)\nSELECT \n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_quantity,\n    cs.total_spent,\n    cs.order_count,\n    p.p_promo_name,\n    p.promo_order_count,\n    p.promo_total_revenue,\n    d.cd_gender,\n    d.cd_marital_status\nFROM \n    CustomerStats cs\nLEFT JOIN \n    Promotions p ON cs.total_spent > 1000 AND p.promo_order_count > 0\nLEFT JOIN \n    Demographics d ON cs.c_customer_sk = d.customer_count\nWHERE \n    cs.total_spent IS NOT NULL \n    AND (d.cd_gender = 'M' OR d.cd_marital_status = 'M')\n    AND cs.total_quantity > (SELECT AVG(total_quantity) FROM CustomerStats)\nORDER BY \n    cs.total_spent DESC, cs.order_count ASC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_gender\n), \nwarehouse_summary AS (\n    SELECT \n        w.w_warehouse_id,\n        w.w_warehouse_name,\n        SUM(inv.inv_quantity_on_hand) AS total_quantity_on_hand\n    FROM \n        warehouse w\n    JOIN \n        inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id, w.w_warehouse_name\n), \nsales_summary AS (\n    SELECT \n        d.d_year,\n        SUM(ws.ws_quantity) AS total_sold_quantity,\n        SUM(ws.ws_net_profit) AS total_sales_profit\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n)\nSELECT \n    cs.c_customer_id,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.cd_gender,\n    ws.w_warehouse_id,\n    ws.w_warehouse_name,\n    ws.total_quantity_on_hand,\n    ss.d_year,\n    ss.total_sold_quantity,\n    ss.total_sales_profit,\n    cs.total_quantity,\n    cs.total_net_profit\nFROM \n    customer_summary cs\nJOIN \n    warehouse_summary ws ON cs.total_quantity > 100\nJOIN \n    sales_summary ss ON ss.total_sold_quantity > 5000\nORDER BY \n    cs.total_net_profit DESC, ss.total_sales_profit ASC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH customer_data AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_current_cdemo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE ws.ws_sold_date_sk > (SELECT MAX(d.d_date_sk) - 30 FROM date_dim d)\n    GROUP BY c.c_customer_sk, c.c_current_cdemo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nwarehouse_performance AS (\n    SELECT \n        w.w_warehouse_sk,\n        w.w_warehouse_name,\n        SUM(ws.ws_net_profit) AS total_profit,\n        AVG(ws.ws_net_paid) AS avg_net_paid\n    FROM warehouse w\n    JOIN web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY w.w_warehouse_sk, w.w_warehouse_name\n),\ndemographic_summary AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COUNT(*) AS customer_count,\n        SUM(cd.cd_purchase_estimate) AS total_purchase_estimate\n    FROM customer_demographics cd\n    JOIN customer_data cd_data ON cd.cd_demo_sk = cd_data.c_current_cdemo_sk\n    GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n)\nSELECT \n    cs.c_customer_sk,\n    cs.order_count,\n    cs.total_sales,\n    wp.w_warehouse_name,\n    wp.total_profit,\n    wp.avg_net_paid,\n    ds.customer_count,\n    ds.total_purchase_estimate\nFROM customer_data cs\nJOIN warehouse_performance wp ON cs.total_sales > 1000.00\nJOIN demographic_summary ds ON cs.cd_gender = ds.cd_gender AND cs.cd_marital_status = ds.cd_marital_status\nWHERE ds.customer_count > 10\nORDER BY total_sales DESC, total_profit DESC;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_id,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ws.ws_ext_sales_price) AS total_spent,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        COUNT(DISTINCT cr.cr_order_number) AS total_returns\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    LEFT JOIN \n        catalog_returns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status\n),\npromotions_summary AS (\n    SELECT \n        p.p_promo_id,\n        p.p_promo_name,\n        COUNT(DISTINCT ws.ws_order_number) AS usage_count,\n        SUM(ws.ws_ext_sales_price) AS total_sales_generated\n    FROM \n        promotion p\n    JOIN \n        web_sales ws ON p.p_promo_sk = ws.ws_promo_sk\n    GROUP BY \n        p.p_promo_id, p.p_promo_name\n)\nSELECT \n    cs.c_customer_id,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.total_spent,\n    cs.total_orders,\n    cs.total_returns,\n    ps.p_promo_id,\n    ps.p_promo_name,\n    ps.usage_count,\n    ps.total_sales_generated\nFROM \n    customer_summary cs\nLEFT JOIN \n    promotions_summary ps ON cs.total_spent > 1000 AND ps.usage_count > 0\nWHERE \n    cs.total_orders > 5\nORDER BY \n    cs.total_spent DESC, ps.total_sales_generated DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH sales_summary AS (\n    SELECT\n        d.d_year,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_net_paid) AS net_revenue,\n        AVG(ws.ws_sales_price) AS avg_sales_price,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        COUNT(DISTINCT ws.ws_ship_customer_sk) AS unique_customers\n    FROM\n        web_sales ws\n    JOIN\n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY\n        d.d_year\n),\ncustomer_segment AS (\n    SELECT\n        cd_gender,\n        cd_marital_status,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        SUM(cs.cs_quantity) AS total_items_sold,\n        SUM(cs.cs_ext_sales_price) AS total_sales_amount\n    FROM\n        customer c\n    LEFT JOIN\n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN\n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    GROUP BY\n        cd_gender, cd_marital_status\n),\nwarehouse_details AS (\n    SELECT\n        w.w_warehouse_id,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory,\n        AVG(inv.inv_quantity_on_hand) AS avg_inventory_level\n    FROM\n        warehouse w\n    JOIN\n        inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk\n    GROUP BY\n        w.w_warehouse_id\n)\nSELECT\n    ss.d_year,\n    ss.total_sales,\n    ss.net_revenue,\n    ss.avg_sales_price,\n    ss.total_orders,\n    ss.unique_customers,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.customer_count,\n    cs.total_items_sold,\n    cs.total_sales_amount,\n    wd.w_warehouse_id,\n    wd.total_inventory,\n    wd.avg_inventory_level\nFROM\n    sales_summary ss\nJOIN\n    customer_segment cs ON ss.total_sales > 1000000\nJOIN\n    warehouse_details wd ON wd.total_inventory > 5000\nORDER BY\n    ss.d_year, cs.customer_count DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        d.d_year,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        AVG(ws.ws_sales_price) AS avg_sales_price,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_coupon_amt) AS total_coupons_used\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year\n),\ncustomer_demographics_analysis AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        SUM(ws.ws_ext_sales_price) AS total_spent,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status\n),\nwarehouse_sales_summary AS (\n    SELECT \n        w.w_warehouse_name,\n        SUM(ws.ws_ext_sales_price) AS warehouse_total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS warehouse_order_count\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        w.w_warehouse_name\n)\nSELECT \n    ss.d_year,\n    ss.total_sales,\n    ss.order_count,\n    ss.avg_sales_price,\n    ss.total_quantity,\n    ss.total_coupons_used,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.customer_count,\n    cd.total_spent,\n    cd.avg_purchase_estimate,\n    ws.w_warehouse_name,\n    ws.warehouse_total_sales,\n    ws.warehouse_order_count\nFROM \n    sales_summary ss\nJOIN \n    customer_demographics_analysis cd ON ss.d_year = EXTRACT(YEAR FROM DATE '2002-10-01') \nJOIN \n    warehouse_sales_summary ws ON ss.total_sales > 10000 \nORDER BY \n    ss.d_year;\n",
  "\nWITH sales_summary AS (\n    SELECT\n        ws_item_sk,\n        SUM(ws_quantity) AS total_quantity,\n        SUM(ws_sales_price) AS total_sales,\n        SUM(ws_ext_discount_amt) AS total_discount,\n        SUM(ws_ext_tax) AS total_tax,\n        CAST(d.d_date AS DATE) AS sale_date\n    FROM\n        web_sales ws\n    JOIN\n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE\n        d.d_year = 2023\n    GROUP BY\n        ws_item_sk, CAST(d.d_date AS DATE)\n),\ntop_items AS (\n    SELECT\n        item.i_item_sk,\n        item.i_item_id,\n        item.i_product_name,\n        ss.total_quantity,\n        ss.total_sales\n    FROM\n        sales_summary ss\n    JOIN\n        item item ON ss.ws_item_sk = item.i_item_sk\n    ORDER BY\n        ss.total_sales DESC\n    LIMIT 10\n),\ncustomer_analysis AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ss.total_sales) AS total_customer_sales\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        sales_summary ss ON ws.ws_item_sk = ss.ws_item_sk\n    WHERE \n        ss.sale_date BETWEEN '2023-01-01' AND '2023-12-31'\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status\n),\nfinal_report AS (\n    SELECT \n        t.i_item_id AS item_id,\n        t.i_product_name AS product_name,\n        t.total_quantity,\n        t.total_sales,\n        ca.c_first_name,\n        ca.c_last_name,\n        ca.cd_gender,\n        ca.cd_marital_status,\n        ca.total_customer_sales\n    FROM \n        top_items t\n    JOIN \n        customer_analysis ca ON t.total_sales = ca.total_customer_sales\n)\nSELECT \n    fr.item_id,\n    fr.product_name,\n    fr.total_quantity,\n    fr.total_sales,\n    fr.c_first_name,\n    fr.c_last_name,\n    fr.cd_gender,\n    fr.cd_marital_status\nFROM \n    final_report fr\nWHERE \n    fr.total_sales > 1000\nORDER BY \n    fr.total_sales DESC;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_id,\n        CONCAT(c.c_first_name, ' ', c.c_last_name) AS full_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ca.ca_city,\n        ca.ca_state,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_paid) AS total_spent\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, \n        cd.cd_education_status, ca.ca_city, ca.ca_state\n),\ngender_stats AS (\n    SELECT\n        cd_gender,\n        COUNT(*) AS gender_count,\n        AVG(total_spent) AS avg_spent,\n        SUM(total_orders) AS total_orders_per_gender\n    FROM \n        customer_summary\n    GROUP BY \n        cd_gender\n),\nstate_summary AS (\n    SELECT \n        ca.ca_state,\n        COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n        SUM(CASE WHEN ws.ws_order_number IS NOT NULL THEN 1 ELSE 0 END) AS total_orders,\n        SUM(ws.ws_net_paid) AS total_revenue\n    FROM \n        customer c\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        ca.ca_state\n)\nSELECT \n    g.cd_gender,\n    g.gender_count,\n    g.avg_spent,\n    g.total_orders_per_gender,\n    s.ca_state,\n    s.unique_customers,\n    s.total_orders,\n    s.total_revenue\nFROM \n    gender_stats g\nCROSS JOIN \n    state_summary s\nORDER BY \n    g.cd_gender, s.ca_state;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        SUM(ws.ws_net_paid) AS total_spent,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate\n),\ndate_summary AS (\n    SELECT \n        d.d_year,\n        SUM(ws.ws_net_paid) AS total_sales\n    FROM \n        date_dim d\n    LEFT JOIN \n        web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\n    GROUP BY \n        d.d_year\n),\nwarehouse_summary AS (\n    SELECT \n        w.w_warehouse_sk,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory\n    FROM \n        warehouse w\n    JOIN \n        inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk\n    GROUP BY \n        w.w_warehouse_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.cd_education_status,\n    cs.cd_purchase_estimate,\n    cs.total_spent,\n    cs.total_orders,\n    ds.d_year,\n    ds.total_sales,\n    ws.w_warehouse_sk,\n    ws.total_inventory\nFROM \n    customer_summary cs\nCROSS JOIN \n    date_summary ds\nJOIN \n    warehouse_summary ws ON cs.total_spent > 1000\nWHERE \n    cs.total_orders > 5\nORDER BY \n    cs.total_spent DESC, ds.d_year ASC;\n",
  "\nWITH customer_stats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_net_paid) AS total_spent,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        COUNT(DISTINCT wr.wr_order_number) AS total_returns\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    LEFT JOIN \n        web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nsales_summary AS (\n    SELECT \n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_quantity) AS total_units_sold,\n        AVG(ws.ws_net_paid) AS average_order_value\n    FROM \n        web_sales ws\n    WHERE \n        ws.ws_sold_date_sk BETWEEN (SELECT MAX(d_date_sk) FROM date_dim) - 30 AND (SELECT MAX(d_date_sk) FROM date_dim)\n),\nwarehouse_inventory AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(inv.inv_quantity_on_hand) AS total_quantity_in_stock\n    FROM \n        warehouse w\n    JOIN \n        inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    cs.c_first_name,\n    cs.c_last_name,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.cd_education_status,\n    cs.total_spent,\n    cs.total_orders,\n    cs.total_returns,\n    ss.total_sales,\n    ss.total_units_sold,\n    ss.average_order_value,\n    wi.w_warehouse_id,\n    wi.total_quantity_in_stock\nFROM \n    customer_stats cs\nCROSS JOIN \n    sales_summary ss\nJOIN \n    warehouse_inventory wi ON wi.total_quantity_in_stock > 1000\nORDER BY \n    cs.total_spent DESC\nLIMIT 100;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_purchase_estimate, \n        hd.hd_income_band_sk,\n        hd.hd_buy_potential,\n        count(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_paid) AS total_spent,\n        AVG(ws.ws_net_paid) AS avg_order_value\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN household_demographics hd ON hd.hd_demo_sk = c.c_current_hdemo_sk\n    LEFT JOIN web_sales ws ON ws.ws_bill_customer_sk = c.c_customer_sk\n    GROUP BY \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        cd.cd_purchase_estimate, \n        hd.hd_income_band_sk,\n        hd.hd_buy_potential\n),\nwarehouse_summary AS (\n    SELECT \n        w.w_warehouse_sk,\n        w.w_warehouse_name,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory\n    FROM warehouse w\n    JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk\n    GROUP BY \n        w.w_warehouse_sk, \n        w.w_warehouse_name\n),\nsales_summary AS (\n    SELECT \n        ws.ws_warehouse_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS total_web_sales,\n        SUM(ws.ws_net_paid) AS total_web_revenue\n    FROM web_sales ws\n    GROUP BY ws.ws_warehouse_sk\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.cd_purchase_estimate,\n    cs.hd_income_band_sk,\n    cs.hd_buy_potential,\n    ws.total_web_sales,\n    ws.total_web_revenue,\n    ws.total_web_revenue / NULLIF(cs.total_orders, 0) AS avg_revenue_per_order,\n    w.total_inventory\nFROM customer_summary cs\nLEFT JOIN sales_summary ws ON ws.ws_warehouse_sk = cs.hd_income_band_sk\nLEFT JOIN warehouse_summary w ON w.w_warehouse_sk = cs.hd_income_band_sk\nWHERE cs.total_spent > 1000\nORDER BY cs.total_spent DESC\nLIMIT 100;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        SUM(ws.ws_ext_tax) AS total_tax,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        d.d_year,\n        d.d_month_seq,\n        c.c_preferred_cust_flag,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n    FROM web_sales ws\n    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    WHERE d.d_year = 2023 AND c.c_preferred_cust_flag = 'Y'\n    GROUP BY \n        ws.ws_item_sk,\n        d.d_year,\n        d.d_month_seq,\n        c.c_preferred_cust_flag,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n),\nReturnData AS (\n    SELECT \n        wr.wr_item_sk,\n        SUM(wr.wr_return_quantity) AS total_return_quantity,\n        SUM(wr.wr_return_amt) AS total_return_amount,\n        COUNT(DISTINCT wr.wr_order_number) AS total_return_orders\n    FROM web_returns wr\n    GROUP BY wr.wr_item_sk\n)\nSELECT \n    sd.ws_item_sk,\n    sd.total_quantity,\n    sd.total_sales,\n    sd.total_discount,\n    sd.total_tax,\n    rd.total_return_quantity,\n    rd.total_return_amount,\n    sd.total_orders,\n    sd.d_year,\n    sd.d_month_seq,\n    sd.cd_gender,\n    sd.cd_marital_status,\n    sd.ib_lower_bound,\n    sd.ib_upper_bound\nFROM SalesData sd\nLEFT JOIN ReturnData rd ON sd.ws_item_sk = rd.wr_item_sk\nORDER BY sd.total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_sales_price) AS avg_sales_price\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_purchase_estimate\n),\nWarehouseStats AS (\n    SELECT \n        w.w_warehouse_sk,\n        w.w_warehouse_name,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_sk, w.w_warehouse_name\n),\nDateStats AS (\n    SELECT \n        dd.d_year,\n        dd.d_month_seq,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM \n        date_dim dd\n    JOIN \n        web_sales ws ON dd.d_date_sk = ws.ws_ship_date_sk\n    GROUP BY \n        dd.d_year, dd.d_month_seq\n)\nSELECT \n    cs.c_first_name,\n    cs.c_last_name,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.total_quantity,\n    cs.total_net_profit AS customer_net_profit,\n    cs.total_orders AS customer_orders,\n    ws.w_warehouse_name,\n    ws.total_quantity_sold,\n    ws.total_net_profit AS warehouse_net_profit,\n    ds.d_year,\n    ds.d_month_seq,\n    ds.total_orders AS monthly_orders,\n    ds.total_net_profit AS monthly_net_profit\nFROM \n    CustomerStats cs\nJOIN \n    WarehouseStats ws ON cs.total_quantity > 0\nJOIN \n    DateStats ds ON cs.total_orders > 0\nWHERE \n    cs.total_net_profit > 1000\nORDER BY \n    ds.d_year DESC, ds.d_month_seq DESC, cs.total_net_profit DESC;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_sales_price) AS total_sales_price,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        SUM(ws.ws_ext_tax) AS total_tax\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    WHERE \n        dd.d_year = 2023\n        AND cd.cd_gender = 'F'\n        AND cd.cd_marital_status = 'M'\n    GROUP BY \n        ws.ws_sold_date_sk, ws.ws_item_sk\n),\naddress_info AS (\n    SELECT \n        ca.ca_address_sk,\n        ca.ca_city,\n        ca.ca_state,\n        ca.ca_country\n    FROM \n        customer_address ca\n    JOIN \n        customer c ON c.c_current_addr_sk = ca.ca_address_sk\n),\ntop_items AS (\n    SELECT \n        item.i_item_sk,\n        item.i_product_name,\n        SUM(sd.total_sales_price) AS total_sales\n    FROM \n        sales_data sd\n    JOIN \n        item item ON sd.ws_item_sk = item.i_item_sk\n    GROUP BY \n        item.i_item_sk, item.i_product_name\n    ORDER BY \n        total_sales DESC\n    LIMIT 10\n)\nSELECT \n    ti.i_product_name,\n    ti.total_sales,\n    ai.ca_city,\n    ai.ca_state,\n    ai.ca_country\nFROM \n    top_items ti\nJOIN \n    sales_data sd ON ti.i_item_sk = sd.ws_item_sk\nJOIN \n    address_info ai ON sd.ws_sold_date_sk IN (\n        SELECT \n            dd.d_date_sk \n        FROM \n            date_dim dd \n        WHERE \n            dd.d_year = 2023\n    )\nORDER BY \n    ti.total_sales DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        AVG(ws.ws_net_profit) AS avg_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        MAX(d.d_date) AS last_purchase_date\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_id\n),\ntop_customers AS (\n    SELECT \n        c.c_customer_id,\n        ss.total_sales,\n        ss.avg_profit,\n        ss.order_count,\n        ss.last_purchase_date\n    FROM \n        sales_summary ss\n    JOIN \n        customer c ON ss.c_customer_id = c.c_customer_id\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    ORDER BY \n        ss.total_sales DESC\n    LIMIT 10\n)\nSELECT \n    tc.c_customer_id,\n    tc.total_sales,\n    tc.avg_profit,\n    tc.order_count,\n    tc.last_purchase_date,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    ca.ca_city,\n    ca.ca_state\nFROM \n    top_customers tc\nJOIN \n    customer c ON tc.c_customer_id = c.c_customer_id\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nWHERE \n    cd.cd_gender = 'F'\nAND \n    tc.total_sales > 1000\nORDER BY \n    tc.last_purchase_date DESC;\n",
  "\nSELECT \n    c.c_first_name,\n    c.c_last_name,\n    SUM(ss.ss_net_paid) AS total_sales,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions,\n    MAX(d.d_date) AS last_purchase_date,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    COUNT(DISTINCT sr.sr_ticket_number) AS total_returns\nFROM \n    customer c\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    store s ON ss.ss_store_sk = s.s_store_sk\nJOIN \n    date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nLEFT JOIN \n    store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\nLEFT JOIN \n    household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\nLEFT JOIN \n    income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status,\n    cd.cd_education_status, ib.ib_lower_bound, ib.ib_upper_bound\nHAVING \n    SUM(ss.ss_net_paid) > 1000\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_id\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_gender,\n        COUNT(cd.cd_demo_sk) AS demo_count\n    FROM \n        customer_demographics cd\n    GROUP BY \n        cd.cd_gender\n),\nSalesByDemographics AS (\n    SELECT \n        cs.c_customer_id,\n        cs.total_sales,\n        cs.total_orders,\n        cd.cd_gender\n    FROM \n        CustomerSales cs\n    JOIN \n        customer c ON cs.c_customer_id = c.c_customer_id\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nWarehouseSales AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_ext_sales_price) AS total_warehouse_sales\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    cs.c_customer_id,\n    cs.total_sales,\n    cs.total_orders,\n    cd.demo_count AS gender_demo_count,\n    ws.total_warehouse_sales\nFROM \n    SalesByDemographics cs\nJOIN \n    CustomerDemographics cd ON cs.cd_gender = cd.cd_gender\nJOIN \n    WarehouseSales ws ON cs.total_sales > 1000\nORDER BY \n    cs.total_sales DESC;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN \n        customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk\n    JOIN \n        promotion p ON ws.ws_promo_sk = p.p_promo_sk\n    WHERE \n        dd.d_year = 2023 AND \n        cd.cd_gender = 'M' AND \n        ca.ca_state = 'CA'\n    GROUP BY \n        ws.ws_item_sk\n), CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT ws.ws_order_number) AS customer_orders,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk\n), TopItems AS (\n    SELECT \n        sd.ws_item_sk,\n        sd.total_quantity,\n        sd.total_sales,\n        cs.customer_orders,\n        cs.total_profit\n    FROM \n        SalesData sd\n    JOIN \n        CustomerStats cs ON sd.ws_item_sk = cs.c_customer_sk\n    ORDER BY \n        sd.total_sales DESC\n    LIMIT 10\n)\nSELECT \n    ti.ws_item_sk,\n    ti.total_quantity,\n    ti.total_sales,\n    ti.customer_orders,\n    ti.total_profit\nFROM \n    TopItems ti\nJOIN \n    item i ON ti.ws_item_sk = i.i_item_sk\nWHERE \n    i.i_current_price > 100 AND \n    i.i_brand LIKE '%Premium%'\nORDER BY \n    ti.total_profit DESC;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_current_cdemo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating,\n        SUM(ss.ss_net_paid_inc_tax) AS total_sales,\n        COUNT(ss.ss_ticket_number) AS total_transactions\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_current_cdemo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_credit_rating\n),\nincome_distribution AS (\n    SELECT \n        hd.hd_income_band_sk, \n        COUNT(*) AS customer_count\n    FROM \n        household_demographics hd\n    JOIN \n        customer c ON hd.hd_demo_sk = c.c_current_hdemo_sk\n    GROUP BY \n        hd.hd_income_band_sk\n),\nsales_by_time AS (\n    SELECT \n        d.d_year,\n        d.d_month_seq,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        date_dim d\n    JOIN \n        web_sales ws ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year, d.d_month_seq\n),\nhighest_sales AS (\n    SELECT \n        c.c_customer_id, \n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    WHERE \n        ws.ws_net_profit IS NOT NULL\n    GROUP BY \n        c.c_customer_id\n    HAVING \n        SUM(ws.ws_net_profit) > 1000 \n),\nfinal_report AS (\n    SELECT \n        cs.c_customer_sk,\n        cs.cd_gender,\n        cs.cd_marital_status,\n        cs.total_sales,\n        cs.total_transactions,\n        id.customer_count AS income_band_count,\n        st.total_profit AS year_profit\n    FROM \n        customer_summary cs\n    LEFT JOIN \n        income_distribution id ON cs.c_current_cdemo_sk = id.hd_income_band_sk\n    LEFT JOIN \n        sales_by_time st ON st.d_year = EXTRACT(YEAR FROM CAST('2002-10-01' AS DATE))\n    WHERE \n        cs.total_sales > 500\n)\nSELECT \n    fr.c_customer_sk,\n    fr.cd_gender,\n    fr.cd_marital_status,\n    fr.total_sales,\n    fr.total_transactions,\n    COALESCE(fr.income_band_count, 0) AS income_band_count,\n    COALESCE(fr.year_profit, 0.00) AS year_profit\nFROM \n    final_report fr\nORDER BY \n    fr.total_sales DESC\nLIMIT 100;\n",
  "\nWITH customer_counts AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT cs.cs_order_number) AS total_catalog_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_web_sales,\n        COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns,\n        COUNT(DISTINCT cr.cr_order_number) AS total_catalog_returns\n    FROM \n        customer c\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    LEFT JOIN \n        catalog_returns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nreturn_stats AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(COALESCE(sr.sr_return_amt, 0)) AS total_return_amount,\n        SUM(COALESCE(cr.cr_return_amount, 0)) AS total_catalog_return_amount\n    FROM \n        customer c\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    LEFT JOIN \n        catalog_returns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nfinal_report AS (\n    SELECT \n        cc.c_customer_sk,\n        cc.total_catalog_sales,\n        cc.total_web_sales,\n        rs.total_return_amount,\n        rs.total_catalog_return_amount,\n        COALESCE(cc.total_web_sales, 0) - COALESCE(rs.total_return_amount, 0) AS adjusted_web_sales,\n        COALESCE(cc.total_catalog_sales, 0) - COALESCE(rs.total_catalog_return_amount, 0) AS adjusted_catalog_sales\n    FROM \n        customer_counts cc\n    JOIN \n        return_stats rs ON cc.c_customer_sk = rs.c_customer_sk\n)\nSELECT \n    f.c_customer_sk,\n    f.total_catalog_sales,\n    f.total_web_sales,\n    f.total_return_amount,\n    f.total_catalog_return_amount,\n    f.adjusted_web_sales,\n    f.adjusted_catalog_sales,\n    CASE \n        WHEN f.adjusted_web_sales > 5000 THEN 'High Value Customer'\n        WHEN f.adjusted_web_sales BETWEEN 2000 AND 5000 THEN 'Medium Value Customer'\n        ELSE 'Low Value Customer'\n    END AS customer_value_category\nFROM \n    final_report f\nWHERE \n    f.total_catalog_sales > 10 \nORDER BY \n    f.adjusted_web_sales DESC, f.adjusted_catalog_sales DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_ship_date_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price * ws.ws_quantity) AS total_sales,\n        ca.ca_state\n    FROM web_sales ws\n    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE dd.d_year = 2023\n      AND ca.ca_state IN ('CA', 'TX', 'NY')\n    GROUP BY ws.ws_ship_date_sk, ca.ca_state\n),\nReturnData AS (\n    SELECT \n        wr.wr_returned_date_sk,\n        SUM(wr.wr_return_quantity) AS total_returned_quantity,\n        SUM(wr.wr_return_amt) AS total_return_amount,\n        ca.ca_state\n    FROM web_returns wr\n    JOIN customer c ON wr.wr_returning_customer_sk = c.c_customer_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN date_dim dd ON wr.wr_returned_date_sk = dd.d_date_sk\n    WHERE dd.d_year = 2023\n      AND ca.ca_state IN ('CA', 'TX', 'NY')\n    GROUP BY wr.wr_returned_date_sk, ca.ca_state\n)\nSELECT \n    sd.ws_ship_date_sk,\n    sd.total_quantity,\n    sd.total_sales,\n    COALESCE(rd.total_returned_quantity, 0) AS total_returned_quantity,\n    COALESCE(rd.total_return_amount, 0) AS total_return_amount,\n    sd.ca_state\nFROM SalesData sd\nLEFT JOIN ReturnData rd ON sd.ws_ship_date_sk = rd.wr_returned_date_sk AND sd.ca_state = rd.ca_state\nORDER BY sd.ws_ship_date_sk, sd.ca_state;\n",
  "\nWITH CustomerStats AS (\n    SELECT\n        cd.cd_gender,\n        SUM(CASE WHEN cs.cs_item_sk IS NOT NULL THEN cs.cs_quantity ELSE 0 END) AS total_quantity_sold,\n        COUNT(DISTINCT c.c_customer_sk) AS number_of_customers,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM\n        customer c\n    JOIN\n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN\n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN\n        catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    GROUP BY\n        cd.cd_gender\n),\nDateStats AS (\n    SELECT\n        d.d_year,\n        SUM(ws.ws_quantity) AS total_web_sales,\n        SUM(ws.ws_net_profit) AS total_web_profit\n    FROM\n        web_sales ws\n    JOIN\n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY\n        d.d_year\n),\nWarehouseInventory AS (\n    SELECT\n        w.w_warehouse_id,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory\n    FROM\n        warehouse w\n    JOIN\n        inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk\n    GROUP BY\n        w.w_warehouse_id\n)\nSELECT \n    cs.cd_gender,\n    cs.total_quantity_sold,\n    cs.number_of_customers,\n    cs.avg_purchase_estimate,\n    ds.d_year,\n    ds.total_web_sales,\n    ds.total_web_profit,\n    wi.w_warehouse_id,\n    wi.total_inventory\nFROM \n    CustomerStats cs\nJOIN \n    DateStats ds ON cs.total_quantity_sold > 0\nJOIN \n    WarehouseInventory wi ON wi.total_inventory > 100\nORDER BY \n    cs.cd_gender, ds.d_year DESC, wi.total_inventory DESC\nLIMIT 1000;\n",
  "WITH sales_summary AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS num_orders,\n        AVG(ws.ws_net_profit) AS avg_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2001\n        AND cd.cd_marital_status = 'M'\n        AND cd.cd_gender = 'F'\n    GROUP BY \n        w.w_warehouse_id\n),\npromotion_summary AS (\n    SELECT \n        p.p_promo_id,\n        COUNT(DISTINCT ws.ws_order_number) AS promo_orders,\n        SUM(ws.ws_sales_price) AS promo_sales\n    FROM \n        promotion p\n    JOIN \n        web_sales ws ON p.p_promo_sk = ws.ws_promo_sk\n    GROUP BY \n        p.p_promo_id\n),\ncombined_summary AS (\n    SELECT \n        ss.w_warehouse_id,\n        ss.total_quantity,\n        ss.total_sales,\n        ss.num_orders,\n        ss.avg_net_profit,\n        COALESCE(ps.promo_orders, 0) AS promo_orders,\n        COALESCE(ps.promo_sales, 0) AS promo_sales\n    FROM \n        sales_summary ss\n    LEFT JOIN \n        promotion_summary ps ON ss.w_warehouse_id = ps.p_promo_id  \n)\nSELECT \n    w.w_warehouse_id,\n    w.w_warehouse_name,\n    cs.total_quantity,\n    cs.total_sales,\n    cs.num_orders,\n    cs.avg_net_profit,\n    cs.promo_orders,\n    cs.promo_sales\nFROM \n    warehouse w\nJOIN \n    combined_summary cs ON w.w_warehouse_id = cs.w_warehouse_id\nORDER BY \n    cs.total_sales DESC;",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        MAX(ws.ws_sold_date_sk) AS last_purchase_date\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk\n), \nSalesDemographics AS (\n    SELECT \n        cs.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_income_band_sk\n    FROM \n        CustomerSales cs\n    JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    LEFT JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n), \nSalesDate AS (\n    SELECT \n        cs.c_customer_sk,\n        dd.d_year,\n        dd.d_quarter_seq\n    FROM \n        CustomerSales cs\n    JOIN \n        date_dim dd ON cs.last_purchase_date = dd.d_date_sk\n)\nSELECT \n    sd.cd_gender,\n    sd.cd_marital_status,\n    COUNT(DISTINCT sd.c_customer_sk) AS customer_count,\n    SUM(cs.total_quantity) AS grand_total_quantity,\n    SUM(cs.total_net_profit) AS grand_total_net_profit,\n    COUNT(DISTINCT sd.c_customer_sk) AS distinct_customers,\n    sd.ib_income_band_sk AS income_band\nFROM \n    SalesDemographics sd\nJOIN \n    CustomerSales cs ON sd.c_customer_sk = cs.c_customer_sk\nJOIN \n    SalesDate sd2 ON sd.c_customer_sk = sd2.c_customer_sk\nWHERE \n    sd2.d_year = 2023\nGROUP BY \n    sd.cd_gender, \n    sd.cd_marital_status, \n    sd.ib_income_band_sk\nORDER BY \n    grand_total_net_profit DESC;\n",
  "\nWITH customer_full_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        ca.ca_city,\n        ca.ca_state,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating\n    FROM \n        customer c\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n),\nitem_statistics AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_desc,\n        COUNT(ws.ws_order_number) AS total_sales,\n        SUM(ws.ws_sales_price) AS total_revenue,\n        AVG(ws.ws_sales_price) AS average_price\n    FROM \n        item i \n    JOIN \n        web_sales ws ON i.i_item_sk = ws.ws_item_sk\n    GROUP BY \n        i.i_item_sk, i.i_item_desc\n),\ncustomer_engagement AS (\n    SELECT \n        cfi.c_customer_sk,\n        COUNT(DISTINCT w.web_site_id) AS total_web_visits,\n        AVG(wp.wp_char_count) AS avg_page_characters\n    FROM \n        customer_full_info cfi\n    LEFT JOIN \n        web_page wp ON cfi.c_customer_sk = wp.wp_customer_sk\n    LEFT JOIN \n        web_site w ON wp.wp_web_page_sk = w.web_site_sk\n    GROUP BY \n        cfi.c_customer_sk\n)\nSELECT \n    cfi.c_customer_sk,\n    cfi.c_first_name,\n    cfi.c_last_name,\n    cfi.ca_city,\n    cfi.ca_state,\n    cfo.total_sales,\n    cfo.total_revenue,\n    cfo.average_price,\n    ce.total_web_visits,\n    ce.avg_page_characters\nFROM \n    customer_full_info cfi\nJOIN \n    item_statistics cfo ON cfi.c_customer_sk = cfo.i_item_sk\nJOIN \n    customer_engagement ce ON cfi.c_customer_sk = ce.c_customer_sk\nWHERE \n    cfi.cd_gender = 'F' AND \n    cfi.cd_education_status LIKE '%Bachelor%' \nORDER BY \n    cfi.c_last_name ASC, cfi.c_first_name ASC;\n",
  "\nWITH Income_Categories AS (\n    SELECT \n        ib_income_band_sk,\n        ib_lower_bound,\n        ib_upper_bound,\n        CASE \n            WHEN ib_income_band_sk IS NULL THEN 'Unknown'\n            WHEN ib_lower_bound < 30000 THEN 'Low Income'\n            WHEN ib_lower_bound < 70000 THEN 'Middle Income'\n            ELSE 'High Income' \n        END AS income_category\n    FROM income_band\n),\nSales_Stats AS (\n    SELECT\n        cs.cs_item_sk,\n        COUNT(cs.cs_order_number) AS total_orders,\n        SUM(cs.cs_sales_price) AS total_sales,\n        SUM(cs.cs_net_profit) AS total_net_profit\n    FROM catalog_sales cs\n    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk\n    LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    GROUP BY cs.cs_item_sk\n),\nReturn_Stats AS (\n    SELECT\n        cr.cr_item_sk,\n        COUNT(cr.cr_order_number) AS total_returns,\n        SUM(cr.cr_return_amount) AS total_return_amount\n    FROM catalog_returns cr\n    GROUP BY cr.cr_item_sk\n),\nFinal_Stats AS (\n    SELECT \n        ss.cs_item_sk,\n        ss.total_orders,\n        ss.total_sales,\n        ss.total_net_profit,\n        COALESCE(rs.total_returns, 0) AS total_returns,\n        COALESCE(rs.total_return_amount, 0) AS total_return_amount,\n        ic.income_category\n    FROM Sales_Stats ss\n    LEFT JOIN Return_Stats rs ON ss.cs_item_sk = rs.cr_item_sk\n    LEFT JOIN customer c ON ss.cs_item_sk = c.c_customer_sk\n    LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    LEFT JOIN Income_Categories ic ON hd.hd_income_band_sk = ic.ib_income_band_sk\n)\nSELECT \n    item.i_item_id,\n    item.i_item_desc,\n    fs.total_orders,\n    fs.total_sales,\n    fs.total_net_profit,\n    fs.total_returns,\n    fs.total_return_amount,\n    fs.income_category\nFROM Final_Stats fs\nJOIN item ON fs.cs_item_sk = item.i_item_sk\nWHERE fs.total_sales > 1000\nORDER BY fs.total_net_profit DESC, fs.total_orders DESC\nLIMIT 50;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM\n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nHighSpenders AS (\n    SELECT \n        c_customer_sk,\n        c_first_name,\n        c_last_name\n    FROM \n        CustomerSales\n    WHERE \n        total_web_sales > (SELECT AVG(total_web_sales) FROM CustomerSales)\n),\nPromotionStats AS (\n    SELECT \n        p.p_promo_id,\n        COUNT(cs.c_customer_sk) AS customer_count,\n        SUM(ws.ws_net_paid) AS total_sales_from_promo\n    FROM \n        promotion p\n    LEFT JOIN \n        web_sales ws ON p.p_promo_sk = ws.ws_promo_sk\n    LEFT JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    LEFT JOIN \n        CustomerSales cs ON cs.c_customer_sk = c.c_customer_sk\n    WHERE \n        cs.c_customer_sk IS NOT NULL\n    GROUP BY \n        p.p_promo_id\n),\nTotalReturns AS (\n    SELECT \n        SUM(sr_return_amt_inc_tax) AS total_return_amt,\n        SUM(cr_return_amt_inc_tax) AS total_catalog_return_amt\n    FROM \n        store_returns sr\n    FULL OUTER JOIN \n        catalog_returns cr ON sr.sr_item_sk = cr.cr_item_sk\n)\nSELECT \n    H.c_first_name,\n    H.c_last_name,\n    COALESCE(P.p_promo_id, 'None') AS promotional_campaign,\n    P.total_sales_from_promo AS promo_sales,\n    T.total_return_amt,\n    T.total_catalog_return_amt\nFROM \n    HighSpenders H\nLEFT JOIN \n    PromotionStats P ON H.c_customer_sk = P.customer_count\nCROSS JOIN \n    TotalReturns T\nWHERE \n    (P.total_sales_from_promo IS NULL OR P.total_sales_from_promo > 5000)\nORDER BY \n    H.c_last_name, H.c_first_name;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        COUNT(DISTINCT ws.ws_order_number) AS number_of_sales\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk \n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        ws.ws_item_sk\n),\ncustomer_purchases AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(sd.total_sales) AS customer_total_spent,\n        COUNT(DISTINCT sd.ws_item_sk) AS unique_items_purchased\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        sales_data sd ON ws.ws_item_sk = sd.ws_item_sk\n    GROUP BY \n        c.c_customer_sk\n),\nhigh_value_customers AS (\n    SELECT \n        cp.c_customer_sk,\n        cp.customer_total_spent,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_credit_rating\n    FROM \n        customer_purchases cp\n    JOIN \n        customer_demographics cd ON cp.c_customer_sk = cd.cd_demo_sk\n    WHERE \n        cp.customer_total_spent > (SELECT AVG(customer_total_spent) FROM customer_purchases)\n)\nSELECT \n    hvc.c_customer_sk,\n    hvc.customer_total_spent,\n    hvc.cd_gender,\n    hvc.cd_marital_status,\n    hvc.cd_credit_rating,\n    ca.ca_city,\n    COUNT(DISTINCT ws.ws_order_number) AS total_orders\nFROM \n    high_value_customers hvc\nJOIN \n    customer c ON hvc.c_customer_sk = c.c_customer_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN \n    web_sales ws ON ws.ws_bill_customer_sk = hvc.c_customer_sk\nGROUP BY \n    hvc.c_customer_sk, \n    hvc.customer_total_spent, \n    hvc.cd_gender, \n    hvc.cd_marital_status, \n    hvc.cd_credit_rating, \n    ca.ca_city\nORDER BY \n    hvc.customer_total_spent DESC\nLIMIT 50;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_sold_date_sk,\n        ws.ws_item_sk,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        SUM(ws.ws_quantity) AS total_quantity,\n        MIN(i.i_current_price) AS min_price,\n        MAX(i.i_current_price) AS max_price,\n        AVG(i.i_current_price) AS avg_price,\n        COUNT(DISTINCT cs.cs_order_number) AS total_orders,\n        COUNT(DISTINCT ws.ws_ship_customer_sk) AS unique_customers\n    FROM \n        web_sales ws\n    JOIN \n        item i ON ws.ws_item_sk = i.i_item_sk\n    LEFT JOIN \n        catalog_sales cs ON ws.ws_item_sk = cs.cs_item_sk AND ws.ws_order_number = cs.cs_order_number\n    GROUP BY \n        ws.ws_sold_date_sk, \n        ws.ws_item_sk\n),\nCustomerDemographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(DISTINCT ws.ws_ship_customer_sk) AS customer_count,\n        SUM(sd.total_net_profit) AS total_profit_by_gender_marital\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    JOIN \n        web_sales ws ON ws.ws_ship_customer_sk = c.c_customer_sk\n    JOIN \n        SalesData sd ON sd.ws_item_sk = ws.ws_item_sk\n    GROUP BY \n        cd.cd_demo_sk, \n        cd.cd_gender, \n        cd.cd_marital_status\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.customer_count,\n    cd.total_profit_by_gender_marital,\n    COUNT(DISTINCT ca.ca_country) AS unique_countries,\n    COUNT(DISTINCT w.w_warehouse_id) AS warehouses_involved\nFROM \n    CustomerDemographics cd\nJOIN \n    customer_address ca ON cd.cd_demo_sk = ca.ca_address_sk\nJOIN \n    warehouse w ON w.w_warehouse_sk = ca.ca_address_sk\nGROUP BY \n    cd.cd_gender, \n    cd.cd_marital_status, \n    cd.customer_count, \n    cd.total_profit_by_gender_marital\nORDER BY \n    total_profit_by_gender_marital DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_id,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_id\n),\nSalesDetails AS (\n    SELECT \n        c.c_customer_id,\n        ca.ca_city,\n        ca.ca_state,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    WHERE \n        ca.ca_state IN ('CA', 'NY', 'TX')\n    GROUP BY \n        c.c_customer_id, ca.ca_city, ca.ca_state\n)\nSELECT \n    sd.c_customer_id,\n    sd.ca_city,\n    sd.ca_state,\n    sd.total_web_sales,\n    sd.total_catalog_sales,\n    sd.total_store_sales,\n    (COALESCE(sd.total_web_sales, 0) + COALESCE(sd.total_catalog_sales, 0) + COALESCE(sd.total_store_sales, 0)) AS total_sales,\n    CASE \n        WHEN (COALESCE(sd.total_web_sales, 0) + COALESCE(sd.total_catalog_sales, 0) + COALESCE(sd.total_store_sales, 0)) > 100000 THEN 'High Value Customer'\n        WHEN (COALESCE(sd.total_web_sales, 0) + COALESCE(sd.total_catalog_sales, 0) + COALESCE(sd.total_store_sales, 0)) > 50000 THEN 'Medium Value Customer'\n        ELSE 'Low Value Customer'\n    END AS customer_value_flag\nFROM \n    SalesDetails sd\nWHERE \n    sd.total_web_sales > 0 OR sd.total_catalog_sales > 0 OR sd.total_store_sales > 0\nORDER BY \n    total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        cd.cd_gender, \n        cd.cd_marital_status, \n        SUM(ws.ws_net_paid) AS total_spent, \n        COUNT(ws.ws_order_number) AS total_orders, \n        COUNT(DISTINCT ws.ws_item_sk) AS unique_items_purchased\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    GROUP BY \n        cd.cd_gender, \n        cd.cd_marital_status\n),\nWarehouseStats AS (\n    SELECT \n        w.w_warehouse_id, \n        COUNT(DISTINCT ws.ws_order_number) AS total_orders_handled, \n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n),\nInventoryStats AS (\n    SELECT \n        i.i_item_id, \n        AVG(inv.inv_quantity_on_hand) AS avg_quantity,\n        SUM(i.i_current_price) AS total_inventory_value\n    FROM \n        item i\n    JOIN \n        inventory inv ON i.i_item_sk = inv.inv_item_sk\n    GROUP BY \n        i.i_item_id\n)\nSELECT \n    cs.cd_gender, \n    cs.cd_marital_status, \n    cs.total_spent, \n    cs.total_orders, \n    ws.w_warehouse_id, \n    ws.total_orders_handled, \n    ws.total_profit, \n    is_.i_item_id, \n    is_.avg_quantity, \n    is_.total_inventory_value\nFROM \n    CustomerStats cs\nJOIN \n    WarehouseStats ws ON cs.total_orders > 0\nJOIN \n    InventoryStats is_ ON is_.avg_quantity > 0\nORDER BY \n    cs.total_spent DESC, ws.total_profit DESC;\n",
  "\nWITH CustomerSales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_net_paid) AS total_web_sales,\n        SUM(cs.cs_net_paid) AS total_catalog_sales,\n        SUM(ss.ss_net_paid) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nIncomeDemographics AS (\n    SELECT \n        h.hd_demo_sk,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        MAX(h.hd_income_band_sk) AS income_band\n    FROM \n        household_demographics h\n    JOIN \n        customer c ON h.hd_demo_sk = c.c_current_hdemo_sk\n    GROUP BY \n        h.hd_demo_sk\n),\nSalesPerformance AS (\n    SELECT \n        cd.cd_gender,\n        COALESCE(SUM(cs.total_catalog_sales), 0) AS total_catalog_sales,\n        COALESCE(SUM(cs.total_web_sales), 0) AS total_web_sales,\n        COALESCE(SUM(cs.total_store_sales), 0) AS total_store_sales\n    FROM \n        CustomerSales cs\n    LEFT JOIN \n        customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\n    LEFT JOIN \n        IncomeDemographics id ON cd.cd_demo_sk = id.hd_demo_sk\n    GROUP BY \n        cd.cd_gender\n)\nSELECT \n    cd.cd_gender AS gender,\n    sp.total_catalog_sales,\n    sp.total_web_sales,\n    sp.total_store_sales,\n    (sp.total_catalog_sales + sp.total_web_sales + sp.total_store_sales) AS total_sales,\n    ROUND((sp.total_catalog_sales + sp.total_web_sales + sp.total_store_sales) / NULLIF(sp.total_catalog_sales + sp.total_web_sales + sp.total_store_sales, 0), 2) AS average_sales_per_customer\nFROM \n    SalesPerformance sp\nJOIN \n    customer_demographics cd ON sp.cd_gender = cd.cd_gender\nORDER BY \n    total_sales DESC;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_customer_id,\n        d.d_year,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_sales_price) AS avg_order_value,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_income_band_sk\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    WHERE \n        d.d_year = 2023\n    GROUP BY \n        c.c_customer_sk, c.c_customer_id, d.d_year, cd.cd_gender, cd.cd_marital_status, ib.ib_income_band_sk\n),\nwarehouse_sales AS (\n    SELECT \n        w.w_warehouse_sk,\n        w.w_warehouse_id,\n        SUM(ws.ws_ext_sales_price) AS warehouse_sales\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_sk, w.w_warehouse_id\n)\nSELECT \n    cs.c_customer_id,\n    cs.total_sales,\n    cs.total_orders,\n    cs.avg_order_value,\n    ws.warehouse_sales,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.ib_income_band_sk\nFROM \n    customer_summary cs\nJOIN \n    warehouse_sales ws ON cs.total_sales = ws.warehouse_sales\nORDER BY \n    cs.total_sales DESC\nLIMIT 100;\n",
  "\nWITH CustomerLocation AS (\n    SELECT \n        ca_city, \n        ca_state,\n        COUNT(DISTINCT c_customer_id) AS total_customers\n    FROM \n        customer_address\n    JOIN \n        customer ON ca_address_sk = c_current_addr_sk\n    GROUP BY \n        ca_city, \n        ca_state\n), \nPromotionalImpact AS (\n    SELECT \n        p.p_promo_id,\n        SUM(CASE \n            WHEN ws_sold_date_sk IS NOT NULL THEN ws_quantity \n            ELSE 0 \n        END) AS total_sold,\n        SUM(ws_net_profit) AS total_profit\n    FROM \n        promotion p\n    LEFT JOIN \n        web_sales ws ON p.p_promo_sk = ws.ws_promo_sk\n    GROUP BY \n        p.p_promo_id\n), \nSalesTrends AS (\n    SELECT \n        d.d_year,\n        SUM(ws_ext_sales_price) AS annual_sales,\n        SUM(ws_ext_discount_amt) AS total_discounts\n    FROM \n        date_dim d\n    JOIN \n        web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\n    GROUP BY \n        d.d_year\n), \nWarehouseInventory AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(inv_quantity_on_hand) AS total_inventory\n    FROM \n        warehouse w\n    JOIN \n        inventory i ON w.w_warehouse_sk = i.inv_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n)\nSELECT \n    cl.ca_city,\n    cl.ca_state,\n    cl.total_customers,\n    pi.p_promo_id,\n    pi.total_sold,\n    pi.total_profit,\n    st.d_year,\n    st.annual_sales,\n    st.total_discounts,\n    wi.w_warehouse_id,\n    wi.total_inventory\nFROM \n    CustomerLocation cl\nLEFT JOIN \n    PromotionalImpact pi ON cl.total_customers > 1000\nLEFT JOIN \n    SalesTrends st ON pi.total_sold > 50\nLEFT JOIN \n    WarehouseInventory wi ON wi.total_inventory < 100\nORDER BY \n    cl.ca_city, \n    cl.ca_state;\n",
  "\nWITH CustomerData AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        h.hd_income_band_sk,\n        h.hd_buy_potential,\n        COUNT(DISTINCT w.web_site_sk) AS website_count,\n        SUM(ws.ws_net_profit) AS total_net_profit\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN household_demographics h ON c.c_customer_sk = h.hd_demo_sk\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk\n    GROUP BY \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        h.hd_income_band_sk,\n        h.hd_buy_potential\n),\nAggregateData AS (\n    SELECT\n        cd.cd_gender,\n        cd.cd_marital_status,\n        h.hd_income_band_sk,\n        COUNT(*) AS customer_count,\n        AVG(ad.total_net_profit) AS avg_net_profit\n    FROM CustomerData ad\n    JOIN customer_demographics cd ON ad.c_customer_sk = cd.cd_demo_sk\n    JOIN household_demographics h ON ad.c_customer_sk = h.hd_demo_sk\n    GROUP BY \n        cd.cd_gender, \n        cd.cd_marital_status, \n        h.hd_income_band_sk\n)\nSELECT\n    ad.cd_gender,\n    ad.cd_marital_status,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    ad.customer_count,\n    ad.avg_net_profit\nFROM AggregateData ad\nJOIN income_band ib ON ad.hd_income_band_sk = ib.ib_income_band_sk\nORDER BY \n    ad.cd_gender,\n    ad.cd_marital_status,\n    ib.ib_lower_bound;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws_bill_customer_sk AS customer_id,\n        CAST(d.d_date AS DATE) AS sales_date,\n        SUM(ws_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT ws_order_number) AS total_orders,\n        SUM(ws_quantity) AS total_quantity\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        ws_bill_customer_sk, d.d_date\n),\nCustomerDemographics AS (\n    SELECT \n        c.c_customer_sk AS customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_income_band_sk\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n),\nFinalData AS (\n    SELECT \n        sd.customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        MAX(sd.sales_date) AS last_purchase_date,\n        SUM(sd.total_sales) AS total_spent,\n        SUM(sd.total_orders) AS total_orders,\n        SUM(sd.total_quantity) AS total_quantity,\n        ib.ib_income_band_sk\n    FROM \n        SalesData sd\n    JOIN \n        CustomerDemographics cd ON sd.customer_id = cd.customer_id\n    LEFT JOIN \n        household_demographics hd ON cd.customer_id = hd.hd_demo_sk\n    LEFT JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    GROUP BY \n        sd.customer_id, cd.cd_gender, cd.cd_marital_status, ib.ib_income_band_sk\n)\nSELECT \n    customer_id,\n    cd_gender,\n    cd_marital_status,\n    last_purchase_date,\n    total_spent,\n    total_orders,\n    total_quantity,\n    CASE \n        WHEN total_spent >= 1000 THEN 'High Value'\n        WHEN total_spent BETWEEN 500 AND 999 THEN 'Medium Value'\n        ELSE 'Low Value'\n    END AS customer_value_category\nFROM \n    FinalData\nORDER BY \n    total_spent DESC\nFETCH FIRST 100 ROWS ONLY;\n",
  "\nWITH CustomerAnalytics AS (\n    SELECT \n        c.c_customer_id,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_quantity) AS total_purchases,\n        SUM(ws.ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_id, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n),\nWarehousePerformance AS (\n    SELECT \n        w.w_warehouse_id,\n        SUM(ws.ws_quantity) AS total_sales,\n        AVG(ws.ws_net_profit) AS average_profit_per_sale,\n        COUNT(DISTINCT ws.ws_order_number) AS unique_orders\n    FROM \n        warehouse w\n    JOIN \n        web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk\n    GROUP BY \n        w.w_warehouse_id\n),\nSalesByState AS (\n    SELECT \n        ca.ca_state,\n        SUM(ws.ws_net_profit) AS total_profit_by_state,\n        COUNT(ws.ws_order_number) AS order_count_by_state\n    FROM \n        web_sales ws\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    GROUP BY \n        ca.ca_state\n)\nSELECT \n    ca.c_customer_id,\n    ca.cd_gender,\n    ca.cd_marital_status,\n    ca.cd_education_status,\n    wp.w_warehouse_id,\n    wp.total_sales,\n    wp.average_profit_per_sale,\n    sb.ca_state,\n    sb.total_profit_by_state,\n    sb.order_count_by_state\nFROM \n    CustomerAnalytics ca\nJOIN \n    WarehousePerformance wp ON ca.total_purchases > 0\nJOIN \n    SalesByState sb ON ca.total_profit > 0\nWHERE \n    ca.total_profit > 1000\nORDER BY \n    ca.total_purchases DESC, wp.total_sales DESC;\n",
  "\nWITH CustomerAggregate AS (\n    SELECT \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status, \n        SUM(ss.ss_net_profit) AS total_net_profit, \n        COUNT(DISTINCT ss.ss_ticket_number) AS total_purchases\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status\n), \nTimeFrame AS (\n    SELECT \n        d.d_date_sk, \n        d.d_year, \n        d.d_month_seq\n    FROM date_dim d\n    WHERE d.d_year = 2023 AND d.d_month_seq IN (1, 2, 3)\n), \nSalesSummary AS (\n    SELECT \n        c.c_customer_sk, \n        SUM(ws.ws_sales_price) AS total_web_sales, \n        SUM(cs.cs_sales_price) AS total_catalog_sales, \n        SUM(ss.ss_sales_price) AS total_store_sales\n    FROM CustomerAggregate c\n    JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    JOIN TimeFrame tf ON ws.ws_sold_date_sk = tf.d_date_sk OR cs.cs_sold_date_sk = tf.d_date_sk OR ss.ss_sold_date_sk = tf.d_date_sk\n    GROUP BY c.c_customer_sk\n)\nSELECT \n    ca.c_customer_sk, \n    ca.c_first_name, \n    ca.c_last_name, \n    ca.cd_gender, \n    ca.cd_marital_status, \n    COALESCE(ss.total_web_sales, 0) AS total_web_sales, \n    COALESCE(ss.total_catalog_sales, 0) AS total_catalog_sales, \n    COALESCE(ss.total_store_sales, 0) AS total_store_sales, \n    ca.total_net_profit, \n    ca.total_purchases\nFROM CustomerAggregate ca\nLEFT JOIN SalesSummary ss ON ca.c_customer_sk = ss.c_customer_sk\nORDER BY ca.total_net_profit DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH customer_summary AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        hd.hd_income_band_sk,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound,\n        COUNT(ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_net_paid) AS total_spent\n    FROM \n        customer c\n        JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n        JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n        JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n        LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    WHERE \n        cd.cd_gender = 'F'\n        AND cd.cd_marital_status = 'M'\n    GROUP BY \n        c.c_customer_sk, \n        c.c_first_name, \n        c.c_last_name, \n        cd.cd_gender, \n        cd.cd_marital_status,\n        cd.cd_purchase_estimate,\n        hd.hd_income_band_sk,\n        ib.ib_lower_bound,\n        ib.ib_upper_bound\n), time_summary AS (\n    SELECT \n        d.d_year,\n        d.d_month_seq,\n        SUM(ws.ws_net_paid) AS monthly_sales\n    FROM \n        web_sales ws\n        JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year, \n        d.d_month_seq\n), average_spending AS (\n    SELECT \n        cs.c_customer_sk,\n        AVG(cs.total_spent) AS avg_spent\n    FROM \n        customer_summary cs\n    GROUP BY \n        cs.c_customer_sk\n)\nSELECT \n    cs.c_first_name,\n    cs.c_last_name,\n    cs.total_orders,\n    cs.total_spent,\n    ts.d_year,\n    ts.d_month_seq,\n    ts.monthly_sales,\n    asp.avg_spent\nFROM \n    customer_summary cs\n    JOIN time_summary ts ON cs.total_orders > 0\n    JOIN average_spending asp ON cs.c_customer_sk = asp.c_customer_sk\nWHERE \n    ts.monthly_sales > 5000\nORDER BY \n    cs.total_spent DESC, \n    ts.d_year DESC, \n    ts.d_month_seq DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_web_site_sk,\n        SUM(ws.ws_net_paid) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        SUM(ws.ws_quantity) AS total_quantity,\n        AVG(ws.ws_net_profit) AS avg_net_profit,\n        w.w_warehouse_name,\n        d.d_year,\n        d.d_quarter_seq\n    FROM \n        web_sales AS ws\n    JOIN \n        warehouse AS w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023 \n        AND w.w_state = 'CA'\n    GROUP BY \n        ws.ws_web_site_sk, w.w_warehouse_name, d.d_year, d.d_quarter_seq\n),\nCustomerData AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        MAX(cd.cd_purchase_estimate) AS max_purchase_estimate,\n        COUNT(DISTINCT ws.ws_order_number) AS orders_count\n    FROM \n        customer AS c\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, cd.cd_gender, cd.cd_marital_status\n),\nPromotions AS (\n    SELECT \n        p.p_promo_sk,\n        p.p_promo_name,\n        SUM(ws.ws_net_paid) AS promo_sales\n    FROM \n        promotion AS p\n    JOIN \n        web_sales AS ws ON p.p_promo_sk = ws.ws_promo_sk\n    GROUP BY \n        p.p_promo_sk, p.p_promo_name\n)\nSELECT \n    sd.ws_web_site_sk,\n    sd.w_warehouse_name,\n    sd.total_sales,\n    sd.total_orders,\n    sd.total_quantity,\n    sd.avg_net_profit,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.max_purchase_estimate,\n    cd.orders_count,\n    p.promo_sales\nFROM \n    SalesData AS sd\nLEFT JOIN \n    CustomerData AS cd ON sd.ws_web_site_sk = cd.c_customer_sk\nLEFT JOIN \n    Promotions AS p ON sd.ws_web_site_sk = p.p_promo_sk\nORDER BY \n    sd.total_sales DESC, sd.total_orders DESC\nLIMIT 100;\n",
  "\nWITH CustomerData AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        COALESCE(hd.hd_income_band_sk, 0) AS income_band,\n        COUNT(DISTINCT wr.wr_order_number) AS web_return_count,\n        COUNT(DISTINCT sr.sr_ticket_number) AS store_return_count\n    FROM \n        customer c\n    LEFT JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n    LEFT JOIN \n        web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, hd.hd_income_band_sk\n),\nSalesData AS (\n    SELECT \n        ws.ws_ship_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(COALESCE(cs.cs_ext_sales_price, 0)) AS total_catalog_sales,\n        SUM(COALESCE(ss.ss_ext_sales_price, 0)) AS total_store_sales\n    FROM \n        web_sales ws\n    LEFT JOIN \n        catalog_sales cs ON ws.ws_ship_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN \n        store_sales ss ON ws.ws_ship_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        ws.ws_ship_customer_sk\n)\nSELECT \n    cd.c_first_name,\n    cd.c_last_name,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_education_status,\n    cd.income_band,\n    COALESCE(sd.total_web_sales, 0) AS total_web_sales,\n    COALESCE(sd.total_catalog_sales, 0) AS total_catalog_sales,\n    COALESCE(sd.total_store_sales, 0) AS total_store_sales,\n    cd.web_return_count,\n    cd.store_return_count\nFROM \n    CustomerData cd\nLEFT JOIN \n    SalesData sd ON cd.c_customer_sk = sd.ws_ship_customer_sk\nORDER BY \n    total_web_sales DESC, total_catalog_sales DESC, total_store_sales DESC;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(COALESCE(ws.ws_net_profit, 0)) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer AS c\n    JOIN \n        customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        web_sales AS ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status\n),\nWarehouseInventory AS (\n    SELECT \n        w.w_warehouse_sk,\n        w.w_warehouse_name,\n        SUM(i.inv_quantity_on_hand) AS total_quantity\n    FROM \n        warehouse AS w\n    JOIN \n        inventory AS i ON w.w_warehouse_sk = i.inv_warehouse_sk\n    GROUP BY \n        w.w_warehouse_sk, w.w_warehouse_name\n),\nPromotionsSummary AS (\n    SELECT \n        p.p_promo_sk,\n        p.p_promo_name,\n        COUNT(cs.cs_order_number) AS num_catalog_sales,\n        COUNT(ws.ws_order_number) AS num_web_sales,\n        SUM(COALESCE(cs.cs_net_profit, 0)) + SUM(COALESCE(ws.ws_net_profit, 0)) AS total_profit\n    FROM \n        promotion AS p\n    LEFT JOIN \n        catalog_sales AS cs ON p.p_promo_sk = cs.cs_promo_sk\n    LEFT JOIN \n        web_sales AS ws ON p.p_promo_sk = ws.ws_promo_sk\n    GROUP BY \n        p.p_promo_sk, p.p_promo_name\n)\nSELECT \n    cs.c_customer_sk,\n    cs.c_first_name,\n    cs.c_last_name,\n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.total_net_profit,\n    cs.total_orders,\n    cs.avg_purchase_estimate,\n    wi.w_warehouse_sk,\n    wi.w_warehouse_name,\n    wi.total_quantity,\n    ps.p_promo_sk,\n    ps.p_promo_name,\n    ps.num_catalog_sales,\n    ps.num_web_sales,\n    ps.total_profit\nFROM \n    CustomerStats AS cs\nJOIN \n    WarehouseInventory AS wi ON MOD(cs.c_customer_sk, 10) = MOD(wi.w_warehouse_sk, 10)\nJOIN \n    PromotionsSummary AS ps ON cs.total_net_profit >= 1000\nORDER BY \n    cs.total_net_profit DESC, ps.total_profit DESC\nFETCH FIRST 50 ROWS ONLY;\n",
  "\nWITH SalesData AS (\n    SELECT \n        ws.ws_item_sk,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount,\n        SUM(ws.ws_net_profit) AS total_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        item i ON ws.ws_item_sk = i.i_item_sk\n    WHERE \n        dd.d_year = 2023 \n        AND cd.cd_gender = 'F' \n        AND cd.cd_marital_status = 'M'\n    GROUP BY \n        ws.ws_item_sk\n), \nPromotionalData AS (\n    SELECT \n        p.p_promo_sk,\n        SUM(ws.ws_net_profit) AS promo_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS promo_orders\n    FROM \n        promotion p\n    JOIN \n        web_sales ws ON p.p_promo_sk = ws.ws_promo_sk\n    GROUP BY \n        p.p_promo_sk\n),\nCombinedData AS (\n    SELECT \n        sd.ws_item_sk,\n        sd.total_quantity,\n        sd.total_sales,\n        sd.total_discount,\n        sd.total_profit,\n        sd.total_orders,\n        COALESCE(pd.promo_profit, 0) AS promo_profit,\n        COALESCE(pd.promo_orders, 0) AS promo_orders\n    FROM \n        SalesData sd\n    LEFT JOIN \n        PromotionalData pd ON sd.ws_item_sk = pd.p_promo_sk\n)\nSELECT \n    ca.ca_city,\n    COUNT(DISTINCT c.c_customer_id) AS unique_customers,\n    SUM(cd.total_profit) AS total_profit,\n    AVG(cd.total_sales) AS avg_sales_per_order,\n    SUM(cd.promo_profit) AS total_promo_profit\nFROM \n    CombinedData cd\nJOIN \n    customer c ON cd.ws_item_sk = c.c_current_cdemo_sk\nJOIN \n    customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY \n    ca.ca_city\nORDER BY \n    total_profit DESC\nLIMIT \n    10;\n",
  "WITH sales_summary AS (\n    SELECT \n        EXTRACT(YEAR FROM d.d_date) AS sales_year,\n        EXTRACT(MONTH FROM d.d_date) AS sales_month,\n        SUM(ws.ws_quantity) AS total_units_sold,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    WHERE \n        d.d_year = 2001 \n        AND (cd.cd_marital_status = 'M' AND cd.cd_gender = 'F') \n        AND ca.ca_state = 'CA'\n    GROUP BY \n        EXTRACT(YEAR FROM d.d_date), EXTRACT(MONTH FROM d.d_date)\n),\npromotion_details AS (\n    SELECT \n        p.p_promo_name,\n        SUM(ws.ws_net_profit) AS promo_net_profit\n    FROM \n        web_sales ws\n    JOIN \n        promotion p ON ws.ws_promo_sk = p.p_promo_sk\n    GROUP BY \n        p.p_promo_name\n),\nwarehouse_performance AS (\n    SELECT \n        w.w_warehouse_name,\n        SUM(ws.ws_quantity) AS total_quantity_sold,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    GROUP BY \n        w.w_warehouse_name\n)\nSELECT \n    ss.sales_year,\n    ss.sales_month,\n    ss.total_units_sold,\n    ss.total_net_profit,\n    pp.promo_net_profit,\n    wp.total_quantity_sold,\n    wp.total_profit\nFROM \n    sales_summary ss\nJOIN \n    promotion_details pp ON ss.sales_month = EXTRACT(MONTH FROM cast('2002-10-01' as date))\nJOIN \n    warehouse_performance wp ON wp.total_profit > 1000\nORDER BY \n    ss.sales_year DESC, ss.sales_month DESC;",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_ship_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n), \ndemographics AS (\n    SELECT \n        c.c_customer_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        hd.hd_income_band_sk,\n        hd.hd_buy_potential\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\n), \nsales_summary AS (\n    SELECT \n        d.c_customer_sk,\n        d.cd_gender,\n        d.cd_marital_status,\n        d.hd_income_band_sk,\n        d.hd_buy_potential,\n        COALESCE(cs.total_web_sales, 0) AS total_web_sales,\n        COALESCE(cs.total_catalog_sales, 0) AS total_catalog_sales,\n        COALESCE(cs.total_store_sales, 0) AS total_store_sales,\n        (COALESCE(cs.total_web_sales, 0) + COALESCE(cs.total_catalog_sales, 0) + COALESCE(cs.total_store_sales, 0)) AS total_sales\n    FROM \n        demographics d\n    LEFT JOIN \n        customer_sales cs ON d.c_customer_sk = cs.c_customer_sk\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    ib.ib_income_band_sk,\n    SUM(ss.total_sales) AS total_sales_by_category\nFROM \n    sales_summary ss\nJOIN \n    income_band ib ON ss.hd_income_band_sk = ib.ib_income_band_sk\nJOIN \n    customer_demographics cd ON ss.c_customer_sk = cd.cd_demo_sk\nGROUP BY \n    cd.cd_gender, \n    cd.cd_marital_status, \n    ib.ib_income_band_sk\nORDER BY \n    cd.cd_gender, \n    cd.cd_marital_status, \n    ib.ib_income_band_sk;\n",
  "\nWITH customer_stats AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(cs.ss_ext_sales_price) AS total_sales,\n        COUNT(DISTINCT cs.ss_ticket_number) AS total_transactions,\n        AVG(cs.ss_sales_price) AS avg_sales_price\n    FROM customer c\n    JOIN store_sales cs ON c.c_customer_sk = cs.ss_customer_sk\n    GROUP BY c.c_customer_sk\n),\ndemographic_analysis AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        COUNT(cs.total_sales) AS customer_count,\n        AVG(cs.total_sales) AS avg_sales_per_customer\n    FROM customer_demographics cd\n    JOIN customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    JOIN customer_stats cs ON c.c_customer_sk = cs.c_customer_sk\n    GROUP BY cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status\n),\nsales_by_income_band AS (\n    SELECT \n        ib.ib_income_band_sk,\n        COUNT(cs.c_customer_sk) AS total_customers,\n        SUM(cs.total_sales) AS total_sales_by_income_band,\n        AVG(cs.avg_sales_price) AS avg_sales_price_by_income_band\n    FROM income_band ib\n    JOIN household_demographics hd ON ib.ib_income_band_sk = hd.hd_income_band_sk\n    JOIN customer c ON hd.hd_demo_sk = c.c_current_hdemo_sk\n    JOIN customer_stats cs ON c.c_customer_sk = cs.c_customer_sk\n    GROUP BY ib.ib_income_band_sk\n)\nSELECT \n    da.cd_gender,\n    da.cd_marital_status,\n    ib.ib_income_band_sk,\n    SUM(da.customer_count) AS total_customers,\n    SUM(da.avg_sales_per_customer) AS avg_sales_per_customer_by_demographics,\n    SUM(sb.total_sales_by_income_band) AS total_sales_by_income_band\nFROM demographic_analysis da\nJOIN sales_by_income_band sb ON da.customer_count > 0\nJOIN income_band ib ON sb.ib_income_band_sk = ib.ib_income_band_sk\nGROUP BY da.cd_gender, da.cd_marital_status, ib.ib_income_band_sk\nORDER BY da.cd_gender, da.cd_marital_status, ib.ib_income_band_sk;\n",
  "\nWITH customer_sales AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS total_web_orders,\n        COUNT(DISTINCT cs.cs_order_number) AS total_catalog_orders\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\ncustomer_demographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        ib.ib_income_band_sk,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM \n        customer_demographics cd\n    LEFT JOIN \n        household_demographics hd ON hd.hd_demo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        income_band ib ON ib.ib_income_band_sk = hd.hd_income_band_sk\n    LEFT JOIN \n        customer c ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN \n        customer_sales cs ON cs.c_customer_sk = c.c_customer_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, ib.ib_income_band_sk\n)\nSELECT \n    cd.cd_gender,\n    cd.cd_marital_status,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    SUM(cs.total_web_sales) AS total_web_sales,\n    SUM(cs.total_catalog_sales) AS total_catalog_sales,\n    SUM(cs.total_web_orders) AS total_web_orders,\n    SUM(cs.total_catalog_orders) AS total_catalog_orders,\n    COUNT(DISTINCT cd.cd_demo_sk) AS demographic_count\nFROM \n    customer_sales cs\nJOIN \n    customer_demographics cd ON cs.c_customer_sk = cd.cd_demo_sk\nJOIN \n    income_band ib ON ib.ib_income_band_sk = cd.ib_income_band_sk\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status, ib.ib_lower_bound, ib.ib_upper_bound\nORDER BY \n    total_web_sales DESC, demographic_count DESC\nFETCH FIRST 10 ROWS ONLY;\n",
  "\nWITH DateRange AS (\n    SELECT D.d_date_sk, D.d_year, D.d_month_seq\n    FROM date_dim D\n    WHERE D.d_date BETWEEN '2023-01-01' AND '2023-12-31'\n),\nCustomerStats AS (\n    SELECT C.c_customer_sk, \n           C.c_first_name, \n           C.c_last_name, \n           CD.cd_gender, \n           CD.cd_marital_status,\n           CD.cd_dep_count,\n           COALESCE(SUM(SS.ss_net_profit), 0) AS total_store_profit,\n           COALESCE(SUM(WS.ws_net_profit), 0) AS total_web_profit,\n           COUNT(DISTINCT SS.ss_ticket_number) AS total_store_sales,\n           COUNT(DISTINCT WS.ws_order_number) AS total_web_sales\n    FROM customer C\n    LEFT JOIN customer_demographics CD ON C.c_current_cdemo_sk = CD.cd_demo_sk\n    LEFT JOIN store_sales SS ON C.c_customer_sk = SS.ss_customer_sk \n    LEFT JOIN web_sales WS ON C.c_customer_sk = WS.ws_ship_customer_sk\n    GROUP BY C.c_customer_sk, C.c_first_name, C.c_last_name, CD.cd_gender, CD.cd_marital_status, CD.cd_dep_count\n),\nIncomeLevels AS (\n    SELECT HD.hd_demo_sk, \n           IB.ib_income_band_sk, \n           CASE \n               WHEN HD.hd_buy_potential = 'High' THEN 'High Income'\n               WHEN HD.hd_buy_potential = 'Medium' THEN 'Medium Income'\n               ELSE 'Low Income'\n           END AS income_level\n    FROM household_demographics HD\n    JOIN income_band IB ON HD.hd_income_band_sk = IB.ib_income_band_sk\n),\nSalesSummary AS (\n    SELECT C.c_customer_sk,\n           D.d_year,\n           SUM(SS.ss_net_profit) AS total_store_profit,\n           SUM(WS.ws_net_profit) AS total_web_profit,\n           SUM(SS.ss_quantity) AS total_store_quantity,\n           SUM(WS.ws_quantity) AS total_web_quantity\n    FROM CustomerStats C\n    JOIN store_sales SS ON C.c_customer_sk = SS.ss_customer_sk\n    JOIN web_sales WS ON C.c_customer_sk = WS.ws_ship_customer_sk\n    JOIN DateRange D ON SS.ss_sold_date_sk = D.d_date_sk OR WS.ws_sold_date_sk = D.d_date_sk\n    GROUP BY C.c_customer_sk, D.d_year\n)\nSELECT S.c_customer_sk,\n       S.total_store_profit,\n       S.total_web_profit,\n       I.income_level,\n       S.total_store_quantity,\n       S.total_web_quantity,\n       CASE\n           WHEN S.total_store_profit > S.total_web_profit THEN 'Store Sales Higher'\n           ELSE 'Web Sales Higher or Equal'\n       END AS sales_comparison\nFROM SalesSummary S\nJOIN IncomeLevels I ON S.c_customer_sk = I.hd_demo_sk\nWHERE S.total_store_profit > 1000 OR S.total_web_profit > 1000\nORDER BY S.total_store_profit DESC, S.total_web_profit DESC;\n",
  "\nWITH customer_info AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(ss.ss_net_paid_inc_tax) AS total_spent\n    FROM customer c\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status\n),\nincome_summary AS (\n    SELECT \n        hd.hd_income_band_sk,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM household_demographics hd\n    JOIN customer c ON hd.hd_demo_sk = c.c_current_hdemo_sk\n    GROUP BY hd.hd_income_band_sk\n),\npurchase_summary AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(COALESCE(ws.ws_net_paid_inc_tax, 0)) AS total_web_sales,\n        SUM(COALESCE(cs.cs_net_paid_inc_tax, 0)) AS total_catalog_sales,\n        SUM(COALESCE(ss.ss_net_paid_inc_tax, 0)) AS total_store_sales\n    FROM customer c\n    LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY c.c_customer_sk\n)\n\nSELECT \n    ci.c_customer_sk,\n    ci.c_first_name,\n    ci.c_last_name,\n    ci.cd_gender,\n    ci.cd_marital_status,\n    COALESCE(isum.customer_count, 0) AS income_band_customer_count,\n    ci.total_spent,\n    ps.total_web_sales,\n    ps.total_catalog_sales,\n    ps.total_store_sales\nFROM customer_info ci\nLEFT JOIN income_summary isum ON ci.c_customer_sk = isum.hd_income_band_sk\nLEFT JOIN purchase_summary ps ON ci.c_customer_sk = ps.c_customer_sk\nWHERE ci.total_spent > (SELECT AVG(total_spent) FROM customer_info) \n  AND (ci.cd_gender = 'F' OR ci.cd_marital_status = 'M')\nORDER BY ci.total_spent DESC\nLIMIT 100;\n",
  "\nWITH SalesSummary AS (\n    SELECT\n        d.d_year,\n        SUM(ws.ws_sales_price) AS total_sales,\n        COUNT(DISTINCT ws.ws_order_number) AS order_count,\n        AVG(ws.ws_net_profit) AS avg_net_profit,\n        SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN ws.ws_sales_price ELSE 0 END) AS preferred_sales\n    FROM\n        web_sales ws\n    JOIN\n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    LEFT JOIN\n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    GROUP BY\n        d.d_year\n),\nDiscountAnalysis AS (\n    SELECT\n        s.s_store_sk,\n        SUM(ss.ss_ext_discount_amt) AS total_discount,\n        COUNT(DISTINCT ss.ss_ticket_number) AS discount_count\n    FROM\n        store_sales ss\n    JOIN\n        store s ON ss.ss_store_sk = s.s_store_sk\n    WHERE\n        ss.ss_sold_date_sk >= (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year = 2023) - 365\n    GROUP BY\n        s.s_store_sk\n),\nCustomerDemographics AS (\n    SELECT\n        cd.cd_gender,\n        SUM(ws.ws_sales_price) AS gender_sales,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM\n        customer_demographics cd\n    JOIN\n        web_sales ws ON cd.cd_demo_sk = ws.ws_bill_cdemo_sk\n    GROUP BY\n        cd.cd_gender\n),\nComplexReturns AS (\n    SELECT\n        COALESCE(sr.sr_item_sk, cr.cr_item_sk) AS item_sk,\n        SUM(COALESCE(sr.sr_return_amt, 0) + COALESCE(cr.cr_return_amount, 0)) AS total_returned\n    FROM\n        store_returns sr\n    FULL OUTER JOIN\n        catalog_returns cr ON sr.sr_item_sk = cr.cr_item_sk\n    GROUP BY\n        COALESCE(sr.sr_item_sk, cr.cr_item_sk)\n)\nSELECT\n    ss.d_year,\n    ss.total_sales,\n    ss.order_count,\n    ss.avg_net_profit,\n    ss.preferred_sales,\n    da.total_discount,\n    da.discount_count,\n    cd.cd_gender,\n    cd.gender_sales,\n    cd.avg_purchase_estimate,\n    cr.item_sk,\n    cr.total_returned\nFROM\n    SalesSummary ss\nJOIN\n    DiscountAnalysis da ON da.total_discount > 1000\nLEFT JOIN\n    CustomerDemographics cd ON cd.gender_sales > 5000\nLEFT JOIN\n    ComplexReturns cr ON cr.total_returned > 50\nORDER BY\n    ss.d_year DESC, ss.total_sales DESC;\n",
  "\nWITH top_customers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        customer c\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n    ORDER BY \n        total_profit DESC\n    LIMIT 10\n), \nmonthly_sales AS (\n    SELECT\n        d.d_year,\n        d.d_month_seq,\n        SUM(ws.ws_ext_sales_price) AS total_sales\n    FROM\n        date_dim d\n    JOIN \n        web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk\n    GROUP BY\n        d.d_year, d.d_month_seq\n), \nstate_summary AS (\n    SELECT \n        ca.ca_state,\n        COUNT(DISTINCT c.c_customer_sk) AS num_customers,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        customer_address ca\n    JOIN \n        customer c ON ca.ca_address_sk = c.c_current_addr_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY \n        ca.ca_state\n), \npromotional_analysis AS (\n    SELECT \n        p.p_promo_name,\n        COUNT(ws.ws_order_number) AS order_count,\n        SUM(ws.ws_sales_price) AS total_sales\n    FROM \n        promotion p\n    JOIN \n        web_sales ws ON p.p_promo_sk = ws.ws_promo_sk\n    GROUP BY \n        p.p_promo_name\n)\nSELECT \n    tc.c_first_name,\n    tc.c_last_name,\n    tc.total_profit,\n    ms.d_year,\n    ms.d_month_seq,\n    ms.total_sales,\n    ss.ca_state,\n    ss.num_customers,\n    ss.total_profit AS state_profit,\n    pa.p_promo_name,\n    pa.order_count,\n    pa.total_sales AS promo_sales\nFROM \n    top_customers tc\nJOIN \n    monthly_sales ms ON ms.total_sales > 10000\nJOIN \n    state_summary ss ON ss.total_profit > 50000\nJOIN \n    promotional_analysis pa ON pa.total_sales > 1000\nORDER BY \n    tc.total_profit DESC, \n    ms.d_year DESC, \n    ss.total_profit DESC;\n",
  "\nWITH Customer_Sales AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        COALESCE(SUM(ws.ws_net_paid_inc_tax), 0) AS total_web_sales,\n        COALESCE(SUM(cs.cs_net_paid_inc_tax), 0) AS total_catalog_sales,\n        COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales,\n        COUNT(DISTINCT wr.wr_order_number) AS total_web_returns,\n        COUNT(DISTINCT cr.cr_order_number) AS total_catalog_returns\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    LEFT JOIN \n        web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk\n    LEFT JOIN \n        catalog_returns cr ON c.c_customer_sk = cr.cr_returning_customer_sk\n    GROUP BY \n        c.c_customer_sk, c.c_first_name, c.c_last_name\n),\nIncome_Dist AS (\n    SELECT \n        hd.hd_income_band_sk, \n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM \n        household_demographics hd\n    JOIN \n        customer c ON hd.hd_demo_sk = c.c_current_hdemo_sk\n    GROUP BY \n        hd.hd_income_band_sk\n),\nSales_Summary AS (\n    SELECT \n        customer_sales.c_customer_sk,\n        customer_sales.c_first_name,\n        customer_sales.c_last_name,\n        COALESCE(customer_sales.total_web_sales, 0) AS total_web_sales,\n        COALESCE(customer_sales.total_catalog_sales, 0) AS total_catalog_sales,\n        customer_sales.total_store_sales,\n        customer_sales.total_web_returns,\n        customer_sales.total_catalog_returns,\n        CASE \n            WHEN customer_sales.total_web_sales + customer_sales.total_catalog_sales > 0 \n            THEN ROUND((customer_sales.total_web_sales + customer_sales.total_catalog_sales) / (customer_sales.total_store_sales + NULLIF(customer_sales.total_web_returns + customer_sales.total_catalog_returns, 0)), 2)\n            ELSE 0 \n        END AS sales_efficiency_ratio\n    FROM \n        Customer_Sales customer_sales\n)\nSELECT \n    s.c_first_name,\n    s.c_last_name,\n    s.total_web_sales,\n    s.total_catalog_sales,\n    s.total_store_sales,\n    s.total_web_returns,\n    s.total_catalog_returns,\n    s.sales_efficiency_ratio,\n    ib.ib_lower_bound,\n    ib.ib_upper_bound,\n    income_dist.customer_count\nFROM \n    Sales_Summary s\nLEFT JOIN \n    income_band ib ON (s.total_web_sales + s.total_catalog_sales) BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound\nLEFT JOIN \n    Income_Dist income_dist ON income_dist.hd_income_band_sk = (CASE \n                                                                  WHEN s.sales_efficiency_ratio > 0.5 THEN 1\n                                                                  WHEN s.sales_efficiency_ratio BETWEEN 0.2 AND 0.5 THEN 2\n                                                                  ELSE 3 \n                                                              END)\nORDER BY \n    s.total_web_sales DESC, \n    s.total_catalog_sales DESC;\n",
  "\nWITH customer_stats AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_first_name,\n        c.c_last_name,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        SUM(CASE WHEN ws.ws_sales_price > 100 THEN 1 ELSE 0 END) AS high_value_sales,\n        COUNT(ws.ws_order_number) AS total_orders,\n        AVG(ws.ws_net_paid) AS avg_order_value,\n        COUNT(DISTINCT ws.ws_order_number) AS unique_orders\n    FROM customer AS c\n    JOIN customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    LEFT JOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status\n),\nwarehouse_stats AS (\n    SELECT \n        w.w_warehouse_sk,\n        w.w_warehouse_name,\n        SUM(inv.inv_quantity_on_hand) AS total_inventory,\n        AVG(inv.inv_quantity_on_hand) AS avg_inventory\n    FROM warehouse AS w\n    JOIN inventory AS inv ON w.w_warehouse_sk = inv.inv_warehouse_sk\n    GROUP BY w.w_warehouse_sk, w.w_warehouse_name\n),\nsales_summary AS (\n    SELECT \n        CAST(d.d_date AS DATE) AS sales_date,\n        SUM(ws.ws_ext_sales_price) AS total_web_sales,\n        SUM(cs.cs_ext_sales_price) AS total_catalog_sales,\n        SUM(ss.ss_ext_sales_price) AS total_store_sales\n    FROM date_dim AS d\n    LEFT JOIN web_sales AS ws ON d.d_date_sk = ws.ws_sold_date_sk\n    LEFT JOIN catalog_sales AS cs ON d.d_date_sk = cs.cs_sold_date_sk\n    LEFT JOIN store_sales AS ss ON d.d_date_sk = ss.ss_sold_date_sk\n    GROUP BY d.d_date\n),\nfinal_report AS (\n    SELECT\n        cs.c_customer_sk,\n        cs.c_first_name,\n        cs.c_last_name,\n        cs.cd_gender,\n        cs.cd_marital_status,\n        ws.w_warehouse_name,\n        COALESCE(cs.high_value_sales, 0) AS high_value_orders,\n        cs.total_orders,\n        ROUND(cs.avg_order_value, 2) AS average_order_value,\n        ROUND(ws.total_inventory, 0) AS warehouse_inventory,\n        ROUND(ws.avg_inventory, 0) AS avg_inventory,\n        s.sales_date,\n        s.total_web_sales,\n        s.total_catalog_sales,\n        s.total_store_sales\n    FROM customer_stats AS cs\n    LEFT JOIN warehouse_stats AS ws ON ws.total_inventory > 0\n    LEFT JOIN sales_summary AS s ON s.sales_date = CAST('2002-10-01' AS DATE)\n)\nSELECT \n    *,\n    CASE \n        WHEN total_web_sales > 10000 THEN 'High Performer'\n        WHEN total_catalog_sales > 10000 THEN 'Catalog Favorite'\n        WHEN total_store_sales > 10000 THEN 'Store Star'\n        ELSE 'Needs Improvement'\n    END AS performance_category\nFROM final_report\nWHERE (high_value_orders > 5 OR total_orders > 20)\nORDER BY average_order_value DESC, warehouse_inventory DESC;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        c.c_customer_sk,\n        COUNT(DISTINCT s.ss_ticket_number) AS total_sales,\n        SUM(s.ss_net_profit) AS total_profit,\n        COUNT(DISTINCT sr.sr_ticket_number) AS total_returns,\n        COALESCE(SUM(sr.sr_net_loss), 0) AS total_loss\n    FROM \n        customer c\n    LEFT JOIN \n        store_sales s ON c.c_customer_sk = s.ss_customer_sk\n    LEFT JOIN \n        store_returns sr ON c.c_customer_sk = sr.sr_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\nIncomeDistribution AS (\n    SELECT \n        h.hd_income_band_sk,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        AVG(cs.total_profit) AS avg_profit_per_customer\n    FROM \n        household_demographics h\n    JOIN \n        customer c ON h.hd_demo_sk = c.c_current_cdemo_sk\n    JOIN \n        CustomerStats cs ON cs.c_customer_sk = c.c_customer_sk\n    GROUP BY \n        h.hd_income_band_sk\n),\nSalesReport AS (\n    SELECT \n        i.i_item_sk,\n        i.i_item_id,\n        SUM(ws.ws_quantity) AS total_web_sales,\n        SUM(cs.cs_quantity) AS total_catalog_sales,\n        SUM(ss.ss_quantity) AS total_store_sales,\n        COALESCE(SUM(ws.ws_net_profit), 0) AS total_web_profit,\n        COALESCE(SUM(cs.cs_net_profit), 0) AS total_catalog_profit,\n        COALESCE(SUM(ss.ss_net_profit), 0) AS total_store_profit\n    FROM \n        item i\n    LEFT JOIN \n        web_sales ws ON i.i_item_sk = ws.ws_item_sk\n    LEFT JOIN \n        catalog_sales cs ON i.i_item_sk = cs.cs_item_sk\n    LEFT JOIN \n        store_sales ss ON i.i_item_sk = ss.ss_item_sk\n    GROUP BY \n        i.i_item_sk, i.i_item_id\n)\n\nSELECT \n    COALESCE(id.hd_income_band_sk, 0) AS income_band,\n    id.customer_count,\n    id.avg_profit_per_customer,\n    sr.i_item_id,\n    sr.total_web_sales,\n    sr.total_catalog_sales,\n    sr.total_store_sales,\n    sr.total_web_profit,\n    sr.total_catalog_profit,\n    sr.total_store_profit\nFROM \n    IncomeDistribution id\nFULL OUTER JOIN \n    SalesReport sr ON id.hd_income_band_sk = sr.i_item_sk\nWHERE \n    id.customer_count > 10\nORDER BY \n    id.avg_profit_per_customer DESC, \n    sr.total_web_sales DESC;\n",
  "\nSELECT \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    SUM(cs.cs_net_profit) AS total_net_profit,\n    COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_count,\n    COUNT(DISTINCT sr.sr_ticket_number) AS total_returns_count,\n    d.d_year,\n    d.d_month_seq,\n    d.d_quarter_seq,\n    w.w_warehouse_id,\n    sm.sm_type AS shipping_method,\n    cd.cd_gender,\n    hd.hd_income_band_sk\nFROM \n    customer c\nJOIN \n    web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN \n    catalog_sales cs ON ws.ws_item_sk = cs.cs_item_sk AND ws.ws_order_number = cs.cs_order_number\nJOIN \n    store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nLEFT JOIN \n    store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number\nJOIN \n    date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nJOIN \n    warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\nJOIN \n    ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk\nJOIN \n    customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\nJOIN \n    household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk\nWHERE \n    d.d_year = 2023\nGROUP BY \n    c.c_customer_id, \n    c.c_first_name, \n    c.c_last_name, \n    d.d_year,\n    d.d_month_seq,\n    d.d_quarter_seq,\n    w.w_warehouse_id,\n    sm.sm_type,\n    cd.cd_gender,\n    hd.hd_income_band_sk\nORDER BY \n    total_net_profit DESC\nLIMIT 100;\n",
  "\nWITH sales_data AS (\n    SELECT \n        ws.ws_sold_date_sk, \n        ws.ws_item_sk, \n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales,\n        SUM(ws.ws_ext_discount_amt) AS total_discount\n    FROM web_sales ws\n    JOIN item i ON ws.ws_item_sk = i.i_item_sk\n    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE d.d_year = 2023\n    GROUP BY ws.ws_sold_date_sk, ws.ws_item_sk\n), store_sales_data AS (\n    SELECT \n        ss.ss_sold_date_sk, \n        ss.ss_item_sk, \n        SUM(ss.ss_quantity) AS total_quantity,\n        SUM(ss.ss_ext_sales_price) AS total_sales,\n        SUM(ss.ss_ext_discount_amt) AS total_discount\n    FROM store_sales ss\n    JOIN item i ON ss.ss_item_sk = i.i_item_sk\n    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk\n    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\n    WHERE d.d_year = 2023\n    GROUP BY ss.ss_sold_date_sk, ss.ss_item_sk\n), combined_sales AS (\n    SELECT \n        sd.ws_sold_date_sk, \n        sd.ws_item_sk,\n        sd.total_quantity AS web_total_quantity,\n        sd.total_sales AS web_total_sales,\n        sd.total_discount AS web_total_discount,\n        COALESCE(ss.total_quantity, 0) AS store_total_quantity,\n        COALESCE(ss.total_sales, 0) AS store_total_sales,\n        COALESCE(ss.total_discount, 0) AS store_total_discount\n    FROM sales_data sd\n    LEFT JOIN store_sales_data ss ON sd.ws_sold_date_sk = ss.ss_sold_date_sk AND sd.ws_item_sk = ss.ss_item_sk\n)\nSELECT \n    cb.ws_sold_date_sk,\n    cb.ws_item_sk,\n    (cb.web_total_quantity + cb.store_total_quantity) AS total_quantity,\n    (cb.web_total_sales + cb.store_total_sales) AS total_sales,\n    (cb.web_total_discount + cb.store_total_discount) AS total_discount,\n    (cb.web_total_sales - cb.web_total_discount + cb.store_total_sales - cb.store_total_discount) AS net_profit\nFROM combined_sales cb\nORDER BY cb.ws_sold_date_sk, cb.ws_item_sk;\n",
  "\nWITH CustomerStats AS (\n    SELECT \n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_net_profit) AS total_net_profit,\n        COUNT(DISTINCT c.c_customer_id) AS customers_count\n    FROM \n        customer c\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023 \n        AND cd.cd_gender IN ('F', 'M')\n    GROUP BY \n        cd.cd_gender, cd.cd_marital_status, cd.cd_education_status\n), StoreStats AS (\n    SELECT \n        s.s_store_name, \n        SUM(ss.ss_quantity) AS total_sales_quantity, \n        SUM(ss.ss_net_profit) AS total_sales_net_profit\n    FROM \n        store s\n    JOIN \n        store_sales ss ON s.s_store_sk = ss.ss_store_sk\n    JOIN \n        date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023 \n    GROUP BY \n        s.s_store_name\n), PromotionImpact AS (\n    SELECT \n        p.p_promo_name,\n        SUM(ws.ws_net_profit) AS total_promo_net_profit\n    FROM \n        promotion p\n    JOIN \n        web_sales ws ON p.p_promo_sk = ws.ws_promo_sk\n    JOIN \n        date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk\n    WHERE \n        dd.d_year = 2023\n    GROUP BY \n        p.p_promo_name\n)\nSELECT \n    cs.cd_gender,\n    cs.cd_marital_status,\n    cs.cd_education_status,\n    cs.total_quantity AS customer_total_quantity,\n    cs.total_net_profit AS customer_total_net_profit,\n    cs.customers_count,\n    ss.s_store_name,\n    ss.total_sales_quantity,\n    ss.total_sales_net_profit,\n    pi.p_promo_name,\n    pi.total_promo_net_profit\nFROM \n    CustomerStats cs\nJOIN \n    StoreStats ss ON cs.total_net_profit > ss.total_sales_net_profit\nJOIN \n    PromotionImpact pi ON cs.total_net_profit > pi.total_promo_net_profit\nORDER BY \n    cs.cd_gender, ss.total_sales_net_profit DESC;\n",
  "\nWITH sales_summary AS (\n    SELECT \n        c.c_customer_sk,\n        SUM(COALESCE(ws.ws_net_profit, 0) + COALESCE(cs.cs_net_profit, 0) + COALESCE(ss.ss_net_profit, 0)) AS total_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS web_orders,\n        COUNT(DISTINCT cs.cs_order_number) AS catalog_orders,\n        COUNT(DISTINCT ss.ss_ticket_number) AS store_orders\n    FROM \n        customer c\n    LEFT JOIN \n        web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\n    LEFT JOIN \n        catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk\n    LEFT JOIN \n        store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\n    GROUP BY \n        c.c_customer_sk\n),\ndate_summary AS (\n    SELECT \n        d.d_year,\n        COUNT(DISTINCT ds.c_customer_sk) AS active_customers,\n        SUM(ds.total_net_profit) AS annual_net_profit\n    FROM \n        date_dim d\n    JOIN \n        sales_summary ds ON d.d_date_sk = (SELECT MAX(d2.d_date_sk) FROM date_dim d2 WHERE d2.d_date = DATE '2002-10-01')\n    GROUP BY \n        d.d_year\n),\ncustomer_demographics AS (\n    SELECT \n        cd.cd_demo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        ib.ib_income_band_sk,\n        COUNT(c.c_customer_sk) AS customer_count\n    FROM \n        customer_demographics cd\n    JOIN \n        customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    JOIN \n        household_demographics hd ON hd.hd_demo_sk = c.c_current_hdemo_sk\n    JOIN \n        income_band ib ON ib.ib_income_band_sk = hd.hd_income_band_sk\n    GROUP BY \n        cd.cd_demo_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, ib.ib_income_band_sk\n)\nSELECT \n    cd.cd_gender AS customer_gender,\n    cd.cd_marital_status AS marital_status,\n    cd.cd_education_status AS education,\n    ib.ib_lower_bound AS income_lower,\n    ib.ib_upper_bound AS income_upper,\n    SUM(ds.active_customers) AS total_active_customers,\n    SUM(ds.annual_net_profit) AS total_net_profit\nFROM \n    customer_demographics cd \nJOIN \n    date_summary ds ON cd.customer_count > 0\nJOIN \n    income_band ib ON ib.ib_income_band_sk = cd.ib_income_band_sk\nGROUP BY \n    cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, ib.ib_lower_bound, ib.ib_upper_bound\nORDER BY \n    total_net_profit DESC;\n",
  "WITH address_summary AS (\n    SELECT \n        ca.ca_city,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count,\n        COUNT(DISTINCT s.s_store_sk) AS store_count,\n        SUM(CASE WHEN cd.cd_gender = 'M' THEN 1 ELSE 0 END) AS male_count,\n        SUM(CASE WHEN cd.cd_gender = 'F' THEN 1 ELSE 0 END) AS female_count,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        customer_address ca\n    JOIN \n        customer c ON ca.ca_address_sk = c.c_current_addr_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        store s ON s.s_city = ca.ca_city\n    GROUP BY \n        ca.ca_city\n),\nincome_analysis AS (\n    SELECT \n        ib.ib_lower_bound,\n        ib.ib_upper_bound,\n        SUM(cd.cd_dep_count) AS total_dependents,\n        COUNT(DISTINCT c.c_customer_sk) AS customer_count\n    FROM \n        household_demographics hd\n    JOIN \n        income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk\n    JOIN \n        customer c ON hd.hd_demo_sk = c.c_current_hdemo_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        ib.ib_lower_bound, ib.ib_upper_bound\n),\ndate_range AS (\n    SELECT \n        d.d_year,\n        d.d_month_seq,\n        COUNT(ws.ws_order_number) AS total_sales,\n        SUM(ws.ws_net_profit) AS total_profit\n    FROM \n        web_sales ws\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    GROUP BY \n        d.d_year, d.d_month_seq\n)\nSELECT \n    a.ca_city,\n    a.customer_count,\n    a.store_count,\n    a.male_count,\n    a.female_count,\n    a.avg_purchase_estimate,\n    i.ib_lower_bound,\n    i.ib_upper_bound,\n    i.total_dependents,\n    i.customer_count AS income_customer_count,\n    d.d_year,\n    d.d_month_seq,\n    d.total_sales,\n    d.total_profit\nFROM \n    address_summary a\nJOIN \n    income_analysis i ON a.customer_count > 0  \nLEFT JOIN \n    date_range d ON a.customer_count > 10  \nORDER BY \n    a.ca_city, i.ib_lower_bound;",
  "\nWITH sales_data AS (\n    SELECT \n        w.w_warehouse_name,\n        SUM(ws.ws_quantity) AS total_quantity,\n        SUM(ws.ws_ext_sales_price) AS total_sales_amount,\n        AVG(ws.ws_net_profit) AS avg_net_profit,\n        COUNT(DISTINCT ws.ws_order_number) AS total_orders\n    FROM \n        web_sales ws\n    JOIN \n        warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        item i ON ws.ws_item_sk = i.i_item_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    JOIN \n        date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n    WHERE \n        d.d_year = 2023 AND \n        cd.cd_gender = 'F' AND \n        i.i_current_price > 50.00\n    GROUP BY \n        w.w_warehouse_name\n),\nwarehouse_summary AS (\n    SELECT \n        w.w_warehouse_name,\n        COUNT(DISTINCT c.c_customer_sk) AS unique_customers,\n        AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate\n    FROM \n        warehouse w\n    JOIN \n        sales_data sd ON w.w_warehouse_name = sd.w_warehouse_name\n    JOIN \n        web_sales ws ON ws.ws_warehouse_sk = w.w_warehouse_sk\n    JOIN \n        customer c ON ws.ws_bill_customer_sk = c.c_customer_sk\n    JOIN \n        customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk\n    GROUP BY \n        w.w_warehouse_name\n)\nSELECT \n    sd.w_warehouse_name,\n    total_quantity,\n    total_sales_amount,\n    avg_net_profit,\n    unique_customers,\n    avg_purchase_estimate\nFROM \n    sales_data sd\nJOIN \n    warehouse_summary ws ON sd.w_warehouse_name = ws.w_warehouse_name\nORDER BY \n    total_sales_amount DESC, unique_customers DESC;\n"
]